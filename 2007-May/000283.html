<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Griffith-svn] r764 - in trunk: . lib/plugins/movie
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/griffith-svn/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r764%20-%20in%20trunk%3A%20.%20lib/plugins/movie&In-Reply-To=%3C200705311826.l4VIQVYn002523%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000282.html">
   <LINK REL="Next"  HREF="000284.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Griffith-svn] r764 - in trunk: . lib/plugins/movie</H1>
    <B>piotrek at BerliOS</B> 
    <A HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r764%20-%20in%20trunk%3A%20.%20lib/plugins/movie&In-Reply-To=%3C200705311826.l4VIQVYn002523%40sheep.berlios.de%3E"
       TITLE="[Griffith-svn] r764 - in trunk: . lib/plugins/movie">piotrek at mail.berlios.de
       </A><BR>
    <I>Thu May 31 20:26:31 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000282.html">[Griffith-svn] r763 - in trunk: . lib
</A></li>
        <LI>Next message: <A HREF="000284.html">[Griffith-svn] r765 - in trunk: . lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#283">[ date ]</a>
              <a href="thread.html#283">[ thread ]</a>
              <a href="subject.html#283">[ subject ]</a>
              <a href="author.html#283">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: piotrek
Date: 2007-05-31 20:26:30 +0200 (Thu, 31 May 2007)
New Revision: 764

Modified:
   trunk/ChangeLog
   trunk/lib/plugins/movie/PluginMovieIMDB-de.py
   trunk/lib/plugins/movie/PluginMovieIMDB.py
   trunk/lib/plugins/movie/PluginMovieKinoDe.py
Log:
IMDB, IMDB-de and KinoDe movie plugins updated (thanks to Michael Jahn)


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2007-05-22 18:23:41 UTC (rev 763)
+++ trunk/ChangeLog	2007-05-31 18:26:30 UTC (rev 764)
@@ -4,6 +4,9 @@
 ------------------
 (c) 2005-2007  Vasco Nunes, Piotr O&#380;arowski
 
+2007-05-31  Piotr O&#380;arowski
+	* IMDB, IMDB-de and KinoDe movie plugins updated (thanks to Michael Jahn)
+
 2007-05-22  Piotr O&#380;arowski
 	* Minor fix in dbupgrade.py
 

Modified: trunk/lib/plugins/movie/PluginMovieIMDB-de.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2007-05-22 18:23:41 UTC (rev 763)
+++ trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2007-05-31 18:26:30 UTC (rev 764)
@@ -32,7 +32,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>'
-plugin_version      = '1.0'
+plugin_version      = '1.1'
 
 class Plugin(movie.Movie):
 	def __init__(self, id):
@@ -40,6 +40,10 @@
 		self.movie_id = id
 		self.url = &quot;<A HREF="http://german.imdb.com/title/tt%s">http://german.imdb.com/title/tt%s</A>&quot; % str(self.movie_id)
 
+	def initialize(self):
+		self.cast_page = self.open_page(url=self.url + '/fullcredits')
+		self.plot_page = self.open_page(url=self.url + '/plotsummary')
+
 	def get_image(self):
 		tmp = string.find(self.page, 'a name=&quot;poster&quot;')
 		if tmp == -1:		# poster not available
@@ -61,15 +65,22 @@
 					break
 
 	def get_director(self):
-		self.director = gutils.trim(self.page,'&lt;h5&gt;Regie&lt;/h5&gt;', '&lt;br/&gt;\n&lt;br/&gt;')
+		self.director = gutils.trim(self.page,'&lt;h5&gt;Regie&lt;/h5&gt;', '&lt;br/&gt;\n')
+		if self.director == '':
+			self.director = gutils.trim(self.page,'&lt;h5&gt;Regisseur:&lt;/h5&gt;', '&lt;br/&gt;\n')
 		self.director = self.__before_more(self.director)
 		self.director = self.director.replace('&lt;br/&gt;', ', ')
 
 	def get_plot(self):
 		self.plot = gutils.trim(self.page, '&lt;h5&gt;Kurzbeschreibung:&lt;/h5&gt;', '&lt;/div&gt;')
 		self.plot = self.__before_more(self.plot)
-		plot_page = self.open_page(url=&quot;<A HREF="http://german.imdb.com/title/tt">http://german.imdb.com/title/tt</A>&quot; + str(self.movie_id) + &quot;/plotsummary&quot;)
-		self.plot = self.plot + '\n\n' + gutils.strip_tags(gutils.trim(plot_page, '&lt;p class=&quot;plotpar&quot;&gt;', '&lt;div'))
+		elements = string.split(self.plot_page, '&lt;p class=&quot;plotpar&quot;&gt;')
+		if len(elements) &gt; 1:
+			self.plot = self.plot + '\n\n'
+			elements[0] = ''
+			for element in elements:
+				if element != '':
+					self.plot = self.plot + gutils.strip_tags(gutils.before(element, '&lt;/a&gt;')) + '\n'
 
 	def get_year(self):
 		self.year = gutils.trim(self.page, '&lt;a href=&quot;/Sections/Years/', '&lt;/a&gt;')
@@ -84,7 +95,9 @@
 
 	def get_cast(self):
 		self.cast = ''
-		self.cast = gutils.trim(self.page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
+		self.cast = gutils.trim(self.cast_page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
+		if self.cast == '':
+			self.cast = gutils.trim(self.page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
 		self.cast = string.replace(self.cast, ' ... ', _(' as '))
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr&gt;', &quot;\n&quot;)
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;even&quot;&gt;', &quot;\n&quot;)
@@ -110,7 +123,7 @@
 		self.country = gutils.trim(self.page, '&lt;h5&gt;Produktionsland:&lt;/h5&gt;', '&lt;/div&gt;')
 
 	def get_rating(self):
-		self.rating = gutils.trim(self.page, '&lt;b&gt;Ihre Bewertung:&lt;/b&gt;', '/10')
+		self.rating = gutils.trim(self.page, '&lt;b&gt;Nutzer-Bewertung:&lt;/b&gt;', '/10')
 		if self.rating:
 			try:
 				self.rating = str(float(gutils.clean(self.rating)))
@@ -119,13 +132,13 @@
 
 	def get_notes(self):
 		self.notes = ''
-		language = gutils.trim(self.page, '&lt;h5&gt;Language:&lt;/h5&gt;', '&lt;/div&gt;')
+		language = gutils.trim(self.page, '&lt;h5&gt;Sprache:&lt;/h5&gt;', '&lt;/div&gt;')
 		language = gutils.strip_tags(language)
-		color = gutils.trim(self.page, '&lt;h5&gt;Color:&lt;/h5&gt;', '&lt;/div&gt;')
+		color = gutils.trim(self.page, '&lt;h5&gt;Farbe:&lt;/h5&gt;', '&lt;/div&gt;')
 		color = gutils.strip_tags(color)
-		sound = gutils.trim(self.page, '&lt;h5&gt;Sound Mix:&lt;/h5&gt;', '&lt;/div&gt;')
+		sound = gutils.trim(self.page, '&lt;h5&gt;Tonverfahren:&lt;/h5&gt;', '&lt;/div&gt;')
 		sound = gutils.strip_tags(sound)
-		tagline = gutils.trim(self.page, '&lt;h5&gt;Tagline:&lt;/h5&gt;', '&lt;/div&gt;')
+		tagline = gutils.trim(self.page, '&lt;h5&gt;Werbezeile:&lt;/h5&gt;', '&lt;/div&gt;')
 		tagline = self.__before_more(tagline)
 		tagline = gutils.strip_tags(tagline)
 		if len(language)&gt;0:

Modified: trunk/lib/plugins/movie/PluginMovieIMDB.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieIMDB.py	2007-05-22 18:23:41 UTC (rev 763)
+++ trunk/lib/plugins/movie/PluginMovieIMDB.py	2007-05-31 18:26:30 UTC (rev 764)
@@ -39,6 +39,10 @@
 		self.movie_id = id
 		self.url = &quot;<A HREF="http://imdb.com/title/tt%s">http://imdb.com/title/tt%s</A>&quot; % str(self.movie_id)
 
+	def initialize(self):
+		self.cast_page = self.open_page(url=self.url + '/fullcredits')
+		self.plot_page = self.open_page(url=self.url + '/plotsummary')
+
 	def get_image(self):
 		tmp = string.find(self.page, 'a name=&quot;poster&quot;')
 		if tmp == -1:		# poster not available
@@ -62,6 +66,13 @@
 	def get_plot(self):
 		self.plot = gutils.trim(self.page, '&lt;h5&gt;Plot Outline:&lt;/h5&gt;', '&lt;/div&gt;')
 		self.plot = self.__before_more(self.plot)
+		elements = string.split(self.plot_page, '&lt;p class=&quot;plotpar&quot;&gt;')
+		if len(elements) &gt; 1:
+			self.plot = self.plot + '\n\n'
+			elements[0] = ''
+			for element in elements:
+				if element &lt;&gt; '':
+					self.plot = self.plot + gutils.strip_tags(gutils.before(element, '&lt;/a&gt;')) + '\n'
 
 	def get_year(self):
 		self.year = gutils.trim(self.page, '&lt;a href=&quot;/Sections/Years/', '&lt;/a&gt;')
@@ -76,7 +87,9 @@
 
 	def get_cast(self):
 		self.cast = ''
-		self.cast = gutils.trim(self.page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
+		self.cast = gutils.trim(self.cast_page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
+		if self.cast == '':
+			self.cast = gutils.trim(self.page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
 		self.cast = string.replace(self.cast, ' ... ', _(' as '))
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr&gt;', &quot;\n&quot;)
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;even&quot;&gt;', &quot;\n&quot;)
@@ -88,7 +101,7 @@
 		self.classification = gutils.trim(self.classification, 'Rated ', ' ')
 
 	def get_studio(self):
-		self.studio = ''
+		self.studio = gutils.trim(self.page, '&lt;h5&gt;Company:&lt;/h5&gt;', '&lt;/a&gt;')
 
 	def get_o_site(self):
 		self.o_site = ''

Modified: trunk/lib/plugins/movie/PluginMovieKinoDe.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieKinoDe.py	2007-05-22 18:23:41 UTC (rev 763)
+++ trunk/lib/plugins/movie/PluginMovieKinoDe.py	2007-05-31 18:26:30 UTC (rev 764)
@@ -1,272 +1,281 @@
-# -*- coding: UTF-8 -*-
-
-__revision__ = '$Id$'
-
-# Copyright (c) 2006-2007
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU Library General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
-
-# You may use and distribute this software under the terms of the
-# GNU General Public License, version 2 or later
-
-from gettext import gettext as _
-import gutils
-import movie
-import string
-
-plugin_name = &quot;Kino.de&quot;
-plugin_description = &quot;KINO.DE&quot;
-plugin_url = &quot;www.kino.de&quot;
-plugin_language = _(&quot;German&quot;)
-plugin_author = &quot;Michael Jahn&quot;
-plugin_author_email = &quot;&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;&quot;
-plugin_version = &quot;1.5&quot;
-
-class Plugin(movie.Movie):
-	url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm.php4?">http://www.kino.de/kinofilm.php4?</A>&quot;
-	url_type = &quot;K&quot;
-
-	def __init__(self, id):
-		self.encode='iso-8859-1'
-		elements = string.split(id, &quot;_&quot;)
-		self.movie_id = elements[1]
-		if (elements[0] == &quot;V&quot;):
-			self.url_to_use = &quot;<A HREF="http://www.kino.de/videofilm.php4?">http://www.kino.de/videofilm.php4?</A>&quot;
-			self.url_type = &quot;V&quot;
-		else:
-			self.url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm.php4?">http://www.kino.de/kinofilm.php4?</A>&quot;
-			self.url_type = &quot;K&quot;
-		self.url = self.url_to_use + &quot;typ=film&amp;nr=&quot; + str(self.movie_id)
-
-	def initialize(self):
-		if (gutils.trim(self.url, &quot;typ=&quot;, &quot;&amp;&quot;) &lt;&gt; &quot;film&quot;):
-			self.url = self.url_to_use + &quot;typ=film&amp;nr=&quot; + str(self.movie_id)
-			self.open_page(self.parent_window)
-		self.tmp_page = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
-	
-	def get_image(self):
-		# first, try to get the second picture before the JavaScript block (it should be the original poster)
-		# if there is no second picture, use the first picture (it should be a picture from the film)
-		self.image_url = &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot; + gutils.trim(gutils.after(gutils.before(self.tmp_page, &quot;&lt;script language=&quot;), &quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;),&quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;, &quot;\&quot;&quot;)
-		if (self.image_url == &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;):
-			self.image_url = &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot; + gutils.trim(self.tmp_page,&quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;, &quot;\&quot;&quot;)
-
-	def get_o_title(self):
-		self.o_title = gutils.trim(self.page,&quot;span CLASS=\&quot;standardsmall\&quot;&gt;&lt;br&gt;(&quot;,&quot;)&lt;&quot;)
-
-	def get_title(self):
-		if (self.url_type == &quot;V&quot;):
-			self.title = gutils.after(gutils.trim(self.page,&quot;\&quot;headline2\&quot;&gt;&lt;A HREF=\&quot;/videofilm.php4?nr=&quot;, &quot;&lt;/A&gt;&quot;), &quot;&gt;&quot;)
-		else:
-			self.title = gutils.after(gutils.trim(self.page,&quot;\&quot;headline2\&quot;&gt;&lt;A HREF=\&quot;/kinofilm.php4?nr=&quot;, &quot;&lt;/A&gt;&quot;), &quot;&gt;&quot;)
-
-	def get_director(self):
-		if (gutils.trim(self.url, &quot;typ=&quot;, &quot;&amp;&quot;) &lt;&gt; &quot;credits&quot;):
-			self.url = self.url_to_use + &quot;typ=credits&amp;nr=&quot; + str(self.movie_id)
-			self.open_page(self.parent_window)
-		self.director = gutils.trim(self.page,&quot;Regie&quot;,&quot;&lt;/a&gt;&quot;)
-		self.director = gutils.after(self.director,&quot;mitwirk.php4&quot;)
-		self.director = gutils.after(self.director,&quot;&gt;&quot;)
-
-	def get_plot(self):
-		if (gutils.trim(self.url, &quot;typ=&quot;, &quot;&amp;&quot;) &lt;&gt; &quot;film&quot;):
-			self.url = self.url_to_use + &quot;typ=film&amp;nr=&quot; + str(self.movie_id)
-			self.open_page(self.parent_window)
-		self.tmp_page = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
-		# little steps to perfect plot (I hope ... it's a terrible structured content ... )
-		self.plot = gutils.trim(self.tmp_page,&quot;Kurzinfo&quot;, &quot;&lt;/TD&gt;&lt;/TR&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;TR&gt;&quot;)
-		if (self.plot == &quot;&quot;):
-			self.plot = gutils.trim(self.tmp_page,&quot;Kurzinfo&quot;, &quot;&lt;script language=\&quot;JavaScript\&quot;&gt;&quot;)
-		self.plot = gutils.after(self.plot, &quot;Fotoshow&lt;/A&gt;&quot;)
-		self.plot = gutils.after(self.plot, &quot;Filmpreise&lt;/A&gt;&quot;)
-		self.plot = gutils.after(self.plot, &quot;Games zum Film&lt;/A&gt;&quot;)
-		self.plot = gutils.after(self.plot, &quot; Crew&lt;/A&gt;&quot;)
-		self.plot = gutils.before(self.plot, &quot;FOTOSHOW&lt;/SPAN&gt;&quot;)
-		self.plot = gutils.after(self.plot, &quot;&lt;/TABLE&gt;&quot;)
-
-	def get_year(self):
-		self.year = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;BR&gt;&quot;)
-		if self.year == &quot;&quot;:
-			self.year = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;BR&gt;&quot;)
-		self.year = gutils.trim(self.year,&quot;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
-		self.year = gutils.after(self.year,&quot; &quot;)
-
-	def get_runtime(self):
-		self.runtime = gutils.trim(self.page,&quot;Jahren&lt;/b&gt; - &lt;b&gt;&quot;,&quot; Min.&quot;)
-		if (self.runtime == ''):
-			self.runtime = gutils.trim(self.page,&quot;Jahren&lt;/b&gt;&lt;/b&gt; - &lt;b&gt;&quot;,&quot; Min.&quot;)
-		if (self.runtime == ''):
-			self.runtime = gutils.trim(self.page,&quot;&lt;/b&gt;&lt;BR&gt;&lt;b&gt;&quot;,&quot; Min.&quot;)
-
-	def get_genre(self):
-		self.genre = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
-		if self.genre == &quot;&quot;:
-			self.genre = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
-
-	def get_cast(self):
-		if (gutils.trim(self.url, &quot;typ=&quot;, &quot;&amp;&quot;) &lt;&gt; &quot;credits&quot;):
-			self.url = self.url_to_use + &quot;typ=credits&amp;nr=&quot; + str(self.movie_id)
-			self.open_page(self.parent_window)
-		self.cast = gutils.trim(self.page,&quot;&lt;/TD&gt;&lt;/TR&gt;&lt;TR  CLASS=\&quot;dbtreffer&quot;, &quot;\n&quot;)
-		self.cast = gutils.after(self.cast, &quot;\&quot;&gt;&quot;)
-		self.cast = self.cast.replace(&quot;&lt;TR  CLASS=\&quot;dbtrefferlight\&quot;&gt;&quot;, &quot;\n&quot;)
-		self.cast = self.cast.replace(&quot;&lt;TR  CLASS=\&quot;dbtrefferdark\&quot;&gt;&quot;, &quot;\n&quot;)
-		self.cast = self.cast.replace(&quot;&nbsp;&quot;, &quot;--flip--&quot;)
-		self.cast = gutils.clean(self.cast)
-		elements = self.cast.split(&quot;\n&quot;)
-		self.cast = ''
-		for element in elements:
-			elements2 = element.split(&quot;--flip--&quot;)
-			if len(elements2) &gt; 1:
-				self.cast += elements2[1] + &quot;--flip--&quot; + elements2[0] + &quot;\n&quot;
-			else:
-				self.cast = element
-		self.cast = string.replace(self.cast, &quot;--flip--&quot;, _(&quot; as &quot;))
-
-	def get_classification(self):
-		self.classification = gutils.trim(self.page,&quot;FSK: &quot;,&quot;&lt;/b&gt;&quot;)
-
-	def get_studio(self):
-		self.studio = gutils.trim(self.page,&quot;Verleih: &quot;, &quot;&lt;/b&gt;&quot;)
-		if (self.studio == &quot;&quot;):
-			self.studio = gutils.trim(self.page,&quot;Anbieter: &quot;, &quot;&lt;/b&gt;&quot;)
-
-	def get_o_site(self):
-		self.o_site = &quot;&quot;
-
-	def get_site(self):
-		self.site = self.url_to_use + &quot;nr=&quot; + self.movie_id;
-
-	def get_trailer(self):
-		self.trailer = &quot;&quot;
-
-	def get_country(self):
-		self.country = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;BR&gt;&quot;)
-		if self.country == &quot;&quot;:
-			self.country = gutils.trim(self.page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;BR&gt;&quot;)
-		self.country = gutils.trim(self.country,&quot;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
-		self.country = gutils.before(self.country,&quot; &quot;)
-
-	def get_rating(self):
-		self.rating = &quot;0&quot;
-
-	def get_notes(self):
-		self.notes = &quot;&quot;
-		self.url = self.url_to_use + &quot;typ=features&amp;nr=&quot; + str(self.movie_id)
-		self.open_page(self.parent_window)
-		self.tmp_page = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
-		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_page, &quot;&lt;b&gt;Sprache&lt;/b&gt;&quot;, &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
-		if (tmp_notes != &quot;&quot;):
-			self.notes = self.notes + &quot;Sprachen:\n&quot; + tmp_notes + &quot;\n\n&quot;
-		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_page, &quot;&lt;b&gt;Untertitel&lt;/b&gt;&quot;, &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
-		if (tmp_notes != &quot;&quot;):
-			self.notes = self.notes + &quot;Untertitel:\n&quot; + tmp_notes + &quot;\n\n&quot;
-		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_page, &quot;&lt;b&gt;Mehrkanalton&lt;/b&gt;&quot;, &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
-		if (tmp_notes != &quot;&quot;):
-			self.notes = self.notes + &quot;Mehrkanalton:\n&quot; + tmp_notes + &quot;\n\n&quot;
-		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_page, &quot;&lt;b&gt;EAN&lt;/b&gt;&quot;, &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
-		if (tmp_notes != &quot;&quot;):
-			self.notes = self.notes + &quot;EAN:\n&quot; + tmp_notes + &quot;\n\n&quot;
-
-#
-# kino.de use iso-8859-1
-# it's not necessary to decode the page
-# in fact if utf-8 is used you can't search for movies with german umlaut
-# and if you use the decode call you get a terrible formatted result list
-#
-
-class SearchPlugin(movie.SearchMovie):
-
-	def __init__(self):
-		self.original_url_search    = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;wort=">http://www.kino.de/megasuche.php4?typ=filme&amp;wort=</A>&quot;
-		self.translated_url_search    = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;wort=">http://www.kino.de/megasuche.php4?typ=filme&amp;wort=</A>&quot;
-#		self.encode='utf-8'
-		self.encode='iso-8859-1'
-
-	def search(self,parent_window):
-		self.open_search(parent_window)
-		tmp_pagemovie = string.replace( self.page, &quot;&lt;/B&gt;&quot;, &quot;&lt;/b&gt;&quot; )
-		tmp_pagemovie = string.replace( tmp_pagemovie, &quot;A HREF&quot;, &quot;a href&quot; )
-		tmp_pagemovie = gutils.trim(tmp_pagemovie,'&lt;/b&gt;&lt;/div&gt;&lt;br&gt;', '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
-		#
-		# try to get all result pages (not so nice, but it works)
-		#
-		tmp_pagecount = gutils.trim(tmp_pagemovie, &quot;&nbsp;von &quot;, &quot;&lt;/SPAN&gt;&quot;)
-		try:
-			tmp_pagecountint = int(tmp_pagecount)
-		except:
-			tmp_pagecountint = 1
-		tmp_pagecountintcurrent = 1
-		while (tmp_pagecountint &gt; tmp_pagecountintcurrent):
-			tmp_pagecountintcurrent = tmp_pagecountintcurrent + 1
-			self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;page=">http://www.kino.de/megasuche.php4?typ=filme&amp;page=</A>&quot; + str(tmp_pagecountintcurrent) + &quot;&amp;wort=&quot;
-			self.open_search(parent_window)
-			tmp_page = string.replace( self.page, &quot;&lt;/B&gt;&quot;, &quot;&lt;/b&gt;&quot; )
-			tmp_page = string.replace( tmp_page, &quot;A HREF&quot;, &quot;a href&quot; )
-			tmp_page = gutils.trim(tmp_page,'&lt;/b&gt;&lt;/div&gt;&lt;br&gt;', '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
-			tmp_pagemovie = tmp_pagemovie + tmp_page
-		#
-		# Look for DVD and VHS
-		#
-		self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=video&amp;wort=">http://www.kino.de/megasuche.php4?typ=video&amp;wort=</A>&quot;
-		self.open_search(parent_window)
-		tmp_pagevideo = string.replace( self.page, &quot;&lt;B&gt;&quot;, &quot;&lt;b&gt;&quot; )
-		tmp_pagevideo = string.replace( tmp_pagevideo, &quot;A HREF&quot;, &quot;a href&quot; )
-		tmp_pagevideo = gutils.trim(tmp_pagevideo,&quot;align=center&gt;&lt;b&gt;Video/DVD 1&quot;, '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
-		tmp_pagevideo = tmp_pagemovie + tmp_pagevideo
-		#
-		# try to get all result pages (not so nice, but it works)
-		#
-		tmp_pagecount = gutils.trim(self.page, &quot;&nbsp;von &quot;, &quot;&lt;/SPAN&gt;&quot;)
-		try:
-			tmp_pagecountint = int(tmp_pagecount)
-		except:
-			tmp_pagecountint = 1
-		tmp_pagecountintcurrent = 1
-		while (tmp_pagecountint &gt; tmp_pagecountintcurrent):
-			tmp_pagecountintcurrent = tmp_pagecountintcurrent + 1
-			self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=video&amp;page=">http://www.kino.de/megasuche.php4?typ=video&amp;page=</A>&quot; + str(tmp_pagecountintcurrent) + &quot;&amp;wort=&quot;
-			self.open_search(parent_window)
-			tmp_page = string.replace( self.page, &quot;&lt;B&gt;&quot;, &quot;&lt;b&gt;&quot; )
-			tmp_page = string.replace( tmp_page, &quot;A HREF&quot;, &quot;a href&quot; )
-			tmp_page = gutils.trim(tmp_page,&quot;align=center&gt;&lt;b&gt;Video/DVD &quot;, '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
-			tmp_pagevideo = tmp_pagevideo + tmp_page
-
-		self.page = tmp_pagevideo
-		return self.page
-
-	def get_searches(self):
-		elements1 = string.split(self.page,'headline3&quot;&gt;&lt;a href=&quot;/kinofilm.php4?nr=')
-		elements1[0] = ''
-		for element in elements1:
-			if element &lt;&gt; '':
-				self.ids.append(&quot;K_&quot; + gutils.before(element,'&amp;'))
-				self.titles.append(gutils.strip_tags(
-					gutils.trim(element,&quot;&gt;&quot;,&quot;&lt;/A&gt;&quot;) + &quot; &quot; +
-					gutils.trim(element, &quot;&lt;span CLASS=\&quot;standardsmall\&quot;&gt;&lt;br&gt;&quot;, &quot;&lt;/SPAN&gt;&quot;) + &quot; (&quot; +
-					string.replace(
-						gutils.trim(element, &quot;&lt;span class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;, &quot;&lt;/span&gt;&quot;), &quot;&lt;b&gt;&quot;, &quot;, &quot;)
-							+ &quot;)&quot;))
-							
-		elements2 = string.split(self.page,'headline3&quot;&gt;&lt;a href=&quot;/videofilm.php4?nr=')
-		elements2[0] = ''
-		for element in elements2:
-			if element &lt;&gt; '':
-				self.ids.append(&quot;V_&quot; + gutils.before(element,'&amp;'))
-				self.titles.append(gutils.strip_tags( 
-					gutils.trim(element,&quot;&gt;&quot;,&quot;&lt;/A&gt;&quot;) + &quot; &quot; +
-					gutils.trim(element, '&lt;span CLASS=&quot;standardsmall&quot;&gt;&lt;br&gt;', '&lt;/SPAN&gt;') + &quot; (&quot; +
-					string.replace(
-						gutils.trim(element, '&lt;span class=&quot;standardsmall&quot;&gt;&lt;br&gt;&lt;b&gt;', &quot;&lt;/span&gt;&quot;), &quot;&lt;b&gt;&quot;, &quot;, &quot;) + &quot;)&quot;))
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright (c) 2006-2007
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+from gettext import gettext as _
+import gutils
+import movie
+import string
+
+plugin_name = &quot;Kino.de&quot;
+plugin_description = &quot;KINO.DE&quot;
+plugin_url = &quot;www.kino.de&quot;
+plugin_language = _(&quot;German&quot;)
+plugin_author = &quot;Michael Jahn&quot;
+plugin_author_email = &quot;&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;&quot;
+plugin_version = &quot;1.6&quot;
+
+class Plugin(movie.Movie):
+	url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm/">http://www.kino.de/kinofilm/</A>&quot;
+	url_type = &quot;K&quot;
+
+	def __init__(self, id):
+		self.encode='iso-8859-1'
+		elements = string.split(id, &quot;_&quot;)
+		self.movie_id = elements[1]
+		if (elements[0] == &quot;V&quot;):
+			self.url_to_use = &quot;<A HREF="http://www.kino.de/videofilm/">http://www.kino.de/videofilm/</A>&quot;
+			self.url_type = &quot;V&quot;
+		else:
+			self.url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm/">http://www.kino.de/kinofilm/</A>&quot;
+			self.url_type = &quot;K&quot;
+		self.url = self.url_to_use + str(self.movie_id)
+
+	def initialize(self):
+		self.tmp_page = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
+		self.url = self.url_to_use + string.replace(str(self.movie_id), '/', '/credits/')
+		self.open_page(self.parent_window)
+		self.tmp_creditspage = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
+		self.url = self.url_to_use + string.replace(str(self.movie_id), &quot;/&quot;, &quot;/features/&quot;)
+		self.open_page(self.parent_window)
+		self.tmp_dvdfeaturespage = gutils.trim(self.page, &quot;&lt;!-- PRINT-CONTENT-START--&gt;&quot;, &quot;&lt;!-- PRINT-CONTENT-ENDE--&gt;&quot;)
+
+	def get_image(self):
+		# first, try to get the second picture before the JavaScript block (it should be the original poster)
+		# if there is no second picture, use the first picture (it should be a picture from the film)
+		self.image_url = &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot; + gutils.trim(gutils.after(gutils.before(self.tmp_page, &quot;&lt;script language=&quot;), &quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;),&quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;, &quot;\&quot;&quot;)
+		if (self.image_url == &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;):
+			self.image_url = &quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot; + gutils.trim(self.tmp_page,&quot;img src=\&quot;<A HREF="http://images.kino.de/flbilder/">http://images.kino.de/flbilder/</A>&quot;, &quot;\&quot;&quot;)
+
+	def get_o_title(self):
+		self.o_title = gutils.trim(self.tmp_page,&quot;span class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;(&quot;,&quot;)&lt;&quot;)
+		if (self.plot == &quot;&quot;):
+			self.o_title = self.title
+
+	def get_title(self):
+		if (self.url_type == &quot;V&quot;):
+			self.title = gutils.after(gutils.trim(self.tmp_page,&quot;\&quot;headline2\&quot;&gt;&lt;a href=\&quot;<A HREF="http://www.kino.de/videofilm">http://www.kino.de/videofilm</A>&quot;, &quot;&lt;/a&gt;&quot;), &quot;&gt;&quot;)
+		else:
+			self.title = gutils.after(gutils.trim(self.tmp_page,&quot;\&quot;headline2\&quot;&gt;&lt;a href=\&quot;<A HREF="http://www.kino.de/kinofilm">http://www.kino.de/kinofilm</A>&quot;, &quot;&lt;/a&gt;&quot;), &quot;&gt;&quot;)
+		if (self.o_title == &quot;&quot;):
+			self.o_title = self.title
+
+	def get_director(self):
+		self.director = gutils.trim(self.tmp_creditspage,&quot;Regie&quot;,&quot;&lt;/a&gt;&quot;)
+		self.director = gutils.after(self.director,&quot;/star/&quot;)
+		self.director = gutils.after(self.director,&quot;&gt;&quot;)
+
+	def get_plot(self):
+		# little steps to perfect plot (I hope ... it's a terrible structured content ... )
+		self.plot = gutils.trim(self.tmp_page,&quot;Kurzinfo&quot;, &quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&quot;)
+		if (self.plot == &quot;&quot;):
+			self.plot = gutils.trim(self.tmp_page,&quot;Kurzinfo&quot;, &quot;&lt;script language=\&quot;JavaScript\&quot;&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;Fotoshow&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;Filmpreise&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;Games zum Film&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot; Crew&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;Soundtracks&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;DVD-Features&lt;/A&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot; Fassungen&lt;/A&gt;&quot;)
+		self.plot = gutils.before(self.plot, &quot;FOTOSHOW&lt;/span&gt;&quot;)
+		self.plot = gutils.after(self.plot, &quot;&lt;/TABLE&gt;&quot;)
+		self.plot = gutils.before(self.plot, &quot;&lt;/span&gt;&quot;)
+
+	def get_year(self):
+		self.year = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.year == &quot;&quot;:
+			self.year = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		self.year = gutils.trim(self.year,&quot;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
+		self.year = gutils.after(self.year,&quot; &quot;)
+
+	def get_runtime(self):
+		self.runtime = gutils.trim(self.tmp_page,&quot;Jahren&lt;/b&gt; - &lt;b&gt;&quot;,&quot; Min.&quot;)
+		if (self.runtime == ''):
+			self.runtime = gutils.trim(self.tmp_page,&quot;Jahren&lt;/b&gt;&lt;/b&gt; - &lt;b&gt;&quot;,&quot; Min.&quot;)
+		if (self.runtime == ''):
+			self.runtime = gutils.trim(self.tmp_page,&quot;&lt;/b&gt;&lt;br /&gt;&lt;b&gt;&quot;,&quot; Min.&quot;)
+
+	def get_genre(self):
+		self.genre = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
+		if self.genre == &quot;&quot;:
+			self.genre = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
+
+	def get_cast(self):
+		self.cast = gutils.trim(self.tmp_creditspage,&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr  class=\&quot;dbtrefferlight&quot;, &quot;&lt;/table&gt;&quot;)
+		if (self.cast == &quot;&quot;):
+			self.cast = gutils.trim(self.tmp_creditspage,&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=\&quot;dbtrefferlight&quot;, &quot;&lt;/table&gt;&quot;)
+		self.cast = gutils.after(self.cast, &quot;\&quot;&gt;&quot;)
+		self.cast = self.cast.replace(&quot;&lt;tr class=\&quot;dbtrefferlight\&quot;&gt;&quot;, &quot;\n&quot;)
+		self.cast = self.cast.replace(&quot;&lt;tr class=\&quot;dbtrefferdark\&quot;&gt;&quot;, &quot;\n&quot;)
+		self.cast = self.cast.replace(&quot;&lt;tr  class=\&quot;dbtrefferlight\&quot;&gt;&quot;, &quot;\n&quot;)
+		self.cast = self.cast.replace(&quot;&lt;tr  class=\&quot;dbtrefferdark\&quot;&gt;&quot;, &quot;\n&quot;)
+		self.cast = self.cast.replace(&quot;&nbsp;&quot;, &quot;--flip--&quot;)
+		self.cast = gutils.clean(self.cast)
+		elements = self.cast.split(&quot;\n&quot;)
+		self.cast = ''
+		for element in elements:
+			elements2 = element.split(&quot;--flip--&quot;)
+			if len(elements2) &gt; 1:
+				self.cast += elements2[1] + &quot;--flip--&quot; + elements2[0] + &quot;\n&quot;
+			else:
+				self.cast = element
+		self.cast = string.replace(self.cast, &quot;--flip--&quot;, _(&quot; as &quot;))
+
+	def get_classification(self):
+		self.classification = gutils.trim(self.tmp_page,&quot;FSK: &quot;,&quot;&lt;/b&gt;&quot;)
+
+	def get_studio(self):
+		self.studio = gutils.trim(self.tmp_page,&quot;Verleih: &quot;, &quot;&lt;/b&gt;&quot;)
+		if (self.studio == &quot;&quot;):
+			self.studio = gutils.trim(self.tmp_page,&quot;Anbieter: &quot;, &quot;&lt;/b&gt;&quot;)
+
+	def get_o_site(self):
+		self.o_site = &quot;&quot;
+
+	def get_site(self):
+		self.site = self.url_to_use + self.movie_id;
+
+	def get_trailer(self):
+		self.trailer = &quot;&quot;
+
+	def get_country(self):
+		self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;DVD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.country == &quot;&quot;:
+			self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;VHS&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.country == &quot;&quot;:
+			self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;Laser Disc&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.country == &quot;&quot;:
+			self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;Video CD&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.country == &quot;&quot;:
+			self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;br /&gt;&lt;b&gt;Blue-ray Disc&lt;/b&gt; - &lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		if self.country == &quot;&quot;:
+			self.country = gutils.trim(self.tmp_page,&quot;class=\&quot;standardsmall\&quot;&gt;&lt;b&gt;&quot;,&quot;&lt;br /&gt;&quot;)
+		self.country = gutils.trim(self.country,&quot;&lt;b&gt;&quot;,&quot;&lt;/b&gt;&quot;)
+		self.country = gutils.before(self.country,&quot; &quot;)
+
+	def get_rating(self):
+		self.rating = &quot;0&quot;
+
+	def get_notes(self):
+		self.notes = &quot;&quot;
+		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_dvdfeaturespage, &quot;&lt;b&gt;Sprache&lt;/b&gt;&quot;, &quot;&lt;/td&gt;&lt;/tr&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
+		if (tmp_notes != &quot;&quot;):
+			self.notes = self.notes + &quot;Sprachen:\n&quot; + tmp_notes + &quot;\n\n&quot;
+		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_dvdfeaturespage, &quot;&lt;b&gt;Untertitel&lt;/b&gt;&quot;, &quot;&lt;/td&gt;&lt;/tr&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
+		if (tmp_notes != &quot;&quot;):
+			self.notes = self.notes + &quot;Untertitel:\n&quot; + tmp_notes + &quot;\n\n&quot;
+		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_dvdfeaturespage, &quot;&lt;b&gt;Mehrkanalton&lt;/b&gt;&quot;, &quot;&lt;/td&gt;&lt;/tr&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
+		if (tmp_notes != &quot;&quot;):
+			self.notes = self.notes + &quot;Mehrkanalton:\n&quot; + tmp_notes + &quot;\n\n&quot;
+		tmp_notes = string.replace(gutils.strip_tags(gutils.trim(self.tmp_dvdfeaturespage, &quot;&lt;b&gt;EAN&lt;/b&gt;&quot;, &quot;&lt;/td&gt;&lt;/tr&gt;&quot;)), &quot;&nbsp;&quot;, &quot;&quot;)
+		if (tmp_notes != &quot;&quot;):
+			self.notes = self.notes + &quot;EAN:\n&quot; + tmp_notes + &quot;\n\n&quot;
+
+#
+# kino.de use iso-8859-1
+# it's not necessary to decode the page
+# in fact if utf-8 is used you can't search for movies with german umlaut
+# and if you use the decode call you get a terrible formatted result list
+#
+
+class SearchPlugin(movie.SearchMovie):
+
+	def __init__(self):
+		self.original_url_search    = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;wort=">http://www.kino.de/megasuche.php4?typ=filme&amp;wort=</A>&quot;
+		self.translated_url_search    = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;wort=">http://www.kino.de/megasuche.php4?typ=filme&amp;wort=</A>&quot;
+#		self.encode='utf-8'
+		self.encode='iso-8859-1'
+
+	def search(self,parent_window):
+		self.open_search(parent_window)
+		tmp_pagemovie = string.replace( self.page, &quot;&lt;/B&gt;&quot;, &quot;&lt;/b&gt;&quot; )
+		tmp_pagemovie = string.replace( tmp_pagemovie, &quot;A HREF&quot;, &quot;a href&quot; )
+		tmp_pagemovie = gutils.trim(tmp_pagemovie,'&lt;/b&gt;&lt;/div&gt;&lt;br&gt;', '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
+		#
+		# try to get all result pages (not so nice, but it works)
+		#
+		tmp_pagecount = gutils.trim(tmp_pagemovie, &quot;&nbsp;von &quot;, &quot;&lt;/SPAN&gt;&quot;)
+		try:
+			tmp_pagecountint = int(tmp_pagecount)
+		except:
+			tmp_pagecountint = 1
+		tmp_pagecountintcurrent = 1
+		while (tmp_pagecountint &gt; tmp_pagecountintcurrent and tmp_pagecountintcurrent &lt; 5):
+			tmp_pagecountintcurrent = tmp_pagecountintcurrent + 1
+			self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=filme&amp;page=">http://www.kino.de/megasuche.php4?typ=filme&amp;page=</A>&quot; + str(tmp_pagecountintcurrent) + &quot;&amp;wort=&quot;
+			self.open_search(parent_window)
+			tmp_page = string.replace( self.page, &quot;&lt;/B&gt;&quot;, &quot;&lt;/b&gt;&quot; )
+			tmp_page = string.replace( tmp_page, &quot;A HREF&quot;, &quot;a href&quot; )
+			tmp_page = gutils.trim(tmp_page,'&lt;/b&gt;&lt;/div&gt;&lt;br&gt;', '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
+			tmp_pagemovie = tmp_pagemovie + tmp_page
+		#
+		# Look for DVD and VHS
+		#
+		self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=video&amp;wort=">http://www.kino.de/megasuche.php4?typ=video&amp;wort=</A>&quot;
+		self.open_search(parent_window)
+		tmp_pagevideo = string.replace( self.page, &quot;&lt;B&gt;&quot;, &quot;&lt;b&gt;&quot; )
+		tmp_pagevideo = string.replace( tmp_pagevideo, &quot;A HREF&quot;, &quot;a href&quot; )
+		tmp_pagevideo = gutils.trim(tmp_pagevideo,&quot;align=center&gt;&lt;b&gt;Video/DVD 1&quot;, '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
+		tmp_pagevideo = tmp_pagemovie + tmp_pagevideo
+		#
+		# try to get all result pages (not so nice, but it works)
+		#
+		tmp_pagecount = gutils.trim(self.page, &quot;&nbsp;von &quot;, &quot;&lt;/SPAN&gt;&quot;)
+		try:
+			tmp_pagecountint = int(tmp_pagecount)
+		except:
+			tmp_pagecountint = 1
+		tmp_pagecountintcurrent = 1
+		while (tmp_pagecountint &gt; tmp_pagecountintcurrent and tmp_pagecountintcurrent &lt; 5):
+			tmp_pagecountintcurrent = tmp_pagecountintcurrent + 1
+			self.url = &quot;<A HREF="http://www.kino.de/megasuche.php4?typ=video&amp;page=">http://www.kino.de/megasuche.php4?typ=video&amp;page=</A>&quot; + str(tmp_pagecountintcurrent) + &quot;&amp;wort=&quot;
+			self.open_search(parent_window)
+			tmp_page = string.replace( self.page, &quot;&lt;B&gt;&quot;, &quot;&lt;b&gt;&quot; )
+			tmp_page = string.replace( tmp_page, &quot;A HREF&quot;, &quot;a href&quot; )
+			tmp_page = gutils.trim(tmp_page,&quot;align=center&gt;&lt;b&gt;Video/DVD &quot;, '&lt;!-- PRINT-CONTENT-ENDE--&gt;');
+			tmp_pagevideo = tmp_pagevideo + tmp_page
+
+		self.page = tmp_pagevideo
+		return self.page
+
+	def get_searches(self):
+		elements1 = string.split(self.page,'headline3&quot;&gt;&lt;a href=&quot;<A HREF="http://www.kino.de/kinofilm/">http://www.kino.de/kinofilm/</A>')
+		elements1[0] = ''
+		for element in elements1:
+			if element &lt;&gt; '':
+				self.ids.append(&quot;K_&quot; + gutils.before(element,'&quot;'))
+				self.titles.append(gutils.strip_tags(
+					gutils.trim(element,&quot;&gt;&quot;,&quot;&lt;/a&gt;&quot;) + &quot; (&quot; +
+					gutils.trim(element, '&lt;span class=&quot;standardsmall&quot;&gt;', &quot;&lt;/span&gt;&quot;) + &quot;)&quot;
+					)
+				)
+
+		elements2 = string.split(self.page,'headline3&quot;&gt;&lt;a href=&quot;<A HREF="http://www.kino.de/videofilm/">http://www.kino.de/videofilm/</A>')
+		elements2[0] = ''
+		for element in elements2:
+			if element &lt;&gt; '':
+				self.ids.append(&quot;V_&quot; + gutils.before(element,'&quot;'))
+				self.titles.append(gutils.strip_tags(
+					gutils.trim(element,&quot;&gt;&quot;,&quot;&lt;/a&gt;&quot;) + &quot; (&quot; +
+					gutils.trim(element, '&lt;span class=&quot;standardsmall&quot;&gt;', '&lt;/span&gt;') + &quot;)&quot;
+					)
+				)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000282.html">[Griffith-svn] r763 - in trunk: . lib
</A></li>
	<LI>Next message: <A HREF="000284.html">[Griffith-svn] r765 - in trunk: . lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#283">[ date ]</a>
              <a href="thread.html#283">[ thread ]</a>
              <a href="subject.html#283">[ subject ]</a>
              <a href="author.html#283">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/griffith-svn">More information about the Griffith-svn
mailing list</a><br>
</body></html>
