From piotrek at mail.berlios.de  Sat Oct 18 23:46:29 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sat, 18 Oct 2008 23:46:29 +0200
Subject: [Griffith-svn] r1004 - in trunk: . lib lib/plugins/imp
Message-ID: <200810182146.m9ILkTRS027673@sheep.berlios.de>

Author: piotrek
Date: 2008-10-18 23:46:28 +0200 (Sat, 18 Oct 2008)
New Revision: 1004

Modified:
   trunk/ChangeLog
   trunk/lib/advfilter.py
   trunk/lib/delete.py
   trunk/lib/plugins/imp/CSV.py
   trunk/lib/plugins/imp/__init__.py
Log:
Speed up import movies function


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-09-23 19:03:59 UTC (rev 1003)
+++ trunk/ChangeLog	2008-10-18 21:46:28 UTC (rev 1004)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-18  Piotr O?arowski
+	* Speed up import movies function
+
 2008-09-23  Michael Jahn
 	* [#273172] "Properties/Volume/show...in this volume" is broken
 

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-09-23 19:03:59 UTC (rev 1003)
+++ trunk/lib/advfilter.py	2008-10-18 21:46:28 UTC (rev 1004)
@@ -37,7 +37,7 @@
     'no_volumes'      : set(), # list of volume_ids     (search for movies outside these volumes)
     'tags'            : set(), # list of tag_ids        (search for movies with these tags)
     'no_tags'         : set(), # list of tag_ids        (search for movies without these tags)
-    'loaned_to'       : set(), # list of person_ids	 (search for movies loaned to these people)
+    'loaned_to'       : set(), # list of person_ids	    (search for movies loaned to these people)
     'sort_by'         : set(("number",)), # "number DESC"
     'equals'          : {}, # {column1: [value1, value2, ...], column2: []}
     'startswith'      : {}, # see above

Modified: trunk/lib/delete.py
===================================================================
--- trunk/lib/delete.py	2008-09-23 19:03:59 UTC (rev 1003)
+++ trunk/lib/delete.py	2008-10-18 21:46:28 UTC (rev 1004)
@@ -41,8 +41,7 @@
         gutils.warning(self, msg=_("You can't delete movie while it is loaned."))
         return False
 
-    response = gutils.question(self, _("Are you sure you want to delete this movie?"), \
-        1, self.widgets['window'])
+    response = gutils.question(_("Are you sure you want to delete this movie?"), True, self.widgets['window'])
     if response == -8:    # gtk.RESPONSE_YES == -8
         delete_poster(self, movie.poster_md5)
 

Modified: trunk/lib/plugins/imp/CSV.py
===================================================================
--- trunk/lib/plugins/imp/CSV.py	2008-09-23 19:03:59 UTC (rev 1003)
+++ trunk/lib/plugins/imp/CSV.py	2008-10-18 21:46:28 UTC (rev 1004)
@@ -57,7 +57,7 @@
         try:
             self.gtk = gtk.glade.XML(gf)
         except:
-            log.info("Glade-file %s can not be loaded." % gf)
+            log.info("Glade-file %s can not be loaded.", gf)
             return False
         # open gtk window
         self.gtk.get_widget('d_import').set_transient_for( self.widgets['window'] )
@@ -372,7 +372,7 @@
         import copy
         # start with the right line
         self.current_csv_row += 1
-        if (self.current_csv_row ) < self.start_row:
+        if self.current_csv_row < self.start_row:
             return None
         
         # assign the keys
@@ -390,15 +390,17 @@
                     t_movies[field] = letters_only( item[ int(self.import_table[field]) ] )
                 elif field == 'cast':
                     try:
-                        if item[ int(self.import_table[field]) ].index(", ") != -1:
-                            t_movies[field] = string.replace( item[ int(self.import_table[field]) ], ", ", "\n" )
+                        if item[int(self.import_table[field])].index(", ") != -1:
+                            t_movies[field] = item[ int(self.import_table[field]) ].replace(', ', "\n")
                     except:
-                        t_movies[field] = string.replace( item[ int(self.import_table[field]) ], ",", "\n" )
+                        t_movies[field] = item[ int(self.import_table[field]) ].replace(',', "\n")
+                    t_movies[field] = unicode(t_movies[field])
                 else:
                     # 1:1 import
-                    t_movies[field] = item[ int(self.import_table[field]) ]
+                    t_movies[field] = unicode(item[ int(self.import_table[field])])
             except:
                 # error field can't be imported
+                log.debug("field %s cannot be imported (%s)", field, e)
                 t_movies.pop(field)
         
         return t_movies

Modified: trunk/lib/plugins/imp/__init__.py
===================================================================
--- trunk/lib/plugins/imp/__init__.py	2008-09-23 19:03:59 UTC (rev 1003)
+++ trunk/lib/plugins/imp/__init__.py	2008-10-18 21:46:28 UTC (rev 1004)
@@ -22,14 +22,21 @@
 # GNU General Public License, version 2 or later
 
 # detect all plugins:
-import glob, os.path
+import glob
+import os.path
+import time
+import gc
 import gettext
 gettext.install('griffith', unicode=1)
+import logging
+log = logging.getLogger("Griffith")
 
+import db
+
 __all__ = [os.path.basename(x)[:-3] for x in glob.glob("%s/*.py" % os.path.dirname(__file__))]
 __all__.remove('__init__')
 
-class ImportPlugin:
+class ImportPlugin(object):
     description = None
     author = None
     email = None
@@ -44,17 +51,17 @@
     data = None
 
     def __init__(self, parent, fields_to_import):
-        self.db        = parent.db
-        self.locations    = parent.locations
-        self.fields    = parent.field_names
-        self.conditions    = parent._conditions
-        self.colors    = parent._colors
-        self.lang_types    = parent._lang_types
-        self.layers    = parent._layers
-        self.regions    = parent._regions
-        self.widgets    = parent.widgets['import']
+        self.db = parent.db
+        self.locations = parent.locations
+        self.fields = parent.field_names
+        self.conditions = parent._conditions
+        self.colors = parent._colors
+        self.lang_types = parent._lang_types
+        self.layers = parent._layers
+        self.regions = parent._regions
+        self.widgets = parent.widgets['import']
         self.fields_to_import = fields_to_import
-        self._abort    = False
+        self._continue = True
 
     def initialize(self):
         """Initializes plugin (get all parameters from user, etc.)"""
@@ -63,7 +70,7 @@
 
     def abort(self, *args):
         """called after abort button clicked"""
-        self._abort = True
+        self._continue = False
 
     def set_source(self, name):
         """Prepare source (open file, etc.)"""
@@ -80,11 +87,11 @@
         """Import movies, function called in a loop over source files"""
         from add import validate_details, edit_movie
         from gutils import find_next_available
-        from sqlalchemy import Select, func
+        from sqlalchemy import select, func
         import gtk
         
         if not self.set_source(name):
-            log.info("Can't read data from file %s" % name)
+            log.info("Can't read data from file %s", name)
             return False
         
         self.widgets['pwindow'].show()
@@ -98,68 +105,80 @@
             for i in range(0,100):
                 update_on.append(int(float(i)/100*count))
 
-        statement = Select( [ func.max(self.db.Movie.c.number) ] )
-        number = statement.execute().fetchone()[0]
+        session = self.db.Session()
+        session.bind = self.db.session.bind
+        
+        number = session.execute(select([func.max(db.Movie.number)])).fetchone()[0]
         if number is None:
             number = 1
         else:
             number += 1
 
-        statement = Select([self.db.Movie.c.number])
-
         # move some stuff outside the loop to speed it up
         set_fraction = self.widgets['progressbar'].set_fraction
         set_text = self.widgets['progressbar'].set_text
         main_iteration = gtk.main_iteration
 
+        gc_was_enabled = gc.isenabled()
+        if gc_was_enabled:
+            gc.collect()
+            gc.disable()
+
+        begin = time.time()
         processed = 0
-        while self._abort is False:
+        while self._continue:
             details = self.get_movie_details()
             if details is None:
                 break
-
+            
             processed += 1
             if processed in update_on:
-                set_fraction(float(processed)/float(count))
+                set_fraction(float(processed)/count)
                 main_iteration()
-                set_text("%s (%s/%s)" % (str(self.imported), str(processed), str(count)))
+                set_text("%s (%s/%s)" % (self.imported, processed, count))
                 main_iteration()
                 main_iteration() # extra iteration for abort button
 
-            if (details.has_key('o_title') and details['o_title']) or (details.has_key('title') and details['title']):
-                if details.has_key('o_title') and details['o_title']:
-                    statement.whereclause = func.lower(self.db.Movie.c.o_title)==details['o_title'].lower()
-                    if details.has_key('title') and details['title']:
-                        statement.append_whereclause( func.lower(self.db.Movie.c.title)==details['title'].lower() )
-                    tmp = statement.execute().fetchone()
+            statement = select([db.Movie.number])
+            o_title_avail = 'o_title' in details
+            title_avail = 'title' in details
+            if (o_title_avail and details['o_title']) or (title_avail and details['title']):
+                if o_title_avail and details['o_title']:
+                    statement.append_whereclause(func.lower(db.Movie.o_title)==details['o_title'].lower())
+                    if title_avail and details['title']:
+                        statement.append_whereclause(func.lower(db.Movie.title)==details['title'].lower())
+                    tmp = session.execute(statement).fetchone()
                     if tmp is not None:
-                        log.info("movie already exists (number=%s, o_title=%s)" % (tmp.number, details['o_title']))
+                        log.info("movie already exists (number=%s, o_title=%s)", tmp.number, details['o_title'])
                         continue
-                elif details.has_key('title') and details['title']:
-                    statement.whereclause = func.lower(self.db.Movie.c.title)==details['title'].lower()
-                    tmp = statement.execute().fetchone()
+                elif title_avail and details['title']:
+                    statement.append_whereclause(func.lower(db.Movie.title)==details['title'].lower())
+                    tmp = session.execute(statement).fetchone()
                     if tmp is not None:
-                        log.info("movie already exists (number=%s, title=%s)" % (tmp.number, details['title']))
+                        log.info("movie already exists (number=%s, title=%s)", tmp.number, details['title'])
                         continue
                 validate_details(details, self.fields_to_import)
-                if self.edit is True:
+                if self.edit:
                     response = edit_movie(self.parent, details)    # FIXME: wait until save or cancel button pressed
                     if response == 1:
                         self.imported += 1
                 else:
-                    if not details.has_key('number') or (details.has_key('number') and details['number'] is None):
+                    if not details.get('number'):
                         #details['number'] = find_next_available(self.db)
                         details['number'] = number
                         number += 1
-                    #movie = self.db.Movie()
+                    #movie = db.Movie()
                     #movie.add_to_db(details)
                     try:
-                        self.db.Movie.mapper.mapped_table.insert().execute(details)
+                        db.movies_table.insert(bind=self.db.session.bind).execute(details)
                         self.imported += 1
                     except Exception, e:
-                        log.info("movie details are not unique, skipping: %s" % str(e))
+                        log.info("movie details are not unique, skipping: %s", e)
             else:
                 log.info('skipping movie without title or original title')
+        log.info("Import process took %s s; %s/%s movies imported", (time.time() - begin), processed, count)
+        if gc_was_enabled:
+            gc.enable()
         self.widgets['pwindow'].hide()
         return True
 
@@ -168,7 +187,7 @@
         self.data = None
         self.imported = 0
         self.__source_name = None
-        self._abort = False
+        self._continue = True
     
     def destroy(self):
         """close all resources"""



From piotrek at mail.berlios.de  Sun Oct 19 00:57:59 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 00:57:59 +0200
Subject: [Griffith-svn] r1005 - trunk/lib/plugins/imp
Message-ID: <200810182257.m9IMvx5R031222@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 00:57:58 +0200 (Sun, 19 Oct 2008)
New Revision: 1005

Modified:
   trunk/lib/plugins/imp/CSV.py
   trunk/lib/plugins/imp/__init__.py
Log:
speed up improt movies even more


Modified: trunk/lib/plugins/imp/CSV.py
===================================================================
--- trunk/lib/plugins/imp/CSV.py	2008-10-18 21:46:28 UTC (rev 1004)
+++ trunk/lib/plugins/imp/CSV.py	2008-10-18 22:57:58 UTC (rev 1005)
@@ -35,9 +35,9 @@
     import string, re
     _match = re.compile(r"\D+")
     try:
-        s = reduce( string.join, _match.findall(s) )
+        s = reduce( unicode.join, _match.findall(s) )
     except:
-        s = s
+        s = unicode(s)
     return s
     
 class ImportPlugin(IP):
@@ -330,11 +330,11 @@
                 if detector.done or lines == 50:
                     break
             detector.close()
-            encoding = string.replace( string.lower( detector.result['encoding'] ), '-', '' )
+            encoding = detector.result['encoding'].replace('-', '')
         except:
             encoding = 'utf_8'
         # remove - and _ for better detection
-        encoding = string.replace( encoding, '_', '' )
+        encoding = encoding.replace('_', '')
         
         model    = self.gtk.get_widget('e_encoding').get_model()
         itempos    = 0

Modified: trunk/lib/plugins/imp/__init__.py
===================================================================
--- trunk/lib/plugins/imp/__init__.py	2008-10-18 21:46:28 UTC (rev 1004)
+++ trunk/lib/plugins/imp/__init__.py	2008-10-18 22:57:58 UTC (rev 1005)
@@ -108,17 +108,18 @@
         session = self.db.Session()
         session.bind = self.db.session.bind
         
-        number = session.execute(select([func.max(db.Movie.number)])).fetchone()[0]
-        if number is None:
-            number = 1
-        else:
-            number += 1
-
         # move some stuff outside the loop to speed it up
         set_fraction = self.widgets['progressbar'].set_fraction
         set_text = self.widgets['progressbar'].set_text
         main_iteration = gtk.main_iteration
 
+        # get some values from DB to avoid queries in the loop
+        statement = select([db.Movie.number, db.Movie.title, db.Movie.o_title])
+        data = session.execute(statement).fetchall()
+        numbers = set([i[0] for i in data])
+        titles = set(i[1].lower() for i in data)
+        o_titles = set(i[2].lower() for i in data)
+
         gc_was_enabled = gc.isenabled()
         if gc_was_enabled:
             gc.collect()
@@ -139,34 +140,27 @@
                 main_iteration()
                 main_iteration() # extra iteration for abort button
 
-            statement = select([db.Movie.number])
             o_title_avail = 'o_title' in details
             title_avail = 'title' in details
+
             if (o_title_avail and details['o_title']) or (title_avail and details['title']):
-                if o_title_avail and details['o_title']:
-                    statement.append_whereclause(func.lower(db.Movie.o_title)==details['o_title'].lower())
-                    if title_avail and details['title']:
-                        statement.append_whereclause(func.lower(db.Movie.title)==details['title'].lower())
-                    tmp = session.execute(statement).fetchone()
-                    if tmp is not None:
-                        log.info("movie already exists (number=%s, o_title=%s)", tmp.number, details['o_title'])
+                if o_title_avail and details['o_title'].lower() in o_titles:
+                    if title_avail and details['title'].lower() in titles:
+                        log.info("movie already exists (o_title=%s, title=%s)", details['o_title'], details['title'])
                         continue
-                elif title_avail and details['title']:
-                    statement.append_whereclause(func.lower(db.Movie.title)==details['title'].lower())
-                    tmp = session.execute(statement).fetchone()
-                    if tmp is not None:
-                        log.info("movie already exists (number=%s, title=%s)", tmp.number, details['title'])
-                        continue
+                elif title_avail and details['title'].lower() in titles: # o_title is not available so lets check title only
+                    log.info("movie already exists (title=%s)", details['title'])
+                    continue
                 validate_details(details, self.fields_to_import)
-                if self.edit:
+                if self.edit: # XXX: not used for now
                     response = edit_movie(self.parent, details)    # FIXME: wait until save or cancel button pressed
                     if response == 1:
                         self.imported += 1
                 else:
-                    if not details.get('number'):
-                        #details['number'] = find_next_available(self.db)
-                        details['number'] = number
+                    number = details.get('number', 1)
+                    while number in numbers:
                         number += 1
+                    details['number'] = number
                     #movie = db.Movie()
                     #movie.add_to_db(details)
                     try:
@@ -174,8 +168,9 @@
                         self.imported += 1
                     except Exception, e:
                         log.info("movie details are not unique, skipping: %s", e)
+                    numbers.add(number)
             else:
-                log.info('skipping movie without title or original title')
+                log.info('skipping movie without title and original title')
         log.info("Import process took %s s; %s/%s movies imported", (time.time() - begin), processed, count)
         if gc_was_enabled:
             gc.enable()



From piotrek at mail.berlios.de  Sun Oct 19 15:24:35 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 15:24:35 +0200
Subject: [Griffith-svn] r1006 - in trunk: . glade lib
Message-ID: <200810191324.m9JDOZTQ008528@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 15:24:34 +0200 (Sun, 19 Oct 2008)
New Revision: 1006

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/lib/advfilter.py
   trunk/lib/sql.py
   trunk/lib/widgets.py
Log:
Add tags/volumes/collections to adv. filter window

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-18 22:57:58 UTC (rev 1005)
+++ trunk/ChangeLog	2008-10-19 13:24:34 UTC (rev 1006)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-19  Piotr O?arowski
+	* Add tags/volumes/collections to adv. filter window
+
 2008-10-18  Piotr O?arowski
 	* Speed up import movies function
 

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-18 22:57:58 UTC (rev 1005)
+++ trunk/glade/griffith.glade	2008-10-19 13:24:34 UTC (rev 1006)
@@ -975,95 +975,110 @@
                             <property name="column_spacing">5</property>
                             <property name="row_spacing">2</property>
                             <child>
-                              <widget class="GtkLabel" id="label278">
+                              <widget class="GtkLabel" id="m_director">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">director</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
-                                <property name="x_options">GTK_FILL</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label277">
+                              <widget class="GtkLabel" id="m_vcodec">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">video codec</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">10</property>
+                                <property name="bottom_attach">11</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label274">
+                              <widget class="GtkLabel" id="m_condition">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">condition</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label237">
+                              <widget class="GtkLabel" id="m_medium">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">2 x medium</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label284">
+                              <widget class="GtkLabel" id="m_layers">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">layers</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label285">
+                              <widget class="GtkLabel" id="m_region">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">region</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="top_attach">6</property>
                                 <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1071,141 +1086,163 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label286">
+                              <widget class="GtkLabel" id="m_color">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">color</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label287">
+                              <widget class="GtkLabel" id="m_classification">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="label" translatable="yes">classification</property>
                                 <property name="use_markup">True</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label288">
+                              <widget class="GtkLabel" id="m_studio">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">studio</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label289">
+                              <widget class="GtkLabel" id="m_genre">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">genre</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label22">
+                              <widget class="GtkLabel" id="m_country">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label">country</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label27">
+                              <widget class="GtkLabel" id="label290">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Country</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label29">
+                              <widget class="GtkLabel" id="label196">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label" translatable="yes">Video codec</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">10</property>
+                                <property name="bottom_attach">11</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label34">
+                              <widget class="GtkLabel" id="label110">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Studio</property>
+                                <property name="label" translatable="yes">Condition</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label33">
+                              <widget class="GtkLabel" id="label38">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Classification</property>
+                                <property name="label" translatable="yes">Medium</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="Color">
+                              <widget class="GtkLabel" id="label109">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Color</property>
+                                <property name="label" translatable="yes">DVD layers</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -1224,180 +1261,155 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label109">
+                              <widget class="GtkLabel" id="Color">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">DVD layers</property>
+                                <property name="label" translatable="yes">Color</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label38">
+                              <widget class="GtkLabel" id="label33">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Medium</property>
+                                <property name="label" translatable="yes">Classification</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label110">
+                              <widget class="GtkLabel" id="label34">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Condition</property>
+                                <property name="label" translatable="yes">Studio</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label196">
+                              <widget class="GtkLabel" id="label29">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Video codec</property>
+                                <property name="label" translatable="yes">Genre</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label290">
+                              <widget class="GtkLabel" id="label27">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Country</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_country">
+                              <widget class="GtkLabel" id="label22">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">country</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Director</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_genre">
+                              <widget class="GtkLabel" id="label289">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">genre</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">10</property>
+                                <property name="bottom_attach">11</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_studio">
+                              <widget class="GtkLabel" id="label288">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">studio</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_classification">
+                              <widget class="GtkLabel" id="label287">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">classification</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
                                 <property name="use_markup">True</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_color">
+                              <widget class="GtkLabel" id="label286">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">color</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_region">
+                              <widget class="GtkLabel" id="label285">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">region</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">6</property>
                                 <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1405,94 +1417,82 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_layers">
+                              <widget class="GtkLabel" id="label284">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">layers</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_medium">
+                              <widget class="GtkLabel" id="label237">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">2 x medium</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_condition">
+                              <widget class="GtkLabel" id="label274">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">condition</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_vcodec">
+                              <widget class="GtkLabel" id="label277">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">video codec</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_director">
+                              <widget class="GtkLabel" id="label278">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">director</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -2618,46 +2618,52 @@
                               <placeholder/>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_image">
+                              <widget class="GtkCheckButton" id="view_rating">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Image</property>
+                                <property name="label" translatable="yes">Rating</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
-                                <signal name="clicked" handler="on_view_image_clicked"/>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">4</property>
+                                <property name="right_attach">5</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_number">
+                              <widget class="GtkCheckButton" id="view_runtime">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Number</property>
+                                <property name="label" translatable="yes">Runtime</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">4</property>
+                                <property name="right_attach">5</property>
+                                <property name="top_attach">1</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_otitle">
+                              <widget class="GtkCheckButton" id="view_year">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Original Title</property>
+                                <property name="label" translatable="yes">Year</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">3</property>
+                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
                                 <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -2665,28 +2671,27 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_title">
+                              <widget class="GtkCheckButton" id="view_seen">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Title</property>
+                                <property name="label" translatable="yes">Seen it</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">3</property>
+                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_director">
+                              <widget class="GtkCheckButton" id="view_genre">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label" translatable="yes">Genre</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -2694,17 +2699,15 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_genre">
+                              <widget class="GtkCheckButton" id="view_director">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label" translatable="yes">Director</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -2712,39 +2715,40 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_seen">
+                              <widget class="GtkCheckButton" id="view_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Seen it</property>
+                                <property name="label" translatable="yes">Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">3</property>
-                                <property name="right_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_year">
+                              <widget class="GtkCheckButton" id="view_otitle">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Year</property>
+                                <property name="label" translatable="yes">Original Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">3</property>
-                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
                                 <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -2752,36 +2756,32 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_runtime">
+                              <widget class="GtkCheckButton" id="view_number">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Runtime</property>
+                                <property name="label" translatable="yes">Number</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">4</property>
-                                <property name="right_attach">5</property>
-                                <property name="top_attach">1</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_rating">
+                              <widget class="GtkCheckButton" id="view_image">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Rating</property>
+                                <property name="label" translatable="yes">Image</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
+                                <signal name="clicked" handler="on_view_image_clicked"/>
                               </widget>
                               <packing>
-                                <property name="left_attach">4</property>
-                                <property name="right_attach">5</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -2876,76 +2876,70 @@
                             <property name="n_rows">6</property>
                             <property name="n_columns">2</property>
                             <child>
-                              <widget class="GtkLabel" id="label141">
+                              <widget class="GtkComboBox" id="p_vcodec">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Media</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label142">
+                              <widget class="GtkLabel" id="label219">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Condition</property>
+                                <property name="label" translatable="yes">Video codec</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label143">
+                              <widget class="GtkComboBox" id="p_region">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Region</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label144">
+                              <widget class="GtkComboBox" id="p_color">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Layers</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label145">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Color</property>
-                              </widget>
-                              <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">4</property>
                                 <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_media">
+                              <widget class="GtkComboBox" id="p_layers">
                                 <property name="visible">True</property>
                                 <property name="items"></property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options">GTK_FILL</property>
                               </packing>
@@ -2965,72 +2959,78 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_layers">
+                              <widget class="GtkComboBox" id="p_media">
                                 <property name="visible">True</property>
                                 <property name="items"></property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_color">
+                              <widget class="GtkLabel" id="label145">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Color</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
                                 <property name="top_attach">4</property>
                                 <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_region">
+                              <widget class="GtkLabel" id="label144">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Layers</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="label143">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Region</property>
+                              </widget>
+                              <packing>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label219">
+                              <widget class="GtkLabel" id="label142">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Video codec</property>
+                                <property name="label" translatable="yes">Condition</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_vcodec">
+                              <widget class="GtkLabel" id="label141">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Media</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                           </widget>
@@ -3119,23 +3119,26 @@
                               <placeholder/>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_classification">
+                              <widget class="GtkCheckButton" id="p_s_cast">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Classification</property>
+                                <property name="label" translatable="yes">Cast</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_country">
+                              <widget class="GtkCheckButton" id="p_s_year">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Country</property>
+                                <property name="label" translatable="yes">Year</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3143,14 +3146,17 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_director">
+                              <widget class="GtkCheckButton" id="p_s_site">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label" translatable="yes">Site</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3158,66 +3164,69 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_trailer">
+                              <widget class="GtkCheckButton" id="p_s_runtime">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Trailer</property>
+                                <property name="label" translatable="yes">Runtime</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_title">
+                              <widget class="GtkCheckButton" id="p_s_rating">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Title</property>
+                                <property name="label" translatable="yes">Rating</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_studio">
+                              <widget class="GtkCheckButton" id="p_s_plot">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Studio</property>
+                                <property name="label" translatable="yes">Plot</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_image">
+                              <widget class="GtkCheckButton" id="p_s_o_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Image</property>
+                                <property name="label" translatable="yes">Original title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3225,24 +3234,24 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_genre">
+                              <widget class="GtkCheckButton" id="p_s_o_site">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label" translatable="yes">Official site</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -3266,26 +3275,26 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_o_site">
+                              <widget class="GtkCheckButton" id="p_s_genre">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Official site</property>
+                                <property name="label" translatable="yes">Genre</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_o_title">
+                              <widget class="GtkCheckButton" id="p_s_image">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Original title</property>
+                                <property name="label" translatable="yes">Image</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3293,69 +3302,69 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_plot">
+                              <widget class="GtkCheckButton" id="p_s_studio">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Plot</property>
+                                <property name="label" translatable="yes">Studio</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_rating">
+                              <widget class="GtkCheckButton" id="p_s_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Rating</property>
+                                <property name="label" translatable="yes">Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_runtime">
+                              <widget class="GtkCheckButton" id="p_s_trailer">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Runtime</property>
+                                <property name="label" translatable="yes">Trailer</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_site">
+                              <widget class="GtkCheckButton" id="p_s_director">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Site</property>
+                                <property name="label" translatable="yes">Director</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3363,17 +3372,14 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_year">
+                              <widget class="GtkCheckButton" id="p_s_country">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Year</property>
+                                <property name="label" translatable="yes">Country</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3381,25 +3387,19 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_cast">
+                              <widget class="GtkCheckButton" id="p_s_classification">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Cast</property>
+                                <property name="label" translatable="yes">Classification</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -3459,71 +3459,65 @@
                           <placeholder/>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label123">
+                          <widget class="GtkEntry" id="mail_smtp_port">
                             <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">SMTP server</property>
-                          </widget>
-                          <packing>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
-                          </packing>
-                        </child>
-                        <child>
-                          <widget class="GtkEntry" id="mail_smtp_server">
-                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
+                            <property name="text">25</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label124">
+                          <widget class="GtkLabel" id="label307">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Password</property>
+                            <property name="label" translatable="yes">SMTP port</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_password">
+                          <widget class="GtkCheckButton" id="mail_use_tls">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="visibility">False</property>
-                            <property name="invisible_char">*</property>
+                            <property name="use_underline">True</property>
+                            <property name="response_id">0</property>
+                            <property name="draw_indicator">True</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label122">
+                          <widget class="GtkLabel" id="label306">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Username</property>
+                            <property name="label" translatable="yes">Use TLS?</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_username">
+                          <widget class="GtkEntry" id="mail_email">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
@@ -3531,12 +3525,25 @@
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
+                          <widget class="GtkLabel" id="label125">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Sender E-mail address</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
                           <widget class="GtkCheckButton" id="mail_use_auth">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
@@ -3555,90 +3562,83 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label125">
+                          <widget class="GtkEntry" id="mail_username">
                             <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Sender E-mail address</property>
-                          </widget>
-                          <packing>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
-                          </packing>
-                        </child>
-                        <child>
-                          <widget class="GtkEntry" id="mail_email">
-                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label306">
+                          <widget class="GtkLabel" id="label122">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Use TLS?</property>
+                            <property name="label" translatable="yes">Username</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkCheckButton" id="mail_use_tls">
+                          <widget class="GtkEntry" id="mail_password">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="use_underline">True</property>
-                            <property name="response_id">0</property>
-                            <property name="draw_indicator">True</property>
+                            <property name="visibility">False</property>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label307">
+                          <widget class="GtkLabel" id="label124">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">SMTP port</property>
+                            <property name="label" translatable="yes">Password</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_smtp_port">
+                          <widget class="GtkEntry" id="mail_smtp_server">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
-                            <property name="text">25</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
+                        <child>
+                          <widget class="GtkLabel" id="label123">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">SMTP server</property>
+                          </widget>
+                          <packing>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
                       </widget>
                     </child>
                   </widget>
@@ -5091,73 +5091,35 @@
                             <property name="column_spacing">4</property>
                             <property name="row_spacing">2</property>
                             <child>
-                              <widget class="GtkLabel" id="label190">
+                              <widget class="GtkEntry" id="p_db_passwd">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Host</property>
+                                <property name="can_focus">True</property>
+                                <property name="visibility">False</property>
+                                <property name="invisible_char">*</property>
                               </widget>
                               <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkHBox" id="hbox99">
-                                <property name="visible">True</property>
-                                <child>
-                                  <widget class="GtkEntry" id="p_db_host">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="invisible_char">*</property>
-                                  </widget>
-                                </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label191">
-                                    <property name="visible">True</property>
-                                    <property name="xalign">0</property>
-                                    <property name="label" translatable="yes">Port</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="expand">False</property>
-                                    <property name="fill">False</property>
-                                    <property name="padding">4</property>
-                                    <property name="position">1</property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkSpinButton" id="p_db_port">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="adjustment">0 0 65536 1 10 10</property>
-                                    <property name="climb_rate">1</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="position">2</property>
-                                  </packing>
-                                </child>
-                              </widget>
-                              <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label194">
+                              <widget class="GtkLabel" id="label193">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Database</property>
+                                <property name="label" translatable="yes">Password</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkEntry" id="p_db_name">
+                              <widget class="GtkEntry" id="p_db_user">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="invisible_char">*</property>
@@ -5165,8 +5127,8 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -5184,7 +5146,7 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkEntry" id="p_db_user">
+                              <widget class="GtkEntry" id="p_db_name">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="invisible_char">*</property>
@@ -5192,36 +5154,74 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label193">
+                              <widget class="GtkLabel" id="label194">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Password</property>
+                                <property name="label" translatable="yes">Database</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkEntry" id="p_db_passwd">
+                              <widget class="GtkHBox" id="hbox99">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="visibility">False</property>
-                                <property name="invisible_char">*</property>
+                                <child>
+                                  <widget class="GtkEntry" id="p_db_host">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="invisible_char">*</property>
+                                  </widget>
+                                </child>
+                                <child>
+                                  <widget class="GtkLabel" id="label191">
+                                    <property name="visible">True</property>
+                                    <property name="xalign">0</property>
+                                    <property name="label" translatable="yes">Port</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="expand">False</property>
+                                    <property name="fill">False</property>
+                                    <property name="padding">4</property>
+                                    <property name="position">1</property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkSpinButton" id="p_db_port">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="adjustment">0 0 65536 1 10 10</property>
+                                    <property name="climb_rate">1</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="position">2</property>
+                                  </packing>
+                                </child>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options">GTK_FILL</property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="label190">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Host</property>
+                              </widget>
+                              <packing>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -5655,57 +5655,72 @@
                           <placeholder/>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label12">
+                          <widget class="GtkHSeparator" id="hseparator12">
                             <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Original Title</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
                             <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="am_original_title">
+                          <widget class="GtkLabel" id="label172">
                             <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="has_focus">True</property>
-                            <property name="invisible_char">*</property>
+                            <property name="label" translatable="yes">Type in the original film tile, select source and choose &lt;i&gt;Get from web&lt;/i&gt;. Griffith will try to fetch all the related information from the Web.</property>
+                            <property name="use_markup">True</property>
+                            <property name="justify">GTK_JUSTIFY_CENTER</property>
+                            <property name="wrap">True</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
-                            <property name="y_options"></property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options">GTK_EXPAND</property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label16">
+                          <widget class="GtkImage" id="image_add_rating">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Title</property>
+                            <property name="pixbuf">nill.png</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="am_title">
+                          <widget class="GtkHScale" id="rating_scale_add">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="invisible_char">*</property>
+                            <property name="adjustment">0 0 10 1 1 0</property>
+                            <property name="digits">0</property>
+                            <property name="value_pos">GTK_POS_RIGHT</property>
+                            <signal name="value_changed" handler="on_rating_scale_add_value_changed"/>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options">GTK_FILL</property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label128">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Rating</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
@@ -5725,73 +5740,58 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label128">
+                          <widget class="GtkEntry" id="am_title">
                             <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Rating</property>
-                          </widget>
-                          <packing>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
-                          </packing>
-                        </child>
-                        <child>
-                          <widget class="GtkHScale" id="rating_scale_add">
-                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="adjustment">0 0 10 1 1 0</property>
-                            <property name="digits">0</property>
-                            <property name="value_pos">GTK_POS_RIGHT</property>
-                            <signal name="value_changed" handler="on_rating_scale_add_value_changed"/>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options">GTK_FILL</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkImage" id="image_add_rating">
+                          <widget class="GtkLabel" id="label16">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="pixbuf">nill.png</property>
+                            <property name="label" translatable="yes">Title</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label172">
+                          <widget class="GtkEntry" id="am_original_title">
                             <property name="visible">True</property>
-                            <property name="label" translatable="yes">Type in the original film tile, select source and choose &lt;i&gt;Get from web&lt;/i&gt;. Griffith will try to fetch all the related information from the Web.</property>
-                            <property name="use_markup">True</property>
-                            <property name="justify">GTK_JUSTIFY_CENTER</property>
-                            <property name="wrap">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="has_focus">True</property>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
+                            <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options">GTK_EXPAND</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkHSeparator" id="hseparator12">
+                          <widget class="GtkLabel" id="label12">
                             <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Original Title</property>
                           </widget>
                           <packing>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                       </widget>
@@ -5982,149 +5982,148 @@
                 <property name="column_spacing">2</property>
                 <property name="row_spacing">2</property>
                 <child>
-                  <widget class="GtkLabel" id="label50">
+                  <widget class="GtkEntry" id="am_trailer">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Studio</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
-                    <property name="x_options">GTK_FILL</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label49">
+                  <widget class="GtkLabel" id="label53">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Classification</property>
+                    <property name="label" translatable="yes">Trailer</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label46">
+                  <widget class="GtkEntry" id="am_imdb">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Genre</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
-                    <property name="x_options">GTK_FILL</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label44">
+                  <widget class="GtkLabel" id="label52">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Country</property>
+                    <property name="label" translatable="yes">Site</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label42">
+                  <widget class="GtkEntry" id="am_site">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Director</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkEntry" id="am_studio">
-                    <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_classification">
+                  <widget class="GtkLabel" id="label51">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Official site</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
+                    <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_genre">
+                  <widget class="GtkHSeparator" id="hseparator7">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
-                    <property name="y_options"></property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_country">
+                  <widget class="GtkHBox" id="hbox65">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_number">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">0 0 1000000 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                        <property name="numeric">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkAlignment" id="alignment34">
+                        <property name="visible">True</property>
+                        <property name="xscale">0.5</property>
+                        <child>
+                          <widget class="GtkCheckButton" id="am_seen">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="label" translatable="yes">Seen it</property>
+                            <property name="use_underline">True</property>
+                            <property name="response_id">0</property>
+                            <property name="draw_indicator">True</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
-                    <property name="y_options"></property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_director">
+                  <widget class="GtkLabel" id="label11">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label43">
-                    <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Year</property>
+                    <property name="label" translatable="yes">Number</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
@@ -6197,86 +6196,62 @@
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label11">
+                  <widget class="GtkLabel" id="label43">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Number</property>
+                    <property name="label" translatable="yes">Year</property>
                   </widget>
                   <packing>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox65">
+                  <widget class="GtkEntry" id="am_director">
                     <property name="visible">True</property>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_number">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">0 0 1000000 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                        <property name="numeric">True</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkAlignment" id="alignment34">
-                        <property name="visible">True</property>
-                        <property name="xscale">0.5</property>
-                        <child>
-                          <widget class="GtkCheckButton" id="am_seen">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="label" translatable="yes">Seen it</property>
-                            <property name="use_underline">True</property>
-                            <property name="response_id">0</property>
-                            <property name="draw_indicator">True</property>
-                          </widget>
-                        </child>
-                      </widget>
-                      <packing>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator7">
+                  <widget class="GtkEntry" id="am_country">
                     <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
+                    <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label51">
+                  <widget class="GtkEntry" id="am_genre">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Official site</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
-                    <property name="x_options">GTK_FILL</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_site">
+                  <widget class="GtkEntry" id="am_classification">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6284,65 +6259,90 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label52">
+                  <widget class="GtkEntry" id="am_studio">
                     <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label42">
+                    <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Site</property>
+                    <property name="label" translatable="yes">Director</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_imdb">
+                  <widget class="GtkLabel" id="label44">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Country</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
+                    <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label53">
+                  <widget class="GtkLabel" id="label46">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Trailer</property>
+                    <property name="label" translatable="yes">Genre</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_trailer">
+                  <widget class="GtkLabel" id="label49">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Classification</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
+                    <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
+                <child>
+                  <widget class="GtkLabel" id="label50">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Studio</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
               </widget>
               <packing>
                 <property name="position">1</property>
@@ -6368,161 +6368,138 @@
                 <property name="column_spacing">2</property>
                 <property name="row_spacing">2</property>
                 <child>
-                  <widget class="GtkLabel" id="label57">
+                  <widget class="GtkComboBox" id="am_vcodec">
                     <property name="visible">True</property>
+                    <property name="items"></property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label197">
+                    <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Medium</property>
+                    <property name="label" translatable="yes">Video codec</property>
                   </widget>
                   <packing>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox58">
+                  <widget class="GtkComboBox" id="am_color">
                     <property name="visible">True</property>
-                    <property name="spacing">4</property>
-                    <child>
-                      <widget class="GtkComboBox" id="am_media">
-                        <property name="visible">True</property>
-                        <property name="items"></property>
-                      </widget>
-                    </child>
-                    <child>
-                      <widget class="GtkLabel" id="label55">
-                        <property name="visible">True</property>
-                        <property name="xalign">0</property>
-                        <property name="label" translatable="yes">Discs</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="fill">False</property>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_discs">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">1 1 100 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="fill">False</property>
-                        <property name="position">2</property>
-                      </packing>
-                    </child>
+                    <property name="items"></property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label115">
+                  <widget class="GtkComboBox" id="am_layers">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Condition</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label113">
+                  <widget class="GtkComboBox" id="am_region">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Region</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
                     <property name="top_attach">2</property>
                     <property name="bottom_attach">3</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label114">
+                  <widget class="GtkComboBox" id="am_condition">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Layers</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label146">
+                  <widget class="GtkHSeparator" id="hseparator17">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Volume</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label171">
+                  <widget class="GtkHSeparator" id="hseparator9">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Collection</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label116">
+                  <widget class="GtkHBox" id="hbox73">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Color</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkHBox" id="hbox74">
-                    <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkComboBoxEntry" id="am_collection_combo">
+                      <widget class="GtkComboBoxEntry" id="am_volume_combo">
                         <property name="visible">True</property>
                         <property name="items" translatable="yes"></property>
-                        <signal name="changed" handler="on_am_collection_combo_changed"/>
+                        <signal name="changed" handler="on_am_volume_combo_changed"/>
                         <child internal-child="entry">
-                          <widget class="GtkEntry" id="comboboxentry-entry8">
+                          <widget class="GtkEntry" id="comboboxentry-entry9">
                           </widget>
                         </child>
                       </widget>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_add_collection_button">
+                      <widget class="GtkButton" id="am_add_volume_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">add entered name to collections list</property>
+                        <property name="tooltip" translatable="yes">add entered name to volumes list</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_add_collection_button_clicked"/>
+                        <signal name="clicked" handler="on_am_add_volume_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image422">
+                          <widget class="GtkImage" id="image420">
                             <property name="visible">True</property>
                             <property name="stock">gtk-add</property>
                           </widget>
@@ -6535,14 +6512,14 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_remove_collection_button">
+                      <widget class="GtkButton" id="am_remove_volume_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">remove selected collection</property>
+                        <property name="tooltip" translatable="yes">remove selected volume</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_remove_collection_button_clicked"/>
+                        <signal name="clicked" handler="on_am_remove_volume_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image423">
+                          <widget class="GtkImage" id="image421">
                             <property name="visible">True</property>
                             <property name="stock">gtk-remove</property>
                           </widget>
@@ -6558,35 +6535,35 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox73">
+                  <widget class="GtkHBox" id="hbox74">
                     <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkComboBoxEntry" id="am_volume_combo">
+                      <widget class="GtkComboBoxEntry" id="am_collection_combo">
                         <property name="visible">True</property>
                         <property name="items" translatable="yes"></property>
-                        <signal name="changed" handler="on_am_volume_combo_changed"/>
+                        <signal name="changed" handler="on_am_collection_combo_changed"/>
                         <child internal-child="entry">
-                          <widget class="GtkEntry" id="comboboxentry-entry9">
+                          <widget class="GtkEntry" id="comboboxentry-entry8">
                           </widget>
                         </child>
                       </widget>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_add_volume_button">
+                      <widget class="GtkButton" id="am_add_collection_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">add entered name to volumes list</property>
+                        <property name="tooltip" translatable="yes">add entered name to collections list</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_add_volume_button_clicked"/>
+                        <signal name="clicked" handler="on_am_add_collection_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image420">
+                          <widget class="GtkImage" id="image422">
                             <property name="visible">True</property>
                             <property name="stock">gtk-add</property>
                           </widget>
@@ -6599,14 +6576,14 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_remove_volume_button">
+                      <widget class="GtkButton" id="am_remove_collection_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">remove selected volume</property>
+                        <property name="tooltip" translatable="yes">remove selected collection</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_remove_volume_button_clicked"/>
+                        <signal name="clicked" handler="on_am_remove_collection_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image421">
+                          <widget class="GtkImage" id="image423">
                             <property name="visible">True</property>
                             <property name="stock">gtk-remove</property>
                           </widget>
@@ -6622,120 +6599,143 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator9">
+                  <widget class="GtkLabel" id="label116">
                     <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Color</property>
                   </widget>
                   <packing>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator17">
+                  <widget class="GtkLabel" id="label171">
                     <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Collection</property>
                   </widget>
                   <packing>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_condition">
+                  <widget class="GtkLabel" id="label146">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Volume</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_region">
+                  <widget class="GtkLabel" id="label114">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Layers</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label113">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Region</property>
+                  </widget>
+                  <packing>
                     <property name="top_attach">2</property>
                     <property name="bottom_attach">3</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_layers">
+                  <widget class="GtkLabel" id="label115">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Condition</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_color">
+                  <widget class="GtkHBox" id="hbox58">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="spacing">4</property>
+                    <child>
+                      <widget class="GtkComboBox" id="am_media">
+                        <property name="visible">True</property>
+                        <property name="items"></property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="label55">
+                        <property name="visible">True</property>
+                        <property name="xalign">0</property>
+                        <property name="label" translatable="yes">Discs</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_discs">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">1 1 100 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">2</property>
+                      </packing>
+                    </child>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label197">
+                  <widget class="GtkLabel" id="label57">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Video codec</property>
+                    <property name="label" translatable="yes">Medium</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
-                <child>
-                  <widget class="GtkComboBox" id="am_vcodec">
-                    <property name="visible">True</property>
-                    <property name="items"></property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                  </packing>
-                </child>
               </widget>
               <packing>
                 <property name="position">2</property>
@@ -7084,36 +7084,40 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkLabel" id="label78">
-                <property name="visible">True</property>
-                <property name="label" translatable="yes">Name</property>
+              <widget class="GtkEntry" id="ep_id">
+                <property name="can_focus">True</property>
+                <property name="invisible_char">*</property>
               </widget>
               <packing>
-                <property name="x_options">GTK_FILL</property>
+                <property name="left_attach">1</property>
+                <property name="right_attach">2</property>
+                <property name="top_attach">3</property>
+                <property name="bottom_attach">4</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_name">
+              <widget class="GtkEntry" id="ep_phone">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
-                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label79">
+              <widget class="GtkLabel" id="label80">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">E-mail</property>
+                <property name="label" translatable="yes">Phone</property>
               </widget>
               <packing>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
@@ -7133,41 +7137,37 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label80">
+              <widget class="GtkLabel" id="label79">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">Phone</property>
+                <property name="label" translatable="yes">E-mail</property>
               </widget>
               <packing>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_phone">
+              <widget class="GtkEntry" id="ep_name">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_id">
-                <property name="can_focus">True</property>
-                <property name="invisible_char">*</property>
+              <widget class="GtkLabel" id="label78">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">Name</property>
               </widget>
               <packing>
-                <property name="left_attach">1</property>
-                <property name="right_attach">2</property>
-                <property name="top_attach">3</property>
-                <property name="bottom_attach">4</property>
+                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
@@ -7230,37 +7230,30 @@
             <property name="column_spacing">4</property>
             <property name="row_spacing">2</property>
             <child>
-              <widget class="GtkLabel" id="label73">
+              <widget class="GtkEntry" id="ap_phone">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">Name</property>
+                <property name="can_focus">True</property>
+                <property name="invisible_char">*</property>
               </widget>
               <packing>
-                <property name="x_options">GTK_FILL</property>
+                <property name="left_attach">1</property>
+                <property name="right_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ap_name">
+              <widget class="GtkEntry" id="ap_email">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
-                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="y_options"></property>
-              </packing>
-            </child>
-            <child>
-              <widget class="GtkLabel" id="label74">
-                <property name="visible">True</property>
-                <property name="label" translatable="yes">E-mail</property>
-              </widget>
-              <packing>
                 <property name="top_attach">1</property>
                 <property name="bottom_attach">2</property>
-                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
@@ -7277,33 +7270,40 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ap_email">
+              <widget class="GtkLabel" id="label74">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="invisible_char">*</property>
+                <property name="label" translatable="yes">E-mail</property>
               </widget>
               <packing>
-                <property name="left_attach">1</property>
-                <property name="right_attach">2</property>
                 <property name="top_attach">1</property>
                 <property name="bottom_attach">2</property>
+                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ap_phone">
+              <widget class="GtkEntry" id="ap_name">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
+            <child>
+              <widget class="GtkLabel" id="label73">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">Name</property>
+              </widget>
+              <packing>
+                <property name="x_options">GTK_FILL</property>
+                <property name="y_options"></property>
+              </packing>
+            </child>
           </widget>
           <packing>
             <property name="position">2</property>
@@ -7500,22 +7500,29 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkCheckButton" id="cover_simple_include_movie_number">
+              <widget class="GtkLabel" id="label71">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="label" translatable="yes">Include movie number</property>
-                <property name="use_underline">True</property>
-                <property name="response_id">0</property>
-                <property name="active">True</property>
-                <property name="draw_indicator">True</property>
+                <property name="xalign">0</property>
+                <property name="label" translatable="yes">Size</property>
               </widget>
               <packing>
+                <property name="x_options">GTK_FILL</property>
+                <property name="y_options"></property>
+                <property name="x_padding">8</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkComboBox" id="cover_simple_size">
+                <property name="visible">True</property>
+                <property name="items" translatable="yes">Standard
+Slim
+Double Slim</property>
+              </widget>
+              <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options"></property>
+                <property name="y_options">GTK_FILL</property>
               </packing>
             </child>
             <child>
@@ -7538,29 +7545,22 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkComboBox" id="cover_simple_size">
+              <widget class="GtkCheckButton" id="cover_simple_include_movie_number">
                 <property name="visible">True</property>
-                <property name="items" translatable="yes">Standard
-Slim
-Double Slim</property>
+                <property name="can_focus">True</property>
+                <property name="label" translatable="yes">Include movie number</property>
+                <property name="use_underline">True</property>
+                <property name="response_id">0</property>
+                <property name="active">True</property>
+                <property name="draw_indicator">True</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options">GTK_FILL</property>
-              </packing>
-            </child>
-            <child>
-              <widget class="GtkLabel" id="label71">
-                <property name="visible">True</property>
-                <property name="xalign">0</property>
-                <property name="label" translatable="yes">Size</property>
-              </widget>
-              <packing>
-                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
-                <property name="x_padding">8</property>
               </packing>
             </child>
           </widget>
@@ -7809,22 +7809,17 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkCheckButton" id="cover_image_number">
+              <widget class="GtkComboBox" id="cover_image_size">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="label" translatable="yes">Include movie number</property>
-                <property name="use_underline">True</property>
-                <property name="response_id">0</property>
-                <property name="active">True</property>
-                <property name="draw_indicator">True</property>
+                <property name="items" translatable="yes">Standard
+Slim
+Double Slim</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options"></property>
+                <property name="y_options">GTK_FILL</property>
               </packing>
             </child>
             <child>
@@ -7840,17 +7835,22 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkComboBox" id="cover_image_size">
+              <widget class="GtkCheckButton" id="cover_image_number">
                 <property name="visible">True</property>
-                <property name="items" translatable="yes">Standard
-Slim
-Double Slim</property>
+                <property name="can_focus">True</property>
+                <property name="label" translatable="yes">Include movie number</property>
+                <property name="use_underline">True</property>
+                <property name="response_id">0</property>
+                <property name="active">True</property>
+                <property name="draw_indicator">True</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options">GTK_FILL</property>
+                <property name="y_options"></property>
               </packing>
             </child>
           </widget>
@@ -7937,98 +7937,98 @@
                                 <property name="n_columns">3</property>
                                 <property name="homogeneous">True</property>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
+                                  <widget class="GtkRadioButton" id="af_rb_loaned">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">unseen only</property>
+                                    <property name="label" translatable="yes">none</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
                                   </widget>
                                   <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
+                                  <widget class="GtkRadioButton" id="af_rb_seen">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">not loaned only</property>
+                                    <property name="label" translatable="yes">none</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
                                   </widget>
                                   <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">seen only</property>
+                                    <property name="label" translatable="yes">loaned only</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
+                                    <property name="group">af_rb_loaned</property>
                                   </widget>
                                   <packing>
                                     <property name="left_attach">1</property>
                                     <property name="right_attach">2</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">loaned only</property>
+                                    <property name="label" translatable="yes">seen only</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
+                                    <property name="group">af_rb_seen</property>
                                   </widget>
                                   <packing>
                                     <property name="left_attach">1</property>
                                     <property name="right_attach">2</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen">
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
+                                    <property name="label" translatable="yes">not loaned only</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_loaned</property>
                                   </widget>
                                   <packing>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned">
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
+                                    <property name="label" translatable="yes">unseen only</property>
                                     <property name="use_underline">True</property>
                                     <property name="response_id">0</property>
                                     <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_seen</property>
                                   </widget>
                                   <packing>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
                                     <property name="y_options"></property>
                                   </packing>
                                 </child>
@@ -8082,7 +8082,7 @@
                                 <child>
                                   <widget class="GtkLabel" id="label1">
                                     <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;with/without tags&lt;/b&gt;</property>
+                                    <property name="label" translatable="yes">&lt;b&gt;Tags&lt;/b&gt;</property>
                                     <property name="use_markup">True</property>
                                   </widget>
                                   <packing>
@@ -8129,7 +8129,7 @@
                                 <child>
                                   <widget class="GtkLabel" id="label2">
                                     <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;(not) in volumes&lt;/b&gt;</property>
+                                    <property name="label" translatable="yes">&lt;b&gt;Volumes&lt;/b&gt;</property>
                                     <property name="use_markup">True</property>
                                   </widget>
                                   <packing>
@@ -8176,7 +8176,7 @@
                                 <child>
                                   <widget class="GtkLabel" id="label3">
                                     <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;(not) in collections&lt;/b&gt;</property>
+                                    <property name="label" translatable="yes">&lt;b&gt;Collections&lt;/b&gt;</property>
                                     <property name="use_markup">True</property>
                                   </widget>
                                   <packing>

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-18 22:57:58 UTC (rev 1005)
+++ trunk/lib/advfilter.py	2008-10-19 13:24:34 UTC (rev 1006)
@@ -21,6 +21,7 @@
 # You may use and distribute this software under the terms of the
 # GNU General Public License, version 2 or later
 
+import gtk
 from copy       import deepcopy
 from sqlalchemy import select
 import logging
@@ -37,6 +38,7 @@
     'no_volumes'      : set(), # list of volume_ids     (search for movies outside these volumes)
     'tags'            : set(), # list of tag_ids        (search for movies with these tags)
     'no_tags'         : set(), # list of tag_ids        (search for movies without these tags)
+    'required_tags'   : set(), # like in tags, but movie must contain all listed tags
     'loaned_to'       : set(), # list of person_ids	    (search for movies loaned to these people)
     'sort_by'         : set(("number",)), # "number DESC"
     'equals'          : {}, # {column1: [value1, value2, ...], column2: []}
@@ -49,12 +51,63 @@
 # widgets -----------------------------------------------------{{{
 
 def show_window(self):
+    initialize(self.widgets['advfilter'], self.db)
     self.widgets['advfilter']['window'].show()
     return True
 
 def hide_window(self):
-    self.widgets['advfilter']['window'].hide()
+    widgets = self.widgets['advfilter']
+    widgets['window'].hide()
+
+    # clear the window
+    for i in widgets['tags_vbox'].get_children():
+        i.destroy()
+    for i in widgets['volumes_vbox'].get_children():
+        i.destroy()
+    for i in widgets['collections_vbox'].get_children():
+        i.destroy()
+
     return True
+
+def _fill_container(container, items, options, id_name):
+    for item in items:
+        hbox = gtk.HBox()
+
+        label_id = gtk.Label()
+        label_id.set_text(str(getattr(item, id_name)))
+        hbox.pack_start(label_id, expand=False)
+
+        widget = gtk.RadioButton(label=options[0]) # first widget
+        hbox.pack_start(widget, expand=False, padding=4)
+        for option in options[1:]: # create rest of the widgets, use first one as a group
+            next_widget = gtk.RadioButton(widget, label=option)
+            hbox.pack_start(next_widget, expand=False, padding=4)
+        
+        label = gtk.Label()
+        label.set_text(item.name)
+        hbox.pack_start(label, padding=16, expand=False)
+
+        hbox.show_all()
+        label_id.hide()
+        container.pack_start(hbox)
+
+def initialize(widgets, gsql):
+    # tags
+    items = gsql.session.query(db.Tag).all()
+    options = (_('ignore'), _('with'), _('without'), _('require'))
+    _fill_container(widgets["tags_vbox"], items, options, 'tag_id')
+
+    # volumes
+    items = gsql.session.query(db.Volume).all()
+    options = (_('ignore'), _('in'), _('not in'))
+    _fill_container(widgets["volumes_vbox"], items, options, 'volume_id')
+    
+    # collections
+    items = gsql.session.query(db.Collection).all()
+    # use volume's options
+    _fill_container(widgets["collections_vbox"], items, options, 'collection_id')
+
+    return True
 #}}}
 
 # database related --------------------------------------------
@@ -79,13 +132,36 @@
     elif widgets["rb_loaned_only_n"].get_active():
         cond["loaned"] = False
 
+    for hbox in widgets["tags_vbox"]:
+        childs = hbox.get_children()
+        if childs[2].get_active():
+            cond["tags"].add(int(childs[0].get_label()))
+        elif childs[3].get_active():
+            cond["no_tags"].add(int(childs[0].get_label()))
+        elif childs[4].get_active():
+            cond["required_tags"].add(int(childs[0].get_label()))
+
+    for hbox in widgets["volumes_vbox"]:
+        childs = hbox.get_children()
+        if childs[2].get_active():
+            cond["volumes"].add(int(childs[0].get_label()))
+        elif childs[3].get_active():
+            cond["no_volumes"].add(int(childs[0].get_label()))
+    
+    for hbox in widgets["collections_vbox"]:
+        childs = hbox.get_children()
+        if childs[2].get_active():
+            cond["collections"].add(int(childs[0].get_label()))
+        elif childs[3].get_active():
+            cond["no_collections"].add(int(childs[0].get_label()))
+
     # TODO: remove after tests
     cond.update({
         #'tags'      : [1],
         #'no_tags'   : [1],
         #'collections'   : set((1,)),
         'sort_by'   : set(("title", "year", "number DESC")),
-        'equals'    : {"year": [2003, 2004]},
+        #'equals'    : {"year": [2003, 2004]},
         #'startswith': {"o_title": [u"Ma", u"Ani"] }
         #'contains'  : {"o_title": [u"ma", u"ani"] },
         })

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2008-10-18 22:57:58 UTC (rev 1005)
+++ trunk/lib/sql.py	2008-10-19 13:24:34 UTC (rev 1006)
@@ -179,6 +179,13 @@
     if loaned_to:
         query.append_whereclause(or_(*loaned_to))
     
+    required_tags = []
+    for tag_id in cond["required_tags"]:
+        required_tags.append(exists([db.MovieTag.movie_id], \
+            and_(db.Movie.movie_id==db.MovieTag.movie_id, db.MovieTag.tag_id==tag_id)))
+    if required_tags:
+        query.append_whereclause(and_(*required_tags))
+
     tags = []
     for tag_id in cond["tags"]:
         tags.append(exists([db.MovieTag.movie_id], \

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-18 22:57:58 UTC (rev 1005)
+++ trunk/lib/widgets.py	2008-10-19 13:24:34 UTC (rev 1006)
@@ -153,6 +153,9 @@
         'rb_loaned'        : get('af_rb_loaned'),
         'rb_loaned_only'   : get('af_rb_loaned_only'),
         'rb_loaned_only_n' : get('af_rb_loaned_only_n'),
+        'tags_vbox'        : get('af_tags_vbox'),
+        'volumes_vbox'     : get('af_volumes_vbox'),
+        'collections_vbox' : get('af_collections_vbox'),
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])



From piotrek at mail.berlios.de  Sun Oct 19 15:55:06 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 15:55:06 +0200
Subject: [Griffith-svn] r1007 - in trunk: . glade lib
Message-ID: <200810191355.m9JDt6dg014970@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 15:55:05 +0200 (Sun, 19 Oct 2008)
New Revision: 1007

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/lib/advfilter.py
   trunk/lib/sql.py
   trunk/lib/widgets.py
Log:
Add loans to adv. filter window

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-19 13:24:34 UTC (rev 1006)
+++ trunk/ChangeLog	2008-10-19 13:55:05 UTC (rev 1007)
@@ -6,7 +6,7 @@
 
 
 2008-10-19  Piotr O?arowski
-	* Add tags/volumes/collections to adv. filter window
+	* Add tags/volumes/collections/loans to adv. filter window
 
 2008-10-18  Piotr O?arowski
 	* Speed up import movies function

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-19 13:24:34 UTC (rev 1006)
+++ trunk/glade/griffith.glade	2008-10-19 13:55:05 UTC (rev 1007)
@@ -8192,6 +8192,53 @@
                         <property name="position">3</property>
                       </packing>
                     </child>
+                    <child>
+                      <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_loans">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+                        <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+                        <child>
+                          <widget class="GtkViewport" id="viewport10">
+                            <property name="visible">True</property>
+                            <property name="shadow_type">GTK_SHADOW_NONE</property>
+                            <child>
+                              <widget class="GtkFrame" id="frame28">
+                                <property name="visible">True</property>
+                                <property name="label_xalign">0</property>
+                                <child>
+                                  <widget class="GtkAlignment" id="alignment6">
+                                    <property name="visible">True</property>
+                                    <property name="left_padding">12</property>
+                                    <child>
+                                      <widget class="GtkVBox" id="af_loans_vbox">
+                                        <property name="visible">True</property>
+                                        <child>
+                                          <placeholder/>
+                                        </child>
+                                      </widget>
+                                    </child>
+                                  </widget>
+                                </child>
+                                <child>
+                                  <widget class="GtkLabel" id="label4">
+                                    <property name="visible">True</property>
+                                    <property name="label" translatable="yes">&lt;b&gt;Loans&lt;/b&gt;</property>
+                                    <property name="use_markup">True</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="type">label_item</property>
+                                  </packing>
+                                </child>
+                              </widget>
+                            </child>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">4</property>
+                      </packing>
+                    </child>
                   </widget>
                 </child>
               </widget>

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-19 13:24:34 UTC (rev 1006)
+++ trunk/lib/advfilter.py	2008-10-19 13:55:05 UTC (rev 1007)
@@ -40,6 +40,7 @@
     'no_tags'         : set(), # list of tag_ids        (search for movies without these tags)
     'required_tags'   : set(), # like in tags, but movie must contain all listed tags
     'loaned_to'       : set(), # list of person_ids	    (search for movies loaned to these people)
+    'loan_history'    : set(), # list of person_ids	    (search for movies which were loaned by these people)
     'sort_by'         : set(("number",)), # "number DESC"
     'equals'          : {}, # {column1: [value1, value2, ...], column2: []}
     'startswith'      : {}, # see above
@@ -66,6 +67,8 @@
         i.destroy()
     for i in widgets['collections_vbox'].get_children():
         i.destroy()
+    for i in widgets['loans_vbox'].get_children():
+        i.destroy()
 
     return True
 
@@ -107,6 +110,10 @@
     # use volume's options
     _fill_container(widgets["collections_vbox"], items, options, 'collection_id')
 
+    # loans
+    items = gsql.session.query(db.Person).all()
+    options = (_('ignore'), _('loaned to '), _('loan history'))
+    _fill_container(widgets["loans_vbox"], items, options, 'person_id')
     return True
 #}}}
 
@@ -154,6 +161,13 @@
             cond["collections"].add(int(childs[0].get_label()))
         elif childs[3].get_active():
             cond["no_collections"].add(int(childs[0].get_label()))
+    
+    for hbox in widgets["loans_vbox"]:
+        childs = hbox.get_children()
+        if childs[2].get_active():
+            cond["loaned_to"].add(int(childs[0].get_label()))
+        elif childs[3].get_active():
+            cond["loan_history"].add(int(childs[0].get_label()))
 
     # TODO: remove after tests
     cond.update({

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2008-10-19 13:24:34 UTC (rev 1006)
+++ trunk/lib/sql.py	2008-10-19 13:55:05 UTC (rev 1007)
@@ -179,6 +179,13 @@
     if loaned_to:
         query.append_whereclause(or_(*loaned_to))
     
+    loan_history = []
+    for per_id in cond["loan_history"]:
+        loan_history.append(exists([db.loans_table.c.movie_id],\
+                and_(db.Movie.movie_id==db.loans_table.c.movie_id, db.loans_table.c.person_id==per_id)))
+    if loan_history:
+        query.append_whereclause(or_(*loan_history))
+    
     required_tags = []
     for tag_id in cond["required_tags"]:
         required_tags.append(exists([db.MovieTag.movie_id], \
@@ -233,6 +240,7 @@
         else:
             query.append_order_by(asc(db.movies_table.columns[rule]))
 
+    log.debug(query.compile())
     return query #}}}
 
 # MOVIE LOAN related functions --------------------------------{{{

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-19 13:24:34 UTC (rev 1006)
+++ trunk/lib/widgets.py	2008-10-19 13:55:05 UTC (rev 1007)
@@ -156,6 +156,7 @@
         'tags_vbox'        : get('af_tags_vbox'),
         'volumes_vbox'     : get('af_volumes_vbox'),
         'collections_vbox' : get('af_collections_vbox'),
+        'loans_vbox'       : get('af_loans_vbox'),
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])



From piotrek at mail.berlios.de  Sun Oct 19 20:09:49 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 20:09:49 +0200
Subject: [Griffith-svn] r1008 - trunk/glade
Message-ID: <200810191809.m9JI9nll029616@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 20:09:48 +0200 (Sun, 19 Oct 2008)
New Revision: 1008

Modified:
   trunk/glade/griffith.glade
Log:
move scrolled windows inside frames (advfilter window)


Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-19 13:55:05 UTC (rev 1007)
+++ trunk/glade/griffith.glade	2008-10-19 18:09:48 UTC (rev 1008)
@@ -8052,23 +8052,23 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_tags">
+                      <widget class="GtkFrame" id="frame9">
                         <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
-                        <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+                        <property name="label_xalign">0</property>
                         <child>
-                          <widget class="GtkViewport" id="viewport2">
+                          <widget class="GtkAlignment" id="alignment1">
                             <property name="visible">True</property>
-                            <property name="shadow_type">GTK_SHADOW_NONE</property>
+                            <property name="left_padding">12</property>
                             <child>
-                              <widget class="GtkFrame" id="frame9">
+                              <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_tags">
                                 <property name="visible">True</property>
-                                <property name="label_xalign">0</property>
+                                <property name="can_focus">True</property>
+                                <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+                                <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
-                                  <widget class="GtkAlignment" id="alignment1">
+                                  <widget class="GtkViewport" id="viewport2">
                                     <property name="visible">True</property>
-                                    <property name="left_padding">12</property>
+                                    <property name="shadow_type">GTK_SHADOW_NONE</property>
                                     <child>
                                       <widget class="GtkVBox" id="af_tags_vbox">
                                         <property name="visible">True</property>
@@ -8079,43 +8079,43 @@
                                     </child>
                                   </widget>
                                 </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label1">
-                                    <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;Tags&lt;/b&gt;</property>
-                                    <property name="use_markup">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="type">label_item</property>
-                                  </packing>
-                                </child>
                               </widget>
                             </child>
                           </widget>
                         </child>
+                        <child>
+                          <widget class="GtkLabel" id="label1">
+                            <property name="visible">True</property>
+                            <property name="label" translatable="yes">&lt;b&gt;Tags&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="type">label_item</property>
+                          </packing>
+                        </child>
                       </widget>
                       <packing>
                         <property name="position">1</property>
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_volumes">
+                      <widget class="GtkFrame" id="frame11">
                         <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
-                        <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+                        <property name="label_xalign">0</property>
                         <child>
-                          <widget class="GtkViewport" id="viewport3">
+                          <widget class="GtkAlignment" id="alignment2">
                             <property name="visible">True</property>
-                            <property name="shadow_type">GTK_SHADOW_NONE</property>
+                            <property name="left_padding">12</property>
                             <child>
-                              <widget class="GtkFrame" id="frame11">
+                              <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_volumes">
                                 <property name="visible">True</property>
-                                <property name="label_xalign">0</property>
+                                <property name="can_focus">True</property>
+                                <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+                                <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
-                                  <widget class="GtkAlignment" id="alignment2">
+                                  <widget class="GtkViewport" id="viewport3">
                                     <property name="visible">True</property>
-                                    <property name="left_padding">12</property>
+                                    <property name="shadow_type">GTK_SHADOW_NONE</property>
                                     <child>
                                       <widget class="GtkVBox" id="af_volumes_vbox">
                                         <property name="visible">True</property>
@@ -8126,43 +8126,43 @@
                                     </child>
                                   </widget>
                                 </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label2">
-                                    <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;Volumes&lt;/b&gt;</property>
-                                    <property name="use_markup">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="type">label_item</property>
-                                  </packing>
-                                </child>
                               </widget>
                             </child>
                           </widget>
                         </child>
+                        <child>
+                          <widget class="GtkLabel" id="label2">
+                            <property name="visible">True</property>
+                            <property name="label" translatable="yes">&lt;b&gt;Volumes&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="type">label_item</property>
+                          </packing>
+                        </child>
                       </widget>
                       <packing>
                         <property name="position">2</property>
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_collections">
+                      <widget class="GtkFrame" id="frame12">
                         <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
-                        <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+                        <property name="label_xalign">0</property>
                         <child>
-                          <widget class="GtkViewport" id="viewport4">
+                          <widget class="GtkAlignment" id="alignment4">
                             <property name="visible">True</property>
-                            <property name="shadow_type">GTK_SHADOW_NONE</property>
+                            <property name="left_padding">12</property>
                             <child>
-                              <widget class="GtkFrame" id="frame12">
+                              <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_collections">
                                 <property name="visible">True</property>
-                                <property name="label_xalign">0</property>
+                                <property name="can_focus">True</property>
+                                <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+                                <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
-                                  <widget class="GtkAlignment" id="alignment4">
+                                  <widget class="GtkViewport" id="viewport4">
                                     <property name="visible">True</property>
-                                    <property name="left_padding">12</property>
+                                    <property name="shadow_type">GTK_SHADOW_NONE</property>
                                     <child>
                                       <widget class="GtkVBox" id="af_collections_vbox">
                                         <property name="visible">True</property>
@@ -8173,43 +8173,43 @@
                                     </child>
                                   </widget>
                                 </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label3">
-                                    <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;Collections&lt;/b&gt;</property>
-                                    <property name="use_markup">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="type">label_item</property>
-                                  </packing>
-                                </child>
                               </widget>
                             </child>
                           </widget>
                         </child>
+                        <child>
+                          <widget class="GtkLabel" id="label3">
+                            <property name="visible">True</property>
+                            <property name="label" translatable="yes">&lt;b&gt;Collections&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="type">label_item</property>
+                          </packing>
+                        </child>
                       </widget>
                       <packing>
                         <property name="position">3</property>
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_loans">
+                      <widget class="GtkFrame" id="frame28">
                         <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
-                        <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+                        <property name="label_xalign">0</property>
                         <child>
-                          <widget class="GtkViewport" id="viewport10">
+                          <widget class="GtkAlignment" id="alignment6">
                             <property name="visible">True</property>
-                            <property name="shadow_type">GTK_SHADOW_NONE</property>
+                            <property name="left_padding">12</property>
                             <child>
-                              <widget class="GtkFrame" id="frame28">
+                              <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_loans">
                                 <property name="visible">True</property>
-                                <property name="label_xalign">0</property>
+                                <property name="can_focus">True</property>
+                                <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+                                <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
-                                  <widget class="GtkAlignment" id="alignment6">
+                                  <widget class="GtkViewport" id="viewport10">
                                     <property name="visible">True</property>
-                                    <property name="left_padding">12</property>
+                                    <property name="shadow_type">GTK_SHADOW_NONE</property>
                                     <child>
                                       <widget class="GtkVBox" id="af_loans_vbox">
                                         <property name="visible">True</property>
@@ -8220,25 +8220,28 @@
                                     </child>
                                   </widget>
                                 </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label4">
-                                    <property name="visible">True</property>
-                                    <property name="label" translatable="yes">&lt;b&gt;Loans&lt;/b&gt;</property>
-                                    <property name="use_markup">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="type">label_item</property>
-                                  </packing>
-                                </child>
                               </widget>
                             </child>
                           </widget>
                         </child>
+                        <child>
+                          <widget class="GtkLabel" id="label4">
+                            <property name="visible">True</property>
+                            <property name="label" translatable="yes">&lt;b&gt;Loans&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="type">label_item</property>
+                          </packing>
+                        </child>
                       </widget>
                       <packing>
                         <property name="position">4</property>
                       </packing>
                     </child>
+                    <child>
+                      <placeholder/>
+                    </child>
                   </widget>
                 </child>
               </widget>



From piotrek at mail.berlios.de  Sun Oct 19 22:06:47 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 22:06:47 +0200
Subject: [Griffith-svn] r1009 - in trunk: . glade lib
Message-ID: <200810192006.m9JK6lGj011511@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 22:06:45 +0200 (Sun, 19 Oct 2008)
New Revision: 1009

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/griffith
   trunk/lib/advfilter.py
   trunk/lib/initialize.py
   trunk/lib/widgets.py
Log:
Add more filter movie rules to the search window (dynamic ones this time)


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/ChangeLog	2008-10-19 20:06:45 UTC (rev 1009)
@@ -6,7 +6,7 @@
 
 
 2008-10-19  Piotr O?arowski
-	* Add tags/volumes/collections/loans to adv. filter window
+	* Add more filter movie rules to the search window
 
 2008-10-18  Piotr O?arowski
 	* Speed up import movies function

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/glade/griffith.glade	2008-10-19 20:06:45 UTC (rev 1009)
@@ -7900,7 +7900,7 @@
     <property name="border_width">5</property>
     <property name="title" translatable="yes">Filter movies</property>
     <property name="window_position">GTK_WIN_POS_CENTER_ON_PARENT</property>
-    <property name="default_height">350</property>
+    <property name="default_height">550</property>
     <property name="type_hint">GDK_WINDOW_TYPE_HINT_DIALOG</property>
     <property name="has_separator">False</property>
     <child internal-child="vbox">
@@ -7923,7 +7923,7 @@
                     <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkFrame" id="frame8">
+                      <widget class="GtkFrame" id="af_frame_limits">
                         <property name="visible">True</property>
                         <property name="label_xalign">0</property>
                         <child>
@@ -8052,7 +8052,7 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkFrame" id="frame9">
+                      <widget class="GtkFrame" id="af_frame_tags">
                         <property name="visible">True</property>
                         <property name="label_xalign">0</property>
                         <child>
@@ -8063,6 +8063,7 @@
                               <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_tags">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
+                                <property name="border_width">4</property>
                                 <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
                                 <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
@@ -8099,7 +8100,7 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkFrame" id="frame11">
+                      <widget class="GtkFrame" id="af_frame_volumes">
                         <property name="visible">True</property>
                         <property name="label_xalign">0</property>
                         <child>
@@ -8110,6 +8111,7 @@
                               <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_volumes">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
+                                <property name="border_width">4</property>
                                 <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
                                 <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
@@ -8146,7 +8148,7 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkFrame" id="frame12">
+                      <widget class="GtkFrame" id="af_frame_collections">
                         <property name="visible">True</property>
                         <property name="label_xalign">0</property>
                         <child>
@@ -8157,6 +8159,7 @@
                               <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_collections">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
+                                <property name="border_width">4</property>
                                 <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
                                 <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
@@ -8193,7 +8196,7 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkFrame" id="frame28">
+                      <widget class="GtkFrame" id="af_frame_loans">
                         <property name="visible">True</property>
                         <property name="label_xalign">0</property>
                         <child>
@@ -8204,6 +8207,7 @@
                               <widget class="GtkScrolledWindow" id="scrolledwindow_advfilter_loans">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
+                                <property name="border_width">4</property>
                                 <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
                                 <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
                                 <child>
@@ -8240,7 +8244,14 @@
                       </packing>
                     </child>
                     <child>
-                      <placeholder/>
+                      <widget class="GtkVBox" id="af_dynamic_vbox">
+                        <property name="visible">True</property>
+                        <property name="spacing">2</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="position">5</property>
+                      </packing>
                     </child>
                   </widget>
                 </child>
@@ -8256,6 +8267,22 @@
             <property name="visible">True</property>
             <property name="layout_style">GTK_BUTTONBOX_END</property>
             <child>
+              <widget class="GtkButton" id="af_add_button">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="receives_default">True</property>
+                <property name="label" translatable="yes">gtk-add</property>
+                <property name="use_stock">True</property>
+                <property name="response_id">0</property>
+              </widget>
+              <packing>
+                <property name="secondary">True</property>
+              </packing>
+            </child>
+            <child>
+              <placeholder/>
+            </child>
+            <child>
               <widget class="GtkButton" id="button3">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
@@ -8264,6 +8291,9 @@
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
               </widget>
+              <packing>
+                <property name="position">2</property>
+              </packing>
             </child>
             <child>
               <widget class="GtkButton" id="button4">
@@ -8275,7 +8305,7 @@
                 <property name="response_id">0</property>
               </widget>
               <packing>
-                <property name="position">1</property>
+                <property name="position">3</property>
               </packing>
             </child>
             <child>
@@ -8288,7 +8318,7 @@
                 <property name="response_id">0</property>
               </widget>
               <packing>
-                <property name="position">2</property>
+                <property name="position">4</property>
               </packing>
             </child>
             <child>
@@ -8296,13 +8326,13 @@
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
                 <property name="receives_default">True</property>
-                <property name="label" translatable="yes">gtk-cancel</property>
+                <property name="label" translatable="yes">gtk-close</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
                 <signal name="clicked" handler="on_advfilter_close"/>
               </widget>
               <packing>
-                <property name="position">3</property>
+                <property name="position">5</property>
               </packing>
             </child>
             <child>
@@ -8310,13 +8340,13 @@
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
                 <property name="receives_default">True</property>
-                <property name="label" translatable="yes">gtk-ok</property>
+                <property name="label" translatable="yes">gtk-find</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
-                <signal name="clicked" handler="on_apply_filter_clicked"/>
+                <signal name="clicked" handler="on_af_find_clicked"/>
               </widget>
               <packing>
-                <property name="position">4</property>
+                <property name="position">6</property>
               </packing>
             </child>
           </widget>

Modified: trunk/griffith
===================================================================
--- trunk/griffith	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/griffith	2008-10-19 20:06:45 UTC (rev 1009)
@@ -963,10 +963,9 @@
         from advfilter import hide_window
         hide_window(self)
 
-    def on_apply_filter_clicked(self, *args):
+    def on_af_find_clicked(self, *args):
         from advfilter import create_select_query, hide_window
         movies = create_select_query(self, None, None, None).execute().fetchall()
-        hide_window(self)
         main_treeview.populate(self, movies, qf=False)
 
     # quick filter operations ---------------------------------------------

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/lib/advfilter.py	2008-10-19 20:06:45 UTC (rev 1009)
@@ -42,17 +42,22 @@
     'loaned_to'       : set(), # list of person_ids	    (search for movies loaned to these people)
     'loan_history'    : set(), # list of person_ids	    (search for movies which were loaned by these people)
     'sort_by'         : set(("number",)), # "number DESC"
-    'equals'          : {}, # {column1: [value1, value2, ...], column2: []}
+    'equals'          : {}, # {column1: set(value1, value2), column2: set(value3)}
     'startswith'      : {}, # see above
     'contains'        : {}, # see above
     'like'            : {}, # see above
     'ilike'           : {}, # see above
     }
+    
+QUERY_FIELDS = ('title', 'o_title', 'director', 'plot', 'cast', 'notes', 'number',
+                'runtime', 'year', 'screenplay', 'cameraman', 'country', 'genre',
+                'studio', 'classification', 'o_site', 'site', 'trailer')
+QUERY_COMMANDS = ('equals', 'startswith', 'contains', 'like', 'ilike')
 
 # widgets -----------------------------------------------------{{{
 
 def show_window(self):
-    initialize(self.widgets['advfilter'], self.db)
+    initialize(self.widgets['advfilter'], self.db, self.field_names)
     self.widgets['advfilter']['window'].show()
     return True
 
@@ -69,6 +74,8 @@
         i.destroy()
     for i in widgets['loans_vbox'].get_children():
         i.destroy()
+    for i in widgets['dynamic_vbox'].get_children():
+        i.destroy()
 
     return True
 
@@ -94,7 +101,7 @@
         label_id.hide()
         container.pack_start(hbox)
 
-def initialize(widgets, gsql):
+def initialize(widgets, gsql, field_names):
     # tags
     items = gsql.session.query(db.Tag).all()
     options = (_('ignore'), _('with'), _('without'), _('require'))
@@ -114,7 +121,39 @@
     items = gsql.session.query(db.Person).all()
     options = (_('ignore'), _('loaned to '), _('loan history'))
     _fill_container(widgets["loans_vbox"], items, options, 'person_id')
+
+    add_query_widget(widgets['dynamic_vbox'], gsql, field_names)
+
+    # TODO: this has to be done only once, move it outside initialize()
+    widgets["add_button"].connect('clicked', lambda w: add_query_widget(widgets['dynamic_vbox'], gsql, field_names))
+    
     return True
+
+def add_query_widget(container, gsql, field_names):
+    hbox = gtk.HBox()
+
+    cb = gtk.combo_box_new_text()
+    for field in QUERY_FIELDS:
+        cb.append_text(field_names[field])
+    cb.set_active(0)
+
+    action_cb = gtk.combo_box_new_text()
+    for command in QUERY_COMMANDS:
+        action_cb.append_text(_(command))
+    action_cb.set_active(0)
+
+    entry = gtk.Entry()
+    
+    button = gtk.Button(stock=gtk.STOCK_DELETE)
+    button.connect("clicked", lambda w: hbox.destroy())
+
+    hbox.pack_start(cb, expand=False)
+    hbox.pack_start(action_cb, expand=False)
+    hbox.pack_start(entry, expand=True, padding=8)
+    hbox.pack_start(button, expand=False, fill=False)
+    hbox.show_all()
+
+    container.pack_start(hbox)
 #}}}
 
 # database related --------------------------------------------
@@ -168,17 +207,28 @@
             cond["loaned_to"].add(int(childs[0].get_label()))
         elif childs[3].get_active():
             cond["loan_history"].add(int(childs[0].get_label()))
+    
+    for hbox in widgets["dynamic_vbox"]:
+        childs = hbox.get_children()
 
-    # TODO: remove after tests
-    cond.update({
-        #'tags'      : [1],
-        #'no_tags'   : [1],
-        #'collections'   : set((1,)),
-        'sort_by'   : set(("title", "year", "number DESC")),
-        #'equals'    : {"year": [2003, 2004]},
-        #'startswith': {"o_title": [u"Ma", u"Ani"] }
-        #'contains'  : {"o_title": [u"ma", u"ani"] },
-        })
+        entry = childs[2].get_text().strip().decode('utf-8')
+        if not entry: # ignore if it's empty
+            continue
+
+        field = childs[0].get_active()
+        if 0 < field > len(QUERY_FIELDS):
+            continue
+        else:
+            field = QUERY_FIELDS[field]
+            
+            command = childs[1].get_active()
+            if 0 < command > len(QUERY_COMMANDS):
+                continue
+            else:
+                command = QUERY_COMMANDS[command]
+            
+        cond[command].setdefault(field, set()).add(entry)
+
     return cond # }}}
 
 def get_select_columns(config): # {{{

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/lib/initialize.py	2008-10-19 20:06:45 UTC (rev 1009)
@@ -608,6 +608,7 @@
         'runtime', 'country', 'genre', 'studio', 'media_num', 'rating')
     self.field_names = {
         'cast'           : _('Cast'),
+        'cameraman'      : _('Cameraman'),
         'classification' : _('Classification'),
         'collection_id'  : _('Collection'),
         'color'          : _('Color'),
@@ -628,6 +629,7 @@
         'rating'         : _('Rating'),
         'region'         : _('Region'),
         'runtime'        : _('Runtime'),
+        'screenplay'     : _('Screenplay'),
         'seen'           : _('Seen it'),
         'site'           : _('Site'),
         'studio'         : _('Studio'),

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-19 18:09:48 UTC (rev 1008)
+++ trunk/lib/widgets.py	2008-10-19 20:06:45 UTC (rev 1009)
@@ -157,6 +157,8 @@
         'volumes_vbox'     : get('af_volumes_vbox'),
         'collections_vbox' : get('af_collections_vbox'),
         'loans_vbox'       : get('af_loans_vbox'),
+        'dynamic_vbox'     : get('af_dynamic_vbox'),
+        'add_button'       : get('af_add_button'),
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])
@@ -484,7 +486,7 @@
         'on_vcodec_name_combo_changed'           : self.on_vcodec_name_combo_changed,
         # advfilter
         'on_open_advfilterwindow_clicked'        : self.show_advfilter_window,
-        'on_apply_filter_clicked'                : self.on_apply_filter_clicked,
+        'on_af_find_clicked'                     : self.on_af_find_clicked,
         'on_advfilter_close'                     : self.hide_advfilter_window,
     })#}}}
 



From piotrek at mail.berlios.de  Sun Oct 19 22:50:41 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 22:50:41 +0200
Subject: [Griffith-svn] r1010 - trunk/lib
Message-ID: <200810192050.m9JKofOE018328@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 22:50:41 +0200 (Sun, 19 Oct 2008)
New Revision: 1010

Modified:
   trunk/lib/advfilter.py
   trunk/lib/widgets.py
Log:
move advfilter's add_button signal connection to widgets module


Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-19 20:06:45 UTC (rev 1009)
+++ trunk/lib/advfilter.py	2008-10-19 20:50:41 UTC (rev 1010)
@@ -124,9 +124,6 @@
 
     add_query_widget(widgets['dynamic_vbox'], gsql, field_names)
 
-    # TODO: this has to be done only once, move it outside initialize()
-    widgets["add_button"].connect('clicked', lambda w: add_query_widget(widgets['dynamic_vbox'], gsql, field_names))
-    
     return True
 
 def add_query_widget(container, gsql, field_names):

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-19 20:06:45 UTC (rev 1009)
+++ trunk/lib/widgets.py	2008-10-19 20:50:41 UTC (rev 1010)
@@ -25,6 +25,7 @@
 gettext.install('griffith', unicode=1)
 import gtk
 import sys
+import advfilter
 
 def define_widgets(self, gladefile):
     get = lambda x: gladefile.get_widget(x)
@@ -142,6 +143,7 @@
     self.widgets['add']['o_title'].connect('activate', self.on_enter)
     self.widgets['add']['title'].connect('activate', self.on_enter)
     self.widgets['add']['window'].set_transient_for(self.widgets['window'])
+    
     #}}}
     
     self.widgets['advfilter'] = {#{{{
@@ -162,6 +164,7 @@
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])
+    self.widgets['advfilter']['add_button'].connect('clicked', lambda w: advfilter.add_query_widget(self.widgets['advfilter']['dynamic_vbox'], self.db, self.field_names))
     #}}}
 
     self.widgets['preferences'] = {#{{{



From piotrek at mail.berlios.de  Sun Oct 19 23:36:18 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 19 Oct 2008 23:36:18 +0200
Subject: [Griffith-svn] r1011 - in trunk: . glade lib
Message-ID: <200810192136.m9JLaI3O023642@sheep.berlios.de>

Author: piotrek
Date: 2008-10-19 23:36:17 +0200 (Sun, 19 Oct 2008)
New Revision: 1011

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/lib/add.py
   trunk/lib/db.py
   trunk/lib/initialize.py
   trunk/lib/main_treeview.py
   trunk/lib/widgets.py
Log:
Screenplay/cameraman/aspect ratio added to main window


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/ChangeLog	2008-10-19 21:36:17 UTC (rev 1011)
@@ -7,6 +7,7 @@
 
 2008-10-19  Piotr O?arowski
 	* Add more filter movie rules to the search window
+	* Screenplay and cameraman added to main/add windows
 
 2008-10-18  Piotr O?arowski
 	* Speed up import movies function

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/glade/griffith.glade	2008-10-19 21:36:17 UTC (rev 1011)
@@ -970,16 +970,16 @@
                           <widget class="GtkTable" id="table3">
                             <property name="visible">True</property>
                             <property name="border_width">5</property>
-                            <property name="n_rows">11</property>
+                            <property name="n_rows">10</property>
                             <property name="n_columns">3</property>
                             <property name="column_spacing">5</property>
                             <property name="row_spacing">2</property>
                             <child>
-                              <widget class="GtkLabel" id="m_director">
+                              <widget class="GtkLabel" id="m_ratio">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">director</property>
+                                <property name="label">16:9</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -987,41 +987,35 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_vcodec">
+                              <widget class="GtkLabel" id="label19">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">video codec</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_condition">
+                              <widget class="GtkLabel" id="label17">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">condition</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Aspect ratio</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
                                 <property name="top_attach">9</property>
                                 <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1029,11 +1023,11 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_medium">
+                              <widget class="GtkLabel" id="m_cameraman">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">2 x medium</property>
+                                <property name="label">cameraman</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1041,18 +1035,18 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_layers">
+                              <widget class="GtkLabel" id="m_screenplay">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">layers</property>
+                                <property name="label">screenplay</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1060,76 +1054,57 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_region">
+                              <widget class="GtkLabel" id="Color2">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">region</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Cameraman</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">6</property>
-                                <property name="bottom_attach">7</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_color">
+                              <widget class="GtkLabel" id="Color1">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">color</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Screenplay</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_classification">
+                              <widget class="GtkLabel" id="label27">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">classification</property>
-                                <property name="use_markup">True</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Country</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_studio">
+                              <widget class="GtkLabel" id="m_genre">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">studio</property>
+                                <property name="label">genre</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1137,37 +1112,31 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_genre">
+                              <widget class="GtkLabel" id="label29">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">genre</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Genre</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_country">
+                              <widget class="GtkLabel" id="m_studio">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">country</property>
+                                <property name="label">studio</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1175,72 +1144,71 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label290">
+                              <widget class="GtkLabel" id="label34">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Studio</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label196">
+                              <widget class="GtkLabel" id="m_classification">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Video codec</property>
+                                <property name="label" translatable="yes">classification</property>
+                                <property name="use_markup">True</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">6</property>
+                                <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label110">
+                              <widget class="GtkLabel" id="label33">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Condition</property>
+                                <property name="label" translatable="yes">Classification</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="top_attach">6</property>
+                                <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label38">
+                              <widget class="GtkLabel" id="m_color">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Medium</property>
+                                <property name="label">color</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label109">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">DVD layers</property>
-                              </widget>
-                              <packing>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="top_attach">7</property>
                                 <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1248,77 +1216,47 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label108">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">DVD region</property>
-                              </widget>
-                              <packing>
-                                <property name="top_attach">6</property>
-                                <property name="bottom_attach">7</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
                               <widget class="GtkLabel" id="Color">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
                                 <property name="label" translatable="yes">Color</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label33">
+                              <widget class="GtkLabel" id="m_director">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Classification</property>
+                                <property name="label">director</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
-                                <property name="x_options">GTK_FILL</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label34">
+                              <widget class="GtkLabel" id="m_country">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Studio</property>
+                                <property name="label">country</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label29">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Genre</property>
-                              </widget>
-                              <packing>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label27">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Country</property>
-                              </widget>
-                              <packing>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="top_attach">1</property>
                                 <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1326,44 +1264,26 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label22">
+                              <widget class="GtkLabel" id="label290">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Director</property>
-                              </widget>
-                              <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label289">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
                                 <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
                                 <property name="use_markup">True</property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">10</property>
-                                <property name="bottom_attach">11</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label288">
+                              <widget class="GtkLabel" id="label22">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Director</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -1496,6 +1416,38 @@
                                 <property name="y_options"></property>
                               </packing>
                             </child>
+                            <child>
+                              <widget class="GtkLabel" id="label196">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Video codec</property>
+                              </widget>
+                              <packing>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="m_vcodec">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label">video codec</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                              </widget>
+                              <packing>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
                           </widget>
                           <packing>
                             <property name="position">3</property>
@@ -2265,6 +2217,215 @@
                         <property name="tab_fill">False</property>
                       </packing>
                     </child>
+                    <child>
+                      <widget class="GtkTable" id="table2">
+                        <property name="visible">True</property>
+                        <property name="border_width">4</property>
+                        <property name="n_rows">4</property>
+                        <property name="n_columns">3</property>
+                        <property name="column_spacing">5</property>
+                        <property name="row_spacing">2</property>
+                        <child>
+                          <widget class="GtkLabel" id="label48">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label14">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label13">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label8">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="m_medium">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">2 x medium</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label38">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Medium</property>
+                          </widget>
+                          <packing>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label108">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">DVD region</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="m_region">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">region</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label109">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">DVD layers</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="m_layers">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">layers</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label110">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Condition</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="m_condition">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label">condition</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                          </widget>
+                          <packing>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">7</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="label6">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">Medium</property>
+                      </widget>
+                      <packing>
+                        <property name="type">tab</property>
+                        <property name="position">7</property>
+                        <property name="tab_fill">False</property>
+                      </packing>
+                    </child>
                   </widget>
                   <packing>
                     <property name="position">1</property>
@@ -5977,12 +6138,12 @@
               <widget class="GtkTable" id="table_a_details">
                 <property name="visible">True</property>
                 <property name="border_width">6</property>
-                <property name="n_rows">11</property>
+                <property name="n_rows">13</property>
                 <property name="n_columns">2</property>
                 <property name="column_spacing">2</property>
                 <property name="row_spacing">2</property>
                 <child>
-                  <widget class="GtkEntry" id="am_trailer">
+                  <widget class="GtkEntry" id="am_cameraman">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -5990,53 +6151,93 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label53">
+                  <widget class="GtkEntry" id="am_screenplay">
                     <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label15">
+                    <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Trailer</property>
+                    <property name="label" translatable="yes">Cameraman</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_imdb">
+                  <widget class="GtkLabel" id="label7">
                     <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Screenplay</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label42">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Director</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkEntry" id="am_country">
+                    <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label52">
+                  <widget class="GtkLabel" id="label44">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Site</property>
+                    <property name="label" translatable="yes">Country</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_site">
+                  <widget class="GtkEntry" id="am_genre">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6044,16 +6245,70 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label46">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Genre</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkEntry" id="am_classification">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label49">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Classification</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkEntry" id="am_studio">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
                     <property name="top_attach">8</property>
                     <property name="bottom_attach">9</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label51">
+                  <widget class="GtkLabel" id="label50">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Official site</property>
+                    <property name="label" translatable="yes">Studio</property>
                   </widget>
                   <packing>
                     <property name="top_attach">8</property>
@@ -6063,19 +6318,100 @@
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator7">
+                  <widget class="GtkHSeparator" id="hseparator1">
                     <property name="visible">True</property>
                   </widget>
                   <packing>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options">GTK_FILL</property>
                     <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
+                  <widget class="GtkEntry" id="am_site">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label51">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Official site</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkEntry" id="am_imdb">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">11</property>
+                    <property name="bottom_attach">12</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label52">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Site</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">11</property>
+                    <property name="bottom_attach">12</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkEntry" id="am_trailer">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">12</property>
+                    <property name="bottom_attach">13</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label53">
+                    <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Trailer</property>
+                  </widget>
+                  <packing>
+                    <property name="top_attach">12</property>
+                    <property name="bottom_attach">13</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
                   <widget class="GtkHBox" id="hbox65">
                     <property name="visible">True</property>
                     <child>
@@ -6222,127 +6558,6 @@
                     <property name="y_options"></property>
                   </packing>
                 </child>
-                <child>
-                  <widget class="GtkEntry" id="am_country">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkEntry" id="am_genre">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkEntry" id="am_classification">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkEntry" id="am_studio">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
-                  </widget>
-                  <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label42">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Director</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label44">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Country</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label46">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Genre</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label49">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Classification</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label50">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Studio</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
               </widget>
               <packing>
                 <property name="position">1</property>

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/lib/add.py	2008-10-19 21:36:17 UTC (rev 1011)
@@ -330,6 +330,7 @@
     plot_buffer  = w['plot'].get_buffer()
     
     t_movies = {
+        'cameraman'      : w['cameraman'].get_text().decode('utf-8'),
         'classification' : w['classification'].get_text().decode('utf-8'),
         'color'          : w['color'].get_active(),
         'cond'           : w['condition'].get_active(),
@@ -345,6 +346,7 @@
         'rating'         : w['rating_slider'].get_value(),
         'region'         : w['region'].get_active(),
         'runtime'        : w['runtime'].get_text().decode('utf-8'),
+        'screenplay'     : w['screenplay'].get_text().decode('utf-8'),
         'site'           : w['site'].get_text().decode('utf-8'),
         'studio'         : w['studio'].get_text().decode('utf-8'),
         'title'          : w['title'].get_text().decode('utf-8'),
@@ -447,6 +449,14 @@
         w['runtime'].set_value( gutils.digits_only(item['runtime']))
     else:
         w['runtime'].set_value(0)
+    if 'cameraman' in item and item['cameraman']:
+        w['cameraman'].set_text(item['cameraman'])
+    else:
+        w['cameraman'].set_text('')
+    if 'screenplay' in item and item['screenplay']:
+        w['screenplay'].set_text(item['screenplay'])
+    else:
+        w['screenplay'].set_text('')
     if 'country' in item and item['country']:
         w['country'].set_text(item['country'])
     else:
@@ -475,10 +485,6 @@
         w['trailer'].set_text(item['trailer'])
     else:
         w['trailer'].set_text('')
-    if 'title' in item and item['title']:
-        w['title'].set_text(item['title'])
-    else:
-        w['title'].set_text('')
     if 'genre' in item and item['genre']:
         w['genre'].set_text(item['genre'])
     else:

Modified: trunk/lib/db.py
===================================================================
--- trunk/lib/db.py	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/lib/db.py	2008-10-19 21:36:17 UTC (rev 1011)
@@ -334,8 +334,8 @@
     'movies': relation(Movie, backref='collection')})
 mapper(Medium, media_table, properties={
     'movies': relation(Movie, backref='medium')})
-mapper(Ratio, media_table, properties={
-    'movies': relation(Movie, backref='ratios')})
+mapper(Ratio, ratios_table, properties={
+    'movies': relation(Movie, backref='ratio')})
 mapper(VCodec, vcodecs_table, properties={
     'movies': relation(Movie, backref='vcodec')})
 mapper(Person, people_table, properties = {

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/lib/initialize.py	2008-10-19 21:36:17 UTC (rev 1011)
@@ -461,7 +461,7 @@
     fields_to_import = ( 'number','title', 'o_title', 'director', 'year', 'runtime', 'country',
         'seen', 'rating', 'genre', 'studio', 'plot', 'cast', 'notes', 'classification',
         'site', 'o_site', 'trailer', 'medium_id', 'media_num', 'vcodec_id', 'color', 'cond',
-        'layers', 'region', 'collection_id', 'volume_id', 'image')
+        'layers', 'region', 'collection_id', 'volume_id', 'image', 'ratio_id')
 
     # glade
     glade_file = gtk.glade.XML(os.path.join(self.locations['glade'], 'import.glade'))
@@ -626,6 +626,7 @@
         'o_site'         : _('Official site'),
         'o_title'        : _('Original Title'),
         'plot'           : _('Plot'),
+        'ratio'          : _('Aspect ratio'),
         'rating'         : _('Rating'),
         'region'         : _('Region'),
         'runtime'        : _('Runtime'),

Modified: trunk/lib/main_treeview.py
===================================================================
--- trunk/lib/main_treeview.py	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/lib/main_treeview.py	2008-10-19 21:36:17 UTC (rev 1011)
@@ -89,6 +89,14 @@
         w['runtime'].set_text(str(int(item['runtime'])))
     else:
         w['runtime'].set_text('x')
+    if 'cameraman' in item and item['cameraman']:
+        w['cameraman'].set_markup("<i>%s</i>" % gutils.html_encode(item['cameraman']))
+    else:
+        w['cameraman'].set_text('')
+    if 'screenplay' in item and item['screenplay']:
+        w['screenplay'].set_markup("<i>%s</i>" % gutils.html_encode(item['screenplay']))
+    else:
+        w['screenplay'].set_text('')
     if 'cast' in item and item['cast']:
         w['cast'].set_text(str(item['cast']))
     else:
@@ -189,6 +197,13 @@
             w['vcodec'].set_text('')
     else:
         w['vcodec'].set_text('')
+    if 'ratio_id' in item:
+        if item.ratio is not None:
+            w['ratio'].set_markup("<i>%s</i>" % gutils.html_encode(item.ratio.name))
+        else:
+            w['ratio'].set_text('')
+    else:
+        w['ratio'].set_text('')
 
     # poster
     if 'poster_md5' in item and item['poster_md5']:

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-19 20:50:41 UTC (rev 1010)
+++ trunk/lib/widgets.py	2008-10-19 21:36:17 UTC (rev 1011)
@@ -45,6 +45,7 @@
     self.widgets['movie'] = {#{{{
         'cast'                   : get('m_cast'),
         'classification'         : get('m_classification'),
+        'cameraman'              : get('m_cameraman'),
         'collection'             : get('m_collection'),
         'color'                  : get('m_color'),
         'condition'              : get('m_condition'),
@@ -63,9 +64,11 @@
         'plot'                   : get('m_plot'),
         'region'                 : get('m_region'),
         'runtime'                : get('m_runtime'),
+        'screenplay'             : get('m_screenplay'),
         'seen_icon'              : get('m_seen_icon'),
         'site'                   : get('m_site'),
         'studio'                 : get('m_studio'),
+        'ratio'                  : get('m_ratio'),
         'tags'                   : get('m_tags'),
         'title'                  : get('m_title'),
         'trailer'                : get('m_trailer'),
@@ -93,6 +96,7 @@
         'window'           : get('add_movie'),
         'notebook'         : get('notebook_add'),
         'classification'   : get('am_classification'),
+        'cameraman'        : get('am_cameraman'),
         'collection'       : get('am_collection_combo'),
         'color'            : get('am_color'),
         'condition'        : get('am_condition'),
@@ -112,10 +116,12 @@
         'plot'             : get('am_plot'),
         'plugin_desc'      : get('am_plugin_desc'),
         'plugin_image'     : get('am_plugin_image'),
+        #'ratio'            : get('am_ratio'), # TODO
         'region'           : get('am_region'),
         'runtime'          : get('am_runtime'),
         'seen'             : get('am_seen'),
         'o_site'           : get('am_site'),
+        'screenplay'       : get('am_screenplay'),
         'source'           : get('am_source'),
         'studio'           : get('am_studio'),
         'tag_vbox'         : get('am_tag_vbox'),



From piotrek at mail.berlios.de  Thu Oct 23 22:54:56 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 23 Oct 2008 22:54:56 +0200
Subject: [Griffith-svn] r1012 - in trunk: . glade lib
Message-ID: <200810232054.m9NKsu0m010750@sheep.berlios.de>

Author: piotrek
Date: 2008-10-23 22:54:56 +0200 (Thu, 23 Oct 2008)
New Revision: 1012

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/lib/advfilter.py
   trunk/lib/widgets.py
Log:
clean/restore search conditions in advfilter


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-19 21:36:17 UTC (rev 1011)
+++ trunk/ChangeLog	2008-10-23 20:54:56 UTC (rev 1012)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-23  Piotr O?arowski
+	* clean/restore search conditions in advfilter
+
 2008-10-19  Piotr O?arowski
 	* Add more filter movie rules to the search window
 	* Screenplay and cameraman added to main/add windows

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-19 21:36:17 UTC (rev 1011)
+++ trunk/glade/griffith.glade	2008-10-23 20:54:56 UTC (rev 1012)
@@ -8489,6 +8489,7 @@
                 <property name="label" translatable="yes">gtk-add</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_add"/>
               </widget>
               <packing>
                 <property name="secondary">True</property>
@@ -8505,6 +8506,7 @@
                 <property name="label" translatable="yes">gtk-open</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_open"/>
               </widget>
               <packing>
                 <property name="position">2</property>
@@ -8518,6 +8520,7 @@
                 <property name="label" translatable="yes">gtk-save-as</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_save"/>
               </widget>
               <packing>
                 <property name="position">3</property>
@@ -8531,6 +8534,7 @@
                 <property name="label" translatable="yes">gtk-clear</property>
                 <property name="use_stock">True</property>
                 <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_clear"/>
               </widget>
               <packing>
                 <property name="position">4</property>

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-19 21:36:17 UTC (rev 1011)
+++ trunk/lib/advfilter.py	2008-10-23 20:54:56 UTC (rev 1012)
@@ -58,7 +58,12 @@
 
 def show_window(self):
     initialize(self.widgets['advfilter'], self.db, self.field_names)
+
+    if getattr(self, '_search_conditions', None):
+        set_conditions(self.widgets['advfilter'], self._search_conditions, self.field_names)
+
     self.widgets['advfilter']['window'].show()
+
     return True
 
 def hide_window(self):
@@ -122,24 +127,29 @@
     options = (_('ignore'), _('loaned to '), _('loan history'))
     _fill_container(widgets["loans_vbox"], items, options, 'person_id')
 
-    add_query_widget(widgets['dynamic_vbox'], gsql, field_names)
-
     return True
 
-def add_query_widget(container, gsql, field_names):
+def add_query_widget(container, field_names, sel_qf='title', sel_comm=0, text='' ):
     hbox = gtk.HBox()
 
     cb = gtk.combo_box_new_text()
-    for field in QUERY_FIELDS:
+    select = 0
+    for i, field in enumerate(QUERY_FIELDS):
+        if sel_qf == field:
+            select = i
         cb.append_text(field_names[field])
-    cb.set_active(0)
+    cb.set_active(select)
 
     action_cb = gtk.combo_box_new_text()
-    for command in QUERY_COMMANDS:
+    select = 0
+    for i, command in enumerate(QUERY_COMMANDS):
+        if sel_comm == command:
+            select = i
         action_cb.append_text(_(command))
-    action_cb.set_active(0)
+    action_cb.set_active(select)
 
     entry = gtk.Entry()
+    entry.set_text(text)
     
     button = gtk.Button(stock=gtk.STOCK_DELETE)
     button.connect("clicked", lambda w: hbox.destroy())
@@ -151,13 +161,78 @@
     hbox.show_all()
 
     container.pack_start(hbox)
-#}}}
 
-# database related --------------------------------------------
+def set_conditions(widgets, cond, field_names): #{{{
+    if cond["seen"] is None:
+        widgets["rb_seen"].set_active(True)
+    elif cond["seen"] is True:
+        widgets["rb_seen_only"].set_active(True)
+    elif cond["seen"] is False:
+        widgets["rb_seen_only_n"].set_active(True)
+    
+    if cond["loaned"] is None:
+        widgets["rb_loaned"].set_active(True)
+    elif cond["loaned"] is True:
+        widgets["rb_loaned_only"].set_active(True)
+    elif cond["loaned"] is False:
+        widgets["rb_loaned_only_n"].set_active(True)
 
-def get_def_conditions():
-    return deepcopy(__conditions)
+    for hbox in widgets["tags_vbox"]:
+        hbox_items = hbox.get_children()
+        id_ = int(hbox_items[0].get_text())
+        if id_ in cond['tags']:
+            hbox_items[2].set_active(True)
+        elif id_ in cond['no_tags']:
+            hbox_items[3].set_active(True)
+        elif id_ in cond['required_tags']:
+            hbox_items[4].set_active(True)
+        else:
+            hbox_items[1].set_active(True)
+    
+    for hbox in widgets["volumes_vbox"]:
+        hbox_items = hbox.get_children()
+        id_ = int(hbox_items[0].get_text())
+        if id_ in cond['volumes']:
+            hbox_items[2].set_active(True)
+        elif id_ in cond['no_volumes']:
+            hbox_items[3].set_active(True)
+        else:
+            hbox_items[1].set_active(True)
+    
+    for hbox in widgets["collections_vbox"]:
+        hbox_items = hbox.get_children()
+        id_ = int(hbox_items[0].get_text())
+        if id_ in cond['collections']:
+            hbox_items[2].set_active(True)
+        elif id_ in cond['no_collections']:
+            hbox_items[3].set_active(True)
+        else:
+            hbox_items[1].set_active(True)
+    
+    for hbox in widgets["loans_vbox"]:
+        hbox_items = hbox.get_children()
+        id_ = int(hbox_items[0].get_text())
+        if id_ in cond['loaned_to']:
+            hbox_items[2].set_active(True)
+        elif id_ in cond['loan_history']:
+            hbox_items[3].set_active(True)
+        else:
+            hbox_items[1].set_active(True)
 
+    if not cond["equals"] and not cond["startswith"] and not cond["contains"] and not cond["like"] and not cond["ilike"]:
+        for i in widgets['dynamic_vbox'].get_children():
+            i.destroy()
+        add_query_widget(widgets['dynamic_vbox'], field_names)
+    else:
+        vbox = widgets['dynamic_vbox']
+        for rule in ('equals', 'startswith', 'contains', 'like', 'ilike'):
+            for field in cond[rule]:
+                for text in cond[rule][field]:
+                    add_query_widget(vbox, field_names, field, rule, text)
+
+    
+    #}}}
+
 def get_conditions(widgets): #{{{
     cond = get_def_conditions()
 
@@ -176,49 +251,49 @@
         cond["loaned"] = False
 
     for hbox in widgets["tags_vbox"]:
-        childs = hbox.get_children()
-        if childs[2].get_active():
-            cond["tags"].add(int(childs[0].get_label()))
-        elif childs[3].get_active():
-            cond["no_tags"].add(int(childs[0].get_label()))
-        elif childs[4].get_active():
-            cond["required_tags"].add(int(childs[0].get_label()))
+        hbox_items = hbox.get_children()
+        if hbox_items[2].get_active():
+            cond["tags"].add(int(hbox_items[0].get_label()))
+        elif hbox_items[3].get_active():
+            cond["no_tags"].add(int(hbox_items[0].get_label()))
+        elif hbox_items[4].get_active():
+            cond["required_tags"].add(int(hbox_items[0].get_label()))
 
     for hbox in widgets["volumes_vbox"]:
-        childs = hbox.get_children()
-        if childs[2].get_active():
-            cond["volumes"].add(int(childs[0].get_label()))
-        elif childs[3].get_active():
-            cond["no_volumes"].add(int(childs[0].get_label()))
+        hbox_items = hbox.get_children()
+        if hbox_items[2].get_active():
+            cond["volumes"].add(int(hbox_items[0].get_label()))
+        elif hbox_items[3].get_active():
+            cond["no_volumes"].add(int(hbox_items[0].get_label()))
     
     for hbox in widgets["collections_vbox"]:
-        childs = hbox.get_children()
-        if childs[2].get_active():
-            cond["collections"].add(int(childs[0].get_label()))
-        elif childs[3].get_active():
-            cond["no_collections"].add(int(childs[0].get_label()))
+        hbox_items = hbox.get_children()
+        if hbox_items[2].get_active():
+            cond["collections"].add(int(hbox_items[0].get_label()))
+        elif hbox_items[3].get_active():
+            cond["no_collections"].add(int(hbox_items[0].get_label()))
     
     for hbox in widgets["loans_vbox"]:
-        childs = hbox.get_children()
-        if childs[2].get_active():
-            cond["loaned_to"].add(int(childs[0].get_label()))
-        elif childs[3].get_active():
-            cond["loan_history"].add(int(childs[0].get_label()))
+        hbox_items = hbox.get_children()
+        if hbox_items[2].get_active():
+            cond["loaned_to"].add(int(hbox_items[0].get_label()))
+        elif hbox_items[3].get_active():
+            cond["loan_history"].add(int(hbox_items[0].get_label()))
     
     for hbox in widgets["dynamic_vbox"]:
-        childs = hbox.get_children()
+        hbox_items = hbox.get_children()
 
-        entry = childs[2].get_text().strip().decode('utf-8')
+        entry = hbox_items[2].get_text().strip().decode('utf-8')
         if not entry: # ignore if it's empty
             continue
 
-        field = childs[0].get_active()
+        field = hbox_items[0].get_active()
         if 0 < field > len(QUERY_FIELDS):
             continue
         else:
             field = QUERY_FIELDS[field]
             
-            command = childs[1].get_active()
+            command = hbox_items[1].get_active()
             if 0 < command > len(QUERY_COMMANDS):
                 continue
             else:
@@ -227,7 +302,13 @@
         cond[command].setdefault(field, set()).add(entry)
 
     return cond # }}}
+#}}}
 
+# database related --------------------------------------------{{{
+
+def get_def_conditions():
+    return deepcopy(__conditions)
+
 def get_select_columns(config): # {{{
     # TODO: get them from config
     columns_to_select = [db.Movie.number,
@@ -246,7 +327,8 @@
         if not columns:
             columns = get_select_columns(self.config)
         query = select(columns, bind=self.db.session.bind)
-
+    
+    self._search_conditions = conditions # save for later
     # TODO: remove after debugging:
     from pprint import pprint
     pprint(conditions)
@@ -257,3 +339,4 @@
     raise NotImplemented
 def load_conditions(name, qsql):
     raise NotImplemented
+#}}}

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-19 21:36:17 UTC (rev 1011)
+++ trunk/lib/widgets.py	2008-10-23 20:54:56 UTC (rev 1012)
@@ -170,7 +170,6 @@
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])
-    self.widgets['advfilter']['add_button'].connect('clicked', lambda w: advfilter.add_query_widget(self.widgets['advfilter']['dynamic_vbox'], self.db, self.field_names))
     #}}}
 
     self.widgets['preferences'] = {#{{{
@@ -497,6 +496,8 @@
         'on_open_advfilterwindow_clicked'        : self.show_advfilter_window,
         'on_af_find_clicked'                     : self.on_af_find_clicked,
         'on_advfilter_close'                     : self.hide_advfilter_window,
+        'on_advfilter_add'                       : lambda w: advfilter.add_query_widget(self.widgets['advfilter']['dynamic_vbox'], self.field_names),
+        'on_advfilter_clear'                     : lambda w: advfilter.set_conditions(self.widgets['advfilter'], advfilter.get_def_conditions(), self.field_names)
     })#}}}
 
 def reconnect_add_signals(self):#{{{



From mikej06 at mail.berlios.de  Thu Oct 23 23:01:16 2008
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Thu, 23 Oct 2008 23:01:16 +0200
Subject: [Griffith-svn] r1013 - branches/0.9.x branches/0.9.x/lib
	branches/0.9.x/lib/plugins/movie trunk trunk/lib
	trunk/lib/plugins/movie
Message-ID: <200810232101.m9NL1GR4011547@sheep.berlios.de>

Author: mikej06
Date: 2008-10-23 23:00:53 +0200 (Thu, 23 Oct 2008)
New Revision: 1013

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
   branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py
   branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py
   branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py
   branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py
   branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py
   branches/0.9.x/lib/test_movieplugins.py
   trunk/ChangeLog
   trunk/lib/plugins/movie/PluginMovieAmazon.py
   trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py
   trunk/lib/plugins/movie/PluginMovieIMDB-de.py
   trunk/lib/plugins/movie/PluginMovieKinoDe.py
   trunk/lib/plugins/movie/PluginMovieOFDb.py
   trunk/lib/plugins/movie/PluginMovieZelluloid.py
   trunk/lib/test_movieplugins.py
Log:
* updated IMDB-de, Kino.de, Zelluloid plugin
* added original url check within plugin test


Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/ChangeLog	2008-10-23 21:00:53 UTC (rev 1013)
@@ -5,6 +5,10 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-23  Michael Jahn
+	* updated IMDB-de, Kino.de, Zelluloid plugin
+	* added original url check within plugin test
+
 2008-09-23  Michael Jahn
 	* [#273172] "Properties/Volume/show...in this volume" is broken
 

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -367,12 +367,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -> expected result count }
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 10,
-		'Arahan'				: 5,
-		'Ein gl?ckliches Jahr'	: 1
+		'Rocky Balboa'			: [ 10, 10 ],
+		'Arahan'				: [ 6, 6 ],
+		'Ein gl?ckliches Jahr'	: [ 1, 1 ]
 	}
 
 class PluginTest:
@@ -437,7 +437,6 @@
 			'country'			: 'S?dkorea',
 			'genre'				: 'Actionkom?die, Abenteuer- & Actionkom?die, Fantasykom?die, Action, Kom?die, Mehr Fantasy, Korea, Action, Kom?die, Fantasy, Unter 10 EUR',
 			'classification'	: 'Freigegeben ab 16 Jahren',
-			'studio'			: 'Splendid Entertainment/WVG',
 			'o_site'			: False,
 			'site'				: 'http://www.amazon.de/dp/B000BSNOD6',
 			'trailer'			: False,

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -172,12 +172,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -> expected result count }
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 1,
-		'Arahan'				: 1,
-		'Ein gl?ckliches Jahr'	: 0
+		'Rocky Balboa'			: [ 1, 1 ],
+		'Arahan'				: [ 1, 1 ],
+		'Ein gl?ckliches Jahr'	: [ 0, 0 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,7 +31,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = 'mikej06 at hotmail.com'
-plugin_version      = '1.2'
+plugin_version      = '1.3'
 
 class Plugin(movie.Movie):
 	def __init__(self, id):
@@ -42,6 +42,16 @@
 	def initialize(self):
 		self.cast_page = self.open_page(url=self.url + '/fullcredits')
 		self.plot_page = self.open_page(url=self.url + '/plotsummary')
+		# correction of all &#xxx entities
+		self.page = self.page.decode(self.encode)
+		self.page = gutils.convert_entities(self.page)
+		self.page = self.page.encode(self.encode)
+		self.cast_page = self.cast_page.decode(self.encode)
+		self.cast_page = gutils.convert_entities(self.cast_page)
+		self.cast_page = self.cast_page.encode(self.encode)
+		self.plot_page = self.plot_page.decode(self.encode)
+		self.plot_page = gutils.convert_entities(self.plot_page)
+		self.plot_page = self.plot_page.encode(self.encode)
 
 	def get_image(self):
 		tmp = string.find(self.page, 'a name="poster"')
@@ -51,10 +61,10 @@
 			self.image_url = gutils.trim(self.page[tmp:], 'src="', '"')
 
 	def get_o_title(self):
-		self.o_title = gutils.trim(self.page, '<h1>', ' <span')
+		self.o_title = gutils.trim(self.page, '<h1>', '<span')
 
 	def get_title(self):
-		self.title = gutils.trim(self.page, '<h1>', ' <span')
+		self.title = gutils.trim(self.page, '<h1>', '<span')
 		elements = string.split(gutils.trim(self.page, '<h5>Alternativ:', '</div>'), '<i class="transl"')
 		if len(elements) > 1:
 			for element in elements:
@@ -69,6 +79,8 @@
 			self.director = gutils.trim(self.page,'<h5>Regisseur:</h5>', '</div>')
 		self.director = self.__before_more(self.director)
 		self.director = self.director.replace('<br/>', ', ')
+		self.director = gutils.clean(self.director)
+		self.director = re.sub(',$', '', self.director)
 
 	def get_plot(self):
 		self.plot = gutils.trim(self.page, '<h5>Kurzbeschreibung:</h5>', '</div>')
@@ -86,7 +98,7 @@
 		self.year = gutils.after(self.year, '">')
 
 	def get_runtime(self):
-		self.runtime = gutils.trim(self.page, '<h5>L&auml;nge:</h5>', ' min')
+		self.runtime = self.regextrim(self.page, '<h5>L[^n]+nge:</h5>', ' [Mm]in')
 
 	def get_genre(self):
 		self.genre = gutils.trim(self.page, '<h5>Genre:</h5>', '</div>')
@@ -103,12 +115,14 @@
 		self.cast = string.replace(self.cast, '</tr><tr class="even">', "\n")
 		self.cast = string.replace(self.cast, '</tr><tr class="odd">', "\n")
 		self.cast = self.__before_more(self.cast)
+		self.cast = re.sub('[ ]+', ' ', self.cast)
 
 	def get_classification(self):
 		self.classification = gutils.trim(gutils.trim(self.page, 'Altersfreigabe:', '</div>'), 'Germany:', '&')
 
 	def get_studio(self):
-		self.studio = gutils.trim(self.page, '<h5>Company:</h5>', '</a>')
+		self.studio = gutils.trim(self.page, '<h5>Firma:</h5>', '</div>')
+		self.studio = self.__before_more(self.studio)
 
 	def get_o_site(self):
 		self.o_site = ''
@@ -120,10 +134,13 @@
 		self.trailer = "http://german.imdb.com/title/tt%s/trailers" % self.movie_id
 
 	def get_country(self):
-		self.country = gutils.trim(self.page, '<h5>Produktionsland:</h5>', '</div>')
+		self.country = gutils.trim(self.page, '<h5>Land:</h5>', '</div>')
+		self.country = self.__before_more(self.country)
+		self.country = re.sub('[\n]+', '', self.country)
+		self.country = re.sub('[ ]+', ' ', self.country)
 
 	def get_rating(self):
-		self.rating = gutils.trim(self.page, '<b>Nutzer-Bewertung:</b>', '/10')
+		self.rating = gutils.trim(self.page, '<h5>Nutzer-Bewertung:</h5>', '/10')
 		if self.rating:
 			try:
 				self.rating = str(float(gutils.clean(self.rating)))
@@ -134,13 +151,33 @@
 		self.notes = ''
 		language = gutils.trim(self.page, '<h5>Sprache:</h5>', '</div>')
 		language = gutils.strip_tags(language)
+		language = re.sub('[\n]+', '', language)
+		language = re.sub('[ ]+', ' ', language)
+		language = language.rstrip()
 		color = gutils.trim(self.page, '<h5>Farbe:</h5>', '</div>')
 		color = gutils.strip_tags(color)
+		color = re.sub('[\n]+', '', color)
+		color = re.sub('[ ]+', ' ', color)
+		color = re.sub('[ ]+$', '', color)
+		color = color.rstrip()
 		sound = gutils.trim(self.page, '<h5>Tonverfahren:</h5>', '</div>')
 		sound = gutils.strip_tags(sound)
+		sound = re.sub('[\n]+', '', sound)
+		sound = re.sub('[ ]+', ' ', sound)
+		sound = sound.rstrip()
+		soundsplit = sound.split(' | ')
+		if len(soundsplit) > 1:
+			soundsplit.sort()
+			sound = ''
+			for elem in soundsplit:
+				sound += elem + ' | '
+			sound = sound[0:len(sound) - 3]
 		tagline = gutils.trim(self.page, '<h5>Werbezeile:</h5>', '</div>')
 		tagline = self.__before_more(tagline)
 		tagline = gutils.strip_tags(tagline)
+		tagline = re.sub('[\n]+', '', tagline)
+		tagline = re.sub('[ ]+', ' ', tagline)
+		tagline = tagline.rstrip()
 		if len(language)>0:
 			self.notes = "%s: %s\n" %(_('Language'), language)
 		if len(sound)>0:
@@ -151,31 +188,211 @@
 			self.notes += "%s: %s\n" %('Tagline', tagline)
 	
 	def __before_more(self, data):
-		tmp = string.find(data, '>mehr...<')
+		tmp = string.find(data, '>mehr<')
 		if tmp>0:
 			data = data[:tmp] + '>'
 		return data
 
+	def regextrim(self,text,key1,key2):
+		obj = re.search(key1, text)
+		if obj is None:
+			return ''
+		else:
+			p1 = obj.end()
+		obj = re.search(key2, text[p1:])
+		if obj is None:
+			return ''
+		else:
+			p2 = p1 + obj.start()
+		return text[p1:p2]
+
 class SearchPlugin(movie.SearchMovie):
-	PATTERN = re.compile(r"""<a href=['"]/title/tt([0-9]+)/["']>(.*?)</td>""")
+	PATTERN = re.compile(r"""<a href=['"]/title/tt([0-9]+)/["']>(.*?)(</td>|</A>)""", re.IGNORECASE)
+	PATTERN_POWERSEARCH = re.compile(r"""Here are the [0-9]+ matching titles""")
+
 	def __init__(self):
 		self.original_url_search	= 'http://german.imdb.com/find?more=tt&q='
-		self.translated_url_search	= 'http://german.imdb.com/find?more=tt&q='
+		self.translated_url_search	= 'http://german.imdb.com/List?words='
 		self.encode = 'iso8859-1'
+		self.remove_accents = False
 
 	def search(self,parent_window):
 		self.open_search(parent_window)
-		self.page = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit');
-		self.page = self.page.decode('iso-8859-1')
+		tmp = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit')
+		if tmp == '':
+			if self.PATTERN_POWERSEARCH.search(self.page) is None:
+				self.page = ''
+		else:
+			self.page = tmp 
+		# correction of all &#xxx entities
+		self.page = self.page.decode(self.encode)
+		self.page = gutils.convert_entities(self.page)
+		self.page = self.page.encode(self.encode)
 		return self.page
 
 	def get_searches(self):
 		elements = string.split(self.page, '<tr>')
+		if len(elements) < 2:
+			elements = string.split(self.page, '<TR>')
 
 		if len(elements):
 			for element in elements[1:]:
 				match = self.PATTERN.findall(element)
-				if len(match):
-					tmp  = gutils.clean(match[0][1])
-					self.ids.append(match[0][0])
+				for entry in match:
+					tmp  = gutils.clean(entry[1])
+					self.ids.append(entry[0])
 					self.titles.append(tmp)
+
+#
+# Plugin Test
+#
+class SearchPluginTest(SearchPlugin):
+	#
+	# Configuration for automated tests:
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
+	#
+	test_configuration = {
+		'Rocky Balboa'			: [ 3, 13 ],
+		'Ein gl?ckliches Jahr'	: [ 1, 30 ]
+	}
+
+class PluginTest:
+	#
+	# Configuration for automated tests:
+	# dict { movie_id -> dict { arribute -> value } }
+	#
+	# value: * True/False if attribute only should be tested for any value
+	#        * or the expected value
+	#
+	test_configuration = {
+		'0479143' : { 
+			'title' 			: 'Rocky Balboa',
+			'o_title' 			: 'Rocky Balboa',
+			'director'			: 'Sylvester Stallone',
+			'plot' 				: True,
+			'cast'				: 'Sylvester Stallone' + _(' as ') + 'Rocky Balboa\n\
+Burt Young' + _(' as ') + 'Paulie Panina\n\
+Antonio Tarver' + _(' as ') + 'Mason \'The Line\' Dixon\n\
+Geraldine Hughes' + _(' as ') + 'Marie\n\
+Milo Ventimiglia' + _(' as ') + 'Robert Balboa Jr.\n\
+Tony Burton' + _(' as ') + 'Duke\n\
+A.J. Benza' + _(' as ') + 'L.C.\n\
+James Francis Kelly III' + _(' as ') + 'Steps\n\
+Talia Shire' + _(' as ') + 'Adrian (archive footage)\n\
+Lou DiBella' + _(' as ') + 'Himself\n\
+Mike Tyson' + _(' as ') + 'Himself\n\
+Henry G. Sanders' + _(' as ') + 'Martin\n\
+Pedro Lovell' + _(' as ') + 'Spider Rico\n\
+Ana Gerena' + _(' as ') + 'Isabel\n\
+Angela Boyd' + _(' as ') + 'Angie\n\
+Louis Giansante' + _(' as ') + 'Bar Thug\n\
+Maureen Schilling' + _(' as ') + 'Lucky\'s Bartender\n\
+Lahmard J. Tate' + _(' as ') + 'X-Cell (as Lahmard Tate)\n\
+Woody Paige' + _(' as ') + 'ESPN Commentator (as Woodrow W. Paige)\n\
+Skip Bayless' + _(' as ') + 'ESPN Commentator\n\
+Jay Crawford' + _(' as ') + 'ESPN Commentator\n\
+Brian Kenny' + _(' as ') + 'ESPN Host\n\
+Dana Jacobson' + _(' as ') + 'ESPN Host\n\
+Charles Johnson' + _(' as ') + 'ESPN Host (as Chuck Johnson)\n\
+James Binns' + _(' as ') + 'Commissioner (as James J. Binns)\n\
+Johnnie Hobbs Jr.' + _(' as ') + 'Commissioner\n\
+Barney Fitzpatrick' + _(' as ') + 'Commissioner\n\
+Jim Lampley' + _(' as ') + 'HBO Commentator\n\
+Larry Merchant' + _(' as ') + 'HBO Commentator\n\
+Max Kellerman' + _(' as ') + 'HBO Commentator\n\
+LeRoy Neiman' + _(' as ') + 'Himself\n\
+Bert Randolph Sugar' + _(' as ') + 'Ring Magazine Reporter\n\
+Bernard Fern?ndez' + _(' as ') + 'Boxing Association of America Writer (as Bernard Fernandez)\n\
+Gunnar Peterson' + _(' as ') + 'Weightlifting Trainer\n\
+Yahya' + _(' as ') + 'Dixon\'s Opponent\n\
+Marc Ratner' + _(' as ') + 'Weigh-In Official\n\
+Anthony Lato Jr.' + _(' as ') + 'Rocky\'s Inspector\n\
+Jack Lazzarado' + _(' as ') + 'Dixon\'s Inspector\n\
+Michael Buffer' + _(' as ') + 'Ring Announcer\n\
+Joe Cortez' + _(' as ') + 'Referee\n\
+Carter Mitchell' + _(' as ') + 'Shamrock Foreman\n\
+Vinod Kumar' + _(' as ') + 'Ravi\n\
+Fran Pultro' + _(' as ') + 'Father at Restaurant\n\
+Frank Stallone' + _(' as ') + 'Dinner Patron (as Frank Stallone Jr.)\n\
+Jody Giambelluca' + _(' as ') + 'Dinner Patron\n\
+Tobias Segal' + _(' as ') + 'Robert\'s Friend\n\
+Tim Carr' + _(' as ') + 'Robert\'s Friend\n\
+Matt Frack' + _(' as ') + 'Robert\'s Friend #3\n\
+Paul Dion Monte' + _(' as ') + 'Robert\'s Friend\n\
+Kevin King Templeton' + _(' as ') + 'Robert\'s Friend (as Kevin King-Templeton)\n\
+Robert Michael Kelly' + _(' as ') + 'Mr. Tomilson\n\
+Rick Buchborn' + _(' as ') + 'Rocky Fan\n\
+Nick Baker' + _(' as ') + 'Irish Pub Bartender\n\
+Don Sherman' + _(' as ') + 'Andy\n\
+Stu Nahan' + _(' as ') + 'Computer Fight Commentator (voice)\n\
+Gary Compton' + _(' as ') + 'Security Guard\n\
+?brige Besetzung in alphabetischer Reihenfolge:\n\
+Ricky Cavazos' + _(' as ') + 'Boxing Spectator (uncredited)\n\
+David Kneeream' + _(' as ') + 'Adrian\'s Patron (uncredited)\n\
+Dolph Lundgren' + _(' as ') + 'Captain Ivan Drago (archive footage) (uncredited)\n\
+Burgess Meredith' + _(' as ') + 'Mickey Goldmill (archive footage) (uncredited)\n\
+Keith Moyer' + _(' as ') + 'Bar Patron (uncredited)\n\
+Mr. T' + _(' as ') + 'Clubber Lang (archive footage) (uncredited)',
+			'country'			: 'USA',
+			'genre'				: 'Action | Sport',
+			'classification'	: False,
+			'studio'			: 'Metro-Goldwyn-Mayer (MGM)',
+			'o_site'			: False,
+			'site'				: 'http://german.imdb.com/title/tt0479143',
+			'trailer'			: 'http://german.imdb.com/title/tt0479143/trailers',
+			'year'				: 2006,
+			'notes'				: _('Language') + ': Englisch | Spanisch\n'\
++ _('Audio') + ': DTS | Dolby Digital | SDDS\n'\
++ _('Color') + ': Farbe\n\
+Tagline: It ain\'t over \'til it\'s over.',
+			'runtime'			: 102,
+			'image'				: True,
+			'rating'			: 7
+		},
+		'0069815' : { 
+			'title' 			: 'Gl?ckliches Jahr, Ein',
+			'o_title' 			: 'Bonne ann?e, La',
+			'director'			: 'Claude Lelouch',
+			'plot' 				: True,
+			'cast'				: 'Lino Ventura' + _(' as ') + 'Simon\n\
+Fran?oise Fabian' + _(' as ') + 'Fran?oise\n\
+Charles G?rard' + _(' as ') + 'Charlot\n\
+Andr? Falcon' + _(' as ') + 'Le bijoutier\n\
+Mireille Mathieu' + _(' as ') + 'Herself / Elle-m?me\n\
+Lilo' + _(' as ') + 'Madame F?lix\n\
+Claude Mann' + _(' as ') + 'L\'intellectuel\n\
+Fr?d?ric de Pasquale' + _(' as ') + 'L\'amant parisien\n\
+G?rard Sire' + _(' as ') + 'Le directeur de la prison\n\
+Silvano Tranquilli' + _(' as ') + 'L\'amant italien\n\
+Andr? Barello\n\
+Michel Bertay\n\
+Norman de la Chesnaye\n\
+Pierre Edeline\n\
+Pierre Pontiche\n\
+Michou' + _(' as ') + 'Himself\n\
+Bettina Rheims' + _(' as ') + 'La jeune vendeuse\n\
+Joseph Rythmann\n\
+Georges Staquet\n\
+Jacques Villedieu\n\
+Harry Walter\n\
+?brige Besetzung in alphabetischer Reihenfolge:\n\
+Anouk Aim?e' + _(' as ') + 'Une femme (archive footage) (uncredited)\n\
+Elie Chouraqui' + _(' as ') + '(uncredited)\n\
+R?my Julienne' + _(' as ') + 'Chauffeur de taxi (uncredited)\n\
+Jean-Louis Trintignant' + _(' as ') + 'Un homme (archive footage) (uncredited)',
+			'country'			: 'France | Italy',
+			'genre'				: 'Kom?die',
+			'classification'	: False,
+			'studio'			: 'Les Films 13',
+			'o_site'			: False,
+			'site'				: 'http://german.imdb.com/title/tt0069815',
+			'trailer'			: 'http://german.imdb.com/title/tt0069815/trailers',
+			'year'				: 1973,
+			'notes'				: _('Language') + ': Franz?sisch\n'\
++ _('Audio') + ': Mono\n'\
++ _('Color') + ': Farbe (Eastmancolor)',
+			'runtime'			: 90,
+			'image'				: True,
+			'rating'			: 7
+		},
+	}

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -33,7 +33,7 @@
 plugin_language = _("German")
 plugin_author = "Michael Jahn"
 plugin_author_email = "<mikej06 at hotmail.com>"
-plugin_version = "1.11"
+plugin_version = "1.12"
 
 class Plugin(movie.Movie):
 	url_to_use = "http://www.kino.de/kinofilm/"
@@ -63,7 +63,7 @@
 	def get_image(self):
 		self.image_url = ''
 		tmpdata = self.regextrim(self.tmp_page, '(PRINT[-]CONTENT[-]START|<td class="content">)', '(Dieser Film wurde |>FOTOSHOW<|>KRITIK<)')
-		tmpdatasplit = re.split('src="http://images.kino.de/flbilder', tmpdata)
+		tmpdatasplit = re.split('src="http://.+/flbilder', tmpdata)
 		if len(tmpdatasplit) > 2:
 			tmpdata = gutils.before(tmpdatasplit[2], '.jpg')
 			if tmpdata <> '':
@@ -88,9 +88,9 @@
 			self.title = gutils.after(self.regextrim(self.tmp_page, 'headline2"[^>]*>[ \t\r\n]*<a href="/kinofilm', '</a>'), '>')
 
 	def get_director(self):
-		self.director = gutils.trim(self.tmp_creditspage,"Regie","</a>")
-		self.director = gutils.after(self.director,"/star/")
-		self.director = gutils.after(self.director,">")
+		self.director = self.regextrim(self.tmp_creditspage, '>[ ]*Regie', '</a>')
+		self.director = gutils.after(self.director, '/star/')
+		self.director = gutils.after(self.director, '>')
 
 	def get_plot(self):
 		# little steps to perfect plot (I hope ... it's a terrible structured content ... )
@@ -158,9 +158,9 @@
 		self.classification = self.regextrim(self.tmp_page,'FSK:( |&nbsp;)+', '</strong>')
 
 	def get_studio(self):
-		self.studio = self.regextrim(self.tmp_page, 'Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
+		self.studio = self.regextrim(self.tmp_page, '>[ ]*Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
 		if (self.studio == ""):
-			self.studio = self.regextrim(self.tmp_page, 'Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
+			self.studio = self.regextrim(self.tmp_page, '>[ ]*Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
 
 	def get_o_site(self):
 		self.o_site = ""
@@ -305,12 +305,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -> expected result count }
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 6,
-		'Arahan'				: 6,
-		'Ein gl?ckliches Jahr'	: 3
+		'Rocky Balboa'			: [ 6, 6 ],
+		'Arahan'				: [ 6, 6 ],
+		'Ein gl?ckliches Jahr'	: [ 3, 3 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -158,12 +158,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -> expected result count }
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 1,
-		'Arahan'				: 3,
-		'gl?ckliches'			: 4
+		'Rocky Balboa'			: [ 1, 1 ],
+		'Arahan'				: [ 3, 2 ],
+		'gl?ckliches'			: [ 4, 2 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -33,7 +33,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '<mikej06 at hotmail.com>'
-plugin_version      = '1.0'
+plugin_version      = '1.1'
 
 class Plugin(movie.Movie):
 	index_url = 'http://www.zelluloid.de/filme/index.php3?id='
@@ -105,7 +105,7 @@
 
 	def get_classification(self):
 		self.classification = gutils.trim(self.detail_page, 'FSK: ', '</TD>')
-		self.classification = re.sub(',.*', '', self.classification)
+		self.classification = re.sub('[,<].*', '', self.classification)
 
 	def get_studio(self):
 		self.studio = gutils.strip_tags(gutils.trim(self.detail_page, 'alt="Produktion"', '&nbsp;'))
@@ -177,11 +177,11 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -> expected result count }
+	# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'		: 1,
-		'Die wilden H?hner'	: 3
+		'Rocky Balboa'		: [ 1, 1 ],
+		'Die wilden H?hner'	: [ 3, 3 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/test_movieplugins.py
===================================================================
--- branches/0.9.x/lib/test_movieplugins.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/test_movieplugins.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,12 +31,12 @@
 # dict in both cases.
 #
 # SearchPluginTest.test_configuration:
-# dict { movie_id -> expected result count }
+# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 #
 # PluginTest.test_configuration:
 # dict { movie_id -> dict { arribute -> value } }
 #
-# value: * True/False if attribute should only be tested for any value
+# value: * True/False if attribute should only be tested for any value or nothing
 #        * or the expected value
 #
 
@@ -64,6 +64,7 @@
 	test_plugins = [
 		'PluginMovieAmazon',
 		'PluginMovieFilmeVonAZ',
+		'PluginMovieIMDB-de',
 		'PluginMovieKinoDe',
 		'PluginMovieOFDb',
 		'PluginMovieZelluloid',
@@ -73,10 +74,12 @@
 	# simulates the search for a movie title and compares
 	# the count of results with the expected count
 	#
-	def test_search(self, plugin, title, cnt):
+	def test_search(self, plugin, title, cntOriginal, cntTranslated):
 		global debug, myconfig
+		result = True
 		plugin.debug = debug
 		plugin.config = myconfig
+		# plugin.translated_url_search
 		plugin.url = plugin.translated_url_search
 		if plugin.remove_accents:
 			plugin.title = gutils.remove_accents(title, 'utf-8')
@@ -84,10 +87,21 @@
 			plugin.title = title
 		plugin.search(None)
 		plugin.get_searches()
-		if not len(plugin.ids) - 1 == cnt:	# first entry is always '' (???)
-			print "Title: %s - expected: %d - found: %d" % (title, cnt, len(plugin.ids) - 1)
-			return False
-		return True
+		if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
+			print "Title (Translated): %s - expected: %d - found: %d" % (title, cntOriginal, len(plugin.ids) - 1)
+			result = False
+		# plugin.original_url_search
+		plugin.url = plugin.original_url_search
+		if plugin.remove_accents:
+			plugin.title = gutils.remove_accents(title, 'utf-8')
+		else:
+			plugin.title = title
+		plugin.search(None)
+		plugin.get_searches()
+		if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
+			print "Title (Original): %s - expected: %d - found: %d" % (title, cntTranslated, len(plugin.ids) - 1)
+			result = False
+		return result
 
 	#
 	# check every configured movie title
@@ -105,7 +119,7 @@
 		if not pluginTestConfig == None:
 			for i in pluginTestConfig.test_configuration:
 				searchPlugin = plugin.SearchPlugin()
-				if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i]):
+				if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i][0], pluginTestConfig.test_configuration[i][1]):
 					result = False
 				sleep(1) # needed for amazon
 		
@@ -281,4 +295,8 @@
 #
 # Start the tests
 #
+gtk.gdk.threads_init()
+gtk.gdk.threads_enter()
 PluginTester().do_test()
+#gtk.main()
+gtk.gdk.threads_leave()

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/ChangeLog	2008-10-23 21:00:53 UTC (rev 1013)
@@ -5,6 +5,10 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-23  Michael Jahn
+	* updated IMDB-de, Kino.de, Zelluloid plugin
+	* added original url check within plugin test
+
 2008-10-23  Piotr O?arowski
 	* clean/restore search conditions in advfilter
 

Modified: trunk/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -367,12 +367,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -> expected result count }
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 10,
-        'Arahan'                : 5,
-        'Ein gl?ckliches Jahr'    : 1
+        'Rocky Balboa'            : [ 10, 10 ],
+        'Arahan'                : [ 6, 6 ],
+        'Ein gl?ckliches Jahr'    : [ 1, 1 ]
     }
 
 class PluginTest:
@@ -437,7 +437,6 @@
             'country'            : 'S?dkorea',
             'genre'                : 'Actionkom?die, Abenteuer- & Actionkom?die, Fantasykom?die, Action, Kom?die, Mehr Fantasy, Korea, Action, Kom?die, Fantasy, Unter 10 EUR',
             'classification'    : 'Freigegeben ab 16 Jahren',
-            'studio'            : 'Splendid Entertainment/WVG',
             'o_site'            : False,
             'site'                : 'http://www.amazon.de/dp/B000BSNOD6',
             'trailer'            : False,

Modified: trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -173,12 +173,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -> expected result count }
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 1,
-        'Arahan'                : 1,
-        'Ein gl?ckliches Jahr'    : 0
+        'Rocky Balboa'            : [ 1, 1 ],
+        'Arahan'                : [ 1, 1 ],
+        'Ein gl?ckliches Jahr'    : [ 0, 0 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieIMDB-de.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -32,7 +32,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = 'mikej06 at hotmail.com'
-plugin_version      = '1.2'
+plugin_version      = '1.3'
 
 class Plugin(movie.Movie):
     def __init__(self, id):
@@ -43,6 +43,16 @@
     def initialize(self):
         self.cast_page = self.open_page(url=self.url + '/fullcredits')
         self.plot_page = self.open_page(url=self.url + '/plotsummary')
+        # correction of all &#xxx entities
+        self.page = self.page.decode(self.encode)
+        self.page = gutils.convert_entities(self.page)
+        self.page = self.page.encode(self.encode)
+        self.cast_page = self.cast_page.decode(self.encode)
+        self.cast_page = gutils.convert_entities(self.cast_page)
+        self.cast_page = self.cast_page.encode(self.encode)
+        self.plot_page = self.plot_page.decode(self.encode)
+        self.plot_page = gutils.convert_entities(self.plot_page)
+        self.plot_page = self.plot_page.encode(self.encode)
 
     def get_image(self):
         tmp = string.find(self.page, 'a name="poster"')
@@ -52,10 +62,10 @@
             self.image_url = gutils.trim(self.page[tmp:], 'src="', '"')
 
     def get_o_title(self):
-        self.o_title = gutils.trim(self.page, '<h1>', ' <span')
+        self.o_title = gutils.trim(self.page, '<h1>', '<span')
 
     def get_title(self):
-        self.title = gutils.trim(self.page, '<h1>', ' <span')
+        self.title = gutils.trim(self.page, '<h1>', '<span')
         elements = string.split(gutils.trim(self.page, '<h5>Alternativ:', '</div>'), '<i class="transl"')
         if len(elements) > 1:
             for element in elements:
@@ -70,6 +80,8 @@
             self.director = gutils.trim(self.page,'<h5>Regisseur:</h5>', '</div>')
         self.director = self.__before_more(self.director)
         self.director = self.director.replace('<br/>', ', ')
+        self.director = gutils.clean(self.director)
+        self.director = re.sub(',$', '', self.director)
 
     def get_plot(self):
         self.plot = gutils.trim(self.page, '<h5>Kurzbeschreibung:</h5>', '</div>')
@@ -87,7 +99,7 @@
         self.year = gutils.after(self.year, '">')
 
     def get_runtime(self):
-        self.runtime = gutils.trim(self.page, '<h5>L&auml;nge:</h5>', ' min')
+        self.runtime = self.regextrim(self.page, '<h5>L[^n]+nge:</h5>', ' [Mm]in')
 
     def get_genre(self):
         self.genre = gutils.trim(self.page, '<h5>Genre:</h5>', '</div>')
@@ -98,18 +110,20 @@
         self.cast = gutils.trim(self.cast_page, '<table class="cast">', '</table>')
         if self.cast == '':
             self.cast = gutils.trim(self.page, '<table class="cast">', '</table>')
-        self.cast = string.replace(self.cast, ' ... ', _(' as '))
-        self.cast = string.replace(self.cast, '...', _(' as '))
+        self.cast = string.replace(self.cast, ' ... ', _(' as ').encode('utf8'))
+        self.cast = string.replace(self.cast, '...', _(' as ').encode('utf8'))
         self.cast = string.replace(self.cast, '</tr><tr>', "\n")
         self.cast = string.replace(self.cast, '</tr><tr class="even">', "\n")
         self.cast = string.replace(self.cast, '</tr><tr class="odd">', "\n")
         self.cast = self.__before_more(self.cast)
+        self.cast = re.sub('[ ]+', ' ', self.cast)
 
     def get_classification(self):
         self.classification = gutils.trim(gutils.trim(self.page, 'Altersfreigabe:', '</div>'), 'Germany:', '&')
 
     def get_studio(self):
-        self.studio = gutils.trim(self.page, '<h5>Company:</h5>', '</a>')
+        self.studio = gutils.trim(self.page, '<h5>Firma:</h5>', '</div>')
+        self.studio = self.__before_more(self.studio)
 
     def get_o_site(self):
         self.o_site = ''
@@ -121,10 +135,13 @@
         self.trailer = "http://german.imdb.com/title/tt%s/trailers" % self.movie_id
 
     def get_country(self):
-        self.country = gutils.trim(self.page, '<h5>Produktionsland:</h5>', '</div>')
+        self.country = gutils.trim(self.page, '<h5>Land:</h5>', '</div>')
+        self.country = self.__before_more(self.country)
+        self.country = re.sub('[\n]+', '', self.country)
+        self.country = re.sub('[ ]+', ' ', self.country)
 
     def get_rating(self):
-        self.rating = gutils.trim(self.page, '<b>Nutzer-Bewertung:</b>', '/10')
+        self.rating = gutils.trim(self.page, '<h5>Nutzer-Bewertung:</h5>', '/10')
         if self.rating:
             try:
                 self.rating = str(float(gutils.clean(self.rating)))
@@ -135,48 +152,248 @@
         self.notes = ''
         language = gutils.trim(self.page, '<h5>Sprache:</h5>', '</div>')
         language = gutils.strip_tags(language)
+        language = re.sub('[\n]+', '', language)
+        language = re.sub('[ ]+', ' ', language)
+        language = language.rstrip()
         color = gutils.trim(self.page, '<h5>Farbe:</h5>', '</div>')
         color = gutils.strip_tags(color)
+        color = re.sub('[\n]+', '', color)
+        color = re.sub('[ ]+', ' ', color)
+        color = re.sub('[ ]+$', '', color)
+        color = color.rstrip()
         sound = gutils.trim(self.page, '<h5>Tonverfahren:</h5>', '</div>')
         sound = gutils.strip_tags(sound)
+        sound = re.sub('[\n]+', '', sound)
+        sound = re.sub('[ ]+', ' ', sound)
+        sound = sound.rstrip()
+        soundsplit = sound.split(' | ')
+        if len(soundsplit) > 1:
+            soundsplit.sort()
+            sound = ''
+            for elem in soundsplit:
+                sound += elem + ' | '
+            sound = sound[0:len(sound) - 3]
         tagline = gutils.trim(self.page, '<h5>Werbezeile:</h5>', '</div>')
         tagline = self.__before_more(tagline)
         tagline = gutils.strip_tags(tagline)
+        tagline = re.sub('[\n]+', '', tagline)
+        tagline = re.sub('[ ]+', ' ', tagline)
+        tagline = tagline.rstrip()
         if len(language)>0:
-            self.notes = "%s: %s\n" %(_('Language'), language)
+            self.notes = "%s: %s\n" %(_('Language').encode('utf8'), language)
         if len(sound)>0:
-            self.notes += "%s: %s\n" %(gutils.strip_tags(_('<b>Audio</b>')), sound)
+            self.notes += "%s: %s\n" %(gutils.strip_tags(_('<b>Audio</b>').encode('utf8')), sound)
         if len(color)>0:
-            self.notes += "%s: %s\n" %(_('Color'), color)
+            self.notes += "%s: %s\n" %(_('Color').encode('utf8'), color)
         if len(tagline)>0:
             self.notes += "%s: %s\n" %('Tagline', tagline)
     
     def __before_more(self, data):
-        tmp = string.find(data, '>mehr...<')
+        tmp = string.find(data, '>mehr<')
         if tmp>0:
             data = data[:tmp] + '>'
         return data
 
+    def regextrim(self,text,key1,key2):
+        obj = re.search(key1, text)
+        if obj is None:
+            return ''
+        else:
+            p1 = obj.end()
+        obj = re.search(key2, text[p1:])
+        if obj is None:
+            return ''
+        else:
+            p2 = p1 + obj.start()
+        return text[p1:p2]
+
 class SearchPlugin(movie.SearchMovie):
-    PATTERN = re.compile(r"""<a href=['"]/title/tt([0-9]+)/["']>(.*?)</td>""")
+    PATTERN = re.compile(r"""<a href=['"]/title/tt([0-9]+)/["']>(.*?)(</td>|</A>)""", re.IGNORECASE)
+    PATTERN_POWERSEARCH = re.compile(r"""Here are the [0-9]+ matching titles""")
+
     def __init__(self):
         self.original_url_search    = 'http://german.imdb.com/find?more=tt&q='
-        self.translated_url_search    = 'http://german.imdb.com/find?more=tt&q='
+        self.translated_url_search    = 'http://german.imdb.com/List?words='
         self.encode = 'iso8859-1'
+        self.remove_accents = False
 
     def search(self,parent_window):
         self.open_search(parent_window)
-        self.page = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit');
-        self.page = self.page.decode('iso-8859-1')
+        tmp = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit')
+        if tmp == '':
+            if self.PATTERN_POWERSEARCH.search(self.page) is None:
+                self.page = ''
+        else:
+            self.page = tmp 
+        # correction of all &#xxx entities
+        self.page = self.page.decode(self.encode)
+        self.page = gutils.convert_entities(self.page)
+        self.page = self.page.encode(self.encode)
         return self.page
 
     def get_searches(self):
         elements = string.split(self.page, '<tr>')
+        if len(elements) < 2:
+            elements = string.split(self.page, '<TR>')
 
         if len(elements):
             for element in elements[1:]:
                 match = self.PATTERN.findall(element)
-                if len(match):
-                    tmp  = gutils.clean(match[0][1])
-                    self.ids.append(match[0][0])
+                for entry in match:
+                    tmp  = gutils.clean(entry[1])
+                    self.ids.append(entry[0])
                     self.titles.append(tmp)
+
+#
+# Plugin Test
+#
+class SearchPluginTest(SearchPlugin):
+    #
+    # Configuration for automated tests:
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
+    #
+    test_configuration = {
+        'Rocky Balboa'            : [ 3, 13 ],
+        'Ein gl?ckliches Jahr'    : [ 1, 30 ]
+    }
+
+class PluginTest:
+    #
+    # Configuration for automated tests:
+    # dict { movie_id -> dict { arribute -> value } }
+    #
+    # value: * True/False if attribute only should be tested for any value
+    #        * or the expected value
+    #
+    test_configuration = {
+        '0479143' : { 
+            'title'             : 'Rocky Balboa',
+            'o_title'             : 'Rocky Balboa',
+            'director'            : 'Sylvester Stallone',
+            'plot'                 : True,
+            'cast'                : 'Sylvester Stallone' + _(' as ') + 'Rocky Balboa\n\
+Burt Young' + _(' as ') + 'Paulie Panina\n\
+Antonio Tarver' + _(' as ') + 'Mason \'The Line\' Dixon\n\
+Geraldine Hughes' + _(' as ') + 'Marie\n\
+Milo Ventimiglia' + _(' as ') + 'Robert Balboa Jr.\n\
+Tony Burton' + _(' as ') + 'Duke\n\
+A.J. Benza' + _(' as ') + 'L.C.\n\
+James Francis Kelly III' + _(' as ') + 'Steps\n\
+Talia Shire' + _(' as ') + 'Adrian (archive footage)\n\
+Lou DiBella' + _(' as ') + 'Himself\n\
+Mike Tyson' + _(' as ') + 'Himself\n\
+Henry G. Sanders' + _(' as ') + 'Martin\n\
+Pedro Lovell' + _(' as ') + 'Spider Rico\n\
+Ana Gerena' + _(' as ') + 'Isabel\n\
+Angela Boyd' + _(' as ') + 'Angie\n\
+Louis Giansante' + _(' as ') + 'Bar Thug\n\
+Maureen Schilling' + _(' as ') + 'Lucky\'s Bartender\n\
+Lahmard J. Tate' + _(' as ') + 'X-Cell (as Lahmard Tate)\n\
+Woody Paige' + _(' as ') + 'ESPN Commentator (as Woodrow W. Paige)\n\
+Skip Bayless' + _(' as ') + 'ESPN Commentator\n\
+Jay Crawford' + _(' as ') + 'ESPN Commentator\n\
+Brian Kenny' + _(' as ') + 'ESPN Host\n\
+Dana Jacobson' + _(' as ') + 'ESPN Host\n\
+Charles Johnson' + _(' as ') + 'ESPN Host (as Chuck Johnson)\n\
+James Binns' + _(' as ') + 'Commissioner (as James J. Binns)\n\
+Johnnie Hobbs Jr.' + _(' as ') + 'Commissioner\n\
+Barney Fitzpatrick' + _(' as ') + 'Commissioner\n\
+Jim Lampley' + _(' as ') + 'HBO Commentator\n\
+Larry Merchant' + _(' as ') + 'HBO Commentator\n\
+Max Kellerman' + _(' as ') + 'HBO Commentator\n\
+LeRoy Neiman' + _(' as ') + 'Himself\n\
+Bert Randolph Sugar' + _(' as ') + 'Ring Magazine Reporter\n\
+Bernard Fern?ndez' + _(' as ') + 'Boxing Association of America Writer (as Bernard Fernandez)\n\
+Gunnar Peterson' + _(' as ') + 'Weightlifting Trainer\n\
+Yahya' + _(' as ') + 'Dixon\'s Opponent\n\
+Marc Ratner' + _(' as ') + 'Weigh-In Official\n\
+Anthony Lato Jr.' + _(' as ') + 'Rocky\'s Inspector\n\
+Jack Lazzarado' + _(' as ') + 'Dixon\'s Inspector\n\
+Michael Buffer' + _(' as ') + 'Ring Announcer\n\
+Joe Cortez' + _(' as ') + 'Referee\n\
+Carter Mitchell' + _(' as ') + 'Shamrock Foreman\n\
+Vinod Kumar' + _(' as ') + 'Ravi\n\
+Fran Pultro' + _(' as ') + 'Father at Restaurant\n\
+Frank Stallone' + _(' as ') + 'Dinner Patron (as Frank Stallone Jr.)\n\
+Jody Giambelluca' + _(' as ') + 'Dinner Patron\n\
+Tobias Segal' + _(' as ') + 'Robert\'s Friend\n\
+Tim Carr' + _(' as ') + 'Robert\'s Friend\n\
+Matt Frack' + _(' as ') + 'Robert\'s Friend #3\n\
+Paul Dion Monte' + _(' as ') + 'Robert\'s Friend\n\
+Kevin King Templeton' + _(' as ') + 'Robert\'s Friend (as Kevin King-Templeton)\n\
+Robert Michael Kelly' + _(' as ') + 'Mr. Tomilson\n\
+Rick Buchborn' + _(' as ') + 'Rocky Fan\n\
+Nick Baker' + _(' as ') + 'Irish Pub Bartender\n\
+Don Sherman' + _(' as ') + 'Andy\n\
+Stu Nahan' + _(' as ') + 'Computer Fight Commentator (voice)\n\
+Gary Compton' + _(' as ') + 'Security Guard\n\
+?brige Besetzung in alphabetischer Reihenfolge:\n\
+Ricky Cavazos' + _(' as ') + 'Boxing Spectator (uncredited)\n\
+David Kneeream' + _(' as ') + 'Adrian\'s Patron (uncredited)\n\
+Dolph Lundgren' + _(' as ') + 'Captain Ivan Drago (archive footage) (uncredited)\n\
+Burgess Meredith' + _(' as ') + 'Mickey Goldmill (archive footage) (uncredited)\n\
+Keith Moyer' + _(' as ') + 'Bar Patron (uncredited)\n\
+Mr. T' + _(' as ') + 'Clubber Lang (archive footage) (uncredited)',
+            'country'            : 'USA',
+            'genre'                : 'Action | Sport',
+            'classification'    : False,
+            'studio'            : 'Metro-Goldwyn-Mayer (MGM)',
+            'o_site'            : False,
+            'site'                : 'http://german.imdb.com/title/tt0479143',
+            'trailer'            : 'http://german.imdb.com/title/tt0479143/trailers',
+            'year'                : 2006,
+            'notes'                : _('Language') + ': Englisch | Spanisch\n'\
++ _('Audio') + ': DTS | Dolby Digital | SDDS\n'\
++ _('Color') + ': Farbe\n\
+Tagline: It ain\'t over \'til it\'s over.',
+            'runtime'            : 102,
+            'image'                : True,
+            'rating'            : 7
+        },
+        '0069815' : { 
+            'title'             : 'Gl?ckliches Jahr, Ein',
+            'o_title'             : 'Bonne ann?e, La',
+            'director'            : 'Claude Lelouch',
+            'plot'                 : True,
+            'cast'                : 'Lino Ventura' + _(' as ') + 'Simon\n\
+Fran?oise Fabian' + _(' as ') + 'Fran?oise\n\
+Charles G?rard' + _(' as ') + 'Charlot\n\
+Andr? Falcon' + _(' as ') + 'Le bijoutier\n\
+Mireille Mathieu' + _(' as ') + 'Herself / Elle-m?me\n\
+Lilo' + _(' as ') + 'Madame F?lix\n\
+Claude Mann' + _(' as ') + 'L\'intellectuel\n\
+Fr?d?ric de Pasquale' + _(' as ') + 'L\'amant parisien\n\
+G?rard Sire' + _(' as ') + 'Le directeur de la prison\n\
+Silvano Tranquilli' + _(' as ') + 'L\'amant italien\n\
+Andr? Barello\n\
+Michel Bertay\n\
+Norman de la Chesnaye\n\
+Pierre Edeline\n\
+Pierre Pontiche\n\
+Michou' + _(' as ') + 'Himself\n\
+Bettina Rheims' + _(' as ') + 'La jeune vendeuse\n\
+Joseph Rythmann\n\
+Georges Staquet\n\
+Jacques Villedieu\n\
+Harry Walter\n\
+?brige Besetzung in alphabetischer Reihenfolge:\n\
+Anouk Aim?e' + _(' as ') + 'Une femme (archive footage) (uncredited)\n\
+Elie Chouraqui' + _(' as ') + '(uncredited)\n\
+R?my Julienne' + _(' as ') + 'Chauffeur de taxi (uncredited)\n\
+Jean-Louis Trintignant' + _(' as ') + 'Un homme (archive footage) (uncredited)',
+            'country'            : 'France | Italy',
+            'genre'                : 'Kom?die',
+            'classification'    : False,
+            'studio'            : 'Les Films 13',
+            'o_site'            : False,
+            'site'                : 'http://german.imdb.com/title/tt0069815',
+            'trailer'            : 'http://german.imdb.com/title/tt0069815/trailers',
+            'year'                : 1973,
+            'notes'                : _('Language') + ': Franz?sisch\n'\
++ _('Audio') + ': Mono\n'\
++ _('Color') + ': Farbe (Eastmancolor)',
+            'runtime'            : 90,
+            'image'                : True,
+            'rating'            : 7
+        },
+    }

Modified: trunk/lib/plugins/movie/PluginMovieKinoDe.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -34,7 +34,7 @@
 plugin_language = _("German")
 plugin_author = "Michael Jahn"
 plugin_author_email = "<mikej06 at hotmail.com>"
-plugin_version = "1.11"
+plugin_version = "1.12"
 
 class Plugin(movie.Movie):
     url_to_use = "http://www.kino.de/kinofilm/"
@@ -64,7 +64,7 @@
     def get_image(self):
         self.image_url = ''
         tmpdata = self.regextrim(self.tmp_page, '(PRINT[-]CONTENT[-]START|<td class="content">)', '(Dieser Film wurde |>FOTOSHOW<|>KRITIK<)')
-        tmpdatasplit = re.split('src="http://images.kino.de/flbilder', tmpdata)
+        tmpdatasplit = re.split('src="http://.+/flbilder', tmpdata)
         if len(tmpdatasplit) > 2:
             tmpdata = gutils.before(tmpdatasplit[2], '.jpg')
             if tmpdata <> '':
@@ -89,9 +89,9 @@
             self.title = gutils.after(self.regextrim(self.tmp_page, 'headline2"[^>]*>[ \t\r\n]*<a href="/kinofilm', '</a>'), '>')
 
     def get_director(self):
-        self.director = gutils.trim(self.tmp_creditspage,"Regie","</a>")
-        self.director = gutils.after(self.director,"/star/")
-        self.director = gutils.after(self.director,">")
+        self.director = self.regextrim(self.tmp_creditspage, '>[ ]*Regie', '</a>')
+        self.director = gutils.after(self.director, '/star/')
+        self.director = gutils.after(self.director, '>')
 
     def get_plot(self):
         # little steps to perfect plot (I hope ... it's a terrible structured content ... )
@@ -159,9 +159,9 @@
         self.classification = self.regextrim(self.tmp_page,'FSK:( |&nbsp;)+', '</strong>')
 
     def get_studio(self):
-        self.studio = self.regextrim(self.tmp_page, 'Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
+        self.studio = self.regextrim(self.tmp_page, '>[ ]*Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
         if (self.studio == ""):
-            self.studio = self.regextrim(self.tmp_page, 'Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
+            self.studio = self.regextrim(self.tmp_page, '>[ ]*Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*</strong>')
 
     def get_o_site(self):
         self.o_site = ""
@@ -306,12 +306,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -> expected result count }
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 6,
-        'Arahan'                : 6,
-        'Ein gl?ckliches Jahr'    : 3
+        'Rocky Balboa'            : [ 6, 6 ],
+        'Arahan'                : [ 6, 6 ],
+        'Ein gl?ckliches Jahr'    : [ 3, 3 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieOFDb.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -159,12 +159,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -> expected result count }
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'          : 1,
-        'Arahan'                : 3,
-        'gl?ckliches'          : 4
+        'Rocky Balboa'            : [ 1, 1 ],
+        'Arahan'                : [ 3, 2 ],
+        'gl?ckliches'            : [ 4, 2 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieZelluloid.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -34,7 +34,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '<mikej06 at hotmail.com>'
-plugin_version      = '1.0'
+plugin_version      = '1.1'
 
 class Plugin(movie.Movie):
     index_url = 'http://www.zelluloid.de/filme/index.php3?id='
@@ -106,7 +106,7 @@
 
     def get_classification(self):
         self.classification = gutils.trim(self.detail_page, 'FSK: ', '</TD>')
-        self.classification = re.sub(',.*', '', self.classification)
+        self.classification = re.sub('[,<].*', '', self.classification)
 
     def get_studio(self):
         self.studio = gutils.strip_tags(gutils.trim(self.detail_page, 'alt="Produktion"', '&nbsp;'))
@@ -178,11 +178,11 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -> expected result count }
+    # dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'        : 1,
-        'Die wilden H?hner'    : 3
+        'Rocky Balboa'        : [ 1, 1 ],
+        'Die wilden H?hner'    : [ 3, 3 ]
     }
 
 class PluginTest:

Modified: trunk/lib/test_movieplugins.py
===================================================================
--- trunk/lib/test_movieplugins.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/test_movieplugins.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,12 +31,12 @@
 # dict in both cases.
 #
 # SearchPluginTest.test_configuration:
-# dict { movie_id -> expected result count }
+# dict { movie_id -> [ expected result count for original url, expected result count for translated url ] }
 #
 # PluginTest.test_configuration:
 # dict { movie_id -> dict { arribute -> value } }
 #
-# value: * True/False if attribute should only be tested for any value
+# value: * True/False if attribute should only be tested for any value or nothing
 #        * or the expected value
 #
 
@@ -63,6 +63,7 @@
     test_plugins = [
         'PluginMovieAmazon',
         'PluginMovieFilmeVonAZ',
+        'PluginMovieIMDB-de',
         'PluginMovieKinoDe',
         'PluginMovieOFDb',
         'PluginMovieZelluloid',
@@ -72,9 +73,11 @@
     # simulates the search for a movie title and compares
     # the count of results with the expected count
     #
-    def test_search(self, plugin, title, cnt):
+    def test_search(self, plugin, title, cntOriginal, cntTranslated):
         global myconfig
+        result = True
         plugin.config = myconfig
+        # plugin.translated_url_search
         plugin.url = plugin.translated_url_search
         if plugin.remove_accents:
             plugin.title = gutils.remove_accents(title, 'utf-8')
@@ -82,10 +85,21 @@
             plugin.title = title
         plugin.search(None)
         plugin.get_searches()
-        if not len(plugin.ids) - 1 == cnt:    # first entry is always '' (???)
-            print "Title: %s - expected: %d - found: %d" % (title, cnt, len(plugin.ids) - 1)
-            return False
-        return True
+        if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
+            print "Title (Translated): %s - expected: %d - found: %d" % (title, cntOriginal, len(plugin.ids) - 1)
+            result = False
+        # plugin.original_url_search
+        plugin.url = plugin.original_url_search
+        if plugin.remove_accents:
+            plugin.title = gutils.remove_accents(title, 'utf-8')
+        else:
+            plugin.title = title
+        plugin.search(None)
+        plugin.get_searches()
+        if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
+            print "Title (Original): %s - expected: %d - found: %d" % (title, cntTranslated, len(plugin.ids) - 1)
+            result = False
+        return result
 
     #
     # check every configured movie title
@@ -103,7 +117,7 @@
         if not pluginTestConfig == None:
             for i in pluginTestConfig.test_configuration:
                 searchPlugin = plugin.SearchPlugin()
-                if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i]):
+                if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i][0], pluginTestConfig.test_configuration[i][1]):
                     result = False
                 sleep(1) # needed for amazon
         
@@ -276,4 +290,8 @@
 #
 # Start the tests
 #
+gtk.gdk.threads_init()
+gtk.gdk.threads_enter()
 PluginTester().do_test()
+#gtk.main()
+gtk.gdk.threads_leave()



From piotrek at mail.berlios.de  Sat Oct 25 19:41:54 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sat, 25 Oct 2008 19:41:54 +0200
Subject: [Griffith-svn] r1014 - in trunk: . glade lib lib/plugins/export
	lib/plugins/imp
Message-ID: <200810251741.m9PHfsxr006409@sheep.berlios.de>

Author: piotrek
Date: 2008-10-25 19:41:50 +0200 (Sat, 25 Oct 2008)
New Revision: 1014

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/griffith
   trunk/lib/advfilter.py
   trunk/lib/db.py
   trunk/lib/dbupgrade.py
   trunk/lib/gutils.py
   trunk/lib/plugins/export/PluginExportCSV.py
   trunk/lib/plugins/export/PluginExportHTML.py
   trunk/lib/plugins/export/PluginExportPDF.py
   trunk/lib/plugins/export/PluginExportXML.py
   trunk/lib/plugins/export/PluginExportiPod.py
   trunk/lib/plugins/imp/CSV.py
   trunk/lib/plugins/imp/__init__.py
   trunk/lib/sql.py
   trunk/lib/widgets.py
Log:
* add load/save search conditions
  + filter table added to DB
* remove "self" from gutils.info's parameters


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/ChangeLog	2008-10-25 17:41:50 UTC (rev 1014)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-25  Piotr O?arowski
+	* add load/save search conditions
+
 2008-10-23  Michael Jahn
 	* updated IMDB-de, Kino.de, Zelluloid plugin
 	* added original url check within plugin test

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/glade/griffith.glade	2008-10-25 17:41:50 UTC (rev 1014)
@@ -625,7 +625,7 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkToolButton" id="toolbutton11">
+                      <widget class="GtkToolButton" id="t_search_movies">
                         <property name="visible">True</property>
                         <property name="tooltip" translatable="yes">Open search window</property>
                         <property name="stock_id">gtk-find</property>
@@ -975,11 +975,11 @@
                             <property name="column_spacing">5</property>
                             <property name="row_spacing">2</property>
                             <child>
-                              <widget class="GtkLabel" id="m_ratio">
+                              <widget class="GtkLabel" id="m_vcodec">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">16:9</property>
+                                <property name="label">video codec</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -987,54 +987,51 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label19">
+                              <widget class="GtkLabel" id="label196">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Video codec</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label17">
+                              <widget class="GtkLabel" id="label278">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Aspect ratio</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">9</property>
-                                <property name="bottom_attach">10</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_cameraman">
+                              <widget class="GtkLabel" id="label277">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">cameraman</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">3</property>
                                 <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1042,18 +1039,15 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_screenplay">
+                              <widget class="GtkLabel" id="label274">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">screenplay</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1061,115 +1055,116 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="Color2">
+                              <widget class="GtkLabel" id="label237">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Cameraman</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="Color1">
+                              <widget class="GtkLabel" id="label284">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Screenplay</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label27">
+                              <widget class="GtkLabel" id="label285">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Country</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">6</property>
+                                <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_genre">
+                              <widget class="GtkLabel" id="label286">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">genre</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label29">
+                              <widget class="GtkLabel" id="label287">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">8</property>
+                                <property name="bottom_attach">9</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_studio">
+                              <widget class="GtkLabel" id="label22">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">studio</property>
-                                <property name="wrap">True</property>
-                                <property name="selectable">True</property>
-                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                                <property name="label" translatable="yes">Director</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label34">
+                              <widget class="GtkLabel" id="label290">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Studio</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_classification">
+                              <widget class="GtkLabel" id="m_country">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">classification</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">country</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1177,31 +1172,18 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">6</property>
-                                <property name="bottom_attach">7</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label33">
+                              <widget class="GtkLabel" id="m_director">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Classification</property>
-                              </widget>
-                              <packing>
-                                <property name="top_attach">6</property>
-                                <property name="bottom_attach">7</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="m_color">
-                                <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">color</property>
+                                <property name="label">director</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1209,9 +1191,6 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -1229,11 +1208,11 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_director">
+                              <widget class="GtkLabel" id="m_color">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">director</property>
+                                <property name="label">color</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1241,15 +1220,32 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">7</property>
+                                <property name="bottom_attach">8</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_country">
+                              <widget class="GtkLabel" id="label33">
                                 <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Classification</property>
+                              </widget>
+                              <packing>
+                                <property name="top_attach">6</property>
+                                <property name="bottom_attach">7</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="m_classification">
+                                <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">country</property>
+                                <property name="label" translatable="yes">classification</property>
+                                <property name="use_markup">True</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1257,127 +1253,128 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">6</property>
+                                <property name="bottom_attach">7</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label290">
+                              <widget class="GtkLabel" id="label34">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Studio</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label22">
+                              <widget class="GtkLabel" id="m_studio">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label">studio</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label287">
+                              <widget class="GtkLabel" id="label29">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Genre</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label286">
+                              <widget class="GtkLabel" id="m_genre">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">genre</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">7</property>
-                                <property name="bottom_attach">8</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label285">
+                              <widget class="GtkLabel" id="label27">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Country</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">6</property>
-                                <property name="bottom_attach">7</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label284">
+                              <widget class="GtkLabel" id="Color1">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Screenplay</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label237">
+                              <widget class="GtkLabel" id="Color2">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Cameraman</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label274">
+                              <widget class="GtkLabel" id="m_screenplay">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">screenplay</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1385,15 +1382,18 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label277">
+                              <widget class="GtkLabel" id="m_cameraman">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label">cameraman</property>
+                                <property name="wrap">True</property>
+                                <property name="selectable">True</property>
+                                <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
                                 <property name="top_attach">3</property>
                                 <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -1401,40 +1401,40 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label278">
+                              <widget class="GtkLabel" id="label17">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                                <property name="use_markup">True</property>
+                                <property name="label" translatable="yes">Aspect ratio</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label196">
+                              <widget class="GtkLabel" id="label19">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Video codec</property>
+                                <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                                <property name="use_markup">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="m_vcodec">
+                              <widget class="GtkLabel" id="m_ratio">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label">video codec</property>
+                                <property name="label">16:9</property>
                                 <property name="wrap">True</property>
                                 <property name="selectable">True</property>
                                 <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -1442,8 +1442,8 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">8</property>
-                                <property name="bottom_attach">9</property>
+                                <property name="top_attach">9</property>
+                                <property name="bottom_attach">10</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -2226,45 +2226,50 @@
                         <property name="column_spacing">5</property>
                         <property name="row_spacing">2</property>
                         <child>
-                          <widget class="GtkLabel" id="label48">
+                          <widget class="GtkLabel" id="m_condition">
                             <property name="visible">True</property>
+                            <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
+                            <property name="label">condition</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label14">
+                          <widget class="GtkLabel" id="label110">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
+                            <property name="label" translatable="yes">Condition</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label13">
+                          <widget class="GtkLabel" id="m_layers">
                             <property name="visible">True</property>
+                            <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
+                            <property name="label">layers</property>
+                            <property name="wrap">True</property>
+                            <property name="selectable">True</property>
+                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
+                            <property name="left_attach">2</property>
+                            <property name="right_attach">3</property>
                             <property name="top_attach">2</property>
                             <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
@@ -2272,27 +2277,24 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label8">
+                          <widget class="GtkLabel" id="label109">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
+                            <property name="label" translatable="yes">DVD layers</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="m_medium">
+                          <widget class="GtkLabel" id="m_region">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">2 x medium</property>
+                            <property name="label">region</property>
                             <property name="wrap">True</property>
                             <property name="selectable">True</property>
                             <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -2300,39 +2302,42 @@
                           <packing>
                             <property name="left_attach">2</property>
                             <property name="right_attach">3</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label38">
+                          <widget class="GtkLabel" id="label108">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Medium</property>
+                            <property name="label" translatable="yes">DVD region</property>
                           </widget>
                           <packing>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label108">
+                          <widget class="GtkLabel" id="label38">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">DVD region</property>
+                            <property name="label" translatable="yes">Medium</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="m_region">
+                          <widget class="GtkLabel" id="m_medium">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">region</property>
+                            <property name="label">2 x medium</property>
                             <property name="wrap">True</property>
                             <property name="selectable">True</property>
                             <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
@@ -2340,38 +2345,35 @@
                           <packing>
                             <property name="left_attach">2</property>
                             <property name="right_attach">3</property>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
-                            <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label109">
+                          <widget class="GtkLabel" id="label8">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">DVD layers</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="m_layers">
+                          <widget class="GtkLabel" id="label13">
                             <property name="visible">True</property>
-                            <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">layers</property>
-                            <property name="wrap">True</property>
-                            <property name="selectable">True</property>
-                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">2</property>
-                            <property name="right_attach">3</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
                             <property name="top_attach">2</property>
                             <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
@@ -2379,33 +2381,31 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label110">
+                          <widget class="GtkLabel" id="label14">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Condition</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="m_condition">
+                          <widget class="GtkLabel" id="label48">
                             <property name="visible">True</property>
-                            <property name="can_focus">True</property>
                             <property name="xalign">0</property>
-                            <property name="label">condition</property>
-                            <property name="wrap">True</property>
-                            <property name="selectable">True</property>
-                            <property name="ellipsize">PANGO_ELLIPSIZE_END</property>
+                            <property name="label">&lt;b&gt;:&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">2</property>
-                            <property name="right_attach">3</property>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
@@ -2779,52 +2779,46 @@
                               <placeholder/>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_rating">
+                              <widget class="GtkCheckButton" id="view_image">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Rating</property>
+                                <property name="label" translatable="yes">Image</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
+                                <signal name="clicked" handler="on_view_image_clicked"/>
                               </widget>
                               <packing>
-                                <property name="left_attach">4</property>
-                                <property name="right_attach">5</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_runtime">
+                              <widget class="GtkCheckButton" id="view_number">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Runtime</property>
+                                <property name="label" translatable="yes">Number</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">4</property>
-                                <property name="right_attach">5</property>
-                                <property name="top_attach">1</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_year">
+                              <widget class="GtkCheckButton" id="view_otitle">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Year</property>
+                                <property name="label" translatable="yes">Original Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">3</property>
-                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
                                 <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -2832,27 +2826,28 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_seen">
+                              <widget class="GtkCheckButton" id="view_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Seen it</property>
+                                <property name="label" translatable="yes">Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">3</property>
-                                <property name="right_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_genre">
+                              <widget class="GtkCheckButton" id="view_director">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label" translatable="yes">Director</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -2860,15 +2855,17 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_director">
+                              <widget class="GtkCheckButton" id="view_genre">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label" translatable="yes">Genre</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -2876,40 +2873,39 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_title">
+                              <widget class="GtkCheckButton" id="view_seen">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Title</property>
+                                <property name="label" translatable="yes">Seen it</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">3</property>
+                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_otitle">
+                              <widget class="GtkCheckButton" id="view_year">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Original Title</property>
+                                <property name="label" translatable="yes">Year</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">3</property>
+                                <property name="right_attach">4</property>
                                 <property name="top_attach">1</property>
                                 <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
@@ -2917,32 +2913,36 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_number">
+                              <widget class="GtkCheckButton" id="view_runtime">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Number</property>
+                                <property name="label" translatable="yes">Runtime</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="left_attach">4</property>
+                                <property name="right_attach">5</property>
+                                <property name="top_attach">1</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="view_image">
+                              <widget class="GtkCheckButton" id="view_rating">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Image</property>
+                                <property name="label" translatable="yes">Rating</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
-                                <signal name="clicked" handler="on_view_image_clicked"/>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="left_attach">4</property>
+                                <property name="right_attach">5</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -3037,70 +3037,76 @@
                             <property name="n_rows">6</property>
                             <property name="n_columns">2</property>
                             <child>
-                              <widget class="GtkComboBox" id="p_vcodec">
+                              <widget class="GtkLabel" id="label141">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Media</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label219">
+                              <widget class="GtkLabel" id="label142">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Video codec</property>
+                                <property name="label" translatable="yes">Condition</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_region">
+                              <widget class="GtkLabel" id="label143">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Region</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_color">
+                              <widget class="GtkLabel" id="label144">
                                 <property name="visible">True</property>
-                                <property name="items"></property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Layers</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkLabel" id="label145">
+                                <property name="visible">True</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Color</property>
+                              </widget>
+                              <packing>
                                 <property name="top_attach">4</property>
                                 <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
+                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_layers">
+                              <widget class="GtkComboBox" id="p_media">
                                 <property name="visible">True</property>
                                 <property name="items"></property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options">GTK_FILL</property>
                               </packing>
@@ -3120,78 +3126,72 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkComboBox" id="p_media">
+                              <widget class="GtkComboBox" id="p_layers">
                                 <property name="visible">True</property>
                                 <property name="items"></property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label145">
+                              <widget class="GtkComboBox" id="p_color">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Color</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">4</property>
                                 <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label144">
+                              <widget class="GtkComboBox" id="p_region">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Layers</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label143">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Region</property>
-                              </widget>
-                              <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
                                 <property name="top_attach">2</property>
                                 <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label142">
+                              <widget class="GtkLabel" id="label219">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Condition</property>
+                                <property name="label" translatable="yes">Video codec</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label141">
+                              <widget class="GtkComboBox" id="p_vcodec">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Media</property>
+                                <property name="items"></property>
                               </widget>
                               <packing>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
                                 <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                           </widget>
@@ -3280,26 +3280,23 @@
                               <placeholder/>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_cast">
+                              <widget class="GtkCheckButton" id="p_s_classification">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Cast</property>
+                                <property name="label" translatable="yes">Classification</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_year">
+                              <widget class="GtkCheckButton" id="p_s_country">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Year</property>
+                                <property name="label" translatable="yes">Country</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3307,17 +3304,14 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">5</property>
-                                <property name="bottom_attach">6</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_site">
+                              <widget class="GtkCheckButton" id="p_s_director">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Site</property>
+                                <property name="label" translatable="yes">Director</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3325,69 +3319,66 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_runtime">
+                              <widget class="GtkCheckButton" id="p_s_trailer">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Runtime</property>
+                                <property name="label" translatable="yes">Trailer</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_rating">
+                              <widget class="GtkCheckButton" id="p_s_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Rating</property>
+                                <property name="label" translatable="yes">Title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_plot">
+                              <widget class="GtkCheckButton" id="p_s_studio">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Plot</property>
+                                <property name="label" translatable="yes">Studio</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">4</property>
+                                <property name="bottom_attach">5</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_o_title">
+                              <widget class="GtkCheckButton" id="p_s_image">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Original title</property>
+                                <property name="label" translatable="yes">Image</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3395,24 +3386,24 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_o_site">
+                              <widget class="GtkCheckButton" id="p_s_genre">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Official site</property>
+                                <property name="label" translatable="yes">Genre</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
@@ -3436,26 +3427,26 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_genre">
+                              <widget class="GtkCheckButton" id="p_s_o_site">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Genre</property>
+                                <property name="label" translatable="yes">Official site</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_image">
+                              <widget class="GtkCheckButton" id="p_s_o_title">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Image</property>
+                                <property name="label" translatable="yes">Original title</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3463,69 +3454,69 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_studio">
+                              <widget class="GtkCheckButton" id="p_s_plot">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Studio</property>
+                                <property name="label" translatable="yes">Plot</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">2</property>
+                                <property name="right_attach">3</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_title">
+                              <widget class="GtkCheckButton" id="p_s_rating">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Title</property>
+                                <property name="label" translatable="yes">Rating</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_trailer">
+                              <widget class="GtkCheckButton" id="p_s_runtime">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Trailer</property>
+                                <property name="label" translatable="yes">Runtime</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
-                                <property name="left_attach">2</property>
-                                <property name="right_attach">3</property>
-                                <property name="top_attach">4</property>
-                                <property name="bottom_attach">5</property>
+                                <property name="left_attach">1</property>
+                                <property name="right_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_director">
+                              <widget class="GtkCheckButton" id="p_s_site">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Director</property>
+                                <property name="label" translatable="yes">Site</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3533,14 +3524,17 @@
                               <packing>
                                 <property name="left_attach">2</property>
                                 <property name="right_attach">3</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_country">
+                              <widget class="GtkCheckButton" id="p_s_year">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Country</property>
+                                <property name="label" translatable="yes">Year</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
@@ -3548,19 +3542,25 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkCheckButton" id="p_s_classification">
+                              <widget class="GtkCheckButton" id="p_s_cast">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="label" translatable="yes">Classification</property>
+                                <property name="label" translatable="yes">Cast</property>
                                 <property name="use_underline">True</property>
                                 <property name="response_id">0</property>
                                 <property name="draw_indicator">True</property>
                               </widget>
                               <packing>
+                                <property name="top_attach">5</property>
+                                <property name="bottom_attach">6</property>
+                                <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -3620,65 +3620,71 @@
                           <placeholder/>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_smtp_port">
+                          <widget class="GtkLabel" id="label123">
                             <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">SMTP server</property>
+                          </widget>
+                          <packing>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkEntry" id="mail_smtp_server">
+                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
-                            <property name="text">25</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label307">
+                          <widget class="GtkLabel" id="label124">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">SMTP port</property>
+                            <property name="label" translatable="yes">Password</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkCheckButton" id="mail_use_tls">
+                          <widget class="GtkEntry" id="mail_password">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="use_underline">True</property>
-                            <property name="response_id">0</property>
-                            <property name="draw_indicator">True</property>
+                            <property name="visibility">False</property>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
+                            <property name="top_attach">3</property>
+                            <property name="bottom_attach">4</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label306">
+                          <widget class="GtkLabel" id="label122">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Use TLS?</property>
+                            <property name="label" translatable="yes">Username</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_email">
+                          <widget class="GtkEntry" id="mail_username">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
@@ -3686,25 +3692,12 @@
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label125">
-                            <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Sender E-mail address</property>
-                          </widget>
-                          <packing>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
-                          </packing>
-                        </child>
-                        <child>
                           <widget class="GtkCheckButton" id="mail_use_auth">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
@@ -3723,83 +3716,90 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_username">
+                          <widget class="GtkLabel" id="label125">
                             <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Sender E-mail address</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkEntry" id="mail_email">
+                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label122">
+                          <widget class="GtkLabel" id="label306">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Username</property>
+                            <property name="label" translatable="yes">Use TLS?</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_password">
+                          <widget class="GtkCheckButton" id="mail_use_tls">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="visibility">False</property>
-                            <property name="invisible_char">*</property>
+                            <property name="use_underline">True</property>
+                            <property name="response_id">0</property>
+                            <property name="draw_indicator">True</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label124">
+                          <widget class="GtkLabel" id="label307">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Password</property>
+                            <property name="label" translatable="yes">SMTP port</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">3</property>
-                            <property name="bottom_attach">4</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="x_options">GTK_FILL</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="mail_smtp_server">
+                          <widget class="GtkEntry" id="mail_smtp_port">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
                             <property name="invisible_char">*</property>
+                            <property name="text">25</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
-                        <child>
-                          <widget class="GtkLabel" id="label123">
-                            <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">SMTP server</property>
-                          </widget>
-                          <packing>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
-                          </packing>
-                        </child>
                       </widget>
                     </child>
                   </widget>
@@ -5252,35 +5252,73 @@
                             <property name="column_spacing">4</property>
                             <property name="row_spacing">2</property>
                             <child>
-                              <widget class="GtkEntry" id="p_db_passwd">
+                              <widget class="GtkLabel" id="label190">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="visibility">False</property>
-                                <property name="invisible_char">*</property>
+                                <property name="xalign">0</property>
+                                <property name="label" translatable="yes">Host</property>
                               </widget>
                               <packing>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options"></property>
+                              </packing>
+                            </child>
+                            <child>
+                              <widget class="GtkHBox" id="hbox99">
+                                <property name="visible">True</property>
+                                <child>
+                                  <widget class="GtkEntry" id="p_db_host">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="invisible_char">*</property>
+                                  </widget>
+                                </child>
+                                <child>
+                                  <widget class="GtkLabel" id="label191">
+                                    <property name="visible">True</property>
+                                    <property name="xalign">0</property>
+                                    <property name="label" translatable="yes">Port</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="expand">False</property>
+                                    <property name="fill">False</property>
+                                    <property name="padding">4</property>
+                                    <property name="position">1</property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkSpinButton" id="p_db_port">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="adjustment">0 0 65536 1 10 10</property>
+                                    <property name="climb_rate">1</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="position">2</property>
+                                  </packing>
+                                </child>
+                              </widget>
+                              <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="y_options"></property>
+                                <property name="x_options">GTK_FILL</property>
+                                <property name="y_options">GTK_FILL</property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label193">
+                              <widget class="GtkLabel" id="label194">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Password</property>
+                                <property name="label" translatable="yes">Database</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkEntry" id="p_db_user">
+                              <widget class="GtkEntry" id="p_db_name">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="invisible_char">*</property>
@@ -5288,8 +5326,8 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
+                                <property name="top_attach">1</property>
+                                <property name="bottom_attach">2</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -5307,7 +5345,7 @@
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkEntry" id="p_db_name">
+                              <widget class="GtkEntry" id="p_db_user">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
                                 <property name="invisible_char">*</property>
@@ -5315,74 +5353,36 @@
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">2</property>
+                                <property name="bottom_attach">3</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkLabel" id="label194">
+                              <widget class="GtkLabel" id="label193">
                                 <property name="visible">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Database</property>
+                                <property name="label" translatable="yes">Password</property>
                               </widget>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="x_options">GTK_FILL</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <widget class="GtkHBox" id="hbox99">
+                              <widget class="GtkEntry" id="p_db_passwd">
                                 <property name="visible">True</property>
-                                <child>
-                                  <widget class="GtkEntry" id="p_db_host">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="invisible_char">*</property>
-                                  </widget>
-                                </child>
-                                <child>
-                                  <widget class="GtkLabel" id="label191">
-                                    <property name="visible">True</property>
-                                    <property name="xalign">0</property>
-                                    <property name="label" translatable="yes">Port</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="expand">False</property>
-                                    <property name="fill">False</property>
-                                    <property name="padding">4</property>
-                                    <property name="position">1</property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkSpinButton" id="p_db_port">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="adjustment">0 0 65536 1 10 10</property>
-                                    <property name="climb_rate">1</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="position">2</property>
-                                  </packing>
-                                </child>
+                                <property name="can_focus">True</property>
+                                <property name="visibility">False</property>
+                                <property name="invisible_char">*</property>
                               </widget>
                               <packing>
                                 <property name="left_attach">1</property>
                                 <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options">GTK_FILL</property>
-                              </packing>
-                            </child>
-                            <child>
-                              <widget class="GtkLabel" id="label190">
-                                <property name="visible">True</property>
-                                <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Host</property>
-                              </widget>
-                              <packing>
-                                <property name="x_options">GTK_FILL</property>
+                                <property name="top_attach">3</property>
+                                <property name="bottom_attach">4</property>
                                 <property name="y_options"></property>
                               </packing>
                             </child>
@@ -5816,72 +5816,57 @@
                           <placeholder/>
                         </child>
                         <child>
-                          <widget class="GtkHSeparator" id="hseparator12">
+                          <widget class="GtkLabel" id="label12">
                             <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Original Title</property>
                           </widget>
                           <packing>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">4</property>
-                            <property name="bottom_attach">5</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
                             <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label172">
+                          <widget class="GtkEntry" id="am_original_title">
                             <property name="visible">True</property>
-                            <property name="label" translatable="yes">Type in the original film tile, select source and choose &lt;i&gt;Get from web&lt;/i&gt;. Griffith will try to fetch all the related information from the Web.</property>
-                            <property name="use_markup">True</property>
-                            <property name="justify">GTK_JUSTIFY_CENTER</property>
-                            <property name="wrap">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="has_focus">True</property>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
+                            <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options">GTK_EXPAND</property>
+                            <property name="top_attach">1</property>
+                            <property name="bottom_attach">2</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkImage" id="image_add_rating">
+                          <widget class="GtkLabel" id="label16">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="pixbuf">nill.png</property>
+                            <property name="label" translatable="yes">Title</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
-                            <property name="right_attach">2</property>
-                            <property name="top_attach">6</property>
-                            <property name="bottom_attach">7</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkHScale" id="rating_scale_add">
+                          <widget class="GtkEntry" id="am_title">
                             <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="adjustment">0 0 10 1 1 0</property>
-                            <property name="digits">0</property>
-                            <property name="value_pos">GTK_POS_RIGHT</property>
-                            <signal name="value_changed" handler="on_rating_scale_add_value_changed"/>
+                            <property name="invisible_char">*</property>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
-                            <property name="y_options">GTK_FILL</property>
-                          </packing>
-                        </child>
-                        <child>
-                          <widget class="GtkLabel" id="label128">
-                            <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Rating</property>
-                          </widget>
-                          <packing>
-                            <property name="top_attach">5</property>
-                            <property name="bottom_attach">6</property>
-                            <property name="x_options">GTK_FILL</property>
+                            <property name="top_attach">2</property>
+                            <property name="bottom_attach">3</property>
                             <property name="y_options"></property>
                           </packing>
                         </child>
@@ -5901,58 +5886,73 @@
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="am_title">
+                          <widget class="GtkLabel" id="label128">
                             <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Rating</property>
+                          </widget>
+                          <packing>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options"></property>
+                          </packing>
+                        </child>
+                        <child>
+                          <widget class="GtkHScale" id="rating_scale_add">
+                            <property name="visible">True</property>
                             <property name="can_focus">True</property>
-                            <property name="invisible_char">*</property>
+                            <property name="adjustment">0 0 10 1 1 0</property>
+                            <property name="digits">0</property>
+                            <property name="value_pos">GTK_POS_RIGHT</property>
+                            <signal name="value_changed" handler="on_rating_scale_add_value_changed"/>
                           </widget>
                           <packing>
                             <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
-                            <property name="y_options"></property>
+                            <property name="top_attach">5</property>
+                            <property name="bottom_attach">6</property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options">GTK_FILL</property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label16">
+                          <widget class="GtkImage" id="image_add_rating">
                             <property name="visible">True</property>
                             <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Title</property>
+                            <property name="pixbuf">nill.png</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">2</property>
-                            <property name="bottom_attach">3</property>
+                            <property name="left_attach">1</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">6</property>
+                            <property name="bottom_attach">7</property>
                             <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkEntry" id="am_original_title">
+                          <widget class="GtkLabel" id="label172">
                             <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="has_focus">True</property>
-                            <property name="invisible_char">*</property>
+                            <property name="label" translatable="yes">Type in the original film tile, select source and choose &lt;i&gt;Get from web&lt;/i&gt;. Griffith will try to fetch all the related information from the Web.</property>
+                            <property name="use_markup">True</property>
+                            <property name="justify">GTK_JUSTIFY_CENTER</property>
+                            <property name="wrap">True</property>
                           </widget>
                           <packing>
-                            <property name="left_attach">1</property>
                             <property name="right_attach">2</property>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
-                            <property name="y_options"></property>
+                            <property name="x_options">GTK_FILL</property>
+                            <property name="y_options">GTK_EXPAND</property>
                           </packing>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label12">
+                          <widget class="GtkHSeparator" id="hseparator12">
                             <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Original Title</property>
                           </widget>
                           <packing>
-                            <property name="top_attach">1</property>
-                            <property name="bottom_attach">2</property>
+                            <property name="right_attach">2</property>
+                            <property name="top_attach">4</property>
+                            <property name="bottom_attach">5</property>
                             <property name="x_options">GTK_FILL</property>
-                            <property name="y_options"></property>
                           </packing>
                         </child>
                       </widget>
@@ -6143,7 +6143,7 @@
                 <property name="column_spacing">2</property>
                 <property name="row_spacing">2</property>
                 <child>
-                  <widget class="GtkEntry" id="am_cameraman">
+                  <widget class="GtkEntry" id="am_director">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6151,66 +6151,159 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_screenplay">
+                  <widget class="GtkLabel" id="label43">
                     <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="invisible_char">*</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Year</property>
                   </widget>
                   <packing>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkHBox" id="hbox66">
+                    <property name="visible">True</property>
+                    <property name="spacing">4</property>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_year">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">1899 1899 2100 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                        <property name="numeric">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkAlignment" id="alignment35">
+                        <property name="visible">True</property>
+                        <property name="xalign">1</property>
+                        <property name="xscale">0</property>
+                        <child>
+                          <widget class="GtkLabel" id="label45">
+                            <property name="visible">True</property>
+                            <property name="xalign">0</property>
+                            <property name="label" translatable="yes">Runtime</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_runtime">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">0 0 99999 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                        <property name="numeric">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="position">2</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="label132">
+                        <property name="visible">True</property>
+                        <property name="label" translatable="yes">minutes</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">3</property>
+                      </packing>
+                    </child>
+                  </widget>
+                  <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
-                    <property name="y_options"></property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label15">
+                  <widget class="GtkLabel" id="label11">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Cameraman</property>
+                    <property name="label" translatable="yes">Number</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label7">
+                  <widget class="GtkHBox" id="hbox65">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Screenplay</property>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_number">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">0 0 1000000 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                        <property name="numeric">True</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkAlignment" id="alignment34">
+                        <property name="visible">True</property>
+                        <property name="xscale">0.5</property>
+                        <child>
+                          <widget class="GtkCheckButton" id="am_seen">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="label" translatable="yes">Seen it</property>
+                            <property name="use_underline">True</property>
+                            <property name="response_id">0</property>
+                            <property name="draw_indicator">True</property>
+                          </widget>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
                   </widget>
                   <packing>
-                    <property name="top_attach">3</property>
-                    <property name="bottom_attach">4</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label42">
+                  <widget class="GtkLabel" id="label53">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Director</property>
+                    <property name="label" translatable="yes">Trailer</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="top_attach">12</property>
+                    <property name="bottom_attach">13</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_country">
+                  <widget class="GtkEntry" id="am_trailer">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6218,26 +6311,26 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">12</property>
+                    <property name="bottom_attach">13</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label44">
+                  <widget class="GtkLabel" id="label52">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Country</property>
+                    <property name="label" translatable="yes">Site</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">11</property>
+                    <property name="bottom_attach">12</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_genre">
+                  <widget class="GtkEntry" id="am_imdb">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6245,26 +6338,26 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="top_attach">11</property>
+                    <property name="bottom_attach">12</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label46">
+                  <widget class="GtkLabel" id="label51">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Genre</property>
+                    <property name="label" translatable="yes">Official site</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_classification">
+                  <widget class="GtkEntry" id="am_site">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6272,20 +6365,33 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
+                    <property name="top_attach">10</property>
+                    <property name="bottom_attach">11</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label49">
+                  <widget class="GtkHSeparator" id="hseparator1">
                     <property name="visible">True</property>
+                  </widget>
+                  <packing>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkLabel" id="label50">
+                    <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Classification</property>
+                    <property name="label" translatable="yes">Studio</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
@@ -6305,60 +6411,47 @@
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label50">
+                  <widget class="GtkLabel" id="label49">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Studio</property>
+                    <property name="label" translatable="yes">Classification</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator1">
+                  <widget class="GtkEntry" id="am_classification">
                     <property name="visible">True</property>
-                  </widget>
-                  <packing>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkEntry" id="am_site">
-                    <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label51">
+                  <widget class="GtkLabel" id="label46">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Official site</property>
+                    <property name="label" translatable="yes">Genre</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">10</property>
-                    <property name="bottom_attach">11</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_imdb">
+                  <widget class="GtkEntry" id="am_genre">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6366,26 +6459,26 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">11</property>
-                    <property name="bottom_attach">12</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label52">
+                  <widget class="GtkLabel" id="label44">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Site</property>
+                    <property name="label" translatable="yes">Country</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">11</property>
-                    <property name="bottom_attach">12</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_trailer">
+                  <widget class="GtkEntry" id="am_country">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6393,159 +6486,66 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">12</property>
-                    <property name="bottom_attach">13</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label53">
+                  <widget class="GtkLabel" id="label42">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Trailer</property>
+                    <property name="label" translatable="yes">Director</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">12</property>
-                    <property name="bottom_attach">13</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox65">
+                  <widget class="GtkLabel" id="label7">
                     <property name="visible">True</property>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_number">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">0 0 1000000 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                        <property name="numeric">True</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkAlignment" id="alignment34">
-                        <property name="visible">True</property>
-                        <property name="xscale">0.5</property>
-                        <child>
-                          <widget class="GtkCheckButton" id="am_seen">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="label" translatable="yes">Seen it</property>
-                            <property name="use_underline">True</property>
-                            <property name="response_id">0</property>
-                            <property name="draw_indicator">True</property>
-                          </widget>
-                        </child>
-                      </widget>
-                      <packing>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Screenplay</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label11">
+                  <widget class="GtkLabel" id="label15">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Number</property>
+                    <property name="label" translatable="yes">Cameraman</property>
                   </widget>
                   <packing>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox66">
+                  <widget class="GtkEntry" id="am_screenplay">
                     <property name="visible">True</property>
-                    <property name="spacing">4</property>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_year">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">1899 1899 2100 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                        <property name="numeric">True</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkAlignment" id="alignment35">
-                        <property name="visible">True</property>
-                        <property name="xalign">1</property>
-                        <property name="xscale">0</property>
-                        <child>
-                          <widget class="GtkLabel" id="label45">
-                            <property name="visible">True</property>
-                            <property name="xalign">0</property>
-                            <property name="label" translatable="yes">Runtime</property>
-                          </widget>
-                        </child>
-                      </widget>
-                      <packing>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_runtime">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">0 0 99999 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                        <property name="numeric">True</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="position">2</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkLabel" id="label132">
-                        <property name="visible">True</property>
-                        <property name="label" translatable="yes">minutes</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="fill">False</property>
-                        <property name="position">3</property>
-                      </packing>
-                    </child>
+                    <property name="can_focus">True</property>
+                    <property name="invisible_char">*</property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkLabel" id="label43">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Year</property>
-                  </widget>
-                  <packing>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
-                    <property name="x_options">GTK_FILL</property>
+                    <property name="top_attach">3</property>
+                    <property name="bottom_attach">4</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkEntry" id="am_director">
+                  <widget class="GtkEntry" id="am_cameraman">
                     <property name="visible">True</property>
                     <property name="can_focus">True</property>
                     <property name="invisible_char">*</property>
@@ -6553,8 +6553,8 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
@@ -6583,138 +6583,161 @@
                 <property name="column_spacing">2</property>
                 <property name="row_spacing">2</property>
                 <child>
-                  <widget class="GtkComboBox" id="am_vcodec">
+                  <widget class="GtkLabel" id="label57">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Medium</property>
                   </widget>
                   <packing>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options"></property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkHBox" id="hbox58">
+                    <property name="visible">True</property>
+                    <property name="spacing">4</property>
+                    <child>
+                      <widget class="GtkComboBox" id="am_media">
+                        <property name="visible">True</property>
+                        <property name="items"></property>
+                      </widget>
+                    </child>
+                    <child>
+                      <widget class="GtkLabel" id="label55">
+                        <property name="visible">True</property>
+                        <property name="xalign">0</property>
+                        <property name="label" translatable="yes">Discs</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
+                    <child>
+                      <widget class="GtkSpinButton" id="am_discs">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="adjustment">1 1 100 1 10 10</property>
+                        <property name="climb_rate">1</property>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">False</property>
+                        <property name="position">2</property>
+                      </packing>
+                    </child>
+                  </widget>
+                  <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label197">
+                  <widget class="GtkLabel" id="label115">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Video codec</property>
+                    <property name="label" translatable="yes">Condition</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">9</property>
-                    <property name="bottom_attach">10</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_color">
+                  <widget class="GtkLabel" id="label113">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Region</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_layers">
+                  <widget class="GtkLabel" id="label114">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Layers</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
                     <property name="top_attach">3</property>
                     <property name="bottom_attach">4</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_region">
+                  <widget class="GtkLabel" id="label146">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Volume</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkComboBox" id="am_condition">
+                  <widget class="GtkLabel" id="label171">
                     <property name="visible">True</property>
-                    <property name="items"></property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Collection</property>
                   </widget>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator17">
+                  <widget class="GtkLabel" id="label116">
                     <property name="visible">True</property>
+                    <property name="xalign">0</property>
+                    <property name="label" translatable="yes">Color</property>
                   </widget>
                   <packing>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">7</property>
-                    <property name="bottom_attach">8</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
+                    <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHSeparator" id="hseparator9">
+                  <widget class="GtkHBox" id="hbox74">
                     <property name="visible">True</property>
-                  </widget>
-                  <packing>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">4</property>
-                    <property name="bottom_attach">5</property>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options">GTK_FILL</property>
-                    <property name="y_padding">4</property>
-                  </packing>
-                </child>
-                <child>
-                  <widget class="GtkHBox" id="hbox73">
-                    <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkComboBoxEntry" id="am_volume_combo">
+                      <widget class="GtkComboBoxEntry" id="am_collection_combo">
                         <property name="visible">True</property>
                         <property name="items" translatable="yes"></property>
-                        <signal name="changed" handler="on_am_volume_combo_changed"/>
+                        <signal name="changed" handler="on_am_collection_combo_changed"/>
                         <child internal-child="entry">
-                          <widget class="GtkEntry" id="comboboxentry-entry9">
+                          <widget class="GtkEntry" id="comboboxentry-entry8">
                           </widget>
                         </child>
                       </widget>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_add_volume_button">
+                      <widget class="GtkButton" id="am_add_collection_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">add entered name to volumes list</property>
+                        <property name="tooltip" translatable="yes">add entered name to collections list</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_add_volume_button_clicked"/>
+                        <signal name="clicked" handler="on_am_add_collection_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image420">
+                          <widget class="GtkImage" id="image422">
                             <property name="visible">True</property>
                             <property name="stock">gtk-add</property>
                           </widget>
@@ -6727,14 +6750,14 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_remove_volume_button">
+                      <widget class="GtkButton" id="am_remove_collection_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">remove selected volume</property>
+                        <property name="tooltip" translatable="yes">remove selected collection</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_remove_volume_button_clicked"/>
+                        <signal name="clicked" handler="on_am_remove_collection_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image421">
+                          <widget class="GtkImage" id="image423">
                             <property name="visible">True</property>
                             <property name="stock">gtk-remove</property>
                           </widget>
@@ -6750,35 +6773,35 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="top_attach">6</property>
+                    <property name="bottom_attach">7</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox74">
+                  <widget class="GtkHBox" id="hbox73">
                     <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkComboBoxEntry" id="am_collection_combo">
+                      <widget class="GtkComboBoxEntry" id="am_volume_combo">
                         <property name="visible">True</property>
                         <property name="items" translatable="yes"></property>
-                        <signal name="changed" handler="on_am_collection_combo_changed"/>
+                        <signal name="changed" handler="on_am_volume_combo_changed"/>
                         <child internal-child="entry">
-                          <widget class="GtkEntry" id="comboboxentry-entry8">
+                          <widget class="GtkEntry" id="comboboxentry-entry9">
                           </widget>
                         </child>
                       </widget>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_add_collection_button">
+                      <widget class="GtkButton" id="am_add_volume_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">add entered name to collections list</property>
+                        <property name="tooltip" translatable="yes">add entered name to volumes list</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_add_collection_button_clicked"/>
+                        <signal name="clicked" handler="on_am_add_volume_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image422">
+                          <widget class="GtkImage" id="image420">
                             <property name="visible">True</property>
                             <property name="stock">gtk-add</property>
                           </widget>
@@ -6791,14 +6814,14 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkButton" id="am_remove_collection_button">
+                      <widget class="GtkButton" id="am_remove_volume_button">
                         <property name="visible">True</property>
                         <property name="can_focus">True</property>
-                        <property name="tooltip" translatable="yes">remove selected collection</property>
+                        <property name="tooltip" translatable="yes">remove selected volume</property>
                         <property name="response_id">0</property>
-                        <signal name="clicked" handler="on_am_remove_collection_button_clicked"/>
+                        <signal name="clicked" handler="on_am_remove_volume_button_clicked"/>
                         <child>
-                          <widget class="GtkImage" id="image423">
+                          <widget class="GtkImage" id="image421">
                             <property name="visible">True</property>
                             <property name="stock">gtk-remove</property>
                           </widget>
@@ -6814,143 +6837,120 @@
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="top_attach">5</property>
+                    <property name="bottom_attach">6</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label116">
+                  <widget class="GtkHSeparator" id="hseparator9">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Color</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">8</property>
-                    <property name="bottom_attach">9</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">4</property>
+                    <property name="bottom_attach">5</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label171">
+                  <widget class="GtkHSeparator" id="hseparator17">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Collection</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">6</property>
-                    <property name="bottom_attach">7</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">7</property>
+                    <property name="bottom_attach">8</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
+                    <property name="y_padding">4</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label146">
+                  <widget class="GtkComboBox" id="am_condition">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Volume</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
-                    <property name="top_attach">5</property>
-                    <property name="bottom_attach">6</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label114">
+                  <widget class="GtkComboBox" id="am_region">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Layers</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">2</property>
+                    <property name="bottom_attach">3</property>
+                    <property name="x_options">GTK_FILL</property>
+                    <property name="y_options">GTK_FILL</property>
+                  </packing>
+                </child>
+                <child>
+                  <widget class="GtkComboBox" id="am_layers">
+                    <property name="visible">True</property>
+                    <property name="items"></property>
+                  </widget>
+                  <packing>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
                     <property name="top_attach">3</property>
                     <property name="bottom_attach">4</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label113">
+                  <widget class="GtkComboBox" id="am_color">
                     <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Region</property>
+                    <property name="items"></property>
                   </widget>
                   <packing>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="left_attach">1</property>
+                    <property name="right_attach">2</property>
+                    <property name="top_attach">8</property>
+                    <property name="bottom_attach">9</property>
                     <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
+                    <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkLabel" id="label115">
+                  <widget class="GtkLabel" id="label197">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Condition</property>
+                    <property name="label" translatable="yes">Video codec</property>
                   </widget>
                   <packing>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
                 <child>
-                  <widget class="GtkHBox" id="hbox58">
+                  <widget class="GtkComboBox" id="am_vcodec">
                     <property name="visible">True</property>
-                    <property name="spacing">4</property>
-                    <child>
-                      <widget class="GtkComboBox" id="am_media">
-                        <property name="visible">True</property>
-                        <property name="items"></property>
-                      </widget>
-                    </child>
-                    <child>
-                      <widget class="GtkLabel" id="label55">
-                        <property name="visible">True</property>
-                        <property name="xalign">0</property>
-                        <property name="label" translatable="yes">Discs</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="fill">False</property>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
-                    <child>
-                      <widget class="GtkSpinButton" id="am_discs">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="adjustment">1 1 100 1 10 10</property>
-                        <property name="climb_rate">1</property>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="fill">False</property>
-                        <property name="position">2</property>
-                      </packing>
-                    </child>
+                    <property name="items"></property>
                   </widget>
                   <packing>
                     <property name="left_attach">1</property>
                     <property name="right_attach">2</property>
+                    <property name="top_attach">9</property>
+                    <property name="bottom_attach">10</property>
                     <property name="x_options">GTK_FILL</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
-                <child>
-                  <widget class="GtkLabel" id="label57">
-                    <property name="visible">True</property>
-                    <property name="xalign">0</property>
-                    <property name="label" translatable="yes">Medium</property>
-                  </widget>
-                  <packing>
-                    <property name="x_options">GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
               </widget>
               <packing>
                 <property name="position">2</property>
@@ -7299,40 +7299,36 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_id">
-                <property name="can_focus">True</property>
-                <property name="invisible_char">*</property>
+              <widget class="GtkLabel" id="label78">
+                <property name="visible">True</property>
+                <property name="label" translatable="yes">Name</property>
               </widget>
               <packing>
-                <property name="left_attach">1</property>
-                <property name="right_attach">2</property>
-                <property name="top_attach">3</property>
-                <property name="bottom_attach">4</property>
+                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_phone">
+              <widget class="GtkEntry" id="ep_name">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label80">
+              <widget class="GtkLabel" id="label79">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">Phone</property>
+                <property name="label" translatable="yes">E-mail</property>
               </widget>
               <packing>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
@@ -7352,37 +7348,41 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label79">
+              <widget class="GtkLabel" id="label80">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">E-mail</property>
+                <property name="label" translatable="yes">Phone</property>
               </widget>
               <packing>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ep_name">
+              <widget class="GtkEntry" id="ep_phone">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
-                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label78">
-                <property name="visible">True</property>
-                <property name="label" translatable="yes">Name</property>
+              <widget class="GtkEntry" id="ep_id">
+                <property name="can_focus">True</property>
+                <property name="invisible_char">*</property>
               </widget>
               <packing>
-                <property name="x_options">GTK_FILL</property>
+                <property name="left_attach">1</property>
+                <property name="right_attach">2</property>
+                <property name="top_attach">3</property>
+                <property name="bottom_attach">4</property>
                 <property name="y_options"></property>
               </packing>
             </child>
@@ -7445,30 +7445,37 @@
             <property name="column_spacing">4</property>
             <property name="row_spacing">2</property>
             <child>
-              <widget class="GtkEntry" id="ap_phone">
+              <widget class="GtkLabel" id="label73">
                 <property name="visible">True</property>
+                <property name="label" translatable="yes">Name</property>
+              </widget>
+              <packing>
+                <property name="x_options">GTK_FILL</property>
+                <property name="y_options"></property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkEntry" id="ap_name">
+                <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">2</property>
-                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ap_email">
+              <widget class="GtkLabel" id="label74">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="invisible_char">*</property>
+                <property name="label" translatable="yes">E-mail</property>
               </widget>
               <packing>
-                <property name="left_attach">1</property>
-                <property name="right_attach">2</property>
                 <property name="top_attach">1</property>
                 <property name="bottom_attach">2</property>
+                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
@@ -7485,40 +7492,33 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkLabel" id="label74">
+              <widget class="GtkEntry" id="ap_email">
                 <property name="visible">True</property>
-                <property name="label" translatable="yes">E-mail</property>
+                <property name="can_focus">True</property>
+                <property name="invisible_char">*</property>
               </widget>
               <packing>
+                <property name="left_attach">1</property>
+                <property name="right_attach">2</property>
                 <property name="top_attach">1</property>
                 <property name="bottom_attach">2</property>
-                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
               </packing>
             </child>
             <child>
-              <widget class="GtkEntry" id="ap_name">
+              <widget class="GtkEntry" id="ap_phone">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
-                <property name="has_focus">True</property>
                 <property name="invisible_char">*</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">2</property>
+                <property name="bottom_attach">3</property>
                 <property name="y_options"></property>
               </packing>
             </child>
-            <child>
-              <widget class="GtkLabel" id="label73">
-                <property name="visible">True</property>
-                <property name="label" translatable="yes">Name</property>
-              </widget>
-              <packing>
-                <property name="x_options">GTK_FILL</property>
-                <property name="y_options"></property>
-              </packing>
-            </child>
           </widget>
           <packing>
             <property name="position">2</property>
@@ -7715,29 +7715,22 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkLabel" id="label71">
+              <widget class="GtkCheckButton" id="cover_simple_include_movie_number">
                 <property name="visible">True</property>
-                <property name="xalign">0</property>
-                <property name="label" translatable="yes">Size</property>
+                <property name="can_focus">True</property>
+                <property name="label" translatable="yes">Include movie number</property>
+                <property name="use_underline">True</property>
+                <property name="response_id">0</property>
+                <property name="active">True</property>
+                <property name="draw_indicator">True</property>
               </widget>
               <packing>
-                <property name="x_options">GTK_FILL</property>
-                <property name="y_options"></property>
-                <property name="x_padding">8</property>
-              </packing>
-            </child>
-            <child>
-              <widget class="GtkComboBox" id="cover_simple_size">
-                <property name="visible">True</property>
-                <property name="items" translatable="yes">Standard
-Slim
-Double Slim</property>
-              </widget>
-              <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options">GTK_FILL</property>
+                <property name="y_options"></property>
               </packing>
             </child>
             <child>
@@ -7760,22 +7753,29 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkCheckButton" id="cover_simple_include_movie_number">
+              <widget class="GtkComboBox" id="cover_simple_size">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="label" translatable="yes">Include movie number</property>
-                <property name="use_underline">True</property>
-                <property name="response_id">0</property>
-                <property name="active">True</property>
-                <property name="draw_indicator">True</property>
+                <property name="items" translatable="yes">Standard
+Slim
+Double Slim</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
+                <property name="y_options">GTK_FILL</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkLabel" id="label71">
+                <property name="visible">True</property>
+                <property name="xalign">0</property>
+                <property name="label" translatable="yes">Size</property>
+              </widget>
+              <packing>
+                <property name="x_options">GTK_FILL</property>
                 <property name="y_options"></property>
+                <property name="x_padding">8</property>
               </packing>
             </child>
           </widget>
@@ -8024,17 +8024,22 @@
               <placeholder/>
             </child>
             <child>
-              <widget class="GtkComboBox" id="cover_image_size">
+              <widget class="GtkCheckButton" id="cover_image_number">
                 <property name="visible">True</property>
-                <property name="items" translatable="yes">Standard
-Slim
-Double Slim</property>
+                <property name="can_focus">True</property>
+                <property name="label" translatable="yes">Include movie number</property>
+                <property name="use_underline">True</property>
+                <property name="response_id">0</property>
+                <property name="active">True</property>
+                <property name="draw_indicator">True</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
+                <property name="top_attach">1</property>
+                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options">GTK_FILL</property>
+                <property name="y_options"></property>
               </packing>
             </child>
             <child>
@@ -8050,22 +8055,17 @@
               </packing>
             </child>
             <child>
-              <widget class="GtkCheckButton" id="cover_image_number">
+              <widget class="GtkComboBox" id="cover_image_size">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="label" translatable="yes">Include movie number</property>
-                <property name="use_underline">True</property>
-                <property name="response_id">0</property>
-                <property name="active">True</property>
-                <property name="draw_indicator">True</property>
+                <property name="items" translatable="yes">Standard
+Slim
+Double Slim</property>
               </widget>
               <packing>
                 <property name="left_attach">1</property>
                 <property name="right_attach">2</property>
-                <property name="top_attach">1</property>
-                <property name="bottom_attach">2</property>
                 <property name="x_options">GTK_FILL</property>
-                <property name="y_options"></property>
+                <property name="y_options">GTK_FILL</property>
               </packing>
             </child>
           </widget>
@@ -8115,6 +8115,7 @@
     <property name="border_width">5</property>
     <property name="title" translatable="yes">Filter movies</property>
     <property name="window_position">GTK_WIN_POS_CENTER_ON_PARENT</property>
+    <property name="default_width">600</property>
     <property name="default_height">550</property>
     <property name="type_hint">GDK_WINDOW_TYPE_HINT_DIALOG</property>
     <property name="has_separator">False</property>
@@ -8138,132 +8139,53 @@
                     <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkFrame" id="af_frame_limits">
+                      <widget class="GtkHBox" id="hbox1">
                         <property name="visible">True</property>
-                        <property name="label_xalign">0</property>
+                        <property name="spacing">4</property>
                         <child>
-                          <widget class="GtkAlignment" id="alignment3">
+                          <widget class="GtkComboBoxEntry" id="af_cbe_name">
                             <property name="visible">True</property>
-                            <property name="left_padding">12</property>
-                            <child>
-                              <widget class="GtkTable" id="table4">
-                                <property name="visible">True</property>
-                                <property name="n_rows">2</property>
-                                <property name="n_columns">3</property>
-                                <property name="homogeneous">True</property>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">loaned only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">seen only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">not loaned only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">unseen only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
+                            <property name="items" translatable="yes"></property>
+                            <child internal-child="entry">
+                              <widget class="GtkEntry" id="af_cbe_name_entry">
                               </widget>
                             </child>
                           </widget>
                         </child>
                         <child>
-                          <widget class="GtkLabel" id="label5">
+                          <widget class="GtkButton" id="button3">
                             <property name="visible">True</property>
-                            <property name="label" translatable="yes">&lt;b&gt;Limits&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="label" translatable="yes">gtk-open</property>
+                            <property name="use_stock">True</property>
+                            <property name="response_id">0</property>
+                            <signal name="clicked" handler="on_advfilter_open"/>
                           </widget>
                           <packing>
-                            <property name="type">label_item</property>
+                            <property name="expand">False</property>
+                            <property name="position">1</property>
                           </packing>
                         </child>
+                        <child>
+                          <widget class="GtkButton" id="button4">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="label" translatable="yes">gtk-save-as</property>
+                            <property name="use_stock">True</property>
+                            <property name="response_id">0</property>
+                            <signal name="clicked" handler="on_advfilter_save"/>
+                          </widget>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="position">2</property>
+                          </packing>
+                        </child>
                       </widget>
                       <packing>
                         <property name="expand">False</property>
+                        <property name="padding">1</property>
                       </packing>
                     </child>
                     <child>
@@ -8468,6 +8390,136 @@
                         <property name="position">5</property>
                       </packing>
                     </child>
+                    <child>
+                      <widget class="GtkFrame" id="af_frame_limits">
+                        <property name="visible">True</property>
+                        <property name="label_xalign">0</property>
+                        <child>
+                          <widget class="GtkAlignment" id="alignment3">
+                            <property name="visible">True</property>
+                            <property name="left_padding">12</property>
+                            <child>
+                              <widget class="GtkTable" id="table4">
+                                <property name="visible">True</property>
+                                <property name="n_rows">2</property>
+                                <property name="n_columns">3</property>
+                                <property name="homogeneous">True</property>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">unseen only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_seen</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">not loaned only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_loaned</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">seen only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_seen</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">1</property>
+                                    <property name="right_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">loaned only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_loaned</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">1</property>
+                                    <property name="right_attach">2</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">none</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">none</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                              </widget>
+                            </child>
+                          </widget>
+                        </child>
+                        <child>
+                          <widget class="GtkLabel" id="label5">
+                            <property name="visible">True</property>
+                            <property name="label" translatable="yes">&lt;b&gt;Limits&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
+                          </widget>
+                          <packing>
+                            <property name="type">label_item</property>
+                          </packing>
+                        </child>
+                      </widget>
+                      <packing>
+                        <property name="expand">False</property>
+                        <property name="position">1</property>
+                      </packing>
+                    </child>
                   </widget>
                 </child>
               </widget>
@@ -8496,37 +8548,6 @@
               </packing>
             </child>
             <child>
-              <placeholder/>
-            </child>
-            <child>
-              <widget class="GtkButton" id="button3">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="receives_default">True</property>
-                <property name="label" translatable="yes">gtk-open</property>
-                <property name="use_stock">True</property>
-                <property name="response_id">0</property>
-                <signal name="clicked" handler="on_advfilter_open"/>
-              </widget>
-              <packing>
-                <property name="position">2</property>
-              </packing>
-            </child>
-            <child>
-              <widget class="GtkButton" id="button4">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="receives_default">True</property>
-                <property name="label" translatable="yes">gtk-save-as</property>
-                <property name="use_stock">True</property>
-                <property name="response_id">0</property>
-                <signal name="clicked" handler="on_advfilter_save"/>
-              </widget>
-              <packing>
-                <property name="position">3</property>
-              </packing>
-            </child>
-            <child>
               <widget class="GtkButton" id="button6">
                 <property name="visible">True</property>
                 <property name="can_focus">True</property>
@@ -8537,7 +8558,7 @@
                 <signal name="clicked" handler="on_advfilter_clear"/>
               </widget>
               <packing>
-                <property name="position">4</property>
+                <property name="position">1</property>
               </packing>
             </child>
             <child>
@@ -8551,7 +8572,7 @@
                 <signal name="clicked" handler="on_advfilter_close"/>
               </widget>
               <packing>
-                <property name="position">5</property>
+                <property name="position">2</property>
               </packing>
             </child>
             <child>
@@ -8565,7 +8586,7 @@
                 <signal name="clicked" handler="on_af_find_clicked"/>
               </widget>
               <packing>
-                <property name="position">6</property>
+                <property name="position">3</property>
               </packing>
             </child>
           </widget>

Modified: trunk/griffith
===================================================================
--- trunk/griffith	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/griffith	2008-10-25 17:41:50 UTC (rev 1014)
@@ -397,8 +397,7 @@
             self.widgets['treeview'].set_cursor(number)
             self.treeview_clicked()
         else:
-            gutils.info(self, \
-                _("You have seen all films in your collection!"), \
+            gutils.info(_("You have seen all films in your collection!"), \
                 self.widgets['window'])
 
     # volumes/collections ----------------------------------------------{{{
@@ -956,6 +955,7 @@
     # advfilter -----------------------------------------------------------    
 
     def show_advfilter_window(self, *args):
+        #if not self.widgets['advfilter']['window'].visible: # FIXME
         from advfilter import show_window
         show_window(self)
 

Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/advfilter.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -28,6 +28,7 @@
 log = logging.getLogger("Griffith")
 import db
 import sql
+from gutils import info
     
 __conditions = { # default
     'loaned'          : None,  # None, True, False
@@ -109,24 +110,44 @@
 def initialize(widgets, gsql, field_names):
     # tags
     items = gsql.session.query(db.Tag).all()
-    options = (_('ignore'), _('with'), _('without'), _('require'))
-    _fill_container(widgets["tags_vbox"], items, options, 'tag_id')
+    if len(items):
+        options = (_('ignore'), _('with'), _('without'), _('require'))
+        _fill_container(widgets["tags_vbox"], items, options, 'tag_id')
+        widgets["tags_frame"].show()
+    else:
+        widgets["tags_frame"].hide()
 
     # volumes
     items = gsql.session.query(db.Volume).all()
     options = (_('ignore'), _('in'), _('not in'))
-    _fill_container(widgets["volumes_vbox"], items, options, 'volume_id')
+    if len(items):
+        _fill_container(widgets["volumes_vbox"], items, options, 'volume_id')
+        widgets["volumes_frame"].show()
+    else:
+        widgets["volumes_frame"].hide()
     
     # collections
     items = gsql.session.query(db.Collection).all()
-    # use volume's options
-    _fill_container(widgets["collections_vbox"], items, options, 'collection_id')
+    if len(items):
+        # use volume's options
+        _fill_container(widgets["collections_vbox"], items, options, 'collection_id')
+        widgets["collections_frame"].show()
+    else:
+        widgets["collections_frame"].hide()
 
     # loans
     items = gsql.session.query(db.Person).all()
-    options = (_('ignore'), _('loaned to '), _('loan history'))
-    _fill_container(widgets["loans_vbox"], items, options, 'person_id')
+    if len(items):
+        options = (_('ignore'), _('loaned to '), _('loan history'))
+        _fill_container(widgets["loans_vbox"], items, options, 'person_id')
+        widgets["loans_frame"].show()
+    else:
+        widgets["loans_frame"].hide()
 
+    widgets['cb_name'].get_model().clear()
+    search_filters = gsql.session.query(db.Filter.name).all()
+    for filter_ in search_filters:
+        widgets['cb_name'].append_text(filter_[0])
     return True
 
 def add_query_widget(container, field_names, sel_qf='title', sel_comm=0, text='' ):
@@ -163,6 +184,12 @@
     container.pack_start(hbox)
 
 def set_conditions(widgets, cond, field_names): #{{{
+    widgets['name'].set_text('')
+    
+    # delete old widgets
+    for i in widgets['dynamic_vbox'].get_children():
+        i.destroy()
+
     if cond["seen"] is None:
         widgets["rb_seen"].set_active(True)
     elif cond["seen"] is True:
@@ -229,7 +256,7 @@
             for field in cond[rule]:
                 for text in cond[rule][field]:
                     add_query_widget(vbox, field_names, field, rule, text)
-
+    return True
     
     #}}}
 
@@ -302,6 +329,33 @@
         cond[command].setdefault(field, set()).add(entry)
 
     return cond # }}}
+
+def save(gsql, widgets):
+    """saves search conditions from current filter window"""
+
+    cond = get_conditions(widgets)
+    name = widgets['cb_name'].get_active_text().decode('utf-8')
+    if not name:
+        log.debug("search rule name is empty")
+        info(_("Name is empty"), widgets['window'])
+        return False
+
+    if sql.save_conditions(gsql, name, cond):
+        info(_("Search conditions saved"), widgets['window'])
+    else:
+        warning(_("Cannot save search conditions"), widgets['window'])
+
+def load(gsql, widgets, field_names):
+    name = widgets['cb_name'].get_active_text().decode('utf-8')
+    if not name:
+        log.debug("search rule name is empty")
+        return False
+    cond = sql.load_conditions(gsql, name)
+    if cond:
+        return set_conditions(widgets, cond, field_names)
+    else:
+        return False
+
 #}}}
 
 # database related --------------------------------------------{{{
@@ -335,8 +389,4 @@
 
     return sql.update_whereclause(query, conditions)
 
-def save_conditions(cond, name, qsql):
-    raise NotImplemented
-def load_conditions(name, qsql):
-    raise NotImplemented
 #}}}

Modified: trunk/lib/db.py
===================================================================
--- trunk/lib/db.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/db.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -31,6 +31,7 @@
 import re
 import string
 import logging
+import marshal
 log = logging.getLogger("Griffith")
 
 EMAIL_PATTERN = re.compile('^[a-z0-9]+[.a-z0-9_+-]*@[a-z0-9_-]+(\.[a-z0-9_-]+)+$', re.IGNORECASE)
@@ -188,6 +189,20 @@
         self.tag_id = tag_id
     def __repr__(self):
         return "<MovieTag:%s-%s>" % (self.movie_id, self.tag_id)
+
+class Filter(object):
+    def __init__(self, name=None, cond=None):
+        if name and cond:
+            self.name = name
+            #self.data = marshal.dumps(cond)
+            self.conditions = cond
+    def __repr__(self):
+        return "<Filter(%s)>" % self.name
+    def _set_cond(self, cond):
+        self.data = marshal.dumps(cond)
+    def _get_cond(self):
+        return marshal.loads(self.data)
+    conditions = property(_get_cond, _set_cond)
 #}}}
 
 ### table definitions ######################################### {{{
@@ -306,6 +321,10 @@
     Column('md5sum', Unicode(32), primary_key=True),
     Column('data', BLOB, nullable=False))
 
+filters_table = Table('filters', metadata,
+    Column('name', Unicode(64), primary_key=True),
+    Column('data', BLOB, nullable=False))
+
 tables = {
     'movies':         movies_table,
     'loans':          loans_table,
@@ -323,7 +342,8 @@
     'movie_lang':     movie_lang_table,
     'movie_tag':      movie_tag_table,
     'configuration':  configuration_table,
-    'posters':        posters_table}
+    'posters':        posters_table,
+    'filters':        filters_table}
 #}}}
 
 ### mappers ################################################### {{{
@@ -368,6 +388,7 @@
     'languages' : relation(MovieLang, cascade='all, delete-orphan')})
 mapper(Poster, posters_table, properties={
     'movies': relation(Movie)})
+mapper(Filter, filters_table)
 #}}}
 
 

Modified: trunk/lib/dbupgrade.py
===================================================================
--- trunk/lib/dbupgrade.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/dbupgrade.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -122,6 +122,7 @@
 
         # create new table
         db.posters_table.create(checkfirst=True, bind=b)
+        db.filters_table.create(checkfirst=True, bind=b)
         db.ratios_table.create(checkfirst=True, bind=b)
         db.ratios_table.insert(bind=b).execute(name=u'16:9')
         db.ratios_table.insert(bind=b).execute(name=u'4:3')

Modified: trunk/lib/gutils.py
===================================================================
--- trunk/lib/gutils.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/gutils.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -238,7 +238,7 @@
     dialog.run()
     dialog.destroy()
 
-def info(self, msg, parent=None):
+def info(msg, parent=None):
     dialog = gtk.MessageDialog(parent,
             gtk.DIALOG_MODAL | gtk.DIALOG_DESTROY_WITH_PARENT,
             gtk.MESSAGE_INFO, gtk.BUTTONS_OK, msg)

Modified: trunk/lib/plugins/export/PluginExportCSV.py
===================================================================
--- trunk/lib/plugins/export/PluginExportCSV.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/export/PluginExportCSV.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -78,4 +78,4 @@
                             'plot', 'cast', 'notes','image'):
                         t.append(movie[s])
                     writer.writerow(t)
-                gutils.info(self, _("%s file has been created.")%"CSV", self.parent)
+                gutils.info(_("%s file has been created.")%"CSV", self.parent)

Modified: trunk/lib/plugins/export/PluginExportHTML.py
===================================================================
--- trunk/lib/plugins/export/PluginExportHTML.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/export/PluginExportHTML.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -879,7 +879,7 @@
             im.save(image_file_dst, config['poster_format'])
         except:
             log.info("Can't convert %s" % image_file_src)
-        gutils.info(self, _("Document has been generated."), self)
+        gutils.info(_("Document has been generated."), self)
         self.on_quit()
     #}}}
 

Modified: trunk/lib/plugins/export/PluginExportPDF.py
===================================================================
--- trunk/lib/plugins/export/PluginExportPDF.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/export/PluginExportPDF.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -168,7 +168,7 @@
                         p = Paragraph(paragraph_text.decode(defaultEnc), self.styles['Normal'])
                         Story.append(p)
                 c.build(Story, onFirstPage=self.page_template, onLaterPages=self.page_template)
-                gutils.info(self, _('PDF has been created.'), self.parent)
+                gutils.info(_('PDF has been created.'), self.parent)
             
     def page_template(self, canvas, doc):
         canvas.saveState()

Modified: trunk/lib/plugins/export/PluginExportXML.py
===================================================================
--- trunk/lib/plugins/export/PluginExportXML.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/export/PluginExportXML.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -96,4 +96,4 @@
                 fp = open(filename[0], "w")
                 xml.dom.ext.PrettyPrint(doc, fp)
                 fp.close()
-                gutils.info(self, _("%s file has been created.")%"XML", self.parent)
+                gutils.info( _("%s file has been created.")%"XML", self.parent)

Modified: trunk/lib/plugins/export/PluginExportiPod.py
===================================================================
--- trunk/lib/plugins/export/PluginExportiPod.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/export/PluginExportiPod.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -100,9 +100,9 @@
         
             if thisPath:
                 commands.getoutput('mv '+os.path.join(tmp_dir,"movies")+' "'+thisPath+'/Notes/"')
-                gutils.info(self, _("List was successful exported to iPod."), self.parent)        
+                gutils.info(_("List was successful exported to iPod."), self.parent)        
             else:
-                gutils.info(self, _("iPod is not connected."), self.parent)
+                gutils.info(_("iPod is not connected."), self.parent)
         # this is not a mac, lets save the file
         else:
             filename = gutils.file_chooser(_("Export a %s document")%"CSV", action=gtk.FILE_CHOOSER_ACTION_SAVE, \
@@ -117,4 +117,4 @@
                         overwrite = False
                 if overwrite == True or overwrite is None:
                     shutil.copyfile(os.path.join(tmp_dir,"movies"), filename[0])
-                    gutils.info(self, _("List was successful exported. Now you should move it to the 'Notes' folder on your iPod."), self.parent)
+                    gutils.info(_("List was successful exported. Now you should move it to the 'Notes' folder on your iPod."), self.parent)

Modified: trunk/lib/plugins/imp/CSV.py
===================================================================
--- trunk/lib/plugins/imp/CSV.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/imp/CSV.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -190,7 +190,7 @@
                         self.gtk.get_widget('d_import').hide()
                         self.gtk.get_widget('d_import').response(gtk.RESPONSE_OK)
                     else:
-                        gutils.info(self.gtk, _("Please assign at least one field first!"), self.gtk.get_widget('d_import') )
+                        gutils.info(_("Please assign at least one field first!"), self.gtk.get_widget('d_import') )
                         
         if widget == self.b_add:
             iterator = self.ls_assigned.append()
@@ -308,7 +308,7 @@
                 self.ls_csv.set_value(iterator, 0, name)
             return True
         except:
-            gutils.info(self.gtk, _("Can't open the file %s") % self.__source_name, self.gtk.get_widget('d_import') )
+            gutils.info(_("Can't open the file %s") % self.__source_name, self.gtk.get_widget('d_import') )
             return False
             
 

Modified: trunk/lib/plugins/imp/__init__.py
===================================================================
--- trunk/lib/plugins/imp/__init__.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/plugins/imp/__init__.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -243,7 +243,7 @@
             self.widgets['import']['progressbar'].set_fraction(0)
             self.widgets['import']['progressbar'].set_text('')
             if ip.run(filename):
-                gutils.info(self, _("%s file has been imported. %s movies added.") \
+                gutils.info(_("%s file has been imported. %s movies added.") \
                     % (plugin_name, ip.imported), self.widgets['window'])
                 self.populate_treeview()
             ip.clear()

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/sql.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -397,4 +397,28 @@
     else:
         return gsql.session.query(db.Loan).filter(db.Loan.movie_id==movie_id).filter(db.Loan.return_date!=None).all()
 
+def save_conditions(gsql, name, cond):
+    session = gsql.Session(bind=gsql.session.bind)
+    #session.bind = gsql.session.bind
+    filter_ = session.query(db.Filter).filter_by(name=name).first()
+    if filter_:
+        filter_.conditions = cond
+    else:
+        filter_ = db.Filter(name, cond)
+    session.add(filter_)
+    try:
+        session.commit()
+    except Exception, e:
+        session.rollback()
+        log.warn(str(e))
+        return False
+    return True
+
+def load_conditions(gsql, name):
+    filter_ = gsql.session.query(db.Filter).filter_by(name=name).first()
+    if filter_:
+        return filter_.conditions
+    else:
+        log.warn("Cannot find search conditions: %s" % name)
+        return None
 #}}}

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2008-10-23 21:00:53 UTC (rev 1013)
+++ trunk/lib/widgets.py	2008-10-25 17:41:50 UTC (rev 1014)
@@ -167,6 +167,12 @@
         'loans_vbox'       : get('af_loans_vbox'),
         'dynamic_vbox'     : get('af_dynamic_vbox'),
         'add_button'       : get('af_add_button'),
+        'tags_frame'       : get('af_frame_tags'),
+        'volumes_frame'    : get('af_frame_volumes'),
+        'collections_frame': get('af_frame_collections'),
+        'loans_frame'      : get('af_frame_loans'),
+        'cb_name'          : get('af_cbe_name'),
+        'name'             : get('af_cbe_name_entry'),
     }
     self.widgets['advfilter']['window'].connect('delete_event', self.hide_advfilter_window)
     self.widgets['advfilter']['window'].set_transient_for(self.widgets['window'])
@@ -497,7 +503,9 @@
         'on_af_find_clicked'                     : self.on_af_find_clicked,
         'on_advfilter_close'                     : self.hide_advfilter_window,
         'on_advfilter_add'                       : lambda w: advfilter.add_query_widget(self.widgets['advfilter']['dynamic_vbox'], self.field_names),
-        'on_advfilter_clear'                     : lambda w: advfilter.set_conditions(self.widgets['advfilter'], advfilter.get_def_conditions(), self.field_names)
+        'on_advfilter_clear'                     : lambda w: advfilter.set_conditions(self.widgets['advfilter'], advfilter.get_def_conditions(), self.field_names),
+        'on_advfilter_save'                      : lambda w: advfilter.save(self.db, self.widgets['advfilter']),
+        'on_advfilter_open'                      : lambda w: advfilter.load(self.db, self.widgets['advfilter'], self.field_names),
     })#}}}
 
 def reconnect_add_signals(self):#{{{



From piotrek at mail.berlios.de  Sat Oct 25 19:51:24 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sat, 25 Oct 2008 19:51:24 +0200
Subject: [Griffith-svn] r1015 - trunk/lib
Message-ID: <200810251751.m9PHpNt5007350@sheep.berlios.de>

Author: piotrek
Date: 2008-10-25 19:51:23 +0200 (Sat, 25 Oct 2008)
New Revision: 1015

Modified:
   trunk/lib/backup.py
   trunk/lib/dbupgrade.py
   trunk/lib/gemail.py
   trunk/lib/initialize.py
   trunk/lib/loan.py
   trunk/lib/people.py
   trunk/lib/test_movieplugins.py
Log:
s/gutils.info(self,/gutils.info(/


Modified: trunk/lib/backup.py
===================================================================
--- trunk/lib/backup.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/backup.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -108,7 +108,7 @@
                         except:
                             log.info("Can't compress %s" % filename)
             mzip.close()
-            gutils.info(self, _("Backup has been created"), self.widgets['window'])
+            gutils.info(_("Backup has been created"), self.widgets['window'])
 
 def restore(self):
     """restores a griffith compressed backup"""
@@ -175,7 +175,7 @@
         # let's refresh the treeview
         self.clear_details()
         self.populate_treeview()
-        gutils.info(self, _("Backup restored"), self.widgets['window'])
+        gutils.info(_("Backup restored"), self.widgets['window'])
 
 def merge(self):    # FIXME
     """
@@ -263,5 +263,5 @@
         # let's refresh the treeview
         self.clear_details()
         self.populate_treeview(self.db.Movie.query.all())
-        #gutils.info(self, _("Databases merged!\n\nProcessed movies: %s\nMerged movies: %s"%(movies, merged)), self.widgets['window'])
+        #gutils.info(_("Databases merged!\n\nProcessed movies: %s\nMerged movies: %s"%(movies, merged)), self.widgets['window'])
 

Modified: trunk/lib/dbupgrade.py
===================================================================
--- trunk/lib/dbupgrade.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/dbupgrade.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -191,7 +191,7 @@
 
 def convert_from_old_db(self, source_file, destination_file):    #{{{
     print 'Converting old database - it can take several minutes...'
-    gutils.info(self,_("Griffith will now convert your database to the new format. This can take several minutes if you have a large database."))
+    gutils.info(_("Griffith will now convert your database to the new format. This can take several minutes if you have a large database."))
     from sqlalchemy.orm import clear_mappers
     from sql import GriffithSQL
     from gutils import digits_only

Modified: trunk/lib/gemail.py
===================================================================
--- trunk/lib/gemail.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/gemail.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -55,7 +55,7 @@
         % (sender, to, subject)
     try:
         smtpresult = session.sendmail(sender, to, headers+msg)
-        gutils.info(self, _("E-mail sent sucessfuly"), self.widgets['window'])
+        gutils.info(_("E-mail sent sucessfuly"), self.widgets['window'])
         return
     except:
         gutils.error(self, _("Error sending e-mail: %s")%"", self.widgets['window'])
@@ -83,5 +83,5 @@
         except:
             gutils.error(self, _("Mail could not be sent. Please check e-mail preferences."), self.widgets['window'])
     else:
-        gutils.info(self, _("This person has no e-mail address defined."), \
+        gutils.info(_("This person has no e-mail address defined."), \
             self.widgets['window'])

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/initialize.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -689,7 +689,7 @@
             if spell_error:
                 log.info('Dictionary not available. Spellcheck will be disabled.')
                 if not self.config.get('notified', False, section='spell'):
-                    gutils.info(self, _("Dictionary not available. Spellcheck will be disabled. \n" + \
+                    gutils.info(_("Dictionary not available. Spellcheck will be disabled. \n" + \
                         "Please install the aspell-%s package or adjust the spellchekcer preferences.")%self.config.get('lang', section='spell'), \
                         self.widgets['preferences']['window'])
                     self.config.set('notified', True, section='spell')

Modified: trunk/lib/loan.py
===================================================================
--- trunk/lib/loan.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/loan.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -42,7 +42,7 @@
         self.widgets['movie']['loan_to'].set_active(0)
         self.widgets['w_loan_to'].show()
     else:
-        gutils.info(self, _("No person is defined yet."), self.widgets['window'])
+        gutils.info(_("No person is defined yet."), self.widgets['window'])
 
 def cancel_loan(self):
     self.widgets['w_loan_to'].hide()

Modified: trunk/lib/people.py
===================================================================
--- trunk/lib/people.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/people.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -132,7 +132,7 @@
         return False
     data = self.db.session.query(db.Loan).filter_by(person_id=person.person_id, return_date=None).all()
     if len(data)>0:
-        gutils.info(self, _("This person has loaned films from you. Return them first."), self.widgets['people']['window'])
+        gutils.info(_("This person has loaned films from you. Return them first."), self.widgets['people']['window'])
         return False
     data = self.db.session.query(db.Loan).filter_by(person_id=person.person_id).all()
     if len(data)>0:

Modified: trunk/lib/test_movieplugins.py
===================================================================
--- trunk/lib/test_movieplugins.py	2008-10-25 17:41:50 UTC (rev 1014)
+++ trunk/lib/test_movieplugins.py	2008-10-25 17:51:23 UTC (rev 1015)
@@ -125,7 +125,7 @@
             if not result:
                 gutils.error(self, 'SearchPluginTest %s: Test NOT successful !' % plugin_name)
             else:
-                gutils.info(self, 'SearchPluginTest %s: Test successful !' % plugin_name)
+                gutils.info('SearchPluginTest %s: Test successful !' % plugin_name)
         
         return result
 
@@ -225,7 +225,7 @@
             if not result:
                 gutils.error(self, 'PluginTest %s: Test NOT successful !' % plugin_name)
             else:
-                gutils.info(self, 'PluginTest %s: Test successful !' % plugin_name)
+                gutils.info('PluginTest %s: Test successful !' % plugin_name)
         
         return result
 
@@ -285,7 +285,7 @@
             else:
                 get_unsuccessful = get_unsuccessful + i + ', '
         if domsgbox:
-            gutils.info(self, 'SearchPluginTests\n  Success: %s\n  Failed: %s\n\nPluginTests\n  Success: %s\n  Failed: %s' % (search_successful, search_unsuccessful, get_successful, get_unsuccessful))
+            gutils.info('SearchPluginTests\n  Success: %s\n  Failed: %s\n\nPluginTests\n  Success: %s\n  Failed: %s' % (search_successful, search_unsuccessful, get_successful, get_unsuccessful))
 
 #
 # Start the tests



From piotrek at mail.berlios.de  Sat Oct 25 20:07:59 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sat, 25 Oct 2008 20:07:59 +0200
Subject: [Griffith-svn] r1016 - trunk/glade
Message-ID: <200810251807.m9PI7xZR009115@sheep.berlios.de>

Author: piotrek
Date: 2008-10-25 20:07:58 +0200 (Sat, 25 Oct 2008)
New Revision: 1016

Modified:
   trunk/glade/griffith.glade
Log:
move af_frame_limits back to the top


Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2008-10-25 17:51:23 UTC (rev 1015)
+++ trunk/glade/griffith.glade	2008-10-25 18:07:58 UTC (rev 1016)
@@ -8122,8 +8122,59 @@
     <child internal-child="vbox">
       <widget class="GtkVBox" id="dialog-vbox11">
         <property name="visible">True</property>
-        <property name="spacing">2</property>
+        <property name="spacing">4</property>
         <child>
+          <widget class="GtkHBox" id="hbox1">
+            <property name="visible">True</property>
+            <property name="spacing">4</property>
+            <child>
+              <widget class="GtkComboBoxEntry" id="af_cbe_name">
+                <property name="visible">True</property>
+                <property name="items" translatable="yes"></property>
+                <child internal-child="entry">
+                  <widget class="GtkEntry" id="af_cbe_name_entry">
+                  </widget>
+                </child>
+              </widget>
+            </child>
+            <child>
+              <widget class="GtkButton" id="button3">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="receives_default">True</property>
+                <property name="label" translatable="yes">gtk-open</property>
+                <property name="use_stock">True</property>
+                <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_open"/>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="position">1</property>
+              </packing>
+            </child>
+            <child>
+              <widget class="GtkButton" id="button4">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="receives_default">True</property>
+                <property name="label" translatable="yes">gtk-save</property>
+                <property name="use_stock">True</property>
+                <property name="response_id">0</property>
+                <signal name="clicked" handler="on_advfilter_save"/>
+              </widget>
+              <packing>
+                <property name="expand">False</property>
+                <property name="position">2</property>
+              </packing>
+            </child>
+          </widget>
+          <packing>
+            <property name="expand">False</property>
+            <property name="padding">1</property>
+            <property name="position">1</property>
+          </packing>
+        </child>
+        <child>
           <widget class="GtkScrolledWindow" id="scrolledwindow1">
             <property name="visible">True</property>
             <property name="can_focus">True</property>
@@ -8139,53 +8190,133 @@
                     <property name="visible">True</property>
                     <property name="spacing">4</property>
                     <child>
-                      <widget class="GtkHBox" id="hbox1">
+                      <widget class="GtkFrame" id="af_frame_limits">
                         <property name="visible">True</property>
-                        <property name="spacing">4</property>
+                        <property name="label_xalign">0</property>
                         <child>
-                          <widget class="GtkComboBoxEntry" id="af_cbe_name">
+                          <widget class="GtkAlignment" id="alignment3">
                             <property name="visible">True</property>
-                            <property name="items" translatable="yes"></property>
-                            <child internal-child="entry">
-                              <widget class="GtkEntry" id="af_cbe_name_entry">
+                            <property name="left_padding">12</property>
+                            <child>
+                              <widget class="GtkTable" id="table4">
+                                <property name="visible">True</property>
+                                <property name="n_rows">2</property>
+                                <property name="n_columns">3</property>
+                                <property name="homogeneous">True</property>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">none</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">none</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">loaned only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_loaned</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">1</property>
+                                    <property name="right_attach">2</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">seen only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_seen</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">1</property>
+                                    <property name="right_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">not loaned only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_loaned</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
+                                    <property name="top_attach">1</property>
+                                    <property name="bottom_attach">2</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="label" translatable="yes">unseen only</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="response_id">0</property>
+                                    <property name="draw_indicator">True</property>
+                                    <property name="group">af_rb_seen</property>
+                                  </widget>
+                                  <packing>
+                                    <property name="left_attach">2</property>
+                                    <property name="right_attach">3</property>
+                                    <property name="y_options"></property>
+                                  </packing>
+                                </child>
                               </widget>
                             </child>
                           </widget>
                         </child>
                         <child>
-                          <widget class="GtkButton" id="button3">
+                          <widget class="GtkLabel" id="label5">
                             <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="label" translatable="yes">gtk-open</property>
-                            <property name="use_stock">True</property>
-                            <property name="response_id">0</property>
-                            <signal name="clicked" handler="on_advfilter_open"/>
+                            <property name="label" translatable="yes">&lt;b&gt;Limits&lt;/b&gt;</property>
+                            <property name="use_markup">True</property>
                           </widget>
                           <packing>
-                            <property name="expand">False</property>
-                            <property name="position">1</property>
+                            <property name="type">label_item</property>
                           </packing>
                         </child>
-                        <child>
-                          <widget class="GtkButton" id="button4">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="label" translatable="yes">gtk-save-as</property>
-                            <property name="use_stock">True</property>
-                            <property name="response_id">0</property>
-                            <signal name="clicked" handler="on_advfilter_save"/>
-                          </widget>
-                          <packing>
-                            <property name="expand">False</property>
-                            <property name="position">2</property>
-                          </packing>
-                        </child>
                       </widget>
                       <packing>
                         <property name="expand">False</property>
-                        <property name="padding">1</property>
+                        <property name="position">1</property>
                       </packing>
                     </child>
                     <child>
@@ -8390,143 +8521,13 @@
                         <property name="position">5</property>
                       </packing>
                     </child>
-                    <child>
-                      <widget class="GtkFrame" id="af_frame_limits">
-                        <property name="visible">True</property>
-                        <property name="label_xalign">0</property>
-                        <child>
-                          <widget class="GtkAlignment" id="alignment3">
-                            <property name="visible">True</property>
-                            <property name="left_padding">12</property>
-                            <child>
-                              <widget class="GtkTable" id="table4">
-                                <property name="visible">True</property>
-                                <property name="n_rows">2</property>
-                                <property name="n_columns">3</property>
-                                <property name="homogeneous">True</property>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only_n">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">unseen only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only_n">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">not loaned only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">2</property>
-                                    <property name="right_attach">3</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen_only">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">seen only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_seen</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned_only">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">loaned only</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                    <property name="group">af_rb_loaned</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_seen">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkRadioButton" id="af_rb_loaned">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="label" translatable="yes">none</property>
-                                    <property name="use_underline">True</property>
-                                    <property name="response_id">0</property>
-                                    <property name="draw_indicator">True</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                              </widget>
-                            </child>
-                          </widget>
-                        </child>
-                        <child>
-                          <widget class="GtkLabel" id="label5">
-                            <property name="visible">True</property>
-                            <property name="label" translatable="yes">&lt;b&gt;Limits&lt;/b&gt;</property>
-                            <property name="use_markup">True</property>
-                          </widget>
-                          <packing>
-                            <property name="type">label_item</property>
-                          </packing>
-                        </child>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
                   </widget>
                 </child>
               </widget>
             </child>
           </widget>
           <packing>
-            <property name="position">1</property>
+            <property name="position">2</property>
           </packing>
         </child>
         <child internal-child="action_area">



From mikej06 at mail.berlios.de  Sat Oct 25 21:58:56 2008
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Sat, 25 Oct 2008 21:58:56 +0200
Subject: [Griffith-svn] r1017 - branches/0.9.x
	branches/0.9.x/lib/plugins/export trunk trunk/lib/plugins/export
Message-ID: <200810251958.m9PJwuC2017426@sheep.berlios.de>

Author: mikej06
Date: 2008-10-25 21:58:46 +0200 (Sat, 25 Oct 2008)
New Revision: 1017

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/plugins/export/PluginExportPDF.py
   trunk/ChangeLog
   trunk/lib/plugins/export/PluginExportPDF.py
Log:
PDF export: disabled movie grouping if movie list is not sorted by title or original title



Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-25 18:07:58 UTC (rev 1016)
+++ branches/0.9.x/ChangeLog	2008-10-25 19:58:46 UTC (rev 1017)
@@ -6,6 +6,9 @@
 
 
 2008-10-23  Michael Jahn
+	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
+
+2008-10-23  Michael Jahn
 	* updated IMDB-de, Kino.de, Zelluloid plugin
 	* added original url check within plugin test
 

Modified: branches/0.9.x/lib/plugins/export/PluginExportPDF.py
===================================================================
--- branches/0.9.x/lib/plugins/export/PluginExportPDF.py	2008-10-25 18:07:58 UTC (rev 1016)
+++ branches/0.9.x/lib/plugins/export/PluginExportPDF.py	2008-10-25 19:58:46 UTC (rev 1017)
@@ -75,7 +75,7 @@
             filename = gutils.file_chooser(_("Export a PDF"), action=gtk.FILE_CHOOSER_ACTION_SAVE, buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK),name="griffith_simple_list.pdf")
         else:
             filename = gutils.file_chooser(_("Export a PDF"), action=gtk.FILE_CHOOSER_ACTION_SAVE, buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK),name="griffith_simple_list.pdf",folder=basedir)
-        if filename[0]:
+        if filename is not False and filename[0]:
             if not self.config is None and filename[1]:
                 self.config.set('export_dir', filename[1], section='export-pdf')
                 self.config.save()
@@ -113,7 +113,10 @@
                 # select sort column
                 sort_column_name = self.config.get('sortby', 'number', section='mainlist')
                 sort_reverse = self.config.get('sortby_reverse', False, section='mainlist')
+                do_grouping = True
                 for i in sort_column_name.split(','):
+                    if i <> 'title' and i <> 'o_title':
+                        do_grouping = False
                     if self.db.Movie.c.has_key(i):
                         if sort_reverse:
                             movies.order_by_clause.append(desc(self.db.Movie.c[i]))
@@ -130,7 +133,7 @@
                     else:
                         director = ""
                     # group by first letter
-                    if title[0] != first_letter:
+                    if do_grouping and title[0] != first_letter:
                         if title[0] in '0123456789':
                             # Group Numbers
                             if first_letter != '0-9':

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-25 18:07:58 UTC (rev 1016)
+++ trunk/ChangeLog	2008-10-25 19:58:46 UTC (rev 1017)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-23  Michael Jahn
+	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
+
 2008-10-25  Piotr O?arowski
 	* add load/save search conditions
 

Modified: trunk/lib/plugins/export/PluginExportPDF.py
===================================================================
--- trunk/lib/plugins/export/PluginExportPDF.py	2008-10-25 18:07:58 UTC (rev 1016)
+++ trunk/lib/plugins/export/PluginExportPDF.py	2008-10-25 19:58:46 UTC (rev 1017)
@@ -78,7 +78,7 @@
             filename = gutils.file_chooser(_("Export a PDF"), action=gtk.FILE_CHOOSER_ACTION_SAVE, buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK),name="griffith_simple_list.pdf")
         else:
             filename = gutils.file_chooser(_("Export a PDF"), action=gtk.FILE_CHOOSER_ACTION_SAVE, buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK),name="griffith_simple_list.pdf",folder=basedir)
-        if filename[0]:
+        if filename is not False and filename[0]:
             if not self.config is None and filename[1]:
                 self.config.set('export_dir', filename[1], section='export-pdf')
                 self.config.save()
@@ -109,7 +109,10 @@
                 # select sort column
                 sort_column_name = self.config.get('sortby', 'number', section='mainlist')
                 sort_reverse = self.config.get('sortby_reverse', False, section='mainlist')
+                do_grouping = True
                 for i in sort_column_name.split(','):
+                    if i <> 'title' and i <> 'o_title':
+                        do_grouping = False
                     if db.movies_table.c.has_key(i):
                         if sort_reverse:
                             movies = movies.order_by(db.movies_table.c[i].desc())
@@ -135,7 +138,7 @@
                     else:
                         director = ""
                     # group by first letter
-                    if title[0] != first_letter:
+                    if do_grouping and title[0] != first_letter:
                         if title[0] in '0123456789':
                             # Group Numbers
                             if first_letter != '0-9':



From piotrek at mail.berlios.de  Sat Oct 25 22:04:09 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sat, 25 Oct 2008 22:04:09 +0200
Subject: [Griffith-svn] r1018 - trunk/lib
Message-ID: <200810252004.m9PK491W017736@sheep.berlios.de>

Author: piotrek
Date: 2008-10-25 22:04:08 +0200 (Sat, 25 Oct 2008)
New Revision: 1018

Modified:
   trunk/lib/advfilter.py
   trunk/lib/db.py
   trunk/lib/sql.py
Log:
search window:
* add negative commands
* translate commands


Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-25 19:58:46 UTC (rev 1017)
+++ trunk/lib/advfilter.py	2008-10-25 20:04:08 UTC (rev 1018)
@@ -29,7 +29,7 @@
 import db
 import sql
 from gutils import info
-    
+
 __conditions = { # default
     'loaned'          : None,  # None, True, False
     'seen'            : None,  # None, True, False
@@ -44,16 +44,33 @@
     'loan_history'    : set(), # list of person_ids	    (search for movies which were loaned by these people)
     'sort_by'         : set(("number",)), # "number DESC"
     'equals'          : {}, # {column1: set(value1, value2), column2: set(value3)}
+    'equals_n'        : {}, # see above
     'startswith'      : {}, # see above
+    'startswith_n'    : {}, # see above
     'contains'        : {}, # see above
+    'contains_n'      : {}, # see above
     'like'            : {}, # see above
+    'like_n'          : {}, # see above
     'ilike'           : {}, # see above
+    'ilike_n'         : {}, # see above
     }
-    
+
 QUERY_FIELDS = ('title', 'o_title', 'director', 'plot', 'cast', 'notes', 'number',
                 'runtime', 'year', 'screenplay', 'cameraman', 'country', 'genre',
                 'studio', 'classification', 'o_site', 'site', 'trailer')
-QUERY_COMMANDS = ('equals', 'startswith', 'contains', 'like', 'ilike')
+QUERY_COMMANDS = ('equals', 'equals_n', 'startswith', 'startswith_n', 'contains',
+                  'contains_n', 'like', 'like_n', 'ilike', 'ilike_n')
+QUERY_COMMAND_NAMES = {
+    'equals'      : _('is equal to'),
+    'equals_n'    : _('is not equal to'),
+    'startswith'  : _('starts with'),
+    'startswith_n': _("doesn't start with"),
+    'contains'    : _('contains'),
+    'contains_n'  : _("doesn't contain"),
+    'like'        : _('like'),
+    'like_n'      : _('not like'),
+    'ilike'       : _('ilike'),
+    'ilike_n'     : _('not ilike')}
 
 # widgets -----------------------------------------------------{{{
 
@@ -98,7 +115,7 @@
         for option in options[1:]: # create rest of the widgets, use first one as a group
             next_widget = gtk.RadioButton(widget, label=option)
             hbox.pack_start(next_widget, expand=False, padding=4)
-        
+
         label = gtk.Label()
         label.set_text(item.name)
         hbox.pack_start(label, padding=16, expand=False)
@@ -125,7 +142,7 @@
         widgets["volumes_frame"].show()
     else:
         widgets["volumes_frame"].hide()
-    
+
     # collections
     items = gsql.session.query(db.Collection).all()
     if len(items):
@@ -150,7 +167,7 @@
         widgets['cb_name'].append_text(filter_[0])
     return True
 
-def add_query_widget(container, field_names, sel_qf='title', sel_comm=0, text='' ):
+def add_query_widget(container, field_names, sel_qf='title', sel_comm='equals', text='' ):
     hbox = gtk.HBox()
 
     cb = gtk.combo_box_new_text()
@@ -166,12 +183,12 @@
     for i, command in enumerate(QUERY_COMMANDS):
         if sel_comm == command:
             select = i
-        action_cb.append_text(_(command))
+        action_cb.append_text(QUERY_COMMAND_NAMES[command])
     action_cb.set_active(select)
 
     entry = gtk.Entry()
     entry.set_text(text)
-    
+
     button = gtk.Button(stock=gtk.STOCK_DELETE)
     button.connect("clicked", lambda w: hbox.destroy())
 
@@ -185,7 +202,7 @@
 
 def set_conditions(widgets, cond, field_names): #{{{
     widgets['name'].set_text('')
-    
+
     # delete old widgets
     for i in widgets['dynamic_vbox'].get_children():
         i.destroy()
@@ -196,7 +213,7 @@
         widgets["rb_seen_only"].set_active(True)
     elif cond["seen"] is False:
         widgets["rb_seen_only_n"].set_active(True)
-    
+
     if cond["loaned"] is None:
         widgets["rb_loaned"].set_active(True)
     elif cond["loaned"] is True:
@@ -215,7 +232,7 @@
             hbox_items[4].set_active(True)
         else:
             hbox_items[1].set_active(True)
-    
+
     for hbox in widgets["volumes_vbox"]:
         hbox_items = hbox.get_children()
         id_ = int(hbox_items[0].get_text())
@@ -225,7 +242,7 @@
             hbox_items[3].set_active(True)
         else:
             hbox_items[1].set_active(True)
-    
+
     for hbox in widgets["collections_vbox"]:
         hbox_items = hbox.get_children()
         id_ = int(hbox_items[0].get_text())
@@ -235,7 +252,7 @@
             hbox_items[3].set_active(True)
         else:
             hbox_items[1].set_active(True)
-    
+
     for hbox in widgets["loans_vbox"]:
         hbox_items = hbox.get_children()
         id_ = int(hbox_items[0].get_text())
@@ -257,7 +274,7 @@
                 for text in cond[rule][field]:
                     add_query_widget(vbox, field_names, field, rule, text)
     return True
-    
+
     #}}}
 
 def get_conditions(widgets): #{{{
@@ -269,7 +286,7 @@
         cond["seen"] = True
     elif widgets["rb_seen_only_n"].get_active():
         cond["seen"] = False
-    
+
     if widgets["rb_loaned"].get_active():
         cond["loaned"] = None
     elif widgets["rb_loaned_only"].get_active():
@@ -292,21 +309,21 @@
             cond["volumes"].add(int(hbox_items[0].get_label()))
         elif hbox_items[3].get_active():
             cond["no_volumes"].add(int(hbox_items[0].get_label()))
-    
+
     for hbox in widgets["collections_vbox"]:
         hbox_items = hbox.get_children()
         if hbox_items[2].get_active():
             cond["collections"].add(int(hbox_items[0].get_label()))
         elif hbox_items[3].get_active():
             cond["no_collections"].add(int(hbox_items[0].get_label()))
-    
+
     for hbox in widgets["loans_vbox"]:
         hbox_items = hbox.get_children()
         if hbox_items[2].get_active():
             cond["loaned_to"].add(int(hbox_items[0].get_label()))
         elif hbox_items[3].get_active():
             cond["loan_history"].add(int(hbox_items[0].get_label()))
-    
+
     for hbox in widgets["dynamic_vbox"]:
         hbox_items = hbox.get_children()
 
@@ -315,17 +332,17 @@
             continue
 
         field = hbox_items[0].get_active()
-        if 0 < field > len(QUERY_FIELDS):
+        if 0 > field or field > len(QUERY_FIELDS):
             continue
         else:
             field = QUERY_FIELDS[field]
-            
+
             command = hbox_items[1].get_active()
-            if 0 < command > len(QUERY_COMMANDS):
+            if 0 > command or command > len(QUERY_COMMANDS):
                 continue
             else:
                 command = QUERY_COMMANDS[command]
-            
+
         cond[command].setdefault(field, set()).add(entry)
 
     return cond # }}}
@@ -381,7 +398,7 @@
         if not columns:
             columns = get_select_columns(self.config)
         query = select(columns, bind=self.db.session.bind)
-    
+
     self._search_conditions = conditions # save for later
     # TODO: remove after debugging:
     from pprint import pprint

Modified: trunk/lib/db.py
===================================================================
--- trunk/lib/db.py	2008-10-25 19:58:46 UTC (rev 1017)
+++ trunk/lib/db.py	2008-10-25 20:04:08 UTC (rev 1018)
@@ -301,7 +301,7 @@
 
 movie_lang_table = Table('movie_lang', metadata,
     Column('ml_id', Integer, primary_key=True),
-    Column('type', SmallInteger), # 0: Original, 1:lector, 2:dubbing, 3:subtitle 
+    Column('type', SmallInteger), # 0: Original, 1:lector, 2:dubbing, 3:subtitle
     Column('movie_id', Integer, ForeignKey('movies.movie_id'), nullable=False),
     Column('lang_id', Integer, ForeignKey('languages.lang_id'), nullable=False),
     Column('acodec_id', Integer, ForeignKey('acodecs.acodec_id')),

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2008-10-25 19:58:46 UTC (rev 1017)
+++ trunk/lib/sql.py	2008-10-25 20:04:08 UTC (rev 1018)
@@ -131,7 +131,7 @@
         self.session = session # global session
         self.Session = Session # create new sessions using this class
         #}}}
-        
+
         # check if database needs an upgrade
         db.metadata.create_all(engine)
         try:
@@ -171,21 +171,21 @@
         query.append_whereclause(db.Movie.volume_id.in_(cond["volumes"]))
     if cond["no_volumes"]:
         query.append_whereclause(~db.Movie.volume_id.in_(cond["no_volumes"]))
-    
+
     loaned_to = []
     for per_id in cond["loaned_to"]:
         loaned_to.append(exists([db.loans_table.c.movie_id],\
                 and_(db.Movie.movie_id==db.loans_table.c.movie_id, db.loans_table.c.person_id==per_id, db.loans_table.c.return_date==None)))
     if loaned_to:
         query.append_whereclause(or_(*loaned_to))
-    
+
     loan_history = []
     for per_id in cond["loan_history"]:
         loan_history.append(exists([db.loans_table.c.movie_id],\
                 and_(db.Movie.movie_id==db.loans_table.c.movie_id, db.loans_table.c.person_id==per_id)))
     if loan_history:
         query.append_whereclause(or_(*loan_history))
-    
+
     required_tags = []
     for tag_id in cond["required_tags"]:
         required_tags.append(exists([db.MovieTag.movie_id], \
@@ -199,7 +199,7 @@
             and_(db.Movie.movie_id==db.MovieTag.movie_id, db.MovieTag.tag_id==tag_id)))
     if tags:
         query.append_whereclause(or_(*tags))
-    
+
     no_tags = []
     for tag_id in cond["no_tags"]:
         no_tags.append(~exists([db.MovieTag.movie_id], \
@@ -207,10 +207,30 @@
     if no_tags:
         query.append_whereclause(and_(*no_tags))
 
+    for field in cond["equals_n"]:
+        values = [ db.movies_table.columns[field]!=value for value in cond["equals_n"][field] ]
+        query.append_whereclause(and_(*values))
+
+    for field in cond["startswith_n"]:
+        values = [ not_(db.movies_table.columns[field].startswith(value)) for value in cond["startswith_n"][field] ]
+        query.append_whereclause(and_(*values))
+
+    for field in cond["like_n"]:
+        values = [ not_(db.movies_table.columns[field].like(value)) for value in cond["like_n"][field] ]
+        query.append_whereclause(and_(*values))
+
+    for field in cond["ilike_n"]:
+        values = [ not_(db.movies_table.columns[field].ilike(value)) for value in cond["ilike_n"][field] ]
+        query.append_whereclause(and_(*values))
+
+    for field in cond["contains_n"]: # XXX: it's not the SQLAlchemy's .contains() i.e. not for one-to-many or many-to-many collections
+        values = [ not_(db.movies_table.columns[field].like('%'+value+'%')) for value in cond["contains_n"][field] ]
+        query.append_whereclause(and_(*values))
+
     for field in cond["equals"]:
         values = [ db.movies_table.columns[field]==value for value in cond["equals"][field] ]
         query.append_whereclause(or_(*values))
-    
+
     for field in cond["startswith"]:
         values = [ db.movies_table.columns[field].startswith(value) for value in cond["startswith"][field] ]
         query.append_whereclause(or_(*values))
@@ -218,15 +238,15 @@
     for field in cond["like"]:
         values = [ db.movies_table.columns[field].like(value) for value in cond["like"][field] ]
         query.append_whereclause(or_(*values))
-    
+
     for field in cond["ilike"]:
         values = [ db.movies_table.columns[field].ilike(value) for value in cond["ilike"][field] ]
         query.append_whereclause(or_(*values))
-    
+
     for field in cond["contains"]: # XXX: it's not the SQLAlchemy's .contains() i.e. not for one-to-many or many-to-many collections
         values = [ db.movies_table.columns[field].like('%'+value+'%') for value in cond["contains"][field] ]
         query.append_whereclause(or_(*values))
-    
+
     # sorting
     for rule in cond["sort_by"]:
         if rule.endswith(" DESC"):
@@ -246,7 +266,7 @@
 # MOVIE LOAN related functions --------------------------------{{{
 def loan_movie(gsql, movie_id, person_id, whole_collection=False):
     """loans a movie, movie's volume and optionally movie's collection"""
-            
+
     session = gsql.Session() # create new session
 
     person = session.query(db.Person).filter_by(person_id=person_id).first()
@@ -296,7 +316,7 @@
 
 def loan_return(gsql, movie_id):
     """marks movie, movie's volume and movie's collection as returned"""
-    
+
     session = gsql.Session() # create new session
 
     loan = session.query(db.Loan).filter_by(movie_id=movie_id, return_date=None).first()
@@ -350,13 +370,13 @@
     movie = gsql.session.query(db.Movie).filter_by(movie_id=movie_id).first()
     if movie is None:
         return False
-    
+
     # fix or add volume/collection data:
     if movie.collection_id is not None:
         collection_id = movie.collection_id
     if movie.volume_id is not None:
         volume_id = movie.volume_id
-    
+
     if collection_id > 0 and volume_id > 0:
         return gsql.session.query(db.Loan).filter(and_(db.Loan.return_date==None,
                                                               or_(db.Loan.collection_id==collection_id,



From mikej06 at mail.berlios.de  Sat Oct 25 22:57:08 2008
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Sat, 25 Oct 2008 22:57:08 +0200
Subject: [Griffith-svn] r1019 - branches/0.9.x branches/0.9.x/lib trunk
	trunk/lib
Message-ID: <200810252057.m9PKv89I021969@sheep.berlios.de>

Author: mikej06
Date: 2008-10-25 22:56:55 +0200 (Sat, 25 Oct 2008)
New Revision: 1019

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/add.py
   trunk/ChangeLog
   trunk/lib/add.py
Log:
[#258817] The application doesn't save volume


Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-25 20:04:08 UTC (rev 1018)
+++ branches/0.9.x/ChangeLog	2008-10-25 20:56:55 UTC (rev 1019)
@@ -7,6 +7,7 @@
 
 2008-10-23  Michael Jahn
 	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
+	* [#258817] The application doesn't save volume
 
 2008-10-23  Michael Jahn
 	* updated IMDB-de, Kino.de, Zelluloid plugin

Modified: branches/0.9.x/lib/add.py
===================================================================
--- branches/0.9.x/lib/add.py	2008-10-25 20:04:08 UTC (rev 1018)
+++ branches/0.9.x/lib/add.py	2008-10-25 20:56:55 UTC (rev 1019)
@@ -332,7 +332,10 @@
 				t_movies.pop(i)
 
 def update_movie(self):
-	movie = self.db.Movie.get_by(movie_id=self._movie_id)
+	if self._am_movie_id is not None:
+		movie = self.db.Movie.get_by(movie_id=self._am_movie_id)
+	else:
+		movie = self.db.Movie.get_by(movie_id=self._movie_id)
 	if movie is None: # movie was deleted in the meantime
 		return add_movie_db(self, True)
 	old_image = movie.image

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-25 20:04:08 UTC (rev 1018)
+++ trunk/ChangeLog	2008-10-25 20:56:55 UTC (rev 1019)
@@ -7,6 +7,7 @@
 
 2008-10-23  Michael Jahn
 	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
+	* [#258817] The application doesn't save volume
 
 2008-10-25  Piotr O?arowski
 	* add load/save search conditions

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2008-10-25 20:04:08 UTC (rev 1018)
+++ trunk/lib/add.py	2008-10-25 20:56:55 UTC (rev 1019)
@@ -68,7 +68,10 @@
 
 
 def update_movie(self):
-    movie = self.db.session.query(db.Movie).filter_by(movie_id=self._movie_id).one()
+    if self._am_movie_id is not None:
+        movie = self.db.session.query(db.Movie).filter_by(movie_id=self._am_movie_id).one()
+    else:
+        movie = self.db.session.query(db.Movie).filter_by(movie_id=self._movie_id).one()
     if movie is None: # movie was deleted in the meantime
         return add_movie_db(self, True)
     



From piotrek at mail.berlios.de  Sun Oct 26 11:27:18 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 26 Oct 2008 11:27:18 +0100
Subject: [Griffith-svn] r1020 - in branches/0.9.x: . lib
Message-ID: <200810261027.m9QARI3h020725@sheep.berlios.de>

Author: piotrek
Date: 2008-10-26 11:27:18 +0100 (Sun, 26 Oct 2008)
New Revision: 1020

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/initialize.py
Log:
Don't refresh movie list while updating quick filter combos (backported from trunk)


Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-25 20:56:55 UTC (rev 1019)
+++ branches/0.9.x/ChangeLog	2008-10-26 10:27:18 UTC (rev 1020)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-26  Piotr O?arowski
+	* Don't refresh movie list while updating quick filter combos (backported from trunk)
+
 2008-10-23  Michael Jahn
 	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
 	* [#258817] The application doesn't save volume

Modified: branches/0.9.x/lib/initialize.py
===================================================================
--- branches/0.9.x/lib/initialize.py	2008-10-25 20:56:55 UTC (rev 1019)
+++ branches/0.9.x/lib/initialize.py	2008-10-26 10:27:18 UTC (rev 1020)
@@ -711,6 +711,8 @@
 		self.widgets['preferences']['db_type'].set_active(0)
 
 def fill_volumes_combo(self, default=0):
+	_tmp = self.initialized
+	self.initialized = False # don't refresh main treeview
 	self.widgets['add']['volume'].get_model().clear()
 	self.widgets['filter']['volume'].get_model().clear()
 	for i in self.volume_combo_ids:
@@ -722,6 +724,7 @@
 		# add some white spaces to prevent scrollbar hides parts of the names	
 		self.widgets['add']['volume'].insert_text(int(i), str(name) + '   ')
 		self.widgets['filter']['volume'].insert_text(int(i), str(name) + '   ')
+	self.initialized = _tmp
 	self.widgets['add']['volume'].show_all()
 	self.widgets['filter']['volume'].show_all()
 	self.widgets['filter']['volume'].set_active(0)
@@ -731,6 +734,8 @@
 	self.widgets['add']['volume'].set_wrap_width(3)
 
 def fill_collections_combo(self, default=0):
+	_tmp = self.initialized
+	self.initialized = False # don't refresh main treeview
 	self.widgets['add']['collection'].get_model().clear()
 	self.widgets['filter']['collection'].get_model().clear()
 	for i in self.collection_combo_ids:
@@ -742,6 +747,8 @@
 		# add some white spaces to prevent scrollbar hides parts of the names	
 		self.widgets['add']['collection'].insert_text(int(i), str(name) + '   ')
 		self.widgets['filter']['collection'].insert_text(int(i), str(name) + '   ')
+	self.initialized = _tmp
+	self.initialized = False
 	self.widgets['add']['collection'].show_all()
 	self.widgets['filter']['collection'].show_all()
 	self.widgets['filter']['collection'].set_active(0)
@@ -751,6 +758,8 @@
 	self.widgets['add']['collection'].set_wrap_width(2)
 
 def fill_loanedto_combo(self):
+	_tmp = self.initialized
+	self.initialized = False # don't refresh main treeview
 	self.widgets['filter']['loanedto'].get_model().clear()
 	for i in self.loanedto_combo_ids:
 		per_id = self.loanedto_combo_ids[i]
@@ -760,10 +769,13 @@
 			name = ''
 		# add some white spaces to prevent scrollbar hides parts of the names	
 		self.widgets['filter']['loanedto'].insert_text(int(i), str(name) + '   ')
+	self.initialized = _tmp
 	self.widgets['filter']['loanedto'].show_all()
 	self.widgets['filter']['loanedto'].set_active(0)
 
 def fill_bytag_combo(self):
+	_tmp = self.initialized
+	self.initialized = False # don't refresh main treeview
 	self.widgets['filter']['tag'].get_model().clear()
 	for i in self.bytag_combo_ids:
 		id = self.bytag_combo_ids[i]
@@ -773,10 +785,13 @@
 			name = ''
 		# add some white spaces to prevent scrollbar hides parts of the names	
 		self.widgets['filter']['tag'].insert_text(int(i), str(name) + '   ')
+	self.initialized = _tmp
 	self.widgets['filter']['tag'].show_all()
 	self.widgets['filter']['tag'].set_active(0)
 
 def fill_preferences_tags_combo(self):
+	_tmp = self.initialized
+	self.initialized = False # don't refresh main treeview
 	self.widgets['preferences']['tag_name'].get_model().clear()
 	self.tags_ids = {}
 	i = 0
@@ -784,6 +799,7 @@
 		self.tags_ids[i] = tag.tag_id
 		self.widgets['preferences']['tag_name'].insert_text(int(i), str(tag.name))
 		i += 1
+	self.initialized = _tmp
 	self.widgets['preferences']['tag_name'].show_all()
 
 def language_combos(self):



From mikej06 at mail.berlios.de  Sun Oct 26 22:28:58 2008
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Sun, 26 Oct 2008 22:28:58 +0100
Subject: [Griffith-svn] r1021 - branches/0.9.x branches/0.9.x/lib
	branches/0.9.x/lib/plugins/movie trunk trunk/lib
	trunk/lib/plugins/movie
Message-ID: <200810262128.m9QLSwmM020885@sheep.berlios.de>

Author: mikej06
Date: 2008-10-26 22:28:32 +0100 (Sun, 26 Oct 2008)
New Revision: 1021

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/add.py
   branches/0.9.x/lib/movie.py
   branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
   branches/0.9.x/lib/test_movieplugins.py
   trunk/ChangeLog
   trunk/lib/add.py
   trunk/lib/movie.py
   trunk/lib/plugins/movie/PluginMovieAmazon.py
   trunk/lib/test_movieplugins.py
Log:
[#179618] During "Get from Web ", griffith window keeps stealing focus


Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-26 10:27:18 UTC (rev 1020)
+++ branches/0.9.x/ChangeLog	2008-10-26 21:28:32 UTC (rev 1021)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-26  Michael Jahn
+	* [#179618] During "Get from Web ", griffith window keeps stealing focus
+
 2008-10-26  Piotr O?arowski
 	* Don't refresh movie list while updating quick filter combos (backported from trunk)
 

Modified: branches/0.9.x/lib/add.py
===================================================================
--- branches/0.9.x/lib/add.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ branches/0.9.x/lib/add.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -511,7 +511,7 @@
 		fields_to_fetch = [ i for i in fields_to_fetch if details[i] is None ]
 	self.movie.fields_to_fetch = fields_to_fetch
 	
-	self.movie.open_page(w['window'])
+	self.movie.get_movie(w['window'])
 	self.movie.parse_movie()
 
 	if 'year' in fields_to_fetch:
@@ -612,7 +612,7 @@
 				self.search_movie.title = gutils.remove_accents(title, 'utf-8')
 			else:
 				self.search_movie.title = unicode(title, 'utf-8')
-		self.search_movie.search(self.widgets['add']['window'])
+		self.search_movie.search_movies(self.widgets['add']['window'])
 		self.search_movie.get_searches()
 		if len(self.search_movie.ids) == 1 and o_title and title:
 			self.search_movie.url = self.search_movie.translated_url_search
@@ -620,7 +620,7 @@
 				self.search_movie.title = gutils.remove_accents(title, 'utf-8')
 			else:
 				self.search_movie.title = unicode(title, 'utf-8')
-			self.search_movie.search(self.widgets['add']['window'])
+			self.search_movie.search_movies(self.widgets['add']['window'])
 			self.search_movie.get_searches()
 		self.show_search_results(self.search_movie)
 	else:

Modified: branches/0.9.x/lib/movie.py
===================================================================
--- branches/0.9.x/lib/movie.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ branches/0.9.x/lib/movie.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -66,7 +66,8 @@
 	image_url = None
 	encode = 'iso-8859-1'
 	fields_to_fetch = []
-	
+	progress = None
+
 	# functions that plugin should implement: {{{
 	def initialize(self):
 		pass
@@ -111,6 +112,24 @@
 	def __setitem__(self, key, value):
 		setattr(self,key,value)
 	
+	def get_movie(self, parent_window=None):
+		try:
+			#
+			# initialize the progress dialog once for the following loading process
+			#
+			if self.progress is None:
+				self.progress = Progress(parent_window)
+			self.progress.set_data(parent_window, _("Fetching data"), _("Wait a moment"), True)
+			#			
+			# get the page
+			#
+			self.open_page(parent_window)
+		except:
+			# close the dialog if an error occured
+			self.progress.hide()
+			# reraise the error
+			raise
+
 	def open_page(self, parent_window=None, url=None):
 		if url is None:
 			url_to_fetch = self.url
@@ -118,16 +137,15 @@
 			url_to_fetch = url
 		if parent_window is not None:
 			self.parent_window = parent_window
-		progress = Progress(self.parent_window,_("Fetching data"),_("Wait a moment"))
-		retriever = Retriever(url_to_fetch, self.parent_window,progress)
+		self.progress.set_data(parent_window, _("Fetching data"), _("Wait a moment"), False)
+		retriever = Retriever(url_to_fetch, self.parent_window, self.progress)
 		retriever.start()
 		while retriever.isAlive():
-			progress.pulse()
-			if progress.status:
+			self.progress.pulse()
+			if self.progress.status:
 				retriever.suspend()
 			while gtk.events_pending():
 				gtk.main_iteration()
-		progress.close()
 		try:
 			ifile = file(retriever.html[0], "rb")
 			data = ifile.read()
@@ -144,16 +162,15 @@
 			self.image = tmp_dest.split('poster_', 1)[1]
 			dest = "%s.jpg" % tmp_dest
 			try:
-				progress = Progress(self.parent_window,_("Fetching poster"),_("Wait a moment"))
-				retriever = Retriever(self.image_url,self.parent_window,progress,dest)
+				self.progress.set_data(self.parent_window, _("Fetching poster"), _("Wait a moment"), False)
+				retriever = Retriever(self.image_url, self.parent_window, self.progress, dest)
 				retriever.start()
 				while retriever.isAlive():
-					progress.pulse()
-					if progress.status:
+					self.progress.pulse()
+					if self.progress.status:
 						retriever.suspend()
 					while gtk.events_pending():
 						gtk.main_iteration()
-				progress.close()
 				urlcleanup()
 			except:
 				self.image = ""
@@ -165,54 +182,58 @@
 			self.image = ""
 
 	def parse_movie(self):
-		from copy import deepcopy
-		fields = deepcopy(self.fields_to_fetch)
+		try:
+			from copy import deepcopy
+			fields = deepcopy(self.fields_to_fetch)
 
-		self.initialize()
+			self.initialize()
 
-		if 'year' in fields:
-			self.get_year()
-			self.year = gutils.digits_only(self.year, 2100)
-			fields.pop(fields.index('year'))
-		if 'runtime' in fields:
-			self.get_runtime()
-			self.runtime = gutils.digits_only(self.runtime)
-			fields.pop(fields.index('runtime'))
-		if 'rating' in fields:
-			self.get_rating()
-			self.rating = gutils.digits_only(self.rating, 10)
-			fields.pop(fields.index('rating'))
-		if 'cast' in fields:
-			self.get_cast()
-			self.cast = gutils.clean(self.cast)
-			self.cast = gutils.gdecode(self.cast, self.encode)
-			fields.pop(fields.index('cast'))
-		if 'plot' in fields:
-			self.get_plot()
-			self.plot = gutils.clean(self.plot)
-			self.plot = gutils.gdecode(self.plot, self.encode)
-			fields.pop(fields.index('plot'))
-		if 'notes' in fields:
-			self.get_notes()
-			self.notes = gutils.clean(self.notes)
-			self.notes = gutils.gdecode(self.notes, self.encode)
-			fields.pop(fields.index('notes'))
-		if 'image' in fields:
-			self.get_image()
-			self.fetch_picture()
-			fields.pop(fields.index('image'))
+			if 'year' in fields:
+				self.get_year()
+				self.year = gutils.digits_only(self.year, 2100)
+				fields.pop(fields.index('year'))
+			if 'runtime' in fields:
+				self.get_runtime()
+				self.runtime = gutils.digits_only(self.runtime)
+				fields.pop(fields.index('runtime'))
+			if 'rating' in fields:
+				self.get_rating()
+				self.rating = gutils.digits_only(self.rating, 10)
+				fields.pop(fields.index('rating'))
+			if 'cast' in fields:
+				self.get_cast()
+				self.cast = gutils.clean(self.cast)
+				self.cast = gutils.gdecode(self.cast, self.encode)
+				fields.pop(fields.index('cast'))
+			if 'plot' in fields:
+				self.get_plot()
+				self.plot = gutils.clean(self.plot)
+				self.plot = gutils.gdecode(self.plot, self.encode)
+				fields.pop(fields.index('plot'))
+			if 'notes' in fields:
+				self.get_notes()
+				self.notes = gutils.clean(self.notes)
+				self.notes = gutils.gdecode(self.notes, self.encode)
+				fields.pop(fields.index('notes'))
+			if 'image' in fields:
+				self.get_image()
+				self.fetch_picture()
+				fields.pop(fields.index('image'))
 
-		for i in fields:
-			getattr(self, "get_%s" % i)()
-			self[i] = gutils.clean(self[i])
-			self[i] = gutils.gdecode(self[i], self.encode)
+			for i in fields:
+				getattr(self, "get_%s" % i)()
+				self[i] = gutils.clean(self[i])
+				self[i] = gutils.gdecode(self[i], self.encode)
 		
-		if 'o_title' in self.fields_to_fetch and self.o_title is not None:
-			if self.o_title[:4] == 'The ':
-				self.o_title = self.o_title[4:] + ', The'
-		if 'title' in self.fields_to_fetch and self.title is not None:
-			if self.title[:4] == 'The ':
-				self.title = self.title[4:] + ', The'
+			if 'o_title' in self.fields_to_fetch and self.o_title is not None:
+				if self.o_title[:4] == 'The ':
+					self.o_title = self.o_title[4:] + ', The'
+			if 'title' in self.fields_to_fetch and self.title is not None:
+				if self.title[:4] == 'The ':
+					self.title = self.title[4:] + ', The'
+		finally:
+			# close the progress dialog which was opened in get_movie
+			self.progress.hide()
 
 class SearchMovie:
 	page = None
@@ -226,10 +247,27 @@
 	elements = None
 	title = None
 	remove_accents = True
+	progress = None
 
 	def __init__(self):
 		pass
 
+	def search_movies(self,parent_window):
+		try:
+			#
+			# initialize the progress dialog once for the following search process
+			#
+			if self.progress is None:
+				self.progress = Progress(parent_window)
+			self.progress.set_data(parent_window, _("Searching"), _("Wait a moment"), True)
+			#			
+			# call the plugin specific search method
+			#
+			self.search(parent_window)
+		finally:
+			# dont forget to hide the progress dialog
+			self.progress.hide()
+
 	def open_search(self,parent_window):
 		self.titles = [""]
 		self.ids = [""]
@@ -238,20 +276,19 @@
 			self.url = string.replace(self.url, ' ', '%20')
 		else:
 			self.url = string.replace(self.url+self.title,' ','%20')
-		progress = Progress(parent_window,_("Searching"),_("Wait a moment"))
 		try:
 			url = self.url.encode(self.encode)
 		except UnicodeEncodeError:
 			url = self.url.encode('utf-8')
-		retriever = Retriever(url, parent_window, progress)
+		self.progress.set_data(parent_window, _("Searching"), _("Wait a moment"), False)
+		retriever = Retriever(url, parent_window, self.progress)
 		retriever.start()
 		while retriever.isAlive():
-			progress.pulse()
-			if progress.status:
+			self.progress.pulse()
+			if self.progress.status:
 				retriever.suspend()
 			while gtk.events_pending():
 				gtk.main_iteration()
-		progress.close()
 		try:
 			ifile = file(retriever.html[0], "rb")
 			self.page = ifile.read()
@@ -308,9 +345,10 @@
 	version = 'Mozilla/5.0 (Windows; U; Windows NT 6.0) Gecko/2008052906 Firefox/3.0'
 	
 class Progress:
-	def __init__(self, window, title, message):
+	def __init__(self, window, title = '', message = ''):
 		self.status = False
 		self.dialog = gtk.Dialog(title, window, gtk.DIALOG_MODAL, ())
+		self.dialog.set_urgency_hint(False)
 		self.label = gtk.Label()
 		self.label.set_markup(message)
 		self.dialog.vbox.pack_start(self.label)
@@ -329,4 +367,12 @@
 		time.sleep(0.01)
 	def close(self):
 		self.dialog.destroy()
+	def hide(self):
+		self.dialog.hide()
+	def set_data(self, parent_window, title, message, showit):
+		#self.dialog.set_parent(parent_window)
+		self.dialog.set_title(title)
+		self.label.set_markup(message)
+		if showit == True:
+			self.dialog.show()
 # vim: fdm=marker

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -52,7 +52,6 @@
 		# dont use base functionality
 		# use the Amazon Web API
 		self.parent_window = parent_window
-		progress = movie.Progress(parent_window,_('Searching'),_('Wait a moment'))
 		try:
 			locale = self.config.get('amazon_locale', 0, section='add')
 			if locale == '1':
@@ -67,20 +66,20 @@
 				locale = 'jp'
 			else:
 				locale = None
-			retriever = AmazonRetriever(self.movie_id, locale, parent_window, progress, self.debug, 'Get')
+			retriever = AmazonRetriever(self.movie_id, locale, parent_window, self.progress, self.debug, 'Get')
 			retriever.start()
 			while retriever.isAlive():
-				progress.pulse()
+				self.progress.pulse()
 				while gtk.events_pending():
 					gtk.main_iteration()
 			self.page = retriever.result.Item
 		except:
+			self.page = ''
 			try:
 				self.debug.show("Error retrieving results from amazon.")
 				self.debug.show(retriever.result.Request.Errors.Error.Message)
 			except:
 				pass
-		progress.close()
 		return self.page
 
 	def get_image(self):
@@ -228,7 +227,6 @@
 		# use the Amazon Web API
 		self.titles = [""]
 		self.ids = [""]
-		progress = movie.Progress(parent_window,_('Searching'),_('Wait a moment'))
 		try:
 			locale = self.config.get('amazon_locale', 0, section='add')
 			if locale == '1':
@@ -243,10 +241,10 @@
 				locale = 'jp'
 			else:
 				locale = None
-			retriever = AmazonRetriever(self.title.encode('iso8859-1'), locale, parent_window, progress, self.debug)
+			retriever = AmazonRetriever(self.title.encode('iso8859-1'), locale, parent_window, self.progress, self.debug)
 			retriever.start()
 			while retriever.isAlive():
-				progress.pulse()
+				self.progress.pulse()
 				while gtk.events_pending():
 					gtk.main_iteration()
 			self.page = retriever.result
@@ -256,7 +254,6 @@
 				self.debug.show(retriever.result.Request.Errors.Error.Message)
 			except:
 				pass
-		progress.close()
 		return self.page
 
 	def get_searches(self):

Modified: branches/0.9.x/lib/test_movieplugins.py
===================================================================
--- branches/0.9.x/lib/test_movieplugins.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ branches/0.9.x/lib/test_movieplugins.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -85,7 +85,7 @@
 			plugin.title = gutils.remove_accents(title, 'utf-8')
 		else:
 			plugin.title = title
-		plugin.search(None)
+		plugin.search_movies(None)
 		plugin.get_searches()
 		if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
 			print "Title (Translated): %s - expected: %d - found: %d" % (title, cntOriginal, len(plugin.ids) - 1)
@@ -96,7 +96,7 @@
 			plugin.title = gutils.remove_accents(title, 'utf-8')
 		else:
 			plugin.title = title
-		plugin.search(None)
+		plugin.search_movies(None)
 		plugin.get_searches()
 		if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
 			print "Title (Original): %s - expected: %d - found: %d" % (title, cntTranslated, len(plugin.ids) - 1)
@@ -150,7 +150,7 @@
 
 		self.movie.fields_to_fetch = fields_to_fetch
 	
-		self.movie.open_page(None)
+		self.movie.get_movie(None)
 		self.movie.parse_movie()
 
 		results = {}

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-26 10:27:18 UTC (rev 1020)
+++ trunk/ChangeLog	2008-10-26 21:28:32 UTC (rev 1021)
@@ -5,6 +5,9 @@
 (c) 2005-2008  Vasco Nunes, Piotr O?arowski
 
 
+2008-10-26  Michael Jahn
+	* [#179618] During "Get from Web ", griffith window keeps stealing focus
+
 2008-10-23  Michael Jahn
 	* PDF export: disabled movie grouping if movie list is not sorted by title or original title
 	* [#258817] The application doesn't save volume

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ trunk/lib/add.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -193,7 +193,7 @@
         fields_to_fetch = [ i for i in fields_to_fetch if details[i] is None ]
     self.movie.fields_to_fetch = fields_to_fetch
     
-    self.movie.open_page(w['window'])
+    self.movie.get_movie(w['window'])
     self.movie.parse_movie()
 
     if 'year' in fields_to_fetch:
@@ -295,7 +295,7 @@
                 self.search_movie.title = gutils.remove_accents(title, 'utf-8')
             else:
                 self.search_movie.title = unicode(title, 'utf-8')
-        self.search_movie.search(self.widgets['add']['window'])
+        self.search_movie.search_movies(self.widgets['add']['window'])
         self.search_movie.get_searches()
         if len(self.search_movie.ids) == 1 and o_title and title:
             self.search_movie.url = self.search_movie.translated_url_search
@@ -303,7 +303,7 @@
                 self.search_movie.title = gutils.remove_accents(title, 'utf-8')
             else:
                 self.search_movie.title = unicode(title, 'utf-8')
-            self.search_movie.search(self.widgets['add']['window'])
+            self.search_movie.search_movies(self.widgets['add']['window'])
             self.search_movie.get_searches()
         self.show_search_results(self.search_movie)
     else:

Modified: trunk/lib/movie.py
===================================================================
--- trunk/lib/movie.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ trunk/lib/movie.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -69,6 +69,7 @@
     image_url = None
     encode = 'iso-8859-1'
     fields_to_fetch = []
+    progress = None
     
     # functions that plugin should implement: {{{
     def initialize(self):
@@ -114,6 +115,24 @@
     def __setitem__(self, key, value):
         setattr(self,key,value)
     
+    def get_movie(self, parent_window=None):
+        try:
+            #
+            # initialize the progress dialog once for the following loading process
+            #
+            if self.progress is None:
+                self.progress = Progress(parent_window)
+            self.progress.set_data(parent_window, _("Fetching data"), _("Wait a moment"), True)
+            #			
+            # get the page
+            #
+            self.open_page(parent_window)
+        except:
+            # close the dialog if an error occured
+            self.progress.hide()
+            # reraise the error
+            raise
+
     def open_page(self, parent_window=None, url=None):
         if url is None:
             url_to_fetch = self.url
@@ -121,16 +140,15 @@
             url_to_fetch = url
         if parent_window is not None:
             self.parent_window = parent_window
-        progress = Progress(self.parent_window,_("Fetching data"),_("Wait a moment"))
-        retriever = Retriever(url_to_fetch, self.parent_window,progress)
+        self.progress.set_data(parent_window, _("Fetching data"), _("Wait a moment"), False)
+        retriever = Retriever(url_to_fetch, self.parent_window, self.progress)
         retriever.start()
         while retriever.isAlive():
-            progress.pulse()
-            if progress.status:
+            self.progress.pulse()
+            if self.progress.status:
                 retriever.suspend()
             while gtk.events_pending():
                 gtk.main_iteration()
-        progress.close()
         try:
             ifile = file(retriever.html[0], "rb")
             data = ifile.read()
@@ -147,16 +165,15 @@
             self.image = tmp_dest.split('poster_', 1)[1]
             dest = "%s.jpg" % tmp_dest
             try:
-                progress = Progress(self.parent_window,_("Fetching poster"),_("Wait a moment"))
-                retriever = Retriever(self.image_url,self.parent_window,progress,dest)
+                self.progress.set_data(self.parent_window, _("Fetching poster"), _("Wait a moment"), False)
+                retriever = Retriever(self.image_url, self.parent_window, self.progress, dest)
                 retriever.start()
                 while retriever.isAlive():
-                    progress.pulse()
-                    if progress.status:
+                    self.progress.pulse()
+                    if self.progress.status:
                         retriever.suspend()
                     while gtk.events_pending():
                         gtk.main_iteration()
-                progress.close()
                 urlcleanup()
             except:
                 self.image = ""
@@ -168,54 +185,58 @@
             self.image = ""
 
     def parse_movie(self):
-        from copy import deepcopy
-        fields = deepcopy(self.fields_to_fetch)
+        try:
+            from copy import deepcopy
+            fields = deepcopy(self.fields_to_fetch)
 
-        self.initialize()
+            self.initialize()
 
-        if 'year' in fields:
-            self.get_year()
-            self.year = gutils.digits_only(self.year, 2100)
-            fields.pop(fields.index('year'))
-        if 'runtime' in fields:
-            self.get_runtime()
-            self.runtime = gutils.digits_only(self.runtime)
-            fields.pop(fields.index('runtime'))
-        if 'rating' in fields:
-            self.get_rating()
-            self.rating = gutils.digits_only(self.rating, 10)
-            fields.pop(fields.index('rating'))
-        if 'cast' in fields:
-            self.get_cast()
-            self.cast = gutils.clean(self.cast)
-            self.cast = gutils.gdecode(self.cast, self.encode)
-            fields.pop(fields.index('cast'))
-        if 'plot' in fields:
-            self.get_plot()
-            self.plot = gutils.clean(self.plot)
-            self.plot = gutils.gdecode(self.plot, self.encode)
-            fields.pop(fields.index('plot'))
-        if 'notes' in fields:
-            self.get_notes()
-            self.notes = gutils.clean(self.notes)
-            self.notes = gutils.gdecode(self.notes, self.encode)
-            fields.pop(fields.index('notes'))
-        if 'image' in fields:
-            self.get_image()
-            self.fetch_picture()
-            fields.pop(fields.index('image'))
+            if 'year' in fields:
+                self.get_year()
+                self.year = gutils.digits_only(self.year, 2100)
+                fields.pop(fields.index('year'))
+            if 'runtime' in fields:
+                self.get_runtime()
+                self.runtime = gutils.digits_only(self.runtime)
+                fields.pop(fields.index('runtime'))
+            if 'rating' in fields:
+                self.get_rating()
+                self.rating = gutils.digits_only(self.rating, 10)
+                fields.pop(fields.index('rating'))
+            if 'cast' in fields:
+                self.get_cast()
+                self.cast = gutils.clean(self.cast)
+                self.cast = gutils.gdecode(self.cast, self.encode)
+                fields.pop(fields.index('cast'))
+            if 'plot' in fields:
+                self.get_plot()
+                self.plot = gutils.clean(self.plot)
+                self.plot = gutils.gdecode(self.plot, self.encode)
+                fields.pop(fields.index('plot'))
+            if 'notes' in fields:
+                self.get_notes()
+                self.notes = gutils.clean(self.notes)
+                self.notes = gutils.gdecode(self.notes, self.encode)
+                fields.pop(fields.index('notes'))
+            if 'image' in fields:
+                self.get_image()
+                self.fetch_picture()
+                fields.pop(fields.index('image'))
 
-        for i in fields:
-            getattr(self, "get_%s" % i)()
-            self[i] = gutils.clean(self[i])
-            self[i] = gutils.gdecode(self[i], self.encode)
+            for i in fields:
+                getattr(self, "get_%s" % i)()
+                self[i] = gutils.clean(self[i])
+                self[i] = gutils.gdecode(self[i], self.encode)
         
-        if 'o_title' in self.fields_to_fetch and self.o_title is not None:
-            if self.o_title[:4] == 'The ':
-                self.o_title = self.o_title[4:] + ', The'
-        if 'title' in self.fields_to_fetch and self.title is not None:
-            if self.title[:4] == 'The ':
-                self.title = self.title[4:] + ', The'
+            if 'o_title' in self.fields_to_fetch and self.o_title is not None:
+                if self.o_title[:4] == 'The ':
+                    self.o_title = self.o_title[4:] + ', The'
+            if 'title' in self.fields_to_fetch and self.title is not None:
+                if self.title[:4] == 'The ':
+                    self.title = self.title[4:] + ', The'
+		finally:
+			# close the progress dialog which was opened in get_movie
+			self.progress.hide()
 
 class SearchMovie:
     page = None
@@ -229,10 +250,27 @@
     elements = None
     title = None
     remove_accents = True
+    progress = None
 
     def __init__(self):
         pass
 
+    def search_movies(self,parent_window):
+        try:
+            #
+            # initialize the progress dialog once for the following search process
+            #
+            if self.progress is None:
+                self.progress = Progress(parent_window)
+            self.progress.set_data(parent_window, _("Searching"), _("Wait a moment"), True)
+            #			
+            # call the plugin specific search method
+            #
+            self.search(parent_window)
+        finally:
+            # dont forget to hide the progress dialog
+            self.progress.hide()
+
     def open_search(self,parent_window):
         self.titles = [""]
         self.ids = [""]
@@ -241,20 +279,19 @@
             self.url = string.replace(self.url, ' ', '%20')
         else:
             self.url = string.replace(self.url+self.title,' ','%20')
-        progress = Progress(parent_window,_("Searching"),_("Wait a moment"))
         try:
             url = self.url.encode(self.encode)
         except UnicodeEncodeError:
             url = self.url.encode('utf-8')
-        retriever = Retriever(url, parent_window, progress)
+        self.progress.set_data(parent_window, _("Searching"), _("Wait a moment"), False)
+        retriever = Retriever(url, parent_window, self.progress)
         retriever.start()
         while retriever.isAlive():
-            progress.pulse()
-            if progress.status:
+            self.progress.pulse()
+            if self.progress.status:
                 retriever.suspend()
             while gtk.events_pending():
                 gtk.main_iteration()
-        progress.close()
         try:
             ifile = file(retriever.html[0], "rb")
             self.page = ifile.read()
@@ -311,9 +348,10 @@
     version = 'Mozilla/5.0 (Windows; U; Windows NT 6.0) Gecko/2008052906 Firefox/3.0'
     
 class Progress:
-    def __init__(self, window, title, message):
+    def __init__(self, window, title = '', message = ''):
         self.status = False
         self.dialog = gtk.Dialog(title, window, gtk.DIALOG_MODAL, ())
+        self.dialog.set_urgency_hint(False)
         self.label = gtk.Label()
         self.label.set_markup(message)
         self.dialog.vbox.pack_start(self.label)
@@ -332,4 +370,12 @@
         time.sleep(0.01)
     def close(self):
         self.dialog.destroy()
+    def hide(self):
+        self.dialog.hide()
+    def set_data(self, parent_window, title, message, showit):
+        #self.dialog.set_parent(parent_window)
+        self.dialog.set_title(title)
+        self.label.set_markup(message)
+        if showit == True:
+            self.dialog.show()
 # vim: fdm=marker

Modified: trunk/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -53,7 +53,6 @@
         # dont use base functionality
         # use the Amazon Web API
         self.parent_window = parent_window
-        progress = movie.Progress(parent_window,_('Searching'),_('Wait a moment'))
         try:
             locale = self.config.get('amazon_locale', 0, section='add')
             if locale == '1':
@@ -68,20 +67,20 @@
                 locale = 'jp'
             else:
                 locale = None
-            retriever = AmazonRetriever(self.movie_id, locale, parent_window, progress, 'Get')
+            retriever = AmazonRetriever(self.movie_id, locale, parent_window, self.progress, 'Get')
             retriever.start()
             while retriever.isAlive():
-                progress.pulse()
+                self.progress.pulse()
                 while gtk.events_pending():
                     gtk.main_iteration()
             self.page = retriever.result.Item
         except:
+            self.page = ''
             try:
                 log.error("Error retrieving results from amazon.")
                 log.error(retriever.result.Request.Errors.Error.Message)
             except:
                 pass
-        progress.close()
         return self.page
 
     def get_image(self):
@@ -229,7 +228,6 @@
         # use the Amazon Web API
         self.titles = [""]
         self.ids = [""]
-        progress = movie.Progress(parent_window,_('Searching'),_('Wait a moment'))
         try:
             locale = self.config.get('amazon_locale', 0, section='add')
             if locale == '1':
@@ -244,10 +242,10 @@
                 locale = 'jp'
             else:
                 locale = None
-            retriever = AmazonRetriever(self.title.encode('iso8859-1'), locale, parent_window, progress)
+            retriever = AmazonRetriever(self.title.encode('iso8859-1'), locale, parent_window, self.progress)
             retriever.start()
             while retriever.isAlive():
-                progress.pulse()
+                self.progress.pulse()
                 while gtk.events_pending():
                     gtk.main_iteration()
             self.page = retriever.result
@@ -257,7 +255,6 @@
                 log.error(retriever.result.Request.Errors.Error.Message)
             except:
                 pass
-        progress.close()
         return self.page
 
     def get_searches(self):

Modified: trunk/lib/test_movieplugins.py
===================================================================
--- trunk/lib/test_movieplugins.py	2008-10-26 10:27:18 UTC (rev 1020)
+++ trunk/lib/test_movieplugins.py	2008-10-26 21:28:32 UTC (rev 1021)
@@ -83,7 +83,7 @@
             plugin.title = gutils.remove_accents(title, 'utf-8')
         else:
             plugin.title = title
-        plugin.search(None)
+        plugin.search_movies(None)
         plugin.get_searches()
         if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
             print "Title (Translated): %s - expected: %d - found: %d" % (title, cntOriginal, len(plugin.ids) - 1)
@@ -94,7 +94,7 @@
             plugin.title = gutils.remove_accents(title, 'utf-8')
         else:
             plugin.title = title
-        plugin.search(None)
+        plugin.search_movies(None)
         plugin.get_searches()
         if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
             print "Title (Original): %s - expected: %d - found: %d" % (title, cntTranslated, len(plugin.ids) - 1)
@@ -147,7 +147,7 @@
 
         self.movie.fields_to_fetch = fields_to_fetch
     
-        self.movie.open_page(None)
+        self.movie.get_movie(None)
         self.movie.parse_movie()
 
         results = {}



From piotrek at mail.berlios.de  Mon Oct 27 22:34:46 2008
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Mon, 27 Oct 2008 22:34:46 +0100
Subject: [Griffith-svn] r1022 - in trunk/lib: . plugins/movie
Message-ID: <200810272134.m9RLYk96022711@sheep.berlios.de>

Author: piotrek
Date: 2008-10-27 22:34:45 +0100 (Mon, 27 Oct 2008)
New Revision: 1022

Modified:
   trunk/lib/advfilter.py
   trunk/lib/movie.py
   trunk/lib/plugins/movie/PluginMovieFDb.py
   trunk/lib/plugins/movie/PluginMovieStopklatka.py
   trunk/lib/test_movieplugins.py
Log:
replace few tabs with spaces


Modified: trunk/lib/advfilter.py
===================================================================
--- trunk/lib/advfilter.py	2008-10-26 21:28:32 UTC (rev 1021)
+++ trunk/lib/advfilter.py	2008-10-27 21:34:45 UTC (rev 1022)
@@ -40,8 +40,8 @@
     'tags'            : set(), # list of tag_ids        (search for movies with these tags)
     'no_tags'         : set(), # list of tag_ids        (search for movies without these tags)
     'required_tags'   : set(), # like in tags, but movie must contain all listed tags
-    'loaned_to'       : set(), # list of person_ids	    (search for movies loaned to these people)
-    'loan_history'    : set(), # list of person_ids	    (search for movies which were loaned by these people)
+    'loaned_to'       : set(), # list of person_ids     (search for movies loaned to these people)
+    'loan_history'    : set(), # list of person_ids     (search for movies which were loaned by these people)
     'sort_by'         : set(("number",)), # "number DESC"
     'equals'          : {}, # {column1: set(value1, value2), column2: set(value3)}
     'equals_n'        : {}, # see above

Modified: trunk/lib/movie.py
===================================================================
--- trunk/lib/movie.py	2008-10-26 21:28:32 UTC (rev 1021)
+++ trunk/lib/movie.py	2008-10-27 21:34:45 UTC (rev 1022)
@@ -123,7 +123,7 @@
             if self.progress is None:
                 self.progress = Progress(parent_window)
             self.progress.set_data(parent_window, _("Fetching data"), _("Wait a moment"), True)
-            #			
+            #            
             # get the page
             #
             self.open_page(parent_window)
@@ -234,9 +234,9 @@
             if 'title' in self.fields_to_fetch and self.title is not None:
                 if self.title[:4] == 'The ':
                     self.title = self.title[4:] + ', The'
-		finally:
-			# close the progress dialog which was opened in get_movie
-			self.progress.hide()
+        finally:
+            # close the progress dialog which was opened in get_movie
+            self.progress.hide()
 
 class SearchMovie:
     page = None
@@ -263,7 +263,7 @@
             if self.progress is None:
                 self.progress = Progress(parent_window)
             self.progress.set_data(parent_window, _("Searching"), _("Wait a moment"), True)
-            #			
+            #            
             # call the plugin specific search method
             #
             self.search(parent_window)

Modified: trunk/lib/plugins/movie/PluginMovieFDb.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieFDb.py	2008-10-26 21:28:32 UTC (rev 1021)
+++ trunk/lib/plugins/movie/PluginMovieFDb.py	2008-10-27 21:34:45 UTC (rev 1022)
@@ -90,26 +90,26 @@
 
     def get_runtime(self):
         self.runtime = gutils.trim(self.page,'Czas trwania</h4>','</div>')
-	self.runtime = gutils.trim(self.runtime,'<li>',' minut')
+        self.runtime = gutils.trim(self.runtime,'<li>',' minut')
 
     def get_genre(self):
         self.genre = gutils.trim(self.page,'Gatunek</h4>','</div>')
-	self.genre = gutils.trim(self.genre,'<li>','</li>')
-	self.genre = string.replace(self.genre, ' / ', ' | ')
+        self.genre = gutils.trim(self.genre,'<li>','</li>')
+        self.genre = string.replace(self.genre, ' / ', ' | ')
 
     def get_cast(self):
         self.cast = gutils.trim(self.page,'Obsada</h3>','</div>')
-	self.cast = gutils.trim(self.cast,"<table>\n",'  </table>')
-	if self.cast != '':
-	    self.cast = gutils.strip_tags(self.cast)
-	    self.cast = self.cast.replace("      ","")
-	    self.cast = self.cast.replace("    ","")
-	    self.cast = self.cast.replace("\n...\n\n  ",_(' as '))
-	    self.cast = self.cast.replace("\n\n\n\n\n","")
+        self.cast = gutils.trim(self.cast,"<table>\n",'  </table>')
+        if self.cast != '':
+            self.cast = gutils.strip_tags(self.cast)
+            self.cast = self.cast.replace("      ","")
+            self.cast = self.cast.replace("    ","")
+            self.cast = self.cast.replace("\n...\n\n  ",_(' as '))
+            self.cast = self.cast.replace("\n\n\n\n\n","")
 
     def get_classification(self):
         self.classification = gutils.trim(self.page,"Od lat</h4>","</div>")
-	self.classification = gutils.trim(self.classification,'<li>','</li>')
+        self.classification = gutils.trim(self.classification,'<li>','</li>')
 
     def get_studio(self):
         self.studio = ''
@@ -127,7 +127,7 @@
 
     def get_country(self):
         self.country = gutils.trim(self.page,'Kraj produkcji</h4>','</div>')
-	self.country = gutils.trim(self.country,'<li>','</li>')
+        self.country = gutils.trim(self.country,'<li>','</li>')
 
     def get_rating(self):
         self.rating = gutils.trim(self.page, 'class="vote"','</strong>')

Modified: trunk/lib/plugins/movie/PluginMovieStopklatka.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieStopklatka.py	2008-10-26 21:28:32 UTC (rev 1021)
+++ trunk/lib/plugins/movie/PluginMovieStopklatka.py	2008-10-27 21:34:45 UTC (rev 1022)
@@ -47,7 +47,7 @@
         self.page = self.page.replace('?','?')
         self.res = re.findall("""</td><td class="middle_cell"><span class="bold">(.*?)</span>, <span class="bold">(.*?)</span>, <span class="bold">(.*?)</span>, <span class="bold">(.*?) min</span>""", self.page)
         if len(self.res) == 0:
-	    self.res = [( '','','','' )]
+            self.res = [( '','','','' )]
 
     def get_image(self):
         image = self.IMAGE_PATTERN.findall(self.page)

Modified: trunk/lib/test_movieplugins.py
===================================================================
--- trunk/lib/test_movieplugins.py	2008-10-26 21:28:32 UTC (rev 1021)
+++ trunk/lib/test_movieplugins.py	2008-10-27 21:34:45 UTC (rev 1022)
@@ -85,7 +85,7 @@
             plugin.title = title
         plugin.search_movies(None)
         plugin.get_searches()
-        if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
+        if not len(plugin.ids) - 1 == cntOriginal:    # first entry is always '' (???)
             print "Title (Translated): %s - expected: %d - found: %d" % (title, cntOriginal, len(plugin.ids) - 1)
             result = False
         # plugin.original_url_search
@@ -96,7 +96,7 @@
             plugin.title = title
         plugin.search_movies(None)
         plugin.get_searches()
-        if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
+        if not len(plugin.ids) - 1 == cntTranslated:    # first entry is always '' (???)
             print "Title (Original): %s - expected: %d - found: %d" % (title, cntTranslated, len(plugin.ids) - 1)
             result = False
         return result



From mikej06 at mail.berlios.de  Thu Oct 30 11:54:46 2008
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Thu, 30 Oct 2008 11:54:46 +0100
Subject: [Griffith-svn] r1023 - extra_artwork/images
Message-ID: <200810301054.m9UAskTP029220@sheep.berlios.de>

Author: mikej06
Date: 2008-10-30 11:54:36 +0100 (Thu, 30 Oct 2008)
New Revision: 1023

Added:
   extra_artwork/images/PluginMovieAmazon.png
Log:
added image for amazon plugin

Added: extra_artwork/images/PluginMovieAmazon.png
===================================================================
(Binary files differ)


Property changes on: extra_artwork/images/PluginMovieAmazon.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



