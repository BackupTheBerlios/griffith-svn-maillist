From piotrek at mail.berlios.de  Mon Aug  3 22:28:46 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Mon, 3 Aug 2009 22:28:46 +0200
Subject: [Griffith-svn] r1271 - in trunk: . debian lib
Message-ID: <200908032028.n73KSkpQ027968@sheep.berlios.de>

Author: piotrek
Date: 2009-08-03 22:28:46 +0200 (Mon, 03 Aug 2009)
New Revision: 1271

Modified:
   trunk/ChangeLog
   trunk/NEWS
   trunk/debian/changelog
   trunk/lib/version.py
   trunk/winpackage.iss
   trunk/winsetup.py
Log:
version changed to 0.10


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/ChangeLog	2009-08-03 20:28:46 UTC (rev 1271)
@@ -5,6 +5,11 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+---- 0.10 ----
+
+2009-08-03  Piotr O?arowski
+	* Releasing 0.10
+
 2009-07-13  Piotr O?arowski
 	* Version changed to 0.10-rc1+svn
 	* Filtering Volumes/Collections by loaned flag fixed

Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/NEWS	2009-08-03 20:28:46 UTC (rev 1271)
@@ -1,3 +1,8 @@
+Griffith 0.10
+=============
+* Almost unchanged release candidate 1
+
+
 Griffith 0.10-rc1
 =================
 * New export plugins: Ant Movie Catalog, GCstar, DVD Profiler XML Export V2 and V3

Modified: trunk/debian/changelog
===================================================================
--- trunk/debian/changelog	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/debian/changelog	2009-08-03 20:28:46 UTC (rev 1271)
@@ -1,3 +1,9 @@
+griffith (0.10-1) unstable; urgency=low
+
+  * New upstream release
+
+ -- Piotr O?arowski <piotr at debian.org>  Mon, 03 Aug 2009 22:27:02 +0200
+
 griffith (0.10~rc1-1) unstable; urgency=low
 
   * New upstream release

Modified: trunk/lib/version.py
===================================================================
--- trunk/lib/version.py	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/lib/version.py	2009-08-03 20:28:46 UTC (rev 1271)
@@ -22,7 +22,7 @@
 # GNU General Public License, version 2 or later
 
 pname        = "Griffith"
-pversion     = "0.10-rc1+svn"
+pversion     = "0.10"
 pauthor      = "Vasco Nunes, Piotr O?arowski <griffith-private at lists.berlios.de>"
 pyear        = "2005-2009"
 pwebsite     = "http://www.griffith.cc/"

Modified: trunk/winpackage.iss
===================================================================
--- trunk/winpackage.iss	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/winpackage.iss	2009-08-03 20:28:46 UTC (rev 1271)
@@ -3,7 +3,7 @@
 
 [Setup]
 AppName=Griffith
-AppVerName=Griffith 0.10-rc1
+AppVerName=Griffith 0.10
 AppPublisher=Vasco Nunes, Piotr O?arowski
 AppPublisherURL=http://griffith.cc/
 AppSupportURL=http://griffith.cc/
@@ -14,7 +14,7 @@
 LicenseFile=COPYING
 InfoAfterFile=README
 OutputDir=installer
-OutputBaseFilename=griffith-0.10-rc1-win32
+OutputBaseFilename=griffith-0.10-win32
 SetupIconFile=images\griffith.ico
 Compression=lzma
 SolidCompression=true
@@ -22,8 +22,8 @@
 InternalCompressLevel=ultra
 AppCopyright=Vasco Nunes/Piotr Ozarowski
 DisableStartupPrompt=false
-AppVersion=0.10-rc1
-VersionInfoVersion=0.10.2
+AppVersion=0.10
+VersionInfoVersion=0.10.3
 
 [Languages]
 Name: eng; MessagesFile: compiler:Default.isl

Modified: trunk/winsetup.py
===================================================================
--- trunk/winsetup.py	2009-07-14 20:44:57 UTC (rev 1270)
+++ trunk/winsetup.py	2009-08-03 20:28:46 UTC (rev 1271)
@@ -53,7 +53,7 @@
 
 setup(
     name = "Griffith",
-    version = "0.10-rc1",
+    version = "0.10",
     description = 'Griffith - A film manager',
     author = 'Vasco Nunes/Piotr Ozarowski',
     author_email = 'griffith-private at lists.berlios.de',



From piotrek at mail.berlios.de  Mon Aug  3 23:50:35 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Mon, 3 Aug 2009 23:50:35 +0200
Subject: [Griffith-svn] r1272 - in tags: . 0.10 0.10/debian 0.10/lib
Message-ID: <200908032150.n73LoZVf004942@sheep.berlios.de>

Author: piotrek
Date: 2009-08-03 23:50:32 +0200 (Mon, 03 Aug 2009)
New Revision: 1272

Added:
   tags/0.10/
   tags/0.10/ChangeLog
   tags/0.10/NEWS
   tags/0.10/debian/changelog
   tags/0.10/lib/version.py
   tags/0.10/winpackage.iss
   tags/0.10/winsetup.py
Removed:
   tags/0.10/ChangeLog
   tags/0.10/NEWS
   tags/0.10/debian/changelog
   tags/0.10/lib/version.py
   tags/0.10/winpackage.iss
   tags/0.10/winsetup.py
Log:
tagging 0.10


Copied: tags/0.10 (from rev 1270, trunk)

Deleted: tags/0.10/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/ChangeLog	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,1899 +0,0 @@
-# $Id$ vim: ts=4
-
-Griffith ChangeLog
-------------------
-(c) 2005-2009  Vasco Nunes, Piotr O?arowski
-
-
-2009-07-13  Piotr O?arowski
-	* Version changed to 0.10-rc1+svn
-	* Filtering Volumes/Collections by loaned flag fixed
-
----- 0.10-rc1 ----
-
-2009-07-12  Piotr O?arowski
-	* Loaning collections with lots of movies inside will work faster now
-	* AniDB movie plugin updated (thanks to nickpick)
-	* Translation files synchronized with Rosetta
-
-2009-07-10  Michael Jahn
-	* new export plugins: Ant Movie Catalog, GCstar, DVD Profiler XML Export V2 and V3
-
-2009-07-07  Michael Jahn
-	* updated Allocine, CineMovies, IMDb-de, MovieMeter, Zelluloid plugin
-
-2009-07-06  Piotr O?arowski
-	* Reorganize ORM stuff file structure (db module moved to db package)
-
-2009-07-05  Piotr O?arowski
-	* Use SQLAlchemy's PickleType to store search conditions
-	  (old rules are removed without warning - beta version privilege ;)
-	* Remove ilike from search criteria
-	* Update current value of sequence after restoring data from backup in
-	  PostgreSQL
-	* Loan details and history added to the movie db model
-
-2009-07-04  Piotr O?arowski
-	* Version changed to 0.10-beta3+svn
-	* [#305123] If Region 0 (no region data) is selected, save "0" in
-	  database otherwise default region will be used
-	* Mail content can be translated again (gettext issue fixed)
-	* [#269865] Don't change movie plugin selection after adding a movie
-	* Rollback all pending operations before creating new database
-	* Poster window (if visible) is updated along with current movie change
-
-2009-07-03  Michael Jahn
-	* updated IMDb plugin
-	* added Ant Movie Catalog import plugin
-
----- 0.10-beta3 ----
-
-2009-06-11  Piotr O?arowski
-	* Don't try to open advfilter window if it's already opened
-	* Add "Full screen" switch in View menu
-	* Add "Open search window" in Tools menu
-	* Add "Select database" in File menu (shortcut to preferences page)
-	* Close poster viewer window if poster button clicked again
-	* Add suggestions for database names (taken from .db file names)
-	* Translation files synchronized with Rosetta
-	* Releasing 0.10-beta3
-
-2009-06-10  Piotr O?arowski
-	* Restoring from backup finally works with external databases
-	* Don't save full paths in backups
-	* Backup from MySQL fixed
-
-2009-06-08  Piotr O?arowski
-	* Restoring from backup to PostgreSQL/MySQL partially works via merging
-
-2009-06-07  Piotr O?arowski
-	* Recognize more resolution aliases
-
-2009-05-24  Michael Jahn
-	* updated CineMovies, FilmAffinity, FilmDb, OFDb plugin
-	* added proxy support for MovieMeter plugin
-
-2009-05-18  Michael Jahn
-	* [#377417] URL contains non-ASCII characters
-
-2009-05-05  Michael Jahn
-	* added MovieMeter plugin
-
-2009-04-17  Michael Jahn
-	* updated FilmAffinity plugin
-	* updated Filmtipset plugin
-
-2009-04-16  Michael Jahn
-	* updated Culturalia plugin
-	* updated E-Pipoca plugin
-
-2009-04-15  Michael Jahn
-	* added data for automated tests of the IMDB plugin
-	* added data for automated tests of the CineMovies plugin
-	* updated CineMovies plugin
-	* updated Cineteka plugin
-	* updated FilmDb plugin
-
-2009-04-08  Michael Jahn
-	* added AllMovie plugin
-
-2009-04-06  Michael Jahn
-	* [#348226] DVD Empire lookup problem
-
-2009-04-05  Michael Jahn
-	* [#269907] PluginMovieFilmDb.py: list index out of range
-	  and complete update of the plugin with test data
-
-2009-04-02  Michael Jahn
-	* IMDB-de plugin updated
-
-2009-03-29  Michael Jahn
-	* [#224546] Plot isn't being pulled from IMDB for some movies
-	* [#341826] "Country" field from IMDB contains newlines
-
-2009-03-10  Michael Jahn
-	* [#337758] 'Titel' and 'Original Titel' get the same content
-	  (IMDb-de plugin updated)
-	* added HD DVD and Blu-ray to the medium table for new databases
-
-2009-03-03  Michael Jahn
-	* Cinematografo movie plugin updated
-
-2009-02-28  Michael Jahn
-	* screenplay, cameraman, resolution and barcode added to Search-For
-	  section in preferences
-
-2009-02-24  Michael Jahn
-	* Amazon posters: removing of temporary files fixed
-
-2009-02-12  Piotr O?arowski
-	* Add new default tag: "Buy me"
-
-2009-02-11  Piotr O?arowski
-	* Version changed to 0.10-beta3~svn
-	* Backup function fixed
-	* PostgreSQL/MySQL backup support added
-
----- 0.10-beta2 ----
-
-2009-02-10  Piotr O?arowski
-	* Fix upgrading from v2 to v4 (columns that are not available yet, are not
-	  used)
-	* Releasing 0.10-beta2
-
-2009-02-07  Michael Jahn
-	* CineMovies movie plugin updated
-
-2009-02-05  Michael Jahn
-	* AniDB movie plugin updated
-
-2009-02-01  Piotr O?arowski
-	* Add interactive shell (--shell commandline option)
-	* Add barcode column to the movie table
-	* Add resolution (width and height columns) to the movie table
-	* Change default type of runtime and year to SmallInteger
-
-2009-01-31  Michael Jahn
-	* Allocine movie plugin updated
-	* small unicode fixes for 7arte movie plugin
-
-2009-01-28  Michael Jahn
-	* FilmAffinity movie plugin updated
-
-2009-01-24  Michael Jahn
-	* DVD-Palace movie plugin updated
-
-2009-01-22  Michael Jahn
-	* fixed Greek translation of the word "Danish" (thanks to Johnny)
-
-2009-01-18  Piotr O?arowski
-	* Upgrading from 0.6.2 partially fixed (posters are missing)
-	* Add loaned_movies_count and returned_movies_count properties to Person
-
-2009-01-17  Piotr O?arowski
-	* Use MediumBLOB on MySQL to store posters. Database has to be recreated
-	  if 0.10-beta1 was used to create it.
-	* Few SQL optimizations
-
-2009-01-16  Piotr O?arowski
-	* Print move details during startup in debug mode
-
-2009-01-16  Michael Jahn
-	* [#317837] 007 james bond (PDF export grouping error)
-
-2009-01-15  Michael Jahn
-	* Amazon movie plugin updated
-	* better results for amazon poster search
-	* movie plugin base class prepared for fetching screenplay and cameraman,
-	  added fetching of screenplay to IMDB plugin 
-
-2009-01-06  Michael Jahn
-	* MovieFone movie plugin updated
-	* windows installer: movie import plugins deselectable from installation
-
-2009-01-04  Piotr O?arowski
-	* MyMoviesIt movie plugin added (thanks to Giovanni Sposito)
-
-2009-01-03  Michael Jahn
-	* [#313012] correctly round ratings
-
-2009-01-02  Michael Jahn
-	* PTGate movie plugin updated
-
-2008-12-25  Michael Jahn
-	* [#309373] export to pdf
-	* Cinematografo movie plugin updated
-
-2008-12-19  Michael Jahn
-	* OFDb, IMDB-de movie plugin updated
-
-2008-12-16  Michael Jahn
-	* IMDB movie plugin updated
-
-2008-12-16  Piotr O?arowski
-	* Reload movie plugin each time search is performed (in --debug mode only,
-	  this should ease writing plugins)
-	* Canceling search doesn't throw exception anymore (closes: 100038)
-
-2008-12-07  Piotr O?arowski
-	* update_image(): update the md5 *after* all other queries (so that UPDATE
-	  will not be invoked)
-
-2008-12-07  Piotr O?arowski
-	* CSFD movie plugin updated (thanks to Ale? Nejdr)
-
-2008-12-03  Piotr O?arowski
-	* Add few indexes to the model
-
-2008-12-01  Piotr O?arowski
-	* HTML export plugin exports posters again (closes: 304072)
-
-2008-11-30  Piotr O?arowski
-	* CSFD movie plugin updated (thanks to Otakar)
-
-2008-11-25  Michael Jahn
-	* fixed some amazon and unicode errors
-
-2008-11-22  Michael Jahn
-	* use unicode for fetched html pages in general
-	* fixed rating, runtime and year are not shown with MySQL backend
-
-2008-11-10  Michael Jahn
-	* optimized windows setup related code, added links to documentation
-	  files, forum and wiki to the installer
-
-2008-11-18  Piotr O?arowski
-	* Version changed to 0.10-beta2~svn
-	* command line's search fixed
-
----- 0.10-beta1 ----
-
-2008-11-17  Piotr O?arowski
-	* Add --version/-v command line options
-	* Add bash completion script
-	* Version changed to 0.10-beta1
-	* Update Polish translation
-
-2008-11-16  Piotr O?arowski
-	* fail if database requires newer Griffith version
-	* Rename backup/restore menu items
-	* Warn about developement version only once
-	  + home / config/ posters directory detected before initializing Griffith
-
-2008-11-15  Piotr O?arowski
-	* Export plugins are now exporting movies listed in main window
-	* Replace "by ..." quick filter combo boxes with saved search conditions
-
-2008-11-13  Piotr O?arowski
-	* update translations
-	* sync with 0.9.x branch
-
-2008-11-10  Michael Jahn
-	* updated plugins IMDB-de, Amazon, Kino.de, FilmeVonAZ
-
-2008-11-01  Michael Jahn
-	* updated IMDB plugin
-
-2008-10-26  Michael Jahn
-	* [#179618] During "Get from Web ", griffith window keeps stealing focus
-
-2008-10-23  Michael Jahn
-	* PDF export: disabled movie grouping if movie list is not sorted by title
-	  or original title
-	* [#258817] The application doesn't save volume
-
-2008-10-25  Piotr O?arowski
-	* add load/save search conditions
-
-2008-10-23  Michael Jahn
-	* updated IMDB-de, Kino.de, Zelluloid plugin
-	* added original url check within plugin test
-
-2008-10-23  Piotr O?arowski
-	* clean/restore search conditions in advfilter
-
-2008-10-19  Piotr O?arowski
-	* Add more filter movie rules to the search window
-	* Screenplay and cameraman added to main/add windows
-
-2008-10-18  Piotr O?arowski
-	* Speed up import movies function
-
-2008-09-23  Michael Jahn
-	* [#273172] "Properties/Volume/show...in this volume" is broken
-
-2008-09-14  Piotr O?arowski
-	* Warn about backups when starting develpement version
-	* seen/loaned settings available in adv. filter window (much more to come
-	  soon)
-
-2008-09-13  Piotr O?arowski
-	* Loaning movies is working again
-
-2008-09-12  Piotr O?arowski
-	* Validate loan contact's email address
-	* Python required version bumped to 2.4 (it was required for a while
-	  aready)
-	* Use SQLAlchemy's validate decorator (minimum required SA version bumped
-	  to 0.5rc1)
-
-2008-09-09  Piotr O?arowski
-	* Add aspect ratio, cameraman and screenplay to the database
-
-2008-08-16  Michael Jahn
-	* fixed support for german umlauts in OFDb plugin
-	* added Amazon plugin (supports search by UPC/EAN)
-	* added Amazon language support for CA and FR
-	* Amazon support is now closer to the current specification
-	* encoding error in plugins Kino.de and Zelluloid
-
-2008-08-14  Michael Jahn
-	* pdf export: group movies with numbers 0-9 (thanks to Luigi Pantano)
-	* pdf export: [#174463] Database Export as PDF doesn't work under Ubuntu
-
-2008-08-12  Piotr O?arowski
-	* Don't refresh movie list while updating quick filter combos
-	* FDb movie plugin updated (thanks to Bartosz Kurczewski)
-
-2008-08-03  Piotr O?arowski
-	* Initial advanced search/filter function implemented (alpha stage)
-
-2008-08-02  Piotr O?arowski
-	* Use unicode in gettext and SQLAlchemy
-	* Move all posters to database, create local cache
-
-2008-07-31  Piotr O?arowski
-	* Replace gdebug with Python's logging module
-	* Add posters table (to store posters in database)
-
-2008-07-30  Michael Jahn
-	* [#253272] extra information columns not loaded on startup
-	* extended debug support on windows platforms
-
-2008-07-28  Piotr O?arowski
-	* Switch back to 4 spaces indentation
-	* Rewrite SQLAlchemy related data to use session (to ease accessing
-	  simultaneously multiple databases)
-
----- 0.9.7.1 ----
-
-2008-07-26  Piotr O?arowski
-	* Links to Griffith's homepage and bug tracker updated
-	* Version changed to 0.9.7
-
-2008-07-24  Michael Jahn
-	* main treeview doesn't accept DB-NULL or empty strings for the int-fields
-	  rating, year and runtime
-
-2008-07-24  Michael Jahn
-	* Windows only: set_wrap_width doesn't work in filter toolbar without side
-	  effects if GTK 2.12.9 is used
-	* updated INSTALL file to new versions (GTK, Glade, PyGTK, py2exe,
-	  pywin32, Inno Setup)
-	* fixed URL creation in setup script; added removing of .pyo files if
-	  deinstalled
-
----- 0.9.7 ----
-
-2008-07-21  Piotr O?arowski
-	* Fixed HTML export plugin (sorting issue)
-	* Amazon posters - don't fail if LargeImage attribute is not set
-	* Filmweb movie plugin updated (thanks to mariusz2806)
-	* Added Latvian translation (thanks to Aleksandrs Zdancuks)
-	* Added Ukrainian translation (thanks to vazaz)
-	* Updated translations: bg, ca, da, de, el, es, fr, it, nb, pt, pt_BR, ru,
-	  sv, tr
-	* Version changed to 0.9.7
-
-2008-07-18  Michael Jahn
-	* added User-Agent support, because some web sites doesn't like the Python
-	  urllib default
-	* updated Zelluloid plugin
-	* support for accents in titles for searching if plugin needs it
-	  (Zelluloid needs german umlauts)
-
-2008-07-17  Michael Jahn
-	* updated OFDb plugin
-	* added column rating to the mainlist
-	* [#226269] default folders hardcoded (not fully fixed)
-
-2008-07-13  Michael Jahn
-	* updated DVDEmpire plugin
-	* [#236598] scroll bar in filter "by volume" appears
-	* fixed loan label in main view if html entities are used in the name of a
-	  person
-
-2008-07-11  Michael Jahn
-	* added quick filter for tags
-	* [#244676] Griffith loses focus
-
-2008-07-10  Michael Jahn
-	* updated Filmtipset plugin
-
-2008-05-09  Michael Jahn
-	* added cast, genre and grouping by first letter to pdf export (thanks to
-	  Luigi Pantano)
-
-2008-05-08  Michael Jahn
-	* updated DVD Empire plugin
-
-2008-04-25  Michael Jahn
-	* fixed fetching posters from Amazon 
-
-2008-04-13  Michael Jahn
-	* updated OFDb plugin
-
-2008-04-01  Michael Jahn
-	* fixed html export if sorted by collection, media, video codec or volume
-
-2008-03-22  Piotr O?arowski
-	* Python>=2.4's xml module compatibility added
-
-2008-03-15  Michael Jahn
-	* quick filter for loaned-to
-
-2008-03-04  Vasco Nunes
-	* Serbian language file updated (thanks to Sasa Petrovic) 
-	* Portuguese language file updated
-
-2008-02-18  Piotr O?arowski
-	* Filmweb movie plugin updated (thanks to Mariusz)
-	* Windows 64 bit is not detected correctly
-
-2008-02-12  Michael Jahn
-	* fixed selecting of quick filter volume and collection in main view
-
-2008-02-11  Vasco Nunes
-	* Added serbian language file (thanks to Sasa Petrovic) 
-
-2008-02-09  Michael Jahn
-	* sort collection list and volume list by name
-
-2008-02-03  Michael Jahn
-	* hit enter key in title/original title box starts retrieving data from
-	  web for a new entry
-	* HTML export: replace linebreaks with <br /> in the data if "XHTML 1.0"
-	  is found in the template header
-
----- 0.9.6 ----
-
-2008-01-27  Michael Jahn
-	* Zelluloid plugin updated
-
-2008-01-27  Piotr O?arowski
-	* AniDB and Stopklatka movie plugins updated
-
-2008-01-26  Piotr O?arowski
-	* Translators tab (about dialog) filled in automatically
-
-2008-01-13  Piotr O?arowski
-	* Distribute local copy of SQLAlchemy 0.3.11 (Griffith 0.10 which will
-	  work with SQLAlchemy 0.4.x is not ready yet)
-	* Version changed to 0.9.6
-	* Update .desktop file to Desktop Entry Specification's version 1.0
-
-2008-01-10  Michael Jahn
-	* OFDb plugin updated
-
-2008-01-06  Michael Jahn
-	* fixed pdf export with non-ascii characters [#174463]
-
-2007-12-16  Piotr O?arowski
-	* Version changed to 0.10~svn
-	* Started working on SQLAlchemy 0.4.x compatibility (NOT YET READY)
-
-2007-12-08  Vasco Nunes
-	* Danish language file updated
-
-2007-12-07  Vasco Nunes
-	* Spanish language file updated
-
-2007-11-30  Michael Jahn
-	* HTML export supports video codec name
-	* quick filter for volumes
-	* export plugins remember the last directory which was used
-
-2007-11-29  Vasco Nunes
-	* Russian language file updated
-
-2007-11-28  Michael Jahn
-	* [#164966] deactivating spellchecker option in preferences dialog
-	  disables the depending elements
-
-2007-11-22  Michael Jahn
-	* added columns genre, seen, runtime and year to the mainlist
-	* enabled reorderable columns
-	* column order is saved
-
-2007-11-12  Michael Jahn
-	* Kino.de plugin updated
-	* fixed pdf export with non-ascii characters in filenames and data
-	* pdf export supports sort column from configuration
-
-2007-11-08  Michael Jahn
-	* status bar shows count of movies after applying a filter
-	* changed HTML export:
-	  + exported poster file names contain the movie number instead of the
-	    random name
-	  + movies without a poster get the griffith picture
-
-2007-10-15  Michael Jahn
-	* Kino.de plugin updated
-	* Fetch from Amazon function fixed
-
-2007-09-20  Vasco Nunes
-	* Italian language file updated
-
-2007-09-06  Vasco Nunes
-	* Berlios task [#003126] complete. Griffith's dir should point to
-	  'Application Data' on windows systems.
-
-2007-09-06  Michael Jahn
-	* save window state, position and size on windows systems
-	* save selected quick filter criteria
-	* fixed backup if path or filename contains special characters (like
-	  german umlauts)
-	* use deflate for backup if available
-	* added auto-test feature for movie plugins (only used by developers;
-	  execute test_movieplugins.py directly)
-	* FilmeVonAZ and OFDb plugin updated
-	* fixed saving media and vcodec defaults in preferences dialog
-
-2007-09-03  Vasco Nunes
-	* Some documentations updates
-
----- 0.9.5 ----
-
-2007-09-02  Piotr O?arowski
-	* Translation files synchronized with Rosetta
-	  + new: Catalan, Norwegian Bokmal
-	  + uptaded: Brazilian Portuguese, Cech, Dutch, French, German, Italian,
-	    Portuguese, Russian
-	* Polish translation updated
-	* Print cover function fixed (reportlab doesn't like unicode)
-
-2007-09-02  Michael Jahn
-	* added support for media type, collection and volume in HTML export plugin
-	* added "auto-fixing" of config file values for defaults section
-
-2007-09-01  Piotr O?arowski
-	* Respect medium and video codec's default value in add window
-	  (closes: #11864)
-	* griffith.glade file converted to glade3 format
-
-2007-09-01  Michael Jahn
-	* Kino.de plugin updated
-	* Fix encoding of --home argument
-
-2007-09-01  Vasco Nunes
-	* Several changes on loan e-mail reminder system:
-		+ Loan E-mail reminder timeout implemented
-		+ Support for TLS smtp auth handshaking
-		+ Added smtp server port usage
-		+ Added gmail smtp server support
-	* 7arte movie plugin updated
-	* Portuguese translation file updated
-
-2007-08-31  Vasco Nunes
-	* Brazilian portuguese translation file updated
-
-2007-08-26  Piotr O?arowski
-	* Fix encoding problems in backup function
-
-2007-08-23  Piotr O?arowski
-	* Export disc number instead of medium id in HTML export plugin
-
-2007-08-16  Michael Jahn
-	* IMDB-de plugin updated
-
----- 0.9.4 ----
-
-2007-08-05  Piotr O?arowski
-	* FDb movie plugin updated
-
-2007-08-04  Piotr O?arowski
-	* Removing tags function fixed
-	* Copy all files from "data" subdirectory to the exported location in HTML
-	  export plugin
-	  + add index.htm files to html_table{,s} templates
-	* Fixed volume/colection loaning problem
-
-2007-08-01  Piotr O?arowski
-	* Translation files synchronized with Rosetta
-	  + new: Japanese, Russian and Turkish
-	  + uptaded: Czech, Spanish, Bulgarian, Greek
-	* Polish translation updated
-
-2007-07-31  Michael Jahn
-	* FilmTipset plugin added
-	* OFDb movie plugin updated
-
-2007-07-21  Piotr O?arowski
-	* Warn about problems with connecting to database (f.e. missing modules)
-
-2007-07-09  Michael Jahn
-	* toggle seen/unseen by double-clicking the icon
-	* support for different database names with sqlite
-
-2007-07-09  Piotr O?arowski
-	* posters directory problem fixed (thanks to Michael)
-
-2007-07-06  Vasco Nunes
-	* PTGate movie plugin updated
-
-2007-07-04  Michael Jahn
-	* Kino.de movie plugin updated
-
-2007-07-03  Michael Jahn
-	* DVD-Palace and IMDB-de movie plugin updated
-
----- 0.9.3.1 ----
-
-2007-07-01  Piotr O?arowski
-	* Problem with saving database preferences in config file fixed
-
----- 0.9.3 ----
-
-2007-06-30  Piotr O?arowski
-	* Use python2.5's sqlite3 module if available (no need to install
-	  pysqlite2)
-	* Check dependencies at startup
-	* Detect old config while restoring data
-	* Stopklatka movie plugin updated
-
-2007-06-29  Piotr O?arowski
-	* Added Greek translation (thanks to Ioannis Koniaris)
-	* Added Simplified Chinese translation (thanks to kempson)
-	* Updated German, Spanish, French and Portuguese Brazilian translations
-	  (from Rosetta)
-	* Updated Polish translations
-	* Do not register mime type in .desktop file
-
-2007-06-29  Vasco Nunes
-	* 7arte.net and Cineteka movie plugins updated
-
-2007-06-29  Piotr O?arowski
-	* IMDb movie plugin updated
-
-2007-06-27  Michael Jahn
-	* Kino.de movie plugin updated
-	* DVD-Palace movie plugin added
-
-2007-06-25  Vasco Nunes
-	* Added Danish translation (thanks to Joe Dalton)
-
-2007-06-20  Piotr O?arowski
-	* Filmweb, WP and FDb movie plugins updated
-
-2007-06-20  Michael Jahn
-	* fixed bug #11103: windows are not "on top"
-	* fixed bug #11088: Clone doesn't produce a new entry
-	* added script for database creation under Microsoft SQL Server (README)
-
-2007-06-19  Vasco Nunes
-	* Portuguese translation updated
-	* winsetup script updated
-
-2007-06-19  Piotr O?arowski
-	* Polish translation updated
-
-2007-06-17  Piotr O?arowski
-	* Change "report bug" link in about menu
-	* Minor bug fixes
-
-2007-06-13  Piotr O?arowski
-	* Add sections to config file
-
-2007-06-09  Vasco Nunes
-	* Added new alpha export plugin for iPods. Exports directly to iPod on
-	  MacOSX for now, saves files in custom location on other platforms.Not
-	  handling 4Kb iPod notes limit yet.
-
-2007-05-31  Piotr O?arowski
-	* IMDB, IMDB-de and KinoDe movie plugins updated (thanks to Michael Jahn)
-	* Resizable columns in add movie window's languages tab (thanks to Michael
-	  Jahn)
-	* Increase runtime maximum value (thanks to Michael Jahn)
-	* Add Microsoft SQL support (thanks to Michael Jahn)
-
-2007-05-22  Piotr O?arowski
-	* Minor fix in dbupgrade.py
-
-2007-05-19  Vasco Nunes
-	* French translation updated (thanks to Guillaume Pratte)
-	* IMDB plugin rating fix (thanks to babelfish)
-	* PTGate movie plugin encoding fixed
-	* E-pipoca movie plugin updated
-
-2007-05-11  Jessica K. Parth
-	* OFDb updated
-
-2007-05-01  Vasco Nunes
-	* E-Pipoca movie plugin updated (thanks to Djohnson "Joe" Lima)
-
-2007-04-15  Piotr O?arowski
-	* IMDB movie plugin updated to version 1.3 (director, rating)
-	* Fetch from Amazon function fixed ("No image available" image issue)
-
-2007-04-11  Piotr O?arowski
-	* Fixed medium_id and vcodec_id column type in movies table
-
-2007-04-01  Piotr O?arowski
-	* Added Dutch translation (thanks to Marcel Dijkstra)
-
-2007-03-29  Piotr O?arowski
-	* IMDB movie plugin updated
-	* IMDb-de movie plugin added (thanks to Michael Jahn)
-
-2007-03-20  Piotr O?arowski
-	* FilmDb and Zelluloid movie plugins added (thanks to Michael Jahn)
-
-2007-03-11  Piotr O?arowski
-	* Filmweb movie plugin updated (no more hangs if no movie info found
-	  (closes #10601)
-	* Version changed to 0.9.2+svn
-	* New configuration file format (human readable) - please delete old one
-	  manually
-
----- 0.9.2 ----
-
-2007-02-20  Piotr O?arowski
-	* IMDB movie plugin updated
-	* New seen/unseen icons (thanks to dragonskulle)
-	* About window updated
-
-2007-02-19  Piotr O?arowski
-	* CSFD movie plugin updated (still needs work)
-	* DVDEmpire movie plugin added (thanks to Michael Jahn)
-
-2007-02-14  Piotr O?arowski
-	* KinoDe and FilmeVonAZ movie plugins updated (thanks to Michael Jahn)
-
----- 0.9.1 ----
-
-2007-02-13  Piotr O?arowski
-	* KinoDe movie plugin updated (thanks to Michael Jahn)
-
-2007-02-12  Piotr O?arowski
-	* Fix broken databases automatically (return date will be set to
-	  2007-01-01) - redo the upgrade process if you don't like it
-
-2007-02-11  Piotr O?arowski
-	* Fix one more bad case in upgrade function
-	* Fix setting loan status in upgrade function
-
-2007-02-03  Jessica K. Parth
-	* OFDb movie plugin updated (website changed)
-
-2007-01-27  Piotr O?arowski
-	* English translation fixes (thanks Frijolie)
-
----- 0.9 ----
-
-2007-01-26  Piotr O?arowski
-	* WP and Filmweb movie plugins updated
-
-2007-01-26  Jessica K. Parth
-	* Fix AniDB Problems in Windows ( file-open problem in movie.py )
-
-2007-01-25  Piotr O?arowski
-	* Fix more bad cases in upgrade from old DB function
-
-2007-01-24  Piotr O?arowski
-	* Fetch from Amazon function recognizes more posters now
-
-2007-01-16  Vasco Nunes
-	* Czech translation updated (thanks to Ondra 'Kepi' Kudl?k)
-
-2007-01-15  Piotr O?arowski
-	* AnimeDB movie plugin updated
-
-2007-01-11  Piotr O?arowski
-	* Fix possible memory leak
-	* Select first movie by default
-	* Remove Excel mime types from CSV import plugin
-	* Fix list of fields to import
-
-2007-01-10  Vasco Nunes
-	* PTGate movie plugin updated
-
----- 0.9-rc3 ----
-
-2007-01-09  Piotr O?arowski
-	* Catch some more bad cases while upgrading database
-	* Switch to sqlite if psycopg2 or MySQLdb module are not available
-	* Fix upgrading vol/col loan data
-	* Version changed to 0.9-rc3
-
-2007-01-08  Piotr O?arowski
-	* Ignore bad entries in loans table
-	* Don't modify old database while upgrading
-
-2007-01-08  Vasco Nunes
-	* Italian translation updated (Thanks to Diego)
-
----- 0.9-rc2 ----
-
-2007-01-07  Piotr O?arowski
-	* Copy title if original title is not available in FDb.pl movie plugin
-	* griffith-export-template manpage removed
-
-2007-01-06  Piotr O?arowski
-	* Clear movie details if no movie is selected
-	* Speed up Griffith's startup a little bit
-
-2007-01-05  Piotr O?arowski
-	* Copyright years updated
-	* Version changed to 0.9-rc2
-	* E-mails removed from changelog
-	* TODO updated
-
-2007-01-05  Vasco Nunes
-	* Updated portuguese translation
-
-2007-01-04  Vasco Nunes
-	* Updated Swedish translation (thanks to Daniel Nylander)
-	* Updated Czech translation and CSFD movie pluging (thanks to Blondak)
-	* Updated Portuguese Brazilian translation (thanks to F?bio Nogueira)
-	* Fixed win32 gtk locale issue
-	* Fixed win32 default system font directory detection (for use in
-	  preferences)
-	* Updated French translation (thanks to Pierre-Luc L?vi)
-	* Latex is no more the default entry for html export plugin :)
-
-2007-01-03  Vasco Nunes
-	* Using cPickle over pickle for serialization. Config files are now fully
-	  cross-platform.
-
-2007-01-03  Piotr O?arowski
-	* Install Polish manpage in ISO-8859-2 encoding
-	* Fix clean rule
-	* Sort by last added movies option added
-	* pysqlite1.1 is not needed anymore
-
-2007-01-02  Piotr O?arowski
-	* Copy volume/collection data when cloning movie
-	* Fix displaying loan info (cached data can be obsolete)
-
-2007-01-01  Jessica K. Parth
-	* "fixed" slow populate function
-	* clear_filter -> don't update four times the maintreeview
-	* german translation update
-
-2007-01-01  Piotr O?arowski
-	* Filmweb movie plugin updated
-	* Added "limit search results to x movies" in preferences
-	* Scroll movie list when selecting first/prev/next/last movie button
-	* Copy video codec data when cloning movie
-	* Fixed displaying volume/collection loan status
-	* Seen status can be now set without opening edit window
-
-2006-12-30  Piotr O?arowski
-	* Compare lower() values while importing movies
-	* Seen icon moved near to rating, loaned icon removed
-	* Speed up main list filling
-	* Hide number column option added
-	* Add Jessica's icon for seen/unseen movies
-
-2006-12-30  Vasco Nunes
-	* Under MacOSX Preview.app is used for pdfs now
-
----- 0.9~rc1 ----
-
-2006-12-24  Vasco Nunes
-	* Added some gtk dialogs when converting old db format
-	* Fixed some win32 setup includes
-
-2006-12-22  Piotr O?arowski
-	* Polish manpage updated
-
-2006-12-20  Piotr O?arowski
-	* Version changed to 0.9~rc1 (0.7 and 0.8 are skipped because of lots of
-	  changes in this release)
-	* Merge function and MySQL/PostgreSQL backup disabled for now
-	* English manpage updated
-	* Homepage updated
-	* --fix-db option removed (no longer needed)
-
-2006-12-18  Piotr O?arowski
-	* Detect old DB (and convert it) in restore function
-	* UI changes (rest of windows converted to dialogs, minor changes)
-
-2006-12-18  Jessica K. Parth
-	* tooltips to mange people dialog added
-	* german translation updated (100% finished)
-
-2006-12-17  Jessica K. Parth
-	* Import CSV plugin updated to work with multiple files
-
-2006-12-17  Piotr O?arowski
-	* AniDB, Filmweb, Stopklatka and TanukiAnime movie plugins updated
-	* Upgrade from old database: detect SQLite3 and print some hints
-	* Add "commentary" to the language types
-
-2006-12-16  Piotr O?arowski
-	* WP, FDb and Onet movie plugins updated
-	* movie plugins:
-	  + allow "%s" in self.original_url_search and self.translated_url_search
-	  + opening new page inside movie plugin is now as easy as:
-	    "self.new_page = self.open_page(url='http://something')"
-	* chardet added to optional dependencies
-	* Import multiple files at once
-
-2006-12-16  Jessica K. Parth
-	* added a warning when there are no movies in the database to ( print
-	  cover, fetch poster, change poster, edit movie, delete movie, clone
-	  movie)
-	* Import CSV Plugin updated (use chardet "http://chardet.feedparser.org/"
-	  to detect file format)
-
-2006-12-15  Piotr O?arowski
-	* Added "N/A" to some fields in "technical information" tab (NULL in
-	  database)
-	* Added some relations between windows
-	* "Suggest unseen movie" now chooses movie from main list only (f.e. from
-	  specified collection)
-
-2006-12-15  Jessica K. Parth
-	* ODFb Plugin uses the quicksearch and returns much more and better results
-	* KinoDE Plugin return both results for Video/DVD and Kino now and some
-	  small fixes
-	* German Translation updated
-	* Moviefone Plugin updated
-
-2006-12-14  Piotr O?arowski
-	* Search for empty fields only option added
-
-2006-12-13  Piotr O?arowski
-	* Import CSV plugin updated (thanks to Jessica)
-	* Fixed "unique name" bug in update poster function
-	* Import plugin is a lot faster now
-
-2006-12-12  Piotr O?arowski
-	* Debian files updated
-	* Docs updated
-	* Some UI improvements
-	* Selectable Amazon server (fetch bigger poster)
-	* Added "--home" command line option
-	* Double click on movies list -> open edit window
-
-2006-12-10  Vasco Nunes
-	* Added three new movie plugins for spanish users -
-	  IMDB espana, Culturalia and Film Affinity (thanks to Pedro D. S?nchez)
-
-2006-12-08  Vasco Nunes
-	* Updated CSFD Plugin to use new website interface (thanks to Blon??k)
-	* Updated Czech translation (thanks to Blon??k)
-	* ClubeMyDVD movie plugin removed (site no longer exists)
-	* Added new portuguese movie plugin (Cineteka)
-
-2006-12-06  Piotr O?arowski
-	* Ask before adding movie which title is already in database
-	* New import plugin system (thanks for help, Jessica)
-	* CSV import plugin added (thanks to Jessica)
-	* IMDb movie plugin updated (thanks to Frank)
-	* Added myself to main authors and changed email address
-
-2006-12-04  Piotr O?arowski
-	* Added --check-dep and --show-dep command line options
-	* OFDb movie plugin updated (thanks to Jessica)
-
-2006-11-20  Vasco Nunes
-	* Added Brasilian Portuguese translation (thanks to F?bio Nogueira)
-
-2006-11-17  Piotr O?arowski
-	* Default sort column can be set in preferences
-	* Menu's show seen/loaned movies only is now used more widely
-
-2006-11-16  Piotr O?arowski
-	* "Edit movie details in 'Add movie' window" transition finished
-	* Show right window after editing person's details
-	* Added more options to command line
-	* GNOME HIG related changes in Glade file (still needs work)
-
-2006-11-08  Piotr O?arowski
-	* "Edit movie details in 'Add movie' window" transition started
-	  + Keep widgets in Griffith.widgets dictionary
-
-2006-09-25  Piotr O?arowski
-	* Added possibility to change Griffith's home directory
-
-2006-09-24  Piotr O?arowski
-	* Added Swedish translation (thanks to Daniel Nylander)
-
-2006-09-20  Piotr O?arowski
-	* AniDB movie plugin now supports gziped data (closes: #5685)
-
-2006-09-15  Piotr O?arowski
-	* Updated German translation (thanks to Malte Wiemann)
-
-2006-09-12  Piotr O?arowski
-	* "With" renamed to "Cast"
-	* Tiny changes in preferences window
-
-2006-09-08  Piotr O?arowski
-	* Fixed required PyGTK version
-	* Installation is now not required to run Griffith
-	  (move griffith file to lib directory and run "./lib/griffith")
-
-2006-09-07  Vasco Nunes
-	* Updated Czech translation (thanks to Ondra 'Kepi' Kudl?k)
-
-2006-09-06  Piotr O?arowski
-	* Fixed CSFD movie plugin (thanks to Ondra 'Kepi' Kudl?k for patch #1449)
-
-2006-09-02  Piotr O?arowski
-	* Fixed some UTF encoding problems in FDb, Filmweb, Onet and WP movie
-	  plugins
-
-2006-08-28  Piotr O?arowski
-	* Some GUI changes mainly suggested by Alan Horkan:
-	  + menu reorganized
-	  + poster button now opens poster window
-	  + changed some icons to their stock equivalent
-
-2006-08-27  Piotr O?arowski
-	* Added new green style to "html tables" template (HTML export plugin)
-	  + old one renamed to "light green"
-	* Added some highlights for next version to NEWS file
-
-2006-08-25  Piotr O?arowski
-	* Movie plugins are now fetching only selected data.
-
-2006-08-24  Piotr O?arowski
-	* Language treeview now supports codec/channel/subtitle format data (still
-	  needs work)
-
-2006-08-23  Piotr O?arowski
-	* Fixed problem with converting images on Windows (HTML export plugin)
-	* Fixed bug with "You have to fill language..." after updating language
-	  list
-
-2006-08-18  Piotr O?arowski
-	* Added green style to "html tables" template (HTML export plugin)
-
-2006-08-15  Vasco Nunes
-	* tempdir for posters is now writable by all users under win32 systems
-
-2006-08-15  Piotr O?arowski
-	* Merged changes from 0.6.2
-
-2006-07-30  Piotr O?arowski
-	* Selecting next/previous movie is now possible (new toolbar buttons)
-
-2006-07-29  Piotr O?arowski
-	* IMDb movie plugin adds new lines in "with" field again
-	* Draggable toolbar
-
-2006-05-02  Piotr O?arowski
-	* Added MySQL support
-	* Server can be changed on the fly (see database tab in preferences)
-
-2006-04-28  Piotr O?arowski
-	* SQLAlchemy transition started
-
-2006-04-26  Piotr O?arowski
-	* Added database settings to preferences window
-
-2006-04-25  Piotr O?arowski
-	* Added PostgreSQL support!
-	* Added merging data from .gri and .db files (still needs work)
-	* Fixed some minor bugs
-
-2006-04-23  Piotr O?arowski
-	* SQLite2 database automatic conversion added
-	* ADOdb transition completed
-
-2006-04-22  Piotr O?arowski
-	* Backup/restore function rewritten (smaller zipfile)
-	* Merge database function added (rewritten coffelius's patch)
-
-2006-04-21  Piotr O?arowski
-	* Adding another numeric tag/lang/volume/collection is now not possible
-
-2006-04-20  Piotr O?arowski
-	* ADOdb transition started
-
----- 0.6.2 ----
-
-2006-08-08  Piotr O?arowski
-	* IMDb movie plugin updated.
-
-2006-08-05  Piotr O?arowski
-	* FDb movie plugin updated.
-
-2006-07-29  Piotr O?arowski
-	* IMDb movie plugin adds new lines in "with" field again
-	* Update button moved to toolbar
-
-2006-07-27  Piotr O?arowski
-	* Makefile for po files updated
-	  - use `cd po && make XX.po` to create new translation
-
-2006-07-21  Piotr O?arowski
-	* Updated Free Software Foundation address.
-	* FDb movie plugin updated.
-	* Filmweb movie plugin updated.
-
-2006-07-20  Piotr O?arowski
-	* Fixed media handling while exporting to HTML.
-
-2006-06-29  Piotr O?arowski
-	* German translation updated (thanks to Malte Wiemann)
-
-2006-05-27  Vasco Nunes
-	* Italian translation updated.
-
-2006-05-19  Piotr O?arowski
-	* Added FDb movie plugin
-
-2006-05-18  Piotr O?arowski
-	* Movie plugins code cleanups
-	* Added FilmeVonAZ movie plugin (thanks to Michael Jahn)
-
-2006-05-17  Piotr O?arowski
-	* Added Kino.de movie plugin (thanks to Michael Jahn)
-
-2006-05-08  Piotr O?arowski
-	* Cinematografo movie plugin updated.
-
-2006-05-02  Piotr O?arowski
-	* Some GtkComboBoxEntry widgets changed to GtkComboBox
-
-2006-04-25  Vasco Nunes
-	* Added italian translation (thanks to Diego Porcelli)
-
-2006-04-17  Piotr O?arowski
-	* Version changed to 0.6.1+svn
-	* Minor fixes in doc files
-	* Added watch file for Debian package
-
----- 0.6.1 ----
-
-2006-04-14  Piotr O?arowski
-	* Updated some docs (translation README and INSTALL notes)
-	* Fixed some typos
-	* Polish translation updated
-
-2006-04-11  Piotr O?arowski
-	* Filter function rewritten
-	  + new fields added
-	  + it should work on Windows now
-
-2006-04-08  Piotr O?arowski
-	* First tag can now be renamed
-
-2006-04-08  Vasco Nunes
-	* win32 distro is using now GTK 2.8 with PyGTK 2.8. This fixes lots of old
-	  PyGTK related bugs (mainly major pixbuf ones)
-
-2006-04-07  Vasco Nunes
-	* some win32 related fixes
-
-2006-04-05  Vasco Nunes
-	* Some changes to winsetup.py
-
-2006-03-11  Piotr O?arowski
-	* Makefile fixes:
-	 + Manpages are now uninstalled as well
-	 + Code cleanups
-	* Debian files updated
-
-2006-03-06  Vasco Nunes
-	* Czech translation updated.
-	* CSFD - 'Cesko-Slovensk Filmov Databze' movie plugin updated.
-
-2006-03-05  Vasco Nunes
-	* Spanish translation updated.
-	* Allocine movie plugin updated.
-
----- 0.6 ----
-
-2006-03-05  Vasco Nunes
-	* Fixed bug when using 'clone movie' function on filtered treeview.
-	* When using quick filter, 'all movies' filter on menu should be checked.
-	  Fixed.
-	* Posters are now saved to the system temp dir and only moved to posters
-	  dir when the movie is really commited to db.
-	* Added a new feature to find and delete orphaned files in poster's
-	  directory. For now, it's a console only tool (griffith -c' or
-	  'griffith --clean'). Griffith should not produce orphans anymore but
-	  this is useful for cleaning old ones.
-
-2006-03-05  Piotr O?arowski
-	* Fixed bug when searching movie titles containing polish characters
-	* Update volume/collection data after creating new database
-
-2006-03-04  Vasco Nunes
-	* After deleting a movie, last row is now selected on main treeview
-	* Minor fixes to Allocine and 7arte movie plugins
-	* Portuguese translation updated.
-	* Quick filter not always working as expected. This is fixed now.
-	* When loaning/returning a movie wrong row is selected. Fixed.
-
-2006-03-04  Piotr O?arowski
-	* Fixed displaing movie info before initialization (tags problem)
-	* Fixed wrong poster path in cloned movie
-	* Clone movie function copies tag/lang data now
-	* Console search can now use multiple options
-	* Some code cleanups
-	* Added some tooltips to poster buttons
-	* Polish translation updated
-
-2006-03-03  Vasco Nunes
-	* IMDB changed the way posters are included in html. Plugin fixed.
-	* Added custom fonts selection for PDF reports.
-	* Fixed bug when adding new collections.
-
-2006-03-03  Piotr O?arowski
-	* New tag/language/volume/collection name must be unique
-	* Volume/collection ids dictionary is filled only if needed
-	* Changed behaviour of poster preview and add movie window
-	* Fixed bug when restoring data
-	* Removal of any movie language is now possible (not just last one)
-	* Stopklatka movie plugin updated
-	* Onet Film movie plugin updated
-
-2006-03-01  Vasco Nunes
-	* French and portuguese translations updated to match current revision
-	* Added a new french movie plugin - Allocine (Thanks to Pierre-Luc L?vy)
-
-2006-02-28  Piotr O?arowski
-	* All *\.py files moved to usr/share/ directory
-
-2006-02-28  Vasco Nunes
-	* Added french translation (Thanks to Pierre-Luc L?vy)
-
-2006-02-26  Piotr O?arowski
-	* Movie now can't be deleted while it is loaned
-
-2006-02-25  Vasco Nunes
-	* Fixed problem under macosx and safari not opening websites fired up by
-	  Griffith
-	* Removed loan flag from the main treeview.
-
-2006-02-21  Piotr O?arowski
-	* New entries in help menu
-	* Worning if languages list is not filled
-
-2006-02-20  Piotr O?arowski
-	* New 'tag' feature is now complete
-
-2006-02-19  Piotr O?arowski
-	* Language/tag renaming in preferences window is finally working
-
-2006-02-18  Piotr O?arowski
-	* All language types are now saved
-	* Code cleanups
-
-2006-02-17  Piotr O?arowski
-	* Fixed saving languages
-	* Polish translation updated
-
-2006-02-12  Piotr O?arowski
-	* Onet movie plugin updated
-	* Some crashes while showing debug info fixed
-
-2006-02-04  Vasco Nunes
-	* New console arguments: 
-	 + -s, --search_title (search by title)
-	 + -o, --search_original (search by original title)
-	 + -d, --director (search by director)
-	 + -w, --with (search by actor)
-	 + -y, --year (search by year)
-	* Debug console argument changed to -D, --debug
-
-2006-02-01  Vasco Nunes
-	* Fixed a problem with IMDB movie plugin not fetching casts for some
-	  movies
-	* Fixed a bug on IMDB movie plugin. Some movies were giving weird results
-	  on director's field.
-	* '"' char is now stripped from titles in all movie plugins.
-	* Added initial support for console arguments. No multi argument support
-	  yet.
-	* Debug functions moved to own class
-	* Added basic searching by original title on the console (griffith -s
-	  movie_title)
-
-2006-01-28  Piotr O?arowski
-	* Movie number is now editable
-	* Some language feature fixes
-
-2006-01-28  Piotr O?arowski
-	* Added languages feature (beta version)
-	* Added tags feature (alpha version)
-
-2006-01-24  Vasco Nunes
-	* Fixed bug with spellchecker initialization when an aspell word list is
-	  not installed.
-
-2006-01-14  Piotr O?arowski
-	* Filmweb movie plugin updated
-
-2006-01-08  Piotr O?arowski
-	* CSV template updated (still needs some work)
-
-2006-01-07  Piotr O?arowski
-	* [Bug #5685] AnimeDB plugin really works again
-
-2006-01-06  Vasco Nunes
-	* German OFDB (Online-Filmdatenbank) movie plugin updated. (Christian
-	  Sagmueller)
-	* German translation updated. (Christian Sagmueller)
-	* Portuguese translation updated.
-
-2006-01-05  Vasco Nunes
-	* [Bug #5627] 7arte.net plugin with weird characters on actors field
-
-2006-01-04  Vasco Nunes
-	* Main treeview being populated twice on startup. Fixed.
-
-2006-01-04  Piotr O?arowski
-	* AnimeDB plugin works again
-
-2006-01-03  Piotr O?arowski
-	* Fixed bad vol./col. ID in ComboBox after adding new entry
-
-2006-01-02  Vasco Nunes
-	* [Bug #5999] Encoding problem with E-Pipoca movie plugin
-
-2005-12-28  Piotr O?arowski
-	* Fixed crash when volume or collection name wasn't string
-
-2005-12-28  Vasco Nunes
-	* Proprietary unicode font used on PDF reports replaced with a free one
-	  (DejaVu)
-	* Some changes to simple list PDF export plugin
-
-2005-12-27  Vasco Nunes
-	* Added spanish translation (thanks to Daniel Ucero)
-
-2005-12-05  Piotr O?arowski
-	* Fixed aspell related problems
-
-2005-11-30  Piotr O?arowski
-	* XML template updated (HTML export plugin)
-
----- 0.5.1 ----
-
-2005-11-26  Piotr O?arowski
-	* Updated polish translation
-
-2005-11-22  Vasco Nunes
-	* Added a new czech movie plugin (CSFD - esko-Slovensk Filmov Databze) -
-	  Thanks to Blondak <blondak at neser.cz>
-
-2005-11-21  Vasco Nunes
-	* Added Czech translation (Thanks to Blondak <blondak at neser.cz>)
-	* [Bug #5684] About window doesn't work on windows
-	* [Bug #5683] Two filters not working at all on windows
-	* Added a win32 installer custom image.
-	* Added portuguese, polish, german and czech translations to win32
-	  installer.
-
-2005-11-21  Piotr O?arowski
-	* Added simple style to table template (HTML export plugin)
-	* [Bug #5686] Coll. & vol. remembers selection after adding a movie
-	* [Bug #5631] wrong language/locale with 0.5
-
-2005-11-15  Vasco Nunes
-	* Applied Arjen Schwarz's patches addressing following problems:
-	  + Removed cancel button from confirmation dialogs
-	  + Fixed layer dropdown list entries
-	  + 'Excellent' mispelled in condition dropdown list
-
-2005-11-15  Piotr O?arowski
-	* Try to use Psyco if available
-
-2005-11-12  Piotr O?arowski
-	* HTML export plugin updated to v3.4 (added posters conversion)
-
----- 0.5 ----
-
-2005-11-11  Piotr O?arowski
-	* HTML export plugin updated to v3.3
-	* Updated polish translation
-
-2005-11-11  Vasco Nunes
-	* Fixed lots of poster operations bugs
-	* Added cgi module include on windows py2exe script (used by amazon.py
-	  module)
-	* Added PIL module include on windows py2exe script
-	* Portuguese language file updated
-
-2005-11-10  Vasco Nunes
-	* Added some cyclic garbage collector calls that really should improve
-	  memory management when using large db collections
-
-2005-11-09  Vasco Nunes
-	* Added a list to choose from when fetching big posters from Amazon.com
-	  and an exact match is not found.
-
-2005-11-07  Vasco Nunes
-	* Big posters fetched from Amazon are now previewed on built-in poster
-	  viewer.
-
-2005-11-05  Piotr O?arowski
-	* Media names are now stored in database
-	* Updated polish translation
-
-2005-11-04  Vasco Nunes
-	* On darwin and win32 platforms the poster viewer should not use
-	  enter/leave events anymore. Pygtk seems buggy when handling these.
-	* Added initial support to fetch bigger posters using Amazon Web Services.
-	  TODO: select poster to use when more than one found. Using the first one
-	  for now.
-	* Added original Mark Pilgrim's amazon python wrapper to core distribution
-
-2005-10-29  Vasco Nunes
-	* Added some HTML export plugin fixes for win32 compatibility
-	* Added a minor change to sql module for win32 poster paths compatibility.
-	  Needs to be tested under *nix to see if nothing is broken.
-	* win32 build should use now the libwimp widget engine for better windows
-	  visual integration
-
-2005-10-27  Vasco Nunes
-	* Added some minor changes for win32 compatibility
-	* Now Griffith's dir defaults to localized 'My Documents' dir on win32
-	  environments
-
-2005-10-27  Piotr O?arowski
-	* Volume/collection renaming is now possible
-	* Volume/collection can now be selected in "add movie" window
-	* Minor changes in volume/collection related code
-
-2005-10-26  Vasco Nunes
-	* Added a winsetup.py file to be used by py2exe
-
-2005-10-25  Piotr O?arowski
-	* Correct loans history is now displayed if movie belongs to
-	collection
-
-2005-10-24  Piotr O?arowski
-	* Loans are finally working correctly
-	* Crush when no media is selected in add movie function - fixed
-
-2005-10-20  Piotr O?arowski
-	* WP movie plugin updated
-	* Onet movie plugin updated
-
-2005-10-16  Vasco Nunes
-	* Fixed bug with posters thumbnail generation
-
-2005-10-15  Vasco Nunes
-	* Added preferences defaults to media, layers, condition, color and region
-
-2005-10-14  Piotr O?arowski
-	* [Bug #5344] fixed wrong encoding in IMDb movie plugin (thanks to dieterv)
-
-2005-10-13  Piotr O?arowski
-	* Updated WP movie plugin (webpage was changed)
-	* Debian menu icon was in wrong format
-	* Removing poster images when deleting movie feature added
-
-2005-10-10  Piotr O?arowski
-	* Fixed crash when poster file is not present
-
-2005-10-09  Vasco Nunes
-	* [Bug #5306] Last toolbar button not working as expected
-	* Added a 'by collection' quick filter
-
-2005-10-05  Piotr O?arowski
-	* Polish translation updated
-
-2005-10-05  Vasco Nunes
-	* Poster viewer events changed to only show full poster when
-	  entering/leaving zoom button
-	* Delete/Zoom poster buttons are now sensitive to poster existence
-	* Portuguese translation updated
-
-2005-10-04  Piotr O?arowski
-	* Griffith now asks if you want to loan whole collection
-
-2005-10-01  Vasco Nunes
-	* Moved all movie plugins logos to a new optional package
-	  (griffith_extra_artwork module on cvs)
-	* Added some tooltips to preferences widgets
-	* Added some new tools to operate with posters (initial support)
-
-2005-09-30  Piotr O?arowski
-	* Volumes / Collections feature now in beta2 version (loaning is
-	  working, some bugfixes)
-	* Some cleanups in Debian files
-
-2005-09-26  Vasco Nunes
-	* Added bulgarian translation (thanks to Luchezar P. Petkov)
-
-2005-09-27  Piotr O?arowski
-	* Volumes / Collections feature now in beta version (filtering is
-	  working, minor bugfixes)
-
-2005-09-26  Piotr O?arowski
-	* Volumes / Collections feature added (alpha version)
-
-2005-09-26  Vasco Nunes
-	* Added a debug method to urlretrieve calls 
-	* Added new XML export plugin
-	* Renamed Export With Templates plugin to HTML export plugin
-	* Fixed bug with tabs not being striped on director data on ClubeMyDVD
-	  movie plugin
-
-2005-09-23  Vasco Nunes
-	* DVDZone2 plugin renamed to Mediadis according to new company service and
-	  website. Some enhancement to this plugin implemented.
-
-2005-09-21  Piotr O?arowski
-	* Added Tanuki-Anime movie plugin.
-	* Minor changes in add and main window.
-	* Makefile update. Closes: #1324
-
-2005-09-21  Vasco Nunes
-	* Added experimental support for Microsoft Windows 2000, Millenium and
-	  Windows 98 systems
-	* [Bug #1313] Film fields with & or < break the PDF export plugin
-
-2005-09-20  Piotr O?arowski
-	* Some fixes in Makefile (for MacOSX users)
-
-2005-09-19  Piotr O?arowski
-	* UseTemplates export plugin update:
-	* [Bug #1314] LANG environment variable no longer required
-	* [Bug #1315] Added extra warning dialog when deleting directry
-
-2005-09-18  Vasco Nunes
-	* Added Moviefone (America online) movie plugin.
-	* [Bug #1312] notes not empty after adding a movie
-
-2005-09-14  Piotr O?arowski
-	* Small main window changes
-
-2005-09-13  Piotr O?arowski
-	* Movie plugins update ("with" entry updated to use multiline, minor bugs
-	  fixed)
-	* Gery movie plugin removed - webpage is not working
-	* movie.py: capwords() should be used only if needed
-
-2005-09-12  Vasco Nunes
-	* [Bug #1302] Searching movies with non-english characters gives null
-	  results
-	* Merged two patches contributed by Arjen Schwarz, addressing one problem
-	  with email notification that was using an incorrect date/time format and
-	  another fixing some english spell errors found in language file.
-	* Color, condition, layers info and region defaults now to 'n/a' when
-	  adding a new movie.
-
-2005-09-12  Piotr O?arowski
-	* UseTemplates export plugin update
-
-2005-09-11  Piotr O?arowski
-	* Updated Anime Database and Filmweb movie plugins
-	* Add movie window reorganization
-
----- 0.4.2 ----
-
-2005-09-10  Vasco Nunes
-	* Updated portuguese language
-	* Added portuguese griffith-export-template manpage
-	* Fixed a bug with malformed urls
-	* Moved some old orphan debugging lines to use new debug method
-	* Fixed encoding bug in built in debug method
-
-2005-09-09  Piotr O?arowski
-	* Added english and polish griffith-export-template manpage
-
-2005-09-08  Piotr O?arowski
-	* HTML export plugin renamed to "Use Templates" and updated to version 3.2
-	  (now uses non-english language data from config files)
-	* Polish translation updated
-
-2005-09-07  Vasco Nunes
-	* [Bug #1295] The 'How To Irritate People' bug :D
-
-2005-09-05  Vasco Nunes
-	* Some minor changes to griffith.desktop file
-
-2005-09-02  Vasco Nunes
-	* Added double click events to lists where needed
-	* Added a new button to add movie window: 'add movie and close'
-	* Added a popup menu to main treeview when left button is clicked over an
-	  entry to perform common tasks
-
-2005-08-31  Vasco Nunes
-	* Added portuguese manpages
-
-2005-08-29  Piotr O?arowski
-	* Some Makefiles changed/added
-
-2005-08-28  Piotr O?arowski
-	* Added english and polish manpages
-	* Added debug and usage command line options
-
-2005-08-27  Piotr O?arowski
-	* HTML export plugin updated to v3.1 - templates have now XML config
-	  files, styles can have preview images
-
-2005-08-24  Piotr O?arowski
-	* HTML export plugin updated to v3.1-beta
-
-2005-08-23  Piotr O?arowski
-	* Updated HTML export plugin (v3.0)
-	* Updated polish translation
-	* Minor changes in Debian package generation files
-
-2005-08-22  Vasco Nunes
-	* [Bug #1261] number disk is 0.
-
-2005-08-21  Piotr O?arowski
-	* HTML export plugin now uses templates! (version 3.0-rc1)
-
-2005-08-20  Vasco Nunes
-	* Merged a couple of patches contributed by Arjen Schwarz, addressing the
-	  following issues:
-	  [Bug #1260] data for the color, region, condition and layers not being
-	  stored in database; Some spelling mistakes fixed on english language
-	  file.
-
----- 0.4.1 ----
-
-2005-08-20  Vasco Nunes
-	* After adding a new movie, the original title widget has now the focus
-
-2005-08-18  Vasco Nunes
-	* Fixed some minor encoding problems with 7arte.net and ClubeMyDVD movie
-	  Plugins
-	* [Bug #1258] wrong movie fetching.
-	* Some UI changes on main window and add dialog
-	* When quick filter is changed movie details should be blank because no
-	  movie is selected. Fixed.
-	* Password characters in email reminder preferences are now hidden
-
-2005-08-18  Piotr O?arowski
-	* Navigation bar update (HTML export plugin)
-
-2005-08-17  Vasco Nunes
-	* [Bug #1253] gtkspell module not found.
-
----- 0.4 ----
-
-2005-08-16  Vasco Nunes
-	* Loans history implemented
-	* Fixed bug when updating a person data. Treeview was not refreshing.
-	* Fixed bug when deleting a person. Should not delete entries in use.
-	* Fixed bugs with some movie plugins.
-	* Added email reminder preferences (smtp server, auth, username, password,
-	  email address sender)
-	* Minor UI adjustment. Moved some fields from movie details tab to
-	  technical information.
-	* Fixed bug with sugest not seen movie not working when a filter is
-	  activated.
-	* Fix bug with random crashes when saving preferences caused by gtkspell
-
-2005-08-15  Vasco Nunes
-	* Added some artwork contributed by Peek
-
-2005-08-14  Piotr O?arowski
-	* Debian package generation files - initial import
-
-2005-08-14  Vasco Nunes
-	* [Bug #1250] Random Crashes. Fixed.
-
-2005-08-13  Piotr O?arowski
-	* Fixed bug #1246 (database upgrade when needed) 
-	* HTML export plugin update (added header entry)
-
-2005-08-13  Vasco Nunes
-	* Fixed a bug in movie data updating
-	* Fixed some bugs in e-mail loan reminder feature.
-	* Some more code cleaning
-
-2005-08-12  Piotr O?arowski
-	* Some fixes in HTML export plugin and polish movie plugins
-	* Fixed problems with AniDB movie plugin (changed gdecode method in
-	  gutils)
-
-2005-08-11  Vasco Nunes
-	* [Bug #1244] Missing poster images. Fixed.
-	* Added four new fields: color, media condition, dvd region and dvd layers
-	  information
-	* Merged some duplicated language strings.
-	* Added favorite movie plugin to preferences to be used by default when
-	  fetching web data 
-
-2005-08-11  Piotr O?arowski
-	* HTML export plugin updated to 2.3beta1
-	* Some new arguments added to get_all_data() function in sql.py
-
-2005-08-10  Vasco Nunes
-	* Added an email reminder option to loaned movies. Still todo: preferences
-	  (smtp server,port,auth...)
-	* Fixed a bug with progressbar when fetching movie posters
-	* Fixed bug with wrong filter behaviour when no data is entered on it
-	* Implemented some generic toolbar buttons
-
-2005-08-09  Vasco Nunes
-	* Fixed a couple of bugs when adding/cloning movies in empty movie
-	  positions. Now the main treeview is always sorted.
-	* Updated polish translation
-	* Updated all polish movie plugins
-	* Added AniDB (english) movie plugin (contributed by Piotr O?arowski)
-	* Added ClubeMyDVD (portuguese) movie plugin
-	* New method for movie plugins available - movie notes (optional). This
-	  field could be used to fetch and store misc information/details about the
-	  entry.
-	* Fixed bug in movie entry clone feature. Some fields were not being
-	  escaped as expected.
-
-2005-08-08  Vasco Nunes
-	* Added picture preview and filter to file choose dialog
-	* Makefile fixed. Make action shouldn't perform a make install.
-
-2005-08-07  Vasco Nunes
-	* Fixed some minor problems with IMDB plugin
-	* Fixed bug with non unique filenames being produced for movie posters
-	* Replaced old rating spin control by an horizontal slider
-	* Rating and 'seen it' values are automatically saved when changed now
-
-2005-08-05  Vasco Nunes
-	* Added a new 'seen movie' field to db
-	* View menu reworked. Added a 'view not seen movies' filter to it.
-	* Added a 'Suggest a movie' feature picked from not seen list.
-	* Portuguese translation updated
-
-2005-08-04  Vasco Nunes
-	* Images are now scaled down to a new file on disk when needed and are not
-	  scaled on the fly anymore. This should result in some better performance
-	  results with larger collections. 
-	* Some minor cosmethic changes on default images
-	* Added spellchecker options to preferences dialog to choose fields and
-	  default language to be used within (unix only)
-
-2005-08-01  Vasco Nunes
-	* Added a very basic debug module
-
-2005-07-29  Vasco Nunes
-	* Some API plugins changes for easier third-party development
-
-2005-07-28  Vasco Nunes
-	* Added OFDb (german) movie plugin contributed by Christian Sagmueller
-	* Some code cleanup
-	* Added german language translation contributed by Christian Sagmueller
-
-2005-07-23  Vasco Nunes
-	* Fixed some windows related import paths for easier packaging
-	* Fixed some HTML export plugin bugs when used on windows systems
-
----- 0.3 ----
-
-2005-07-21  Vasco Nunes
-	* Updated polish and portuguese language translations
-	* HTML export plugin updated to v2.0RC1
-
-2005-07-19  Vasco Nunes
-	* Added a free unicode truetype font (Lucida) to distribution
-	* Some minor PDF export plugin related fixes
-	* [Bug #1190] Encoding problems with polish when exporting to PDF. Fixed.
-	* HTML export plugin updated to v2.0beta3
-	* Updated polish and portuguese language translations
-	* Added E-Pipoca (brasilian) movie plugin
-
-2005-07-16  Vasco Nunes
-	* HTML export plugin updated to v2.0beta2
-	* Updated polish and portuguese language translations
-	* Added Cinematografo (Italian) plugin
-	* Fixed bug. Problem with some characters not escaped as should be when
-	  inserting in db.
-
-2005-07-15  Vasco Nunes
-	* Old export filters changed to plugins
-	* Included Piotr O?arowski's HTML export plugin v2.0beta
-
-2005-07-14  Vasco Nunes
-	* Created a 'plugins' directory. Moved all movie plugins to this new 
-	  directory for better organization, inside own subdirectory 'movie'
-	* Initial export plugins support
-
-2005-07-12  Vasco Nunes
-	* [Bug #1193] Add new. Cancel not working. Fixed.
-
-2005-07-07  Vasco Nunes
-	* Config module rewritten. Now config uses pickle for better cross
-	  platform handling.
-	* Griffith now stores window size and position on exit.
-
-2005-07-06  Vasco Nunes
-	* Added simple html list exporting. (thanks to Piotr O?arowski)
-
-2005-07-05  Vasco Nunes
-	* [Bug #1194] Filter drop menu not working. Fixed.
-	* [Bug #1195] Loans not working. Fixed.
-	* [Bug #1196] Can't delete people on the friends list. Fixed.
-	* Now is not possible to delete a person with loaned films.
-	* Some minor UI changes
-	* [Bug #1191] Main window needs to me smaller. Fixed.
-	* Added .ico for windows version
-	* [Bug #1192] New database not working under windows. Fixed.
-	* Added delete key event support on main viewlist to delete rows
-
-2005-07-03  Vasco Nunes
-	* Added CineMovie (french) plugin
-
----- 0.2 ----
-
-2005-07-02  Vasco Nunes
-	* [Bug] Sorting by film number don't work as expected. Fixed.
-	* Added toggle toolbar view functionality
-	* [Bug #1176] Last item not selected. Closed.
-
-2005-07-01  Vasco Nunes
-	* Added some menu shortcuts
-	* Added view menu
-	* Another portuguese/polish translation update
-	* All polish plugins now include rating capability (thanks to Piotr
-	  O?arowski)
-
-2005-06-30  Vasco Nunes
-	* Changed plugin detection function to use glob module instead
-	* all file operations changed to use shutil module instead
-	* General code cleaning
-	* [Bug] Before function in gutils returning incorrect string. Fixed.
-	  (thanks to Piotr O?arowski)
-	* added Onnet Film (polish) plugin (thanks to Piotr O?arowski).
-	* polish translation updated
-	* portuguese translation updated
-	* Added film ratings
-	* Added ratings to quick filter
-	* [Bug] Clearing filter with some criterias were not refreshing main
-	  treeview. Fixed.
-
-2005-06-29  Vasco Nunes
-	* Moved all glade widgets/event handlers definitions for a new module
-	* Moved editing functions to a new module
-	* [Bug] Changed all file selection dialogs to modal
-
-2005-06-28  Vasco Nunes
-	* Added year to search results on imdb plugin
-
-2005-06-26  Vasco Nunes
-	* [Bug] Problem with null searches fixed 
-	* [Bug] Fixed bug on imdb plugin. exact matches were not returning any
-	  results.
-	* When an exact match is founded griffith tries to use it automatically
-
-2005-06-23  Vasco Nunes
-	* new update to polish translation.
-	* added FilmWeb (polish) plugin (thanks to Piotr O?arowski).
-	* added WP (polish) plugin (thanks to Piotr O?arowski).
-	* added csv export filter
-	* added initial support for gtkspell under *nix systems. new dependency:
-	  python-gnome-extras (optional - will not be used if not available)
-	* main poster changed to a button widget allowing now to select a custom
-	  poster image.
-
-2005-06-22  Vasco Nunes
-	* added Gery Film (polish) plugin (thanks to Piotr O?arowski).
-	* [Bug] Fixed bug with null year and runtime display
-	* [Bug] Fixed some bugs related with single quote problems
-	* Implemented a new field to write custom notes
-
-2005-06-21  Vasco Nunes
-	* updated polish translation. fixed encoding problems.
-	* added PTGate.pt (portuguese) plugin.
-	* hardcoded library locations fixed.
-	* added main treeview flag on loaned films.
-	* [Bug #] After droping old database and creating a new one, new movie
-	  don't get ID=1 but incremented old highest value. Fixed.    
-
-2005-06-20  Vasco Nunes
-	* true plugin system implemented.
-	* included stopklatka.pl (polish) plugin (thanks to Piotr O?arowski).
-	* [Bug #] bug with year and running time not filled when image is not
-	  available. Fixed.
-	* updated polish translation.
-
-2005-06-19  Vasco Nunes
-	* added polish translation (thanks to Piotr O?arowski).
-
----- 0.1 ----
-
-2005-06-18  Vasco Nunes
-	* public release - version 0.1

Copied: tags/0.10/ChangeLog (from rev 1271, trunk/ChangeLog)

Deleted: tags/0.10/NEWS
===================================================================
--- trunk/NEWS	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/NEWS	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,458 +0,0 @@
-Griffith 0.10-rc1
-=================
-* New export plugins: Ant Movie Catalog, GCstar, DVD Profiler XML Export V2 and V3
-* New import plugin: Ant Movie Catalog
-* Updated movie plugins: IMDb, Allocine, CineMovies, IMDb-de, MovieMeter,
-  Zelluloid, AniDB
-* Few bugs fixed
-
-
-Griffith 0.10-beta3
-===================
-* Backup function fixed
-* PostgreSQL/MySQL backup support added
-* Restoring from backup works with external databases
-* New movie plugins: All Media Guide and MovieMete
-* Many movie plugins updated
-
-
-Griffith 0.10-beta2
-===================
-* Most movie plugins updated
-* New fields: barcode, resolution (width and height or PAL, NTSC, VGA, HD 1080, etc.)
-* Better results for Amazon poster search
-* HTML export plugin exports posters again
-* Reload movie plugin each time search is performed (in --debug mode only, this
-  should ease writing movie plugins)
-* Canceling search doesn't throw exception anymore
-* --shell command line option added (for advanced users/developers only!)
-
-
-Griffith 0.10-beta1
-===================
-* Filter movies using complex search criteria functionality
-* Posters stored in database (+local cache)
-* New fields: aspect ratio, cameraman and screenplay
-* Lots of internal changes
-  + Unicode used internally (less problems with encodings, still needs some work)
-* Movie plugins updated
-* Export plugins are now exporting movies listed in main window only
-* Lots of bugs fixed, some speedups
-
-Note to package maintainers:
-Please note that Griffith requires Python >=2.5 and SQLAlchemy >=0.5 now
-(see `./griffith --check-dep` or `./griffith --show-dep`)
-
-
-Griffith 0.9.8
-==============
-* New movie plugin: Amazon
-* Updated movie plugins: IMDb, IMDB-de, Kino.de, OFDb, FilmeVonAZ, Zelluloid
-* Translation changes:
-  + new: Persian, Finnish, Low German
-  + updated: bg, fi, pl, rs, fa
-* added compatibility with pysqlite2 2.5.0
-* bugs fixed: #179618, #258817, #273172, #253272 (see ChangeLog for more)
-
-
-Griffith 0.9.7.1
-================
-* Fixed crash when database (rating/year/runtime fields) contains empty data
-
-
-Griffith 0.9.7 ("Michael Jahn's release" :-)
-==============
-* Fixed fetching posters from Amazon
-* Updated movie plugins: DVDEmpire, Filmtipset, Filmweb, OFDb, Zelluloid
-* Update export plugins: HTML, PDF
-* Translation changes:
-  + new: Latvian, Ukrainian 
-  + updated: bg, ca, da, de, el, es, fr, it, nb, pt, pt_BR, ru, sv, tr
-* Few quick filter combos added (advanced search function not ready yet)
-* See ChangeLog for more changes
-
-
-Griffith 0.9.6
-==============
-* Distribute local copy of SQLAlchemy 0.3.11 (Griffith 0.10 which will work
-  with SQLAlchemy 0.4.x is not ready yet)
-* Updated movie plugins: AniDb, FilmeVonAZ, Kino.de, OFDb, Stopklatka,
-  Zelluloid
-* Translation changes:
-  + new: Estonian, Hungarian, Indonesian, Korean, Occitan (post 1500), Pashto,
-	 Slovak
-  + updated: almost all :-)
-* Quick filter for volumes
-* Added columns genre, seen, runtime and year to the mainlist
-* See ChangeLog for more changes
-
-
-Griffith 0.9.5
-==============
-* Backup function fixed
-* Updated movie plugins: 7arte, IMDB-de, KinoDE
-* Several changes on loan e-mail reminder system:
-  + Loan E-mail reminder timeout implemented
-  + Support for TLS smtp auth handshaking
-  + Added smtp server port usage
-  + Added gmail smtp server support
-* Translation changes:
-  + new: Catalan, Norwegian Bokmal
-  + updated: Brazilian Portuguese, Cech, Dutch, French, German, Italian,
-             Polish, Portuguese, Russian
-* [Bug #11864] Fixed medium and video codec's default value in add window
-
-
-Griffith 0.9.4
-==============
-* Fixed volume/colection loaning problem
-* Support for different database names with sqlite
-* Updated movie plugins: FDb, OFDb, PTGate, Kino.de, DVD-Palace and IMDB-de
-* New movie plugins: FilmTipset
-* Translation files synchronized with Rosetta
-  + new: Japanese, Russian and Turkish
-  + updated: Czech, Spanish, Bulgarian, Greek
-* Few bugs fixed
-
-
-Griffith 0.9.3.1
-================
-* Problem with saving database preferences in config file fixed
-
-
-Griffith 0.9.3
-==============
-* New configuration file format (human readable) - please note that data from
-  old config file is not used
-* Updated movie plugins: Filmweb, WP, FDb, IMDb, 7arte.net, Cineteka, Kino.de,
-  DVD-Palace, E-Pipoca, Stopklatka
-* New movie plugins: FilmDb, Zelluloid, IMDb-de
-* New translations:
-  + Dutch (thanks to Marcel Dijkstra)
-  + Danish (thanks to Joe Dalton)
-  + Greek (thanka to Ioannis Koniaris)
-  + Simplified Chinese (thanks to kempson)
-* Updated translations: German, Spanish, French, Polish and Portuguese
-  Brazilian (from Rosetta)
-* Added new alpha export plugin for iPods
-* Added Microsoft SQL support
-* Lots of bugs fixed
-
-
-Griffith 0.9.2
-==============
-* Updated movie plugins: IMDB, CSFD, KinoDE, FilmeVonAZ
-* New movie plugin: DVDEmpire
-* New seen/unseen icons
-
-
-Griffith 0.9.1
-==============
-Loan data is now imported correctly from old database.
-Broken databases will be fixed automatically, but return date will be set to 2007-01-01.
-If you don't like this behaviour, redo the upgrade process by changing
-"griffith.db" into "griffith.gri" in griffith.conf file. On Linux you can do
-that with this simple command: `sed -ie 's/griffith.db/griffith.gri/' ~/griffith.conf`
-
-
-Griffith 0.9
-============
-* Possible memory leak fixed (year data from some movie plugins wasn't parsed
-  correctly)
-* AnimeDB, Filmweb, PTGate and WP movie plugins updated
-* CSV import plugin updated
-* Fetch from Amazon function recognizes more posters now
-* First movie is selected by default now
-* Czech translation updated
-
-
-Griffith 0.9-rc3
-================
-* Old database is not modified during upgrade process (bug introduced in 0.9-rc2)
-* Catch some more bad cases while upgrading database
-* Fix upgrading volume / collection loan data
-* Updated translations: Italian
-
-
-Griffith 0.9-rc2
-================
-* Griffith works now a lot faster with large (>1000 movies) databases
-* Fix displaying volume/collection's loan status
-* Config files are now fully cross-platform
-* New features:
-  + limit search results to x movies
-  + sort by last added movies
-  + hide "Number" column
-  + change "seen it" status without opening edit window, new icons added
-* Filmweb movie plugin fixed
-* Updated translations: Czech, French, German, Portuguese, Portuguese Brazilian,
-  Swedish 
-
-Note to package maintainers:
-Please keep pysqlite1.0 as required dependency (see README file)
-This will make upgrade process from 0.6.2 a lot easier.
-
-
-Griffith 0.9~rc1 "Christmas Edition"
-====================================
-This release is marked as "Release Candidate" due to:
- - database format change (if you have any problems send us the
-   ~/.griffith/griffith.gri file or `griffith --debug` output)
- - translations are not finished (translators need more time)
-
-* SQLAlchemy transition, i.e.
-  + MySQL support added
-  + PostgreSQL support added
-  + SQLite3 transition on Linux (pysqlite2 is now required)
-* Import plugin system added, first import plugin (CSV)
-* All movie plugins updated
-* New data:
-  + video codec
-  + audio codec
-  + audio channels
-  + subtitle format
-  + "commentary" language type added
-* GUI changes:
-  + editing movie details moved to "Add" dialog
-  + languages data look changed
-  + draggable toolbar
-  + new "next" / "previous" buttons
-  + windows converted to dialogs
-* Selectable search data in movie plugins (search only for data you want to
-  download or not yet filled data)
-* Fetch details from different movie plugins
-* Smaller backup zip files generation
-* HTML export plugin changes:
-  + Fixed problem with posters conversion on Windows
-  + New green style in exported HTML tables
-* Configurable main list's default sorting criteria
-* Lots of bugs fixed (some new added ;-)
-
-
-Griffith 0.6.2
-==============
-This release updates some movie plugins. It's last release before
-SQLAlchemy transition. See SVN repository for list of new features already
-available.
-
-Updates:
-
-* Updated movie plugins: 7arte, AniDB, Cinematografo, Filmweb, IMDb.
-* New movie plugins: FilmeVonAZ, MovieKinoDe ((thanks to Michael Jahn), FDb.
-* Added italian translation (thanks to Diego Porcelli).
-* German translation updated (thanks to Malte Wiemann).
-* Some other tiny changes.
-
-
-Griffith 0.6.1
-==============
-This is mainly a bug fix release. Some changes:
-
-* Updated spanish, czech and polish language files.
-* Updated allocine and CSFD movie plugins.
-* Some makefile code cleanup.
-* First tag can now be renamed.
-* Quick filter rewrited with new fields as well.
-* Some language typos fixed.
-* Many windows related fixes.
-* Windows version is now up-to-date with posix one.
-* Initial latex export support
-
-
-Griffith 0.6
-============
-Latest Griffith has some new exciting features and dozens of bugs fixed as
-well. Also, this version has a reworked user interface and many code
-improvements.
-
-Some highlights:
-
-* Unlimited movie languages (lector, dubbing and subtitles).
-* Unlimited movie tags.
-* A reworked user interface
-* A new french movie plugin - Allocine (Thanks to Pierre-Luc Levy).
-* Added french translation (Thanks to Pierre-Luc Levy).
-* Added spanish translation (thanks to Daniel Ucero).
-* Movie numbers are now editable.
-* Custom fonts for PDF lists and movie covers.
-* Initial console support with multiple arguments for searching operations,
-  debug and maintenance.
-* Dozens of bugs fixed and lots of code optimization. See full changelog for
-  details.
-
-
-Griffith 0.5.1
-==============
-Changes/New features:
-
-* Added posters conversion to HTML export plugin
-* Added simple style to table template (HTML export plugin)
-* Added a win32 installer custom image.
-* Added portuguese, polish, german and czech translations to win32 installer.
-* Added Czech translation (Thanks to Blondak )
-* Added a new czech movie plugin (CSFD - esko-Slovensk Filmov Databze) - Thanks
-  to Blondak 
-* Polish translation updated
-
-Bugs fixed:
-
-* [Bug #5686] Colection/volume remembers selection after adding a movie
-* [Bug #5631] wrong language/locale with 0.5
-* [Bug #5684] About window doesn't work on windows
-* [Bug #5683] Two filters not working at all on windows
-* Removed cancel button from confirmation dialogs
-* Fixed layer dropdown list entries
-* 'Excellent' mispelled in condition dropdown list
-
-
-Griffith 0.5
-============
-Changes/New features
-
-* HTML export plugin updated to v3.3
-* Updated polish and portuguese translations
-* Memory management improvements when using large db collections
-* Media names are now stored in database. No frontend interface yet.
-* Added support to fetch bigger posters using Amazon Web Services
-* Added some HTML export plugin fixes for win32 compatibility
-* win32 build should use now the libwimp widget engine for better windows xp
-  default theme integration
-* Now Griffith's dir defaults to localized 'My Documents' dir on win32
-  environments
-* Added preferences defaults to media, layers, condition, color and region
-* Updated WP movie plugin (webpage was changed)
-* Removing poster images when deleting movie feature added
-* Added a 'by collection' quick filter
-* Poster viewer events changed to only show full poster when entering/leaving
-  zoom button
-* Moved all movie plugins logos to a new optional package
-* Added some tooltips to preferences widgets
-* Added some new tools to operate with posters
-* Added bulgarian translation (thanks to Luchezar P. Petkov)
-* Volumes / Collections feature added
-* Added new XML export plugin
-* Renamed Export With Templates plugin to HTML export plugin
-* DVDZone2 plugin renamed to Mediadis according to new company service and
-  website. Some enhancement to this plugin implemented.
-* Added Tanuki-Anime and Moviefone (America online) movie plugin
-* Added experimental support for Microsoft Windows 2000, Millenium and Windows 98
-  systems
-* Some fixes in Makefile (for MacOSX users)
-* Small main window changes
-* Gery movie plugin removed - webpage is not working
-* Merged two patches contributed by Arjen Schwarz, addressing one problem with
-  email notification that was using an incorrect date/time format and another
-  fixing some english spell errors found in language file.
-* Updated Anime Database and Filmweb movie plugins
-* Movie window reorganization
-
-Bugs fixed:
-
-* [Bug #1302] Searching movies with non-english characters gives null results
-* [Bug #1312] notes not empty after adding a movie
-* [Bug #1314] LANG environment variable no longer required
-* [Bug #1315] Added extra warning dialog when deleting directory
-* [Bug #1313] Film fields with & or < break the PDF export plugin
-* [Bug #5306] Last toolbar button not working as expected
-* [Bug #5344] fixed wrong encoding in IMDb movie plugin (thanks to dieterv)
-* [Bug #1324] Makefile fix.
-
-
-Griffith 0.4.2
-==============
-This is mainly a bug fixing release, addressing some issues found on the
-previous one. These are the main changes:
-
-* HTML export plugin now can use custom templates with XML config files. Styles
-  can have a thumbnail picture preview
-* Added manpages to griffith and to griffith-export-template
-* Added double click events and a popup menu in maintree view
-
-Bugs fixed:
-
-* [Bug #1260] data for the color, region, condition and layers not being stored
-  in database; Some spelling mistakes fixed on english language file. (thanks to
-  Arjen Schwarz)
-* [Bug #1261] number disk is 0.
-* [Bug #1295] The 'How To Irritate People' bug
-* Fixed encoding bug in built in debug method
-* Fixed a bug with malformed urls
-
-Read the included Changelog for the complete listing.
-
-
-Griffith 0.4.1
-==============
-A bug fix release, addressing some issues found on 0.4:
-
-* Fixed some encoding problems with portuguese movie plugins
-* Some minor UI changes
-* HTML export plugin update
-* [Bug #1258] wrong movie fetching
-* [Bug #1253] gtkspell module not found
-
-
-Griffith 0.4
-============
-* Loans history implemented
-* Better performance for large collections
-* New 'E-mail reminder' feature
-* HTML export plugin updated
-* New fields: seen movie, color, media condition, DVD region and DVD layers
-  information
-* Favorite movie plugin can be defined in the preferences
-* New movie plugins added: AniDB (english), OFDb (german) and ClubeMyDVD
-  (portuguese)
-* Added german translation; polish and portuguese translations updated.
-* Added picture preview and filter to file choose dialog
-* Added a 'Suggest a movie' feature.
-* Some minor UI changes.
-* Dozens of bugs fixed.
-
-Read the included Changelog for the complete listing.
-
-
-Griffith 0.3
-============
-* Three new movie plugins: CineMovie (french), Cinematografo (italian) and
-  E-pipoca (brasilian)
-* Added key events for trivial operations
-* Export plugin system implemented
-* Added HTML export plugin (contributed by Piotr Ozarowski)
-
-Bugs fixed:
-
-* [Bug #1192] New database not working under windows
-* [Bug #1196] Can't delete people on the friends list
-* [Bug #1195] Loans not working
-* [Bug #1194] Filter drop menu not working
-* [Bug #1193] Add new. Cancel not working 
-* [Bug #1190] Encoding problems with polish when exporting to PDF (and other
-  languages)
-* Problem with some characters not escaped as should be when inserting in db
-* Some minor PDF export plugin related fixes
-
-
-Griffith 0.2
-============
-* Multilanguage support (UNIX only)
-* Polish translation added (thanks to Piotr Ozarowski)
-* Portuguese translation added
-* True plugin system for web based data sources implemented
-* Five new polish plugins added (Filmeweb, Gery, Onet, Stopklatka and WP -
-  thanks to Piotr Ozarowski)
-* One new portuguese plugin added (PTGate)
-* Added flag for loaned films
-* Two new fields for data holding: notes and film rating
-* Film posters can now be replaced by custom ones
-* Initial gtkspell support (unix only)
-* Export database to CSV file
-* Exact search matches are now used without user intervention
-* Initial Microsoft Windows support
-* Initial Red Carpet package availability
-* Dozens of bugs fixed. See source package changelog for details.
-
-
-Griffith 0.1
-============
-Initial release

Copied: tags/0.10/NEWS (from rev 1271, trunk/NEWS)

Deleted: tags/0.10/debian/changelog
===================================================================
--- trunk/debian/changelog	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/debian/changelog	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,199 +0,0 @@
-griffith (0.10~rc1-1) unstable; urgency=low
-
-  * New upstream release
-  * Bump Standards-Version to 3.8.2 (no changes needed)
-  * Upload to unstable
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 12 Jul 2009 22:57:18 +0200
-
-griffith (0.10~beta3-1) experimental; urgency=low
-
-  * New upstream release
-  * Update preinst script to handle 0.10~beta versions
-
- -- Piotr O?arowski <piotr at debian.org>  Thu, 11 Jun 2009 22:14:40 +0200
-
-griffith (0.9.10-1) unstable; urgency=low
-
-  * New upstream release
-  * Convert to python-support
-    + add preinst maintainer script to clean after pycentral
-  * Add docbook2x to Build-Depend-Indep
-  * Bump Standards-Version to 3.8.1 (no changes needed)
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 10 May 2009 21:43:22 +0200
-
-griffith (0.10~beta2-1) experimental; urgency=low
-
-  * New upstream release
-  * Changes in dependencies:
-    + SQLAlchemy minimum required version bumped to 0.5
-    + pysqlite2 removed from alternative dependencies as python2.5 is now
-      required
-    + python-sqlite moved to Suggests
-    + ipython added to Suggests (--shell option)
-
- -- Piotr O?arowski <piotr at debian.org>  Tue, 10 Feb 2009 21:08:30 +0100
-
-griffith (0.9.9-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr O?arowski <piotr at debian.org>  Sat, 27 Dec 2008 22:47:18 +0100
-
-griffith (0.10~beta1-1) experimental; urgency=low
-
-  * New upstream release
-    + XS-Python-Version bumped to >=2.5
-
- -- Piotr O?arowski <piotr at debian.org>  Mon, 17 Nov 2008 22:20:53 +0100
-
-griffith (0.9.8-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 16 Nov 2008 21:58:55 +0100
-
-griffith (0.9.7.1-1) unstable; urgency=low
-
-  * New upstream release
-  * Homepage updated
-
- -- Piotr O?arowski <piotr at debian.org>  Sat, 26 Jul 2008 22:04:07 +0200
-
-griffith (0.9.7-1) unstable; urgency=medium
-
-  * New upstream release
-  * debian/watch updated
-  * Bump Standards-Version to 3.8.0 (no changes needed)
-
- -- Piotr O?arowski <piotr at debian.org>  Mon, 21 Jul 2008 19:10:08 +0200
-
-griffith (0.9.6-2) unstable; urgency=low
-
-  * Added patch for Python>=2.4's xml module compatibility (LP: #203161)
-
- -- Piotr O?arowski <piotr at debian.org>  Sat, 22 Mar 2008 15:15:01 +0100
-
-griffith (0.9.6-1) unstable; urgency=low
-
-  * New upstream release
-    + includes local copy of SQLAlchemy 0.3.11 (closes: #453736)
-  * python-sqlalchemy dependency temporary removed
-    (0.10 will require SQLAlchemy 0.4 so it closes: #443199)
-  * Remove "XS-" prefix from Vcs-* fields (dpkg supports them now)
-  * Add Homepage field
-  * Bump Standards-Version to 3.7.3 (no changes needed)
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 27 Jan 2008 23:28:39 +0100
-
-griffith (0.9.5-1) unstable; urgency=low
-
-  * New upstream release 
-  * debian/watch file updated
-  * debian/menu file updated
-  * Add python-sqlalchemy (<< 0.4~) to depends (Griffith doesn't work with SA
-    0.4 for now)
-  * python-sqlite package moved to Recommends
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 02 Sep 2007 23:56:26 +0200
-
-griffith (0.9.4-1) unstable; urgency=low
-
-  * New upstream release
-  * Update XS-Vcs-* fields to point to debian dir
-
- -- Piotr O?arowski <piotr at debian.org>  Sun, 05 Aug 2007 20:21:23 +0200
-
-griffith (0.9.3.1-1) unstable; urgency=low
-
-  * New upstream release 
-
- -- Piotr O?arowski <piotr at debian.org>  Mon, 02 Jul 2007 19:32:15 +0200
-
-griffith (0.9.3-1) unstable; urgency=low
-
-  * New upstream release
-  * Don't require python-pysqlite2 if Python 2.5 is the default Python version
-    (sqlite3 module will be used if possible)
-  * Changed my address to piotr at debian.org
-
- -- Piotr O?arowski <piotr at debian.org>  Sat, 30 Jun 2007 16:47:04 +0200
-
-griffith (0.9.2-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Tue, 20 Feb 2007 17:01:26 +0100
-
-griffith (0.9.1-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Mon, 12 Feb 2007 21:30:40 +0100
-
-griffith (0.9-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Fri, 26 Jan 2007 19:49:36 +0100
-
-griffith (0.9~rc3-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Tue,  9 Jan 2007 23:17:41 +0100
-
-griffith (0.9~rc2-1) unstable; urgency=low
-
-  * New upstream release
-  * debian/copyright and debian/watch files updated
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Mon,  8 Jan 2007 00:04:41 +0100
-
-griffith (0.9~rc1-1) experimental; urgency=low
-
-  * New upstream release
-  * Dependencies updated (python-sqlite is still in Depends: to make the
-    upgrade process smooth)
-  * Added XS-Vcs-Svn and XS-Vcs-Browser fields to debian/control
-  * Homepage updated
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Wed, 20 Dec 2006 17:30:14 +0100
-
-griffith (0.6.2-1) unstable; urgency=low
-
-  * New upstream release
-  * Updated to latest python policy (closes: #380835)
-    - Convert to python-central
-    - Bumped debhelper compatibility level to 5
-    - Dependencies updated (closes: #377570)
-    - Added new debian/pycompat file
-  * Watch file added
-  * Removed changelog entries before initial Debian release
-  * Added info about amazon.py file in debian/copyright
-  * Standards-version bumped to 3.7.2 (no changes needed)
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Tue,  1 Aug 2006 15:38:22 +0200
-
-griffith (0.6.1-1) unstable; urgency=low
-
-  * New upstream release
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Fri, 14 Apr 2006 22:50:45 +0200
-
-griffith (0.6+svn293-1) unstable; urgency=low
-
-  * Upstream homepage added to the package description
-  * Updated to latest SVN version
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Sun, 12 Mar 2006 17:48:08 +0100
-
-griffith (0.6-1) unstable; urgency=low
-
-  * New upstream release (closes: #329853)
-  * Recommendations and build-depends updated
-  * Package is now lintian and linda clean
-
- -- Piotr Ozarowski <ozarow at gmail.com>  Sun,  5 Mar 2006 19:53:00 +0100
-

Copied: tags/0.10/debian/changelog (from rev 1271, trunk/debian/changelog)

Deleted: tags/0.10/lib/version.py
===================================================================
--- trunk/lib/version.py	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/lib/version.py	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,29 +0,0 @@
-# -*- coding: UTF-8 -*-
-
-__revision__ = '$Id$'
-
-# Copyright (c) 2005-2009 Vasco Nunes, Piotr O?arowski
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU Library General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
-
-# You may use and distribute this software under the terms of the
-# GNU General Public License, version 2 or later
-
-pname        = "Griffith"
-pversion     = "0.10-rc1+svn"
-pauthor      = "Vasco Nunes, Piotr O?arowski <griffith-private at lists.berlios.de>"
-pyear        = "2005-2009"
-pwebsite     = "http://www.griffith.cc/"
-pdescription = _("Griffith is a film collection manager.")

Copied: tags/0.10/lib/version.py (from rev 1271, trunk/lib/version.py)

Deleted: tags/0.10/winpackage.iss
===================================================================
--- trunk/winpackage.iss	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/winpackage.iss	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,206 +0,0 @@
-; Script generated by the Inno Setup Script Wizard.
-; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!
-
-[Setup]
-AppName=Griffith
-AppVerName=Griffith 0.10-rc1
-AppPublisher=Vasco Nunes, Piotr O?arowski
-AppPublisherURL=http://griffith.cc/
-AppSupportURL=http://griffith.cc/
-AppUpdatesURL=http://griffith.cc/
-DefaultDirName={pf}\Griffith
-DefaultGroupName=Griffith
-AllowNoIcons=true
-LicenseFile=COPYING
-InfoAfterFile=README
-OutputDir=installer
-OutputBaseFilename=griffith-0.10-rc1-win32
-SetupIconFile=images\griffith.ico
-Compression=lzma
-SolidCompression=true
-WizardImageFile=images\griffith_win32_installer.bmp
-InternalCompressLevel=ultra
-AppCopyright=Vasco Nunes/Piotr Ozarowski
-DisableStartupPrompt=false
-AppVersion=0.10-rc1
-VersionInfoVersion=0.10.2
-
-[Languages]
-Name: eng; MessagesFile: compiler:Default.isl
-Name: por; MessagesFile: compiler:languages\Portuguese.isl
-Name: por; MessagesFile: compiler:languages\BrazilianPortuguese.isl
-Name: pol; MessagesFile: compiler:languages\Polish.isl
-Name: ger; MessagesFile: compiler:languages\German.isl
-Name: cze; MessagesFile: compiler:languages\Czech.isl
-Name: dut; MessagesFile: compiler:languages\Dutch.isl
-Name: fin; MessagesFile: compiler:languages\Finnish.isl
-Name: ita; MessagesFile: compiler:languages\Italian.isl
-Name: fre; MessagesFile: compiler:languages\French.isl
-Name: nor; MessagesFile: compiler:languages\Norwegian.isl
-Name: hun; MessagesFile: compiler:languages\Hungarian.isl
-Name: spa; MessagesFile: compiler:languages\Spanish.isl
-Name: chi; MessagesFile: compiler:languages\ChineseSimp-11-5.1.0.isl
-Name: gre; MessagesFile: compiler:languages\Greek-4-5.1.11.isl
-Name: jap; MessagesFile: compiler:languages\Japanese-5-5.1.11.isl
-Name: bul; MessagesFile: compiler:languages\Bulgarian-5.1.11.isl
-
-[LangOptions]
-LanguageCodePage=0
-
-[Tasks]
-Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
-Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
-
-[Files]
-Source: dist\griffith.exe; DestDir: {app}; Flags: ignoreversion
-; don't use recursion because of components selection (movie plugins, ...)
-Source: dist\*;        DestDir: {app}; Flags: ignoreversion
-; use recursion, no components
-Source: dist\etc\*;    DestDir: {app}\etc;    Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\glade\*;  DestDir: {app}\glade;  Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\i18n\*;   DestDir: {app}\i18n;   Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\images\*; DestDir: {app}\images; Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\share\*;  DestDir: {app}\share;  Flags: ignoreversion recursesubdirs createallsubdirs
-; don't use recursion because of components selection (movie plugins, ...)
-Source: dist\lib\*;    DestDir: {app}\lib;    Flags: ignoreversion
-; use recursion, no components
-Source: dist\lib\db\*;           DestDir: {app}\lib\db;           Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\gettext\*;      DestDir: {app}\lib\gettext;      Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\glade3\*;       DestDir: {app}\lib\glade3;       Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\glib-2.0\*;     DestDir: {app}\lib\glib-2.0;     Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\gtk-2.0\*;      DestDir: {app}\lib\gtk-2.0;      Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\gtkglext-1.0\*; DestDir: {app}\lib\gtkglext-1.0; Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\libglade\*;     DestDir: {app}\lib\libglade;     Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\pango\*;        DestDir: {app}\lib\pango;        Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\pkgconfig\*;    DestDir: {app}\lib\pkgconfig;    Flags: ignoreversion recursesubdirs createallsubdirs
-; don't use recursion because of components selection (movie plugins, ...)
-Source: dist\lib\plugins\*;        DestDir: {app}\lib\plugins;    Flags: ignoreversion
-; use recursion, no components
-Source: dist\lib\plugins\export\*; DestDir: {app}\lib\plugins\export; Flags: ignoreversion recursesubdirs createallsubdirs
-Source: dist\lib\plugins\imp\*;    DestDir: {app}\lib\plugins\imp;    Flags: ignoreversion recursesubdirs createallsubdirs
-; component based installation
-Source: dist\lib\plugins\movie\PluginMovie7arte.py;         DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Portuguese\7arte
-Source: dist\lib\plugins\movie\PluginMovieAllMovie.py;      DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\English\AllMovie
-Source: dist\lib\plugins\movie\PluginMovieAllocine.py;      DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\French\Allocine
-Source: dist\lib\plugins\movie\PluginMovieAmazon.py;        DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Amazon
-Source: dist\lib\plugins\movie\PluginMovieAniDB.py;         DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\English\AnimeDB
-Source: dist\lib\plugins\movie\PluginMovieCinematografo.py; DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Italian\Cinematografo
-Source: dist\lib\plugins\movie\PluginMovieCineMovies.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\French\CineMovies
-Source: dist\lib\plugins\movie\PluginMovieCineteka.py;      DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Portuguese\Cineteka
-Source: dist\lib\plugins\movie\PluginMovieCSFD.py;          DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Czech\CSFD
-Source: dist\lib\plugins\movie\PluginMovieCulturalia.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Spanish\Culturalia
-Source: dist\lib\plugins\movie\PluginMovieDVDEmpire.py;     DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\English\DVD_Empire
-Source: dist\lib\plugins\movie\PluginMovieDVDPalace.py;     DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\DVD_Palace
-Source: dist\lib\plugins\movie\PluginMovieE-Pipoca.py;      DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Brazilian_Portuguese\E_Pipoca
-Source: dist\lib\plugins\movie\PluginMovieFDb.py;           DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\FDb
-Source: dist\lib\plugins\movie\PluginMovieFilmAffinity.py;  DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Spanish\FilmAffinity
-Source: dist\lib\plugins\movie\PluginMovieFilmDb.py;        DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\FilmDb
-Source: dist\lib\plugins\movie\PluginMovieFilmeVonAZ.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\Filme_von_A_bis_Z
-Source: dist\lib\plugins\movie\PluginMovieFilmtipset.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Swedish\Film_tip_set
-Source: dist\lib\plugins\movie\PluginMovieFilmweb.py;       DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\Filmweb
-Source: dist\lib\plugins\movie\PluginMovieIMDB.py;          DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\IMDB
-Source: dist\lib\plugins\movie\PluginMovieIMDB-de.py;       DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\IMDBde
-Source: dist\lib\plugins\movie\PluginMovieIMDB-es.py;       DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Spanish\IMDB_es
-Source: dist\lib\plugins\movie\PluginMovieKinoDe.py;        DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\Kinode
-Source: dist\lib\plugins\movie\PluginMovieMediadis.py;      DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\English\Mediadis
-Source: dist\lib\plugins\movie\PluginMovieMoviefone.py;     DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\English\Moviefone
-Source: dist\lib\plugins\movie\PluginMovieMovieMeter.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Dutch\MovieMeter
-Source: dist\lib\plugins\movie\PluginMovieMyMoviesIt.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Italian\MyMoviesIt
-Source: dist\lib\plugins\movie\PluginMovieOFDb.py;          DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\OFDb
-Source: dist\lib\plugins\movie\PluginMovieOnet.py;          DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\Onet
-Source: dist\lib\plugins\movie\PluginMoviePTGate.py;        DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Portuguese\PTGate
-Source: dist\lib\plugins\movie\PluginMovieStopklatka.py;    DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\Stopklatka
-Source: dist\lib\plugins\movie\PluginMovieTanukiAnime.py;   DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\Tanuki_Anime
-Source: dist\lib\plugins\movie\PluginMovieWP.py;            DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\Polish\Wirtualna_Polska
-Source: dist\lib\plugins\movie\PluginMovieZelluloid.py;     DestDir: {app}\lib\plugins\movie; Flags: ignoreversion; Components: Movie_Import_Plugins\German\Zelluloid
-
-; NOTE: Don't use "Flags: ignoreversion" on any shared system files
-
-[Icons]
-Name: {group}\{cm:LaunchProgram,Griffith};    Filename: {app}\griffith.exe
-Name: {group}\{cm:UninstallProgram,Griffith}; Filename: {uninstallexe}
-Name: {group}\{cm:ProgramOnTheWeb,Griffith};  Filename: http://griffith.cc
-Name: {group}\Doc\Griffith Forum;             Filename: http://griffith.cc/forum/
-Name: {group}\Doc\Griffith Wiki;              Filename: http://wiki.griffith.cc/
-; some information files opened by iexplore which should work on most installations
-Name: {group}\Doc\INSTALL;     Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\INSTALL;     IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\NEWS;        Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\NEWS;        IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\AUTHORS;     Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\AUTHORS;     IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\THANKS;      Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\THANKS;      IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\License;     Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\COPYING;     IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\README;      Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\README;      IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-Name: {group}\Doc\TRANSLATORS; Filename: "{pf}\Internet Explorer\iexplore.exe"; Parameters: {app}\TRANSLATORS; IconFilename: %SystemRoot%\system32\SHELL32.dll; IconIndex: -152
-; desktop and quick launch icons
-Name: {userdesktop}\Griffith; Filename: {app}\griffith.exe; Tasks: desktopicon
-Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\Griffith; Filename: {app}\griffith.exe; Tasks: quicklaunchicon
-
-[Run]
-Filename: {app}\griffith.exe; Description: {cm:LaunchProgram,Griffith}; Flags: nowait postinstall skipifsilent
-
-[UninstallDelete]
-Type: files; Name: {app}\lib\*.pyo
-Type: files; Name: {app}\lib\db\*.pyo
-Type: files; Name: {app}\lib\plugins\export\*.pyo
-Type: files; Name: {app}\lib\plugins\movie\*.pyo
-Type: files; Name: {app}\lib\plugins\imp\*.pyo
-
-[Components]
-Name: Griffith;                                      Description: Griffith; Types: custom compact full; Flags: fixed
-Name: Movie_Import_Plugins;                          Description: Movie Import Plugins; Types: custom compact full; Flags: fixed
-Name: Movie_Import_Plugins\IMDB;                     Description: IMDB Import Plugin; Types: custom compact full; Flags: fixed
-Name: Movie_Import_Plugins\Amazon;                   Description: Amazon Import Plugin; Types: full
-
-Name: Movie_Import_Plugins\English;                  Description: English Import Plugins; Types: full
-Name: Movie_Import_Plugins\English\AllMovie;         Description: All Media Guide / www.allmovie.com; Types: full
-Name: Movie_Import_Plugins\English\AnimeDB;          Description: AnimeDB / www.anidb.net; Types: full
-Name: Movie_Import_Plugins\English\DVD_Empire;       Description: DVD Empire / www.dvdempire.com; Types: full
-Name: Movie_Import_Plugins\English\Mediadis;         Description: Mediadis / www.mediadis.com; Types: full
-Name: Movie_Import_Plugins\English\Moviefone;        Description: Moviefone / www.moviefone.com; Types: full
-
-Name: Movie_Import_Plugins\Dutch;                    Description: Dutch Import Plugins; Types: full
-Name: Movie_Import_Plugins\Dutch\MovieMeter;         Description: MovieMeter / www.moviemeter.nl; Types: full
-
-Name: Movie_Import_Plugins\Czech;                    Description: Czech Import Plugins; Types: full
-Name: Movie_Import_Plugins\Czech\CSFD;               Description: CSFD / www.csfd.cz; Types: full
-
-Name: Movie_Import_Plugins\French;                   Description: French Import Plugins; Types: full
-Name: Movie_Import_Plugins\French\Allocine;          Description: Allocine / www.allocine.fr; Types: full
-Name: Movie_Import_Plugins\French\CineMovies;        Description: CineMovies / www.cinemovies.fr; Types: full
-
-Name: Movie_Import_Plugins\German;                   Description: German Import Plugins; Types: full
-Name: Movie_Import_Plugins\German\DVD_Palace;        Description: DVD-Palace / www.dvd-palace.de; Types: full
-Name: Movie_Import_Plugins\German\FilmDb;            Description: FilmDb / www.filmdb.de; Types: full
-Name: Movie_Import_Plugins\German\Filme_von_A_bis_Z; Description: Filme von A-Z / www.filmevona-z.de; Types: full
-Name: Movie_Import_Plugins\German\IMDBde;            Description: IMDB.de / german.imdb.com; Types: full
-Name: Movie_Import_Plugins\German\OFDb;              Description: OFDb / www.ofdb.de; Types: full
-Name: Movie_Import_Plugins\German\Kinode;            Description: Kino.de / www.kino.de; Types: full
-Name: Movie_Import_Plugins\German\Zelluloid;         Description: Zelluloid / www.zelluloid.de; Types: full
-
-Name: Movie_Import_Plugins\Italian;                  Description: Italian Import Plugins; Types: full
-Name: Movie_Import_Plugins\Italian\Cinematografo;    Description: Cinematografo / www.cinematografo.it; Types: full
-Name: Movie_Import_Plugins\Italian\MyMoviesIt;       Description: MyMoviesIt / www.mymovies.it; Types: full
-
-Name: Movie_Import_Plugins\Polish;                   Description: Polish Import Plugins; Types: full
-Name: Movie_Import_Plugins\Polish\FDb;               Description: FDb / fdb.pl; Types: full
-Name: Movie_Import_Plugins\Polish\Filmweb;           Description: Filmweb / www.filmweb.pl; Types: full
-Name: Movie_Import_Plugins\Polish\Onet;              Description: Onet / film.onet.pl; Types: full
-Name: Movie_Import_Plugins\Polish\Stopklatka;        Description: Stopklatka / www.stopklatka.pl; Types: full
-Name: Movie_Import_Plugins\Polish\Tanuki_Anime;      Description: Tanuki Anime / anime.tanuki.pl; Types: full
-Name: Movie_Import_Plugins\Polish\Wirtualna_Polska;  Description: Wirtualna Polska / www.film.wp.pl; Types: full
-
-Name: Movie_Import_Plugins\Portuguese;               Description: Portuguese Import Plugins; Types: full
-Name: Movie_Import_Plugins\Portuguese\7arte;         Description: 7arte / 7arte.net; Types: full
-Name: Movie_Import_Plugins\Portuguese\Cineteka;      Description: Cineteka / cineteka.com; Types: full
-Name: Movie_Import_Plugins\Portuguese\PTGate;        Description: PTGate / cinema.ptgate.pt; Types: full
-
-Name: Movie_Import_Plugins\Brazilian_Portuguese;          Description: Brazilian Portuguese Import Plugins; Types: full
-Name: Movie_Import_Plugins\Brazilian_Portuguese\E_Pipoca; Description: E-Pipoca / epipoca.uol.com.br; Types: full
-
-Name: Movie_Import_Plugins\Spanish;                  Description: Spanish Import Plugins; Types: full
-Name: Movie_Import_Plugins\Spanish\Culturalia;       Description: Culturalia / www.culturalianet.com; Types: full
-Name: Movie_Import_Plugins\Spanish\FilmAffinity;     Description: FilmAffinity / www.filmaffinity.com; Types: full
-Name: Movie_Import_Plugins\Spanish\IMDB_es;          Description: IMDB.es / spanish.imdb.com; Types: full
-
-Name: Movie_Import_Plugins\Swedish;                  Description: Swedish Import Plugins; Types: full
-Name: Movie_Import_Plugins\Swedish\Film_tip_set;     Description: Film tip set / www.filmtipset.se; Types: full
-

Copied: tags/0.10/winpackage.iss (from rev 1271, trunk/winpackage.iss)

Deleted: tags/0.10/winsetup.py
===================================================================
--- trunk/winsetup.py	2009-07-14 20:44:57 UTC (rev 1270)
+++ tags/0.10/winsetup.py	2009-08-03 21:50:32 UTC (rev 1272)
@@ -1,117 +0,0 @@
-#!/usr/bin/env python
-# -*- coding: utf-8 -*-
-
-__revision__ = '$Id$'
-
-# Copyright (c) 2005-2007 Vasco Nunes
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU Library General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
-
-# You may use and distribute this software under the terms of the
-# GNU General Public License, version 2 or later
-
-import sys
-
-# ModuleFinder can't handle runtime changes to __path__, but win32com uses them
-
-try:
-    import modulefinder
-    import win32com
-    for p in win32com.__path__[1:]:
-        modulefinder.AddPackagePath("win32com", p)
-    for extra in ["win32com.shell"]: #,"win32com.mapi"
-        __import__(extra)
-        m = sys.modules[extra]
-        for p in m.__path__[1:]:
-            modulefinder.AddPackagePath(extra, p)
-except ImportError:
-    # no build path setup, no worries.
-    pass
-
-from distutils.core import setup
-import glob
-import py2exe
-
-opts = {
-    "py2exe": {
-        "includes": "pygtk,cairo,pangocairo,gobject,cgi,PIL,pysqlite2,pysqlite2.*,pango,atk,gobject,tempfile,csv,xml.dom,xml.dom.ext,xml.dom.minidom,xml.sax,threading,htmlentitydefs,sqlalchemy,sqlalchemy.*,sqlalchemy.databases.*,sqlalchemy.engine.*,sqlalchemy.ext.*,sqlalchemy.orm.*,sqlalchemy.sql.*,zipfile,webbrowser,shutil,reportlab,reportlab.pdfgen,reportlab.pdfgen.canvas,reportlab.platypus,reportlab.pdfbase.ttfonts,smtplib,win32com,platform,winshell,psycopg2,MySQLdb,chardet,gzip,commands,encodings,encodings.*,ConfigParser,gtk.glade,xmlrpclib",
-        "optimize": 2,
-        "dist_dir": "dist",
-    }
-}
-
-setup(
-    name = "Griffith",
-    version = "0.10-rc1",
-    description = 'Griffith - A film manager',
-    author = 'Vasco Nunes/Piotr Ozarowski',
-    author_email = 'griffith-private at lists.berlios.de',
-    url = 'http://www.griffith.cc/',
-    license = 'GPL',
-    windows = [
-        {
-            "script": "griffith",
-            "icon_resources": [(1, "images\griffith.ico")]
-        }],
-    options = opts,
-        data_files=[
-        ("images", glob.glob("data\\*.png")),
-        ("images/export_templates", glob.glob("export_templates\\*.dtd")),
-        ("images/export_templates/csv",    glob.glob("export_templates\\csv\\*.*")),
-        ("images/export_templates/xml",    glob.glob("export_templates\\xml\\*.*")),
-        ("images/export_templates/latex", glob.glob("export_templates\\latex\\*.*")),
-        ("images/export_templates/html_table", glob.glob("export_templates\\html_table\\*.*")),
-        ("images/export_templates/html_tables",    glob.glob("export_templates\\html_tables\\*.*")),
-        ("glade", glob.glob("glade\\*.*")),
-        ("i18n/bg/LC_MESSAGES", glob.glob("i18n\\bg\\LC_MESSAGES\\*.mo")),
-        ("i18n/ca/LC_MESSAGES",    glob.glob("i18n\\ca\\LC_MESSAGES\\*.mo")),
-        ("i18n/cs/LC_MESSAGES",    glob.glob("i18n\\cs\\LC_MESSAGES\\*.mo")),
-        ("i18n/da/LC_MESSAGES",    glob.glob("i18n\\da\\LC_MESSAGES\\*.mo")),
-        ("i18n/de/LC_MESSAGES",    glob.glob("i18n\\de\\LC_MESSAGES\\*.mo")),
-        ("i18n/el/LC_MESSAGES",    glob.glob("i18n\\el\\LC_MESSAGES\\*.mo")),
-        ("i18n/en_GB/LC_MESSAGES", glob.glob("i18n\\en_GB\\LC_MESSAGES\\*.mo")),
-        ("i18n/es/LC_MESSAGES",    glob.glob("i18n\\es\\LC_MESSAGES\\*.mo")),
-        ("i18n/et/LC_MESSAGES",    glob.glob("i18n\\et\\LC_MESSAGES\\*.mo")),
-        ("i18n/fa/LC_MESSAGES",    glob.glob("i18n\\fa\\LC_MESSAGES\\*.mo")),
-        ("i18n/fi/LC_MESSAGES",    glob.glob("i18n\\fi\\LC_MESSAGES\\*.mo")),
-        ("i18n/fr/LC_MESSAGES",    glob.glob("i18n\\fr\\LC_MESSAGES\\*.mo")),
-        ("i18n/hu/LC_MESSAGES",    glob.glob("i18n\\hu\\LC_MESSAGES\\*.mo")),
-        ("i18n/id/LC_MESSAGES",    glob.glob("i18n\\id\\LC_MESSAGES\\*.mo")),
-        ("i18n/it/LC_MESSAGES",    glob.glob("i18n\\it\\LC_MESSAGES\\*.mo")),
-        ("i18n/ja/LC_MESSAGES",    glob.glob("i18n\\ja\\LC_MESSAGES\\*.mo")),
-        ("i18n/ko/LC_MESSAGES",    glob.glob("i18n\\ko\\LC_MESSAGES\\*.mo")),
-        ("i18n/lv/LC_MESSAGES",    glob.glob("i18n\\lv\\LC_MESSAGES\\*.mo")),
-        ("i18n/nb/LC_MESSAGES",    glob.glob("i18n\\nb\\LC_MESSAGES\\*.mo")),
-        ("i18n/nds/LC_MESSAGES",    glob.glob("i18n\\nds\\LC_MESSAGES\\*.mo")),
-        ("i18n/nl/LC_MESSAGES",    glob.glob("i18n\\nl\\LC_MESSAGES\\*.mo")),
-        ("i18n/oc/LC_MESSAGES",    glob.glob("i18n\\oc\\LC_MESSAGES\\*.mo")),
-        ("i18n/pl/LC_MESSAGES",    glob.glob("i18n\\pl\\LC_MESSAGES\\*.mo")),
-        ("i18n/ps/LC_MESSAGES",    glob.glob("i18n\\ps\\LC_MESSAGES\\*.mo")),
-        ("i18n/pt/LC_MESSAGES",    glob.glob("i18n\\pt\\LC_MESSAGES\\*.mo")),
-        ("i18n/pt_BR/LC_MESSAGES", glob.glob("i18n\\pt_BR\\LC_MESSAGES\\*.mo")),
-        ("i18n/ru/LC_MESSAGES",    glob.glob("i18n\\ru\\LC_MESSAGES\\*.mo")),
-        ("i18n/sk/LC_MESSAGES",    glob.glob("i18n\\sk\\LC_MESSAGES\\*.mo")),
-        ("i18n/sr/LC_MESSAGES",    glob.glob("i18n\\sr\\LC_MESSAGES\\*.mo")),
-        ("i18n/sv/LC_MESSAGES",    glob.glob("i18n\\sv\\LC_MESSAGES\\*.mo")),
-        ("i18n/tr/LC_MESSAGES",    glob.glob("i18n\\tr\\LC_MESSAGES\\*.mo")),
-        ("i18n/uk/LC_MESSAGES",    glob.glob("i18n\\uk\\LC_MESSAGES\\*.mo")),
-        ("i18n/zh_CN/LC_MESSAGES", glob.glob("i18n\\zh_CN\\LC_MESSAGES\\*.mo")),
-        ("lib/plugins", glob.glob("lib\\plugins\\*.*")),
-        ("lib/plugins/export", glob.glob("lib\\plugins\\export\\*.*")),
-        ("lib/plugins/movie", glob.glob("lib\\plugins\\movie\\*.*")),
-        ("lib/plugins/imp", glob.glob("lib\\plugins\\imp\\*.*")),
-        ("images", glob.glob("images\\*.png")),
-        ("lib/db", glob.glob("lib\\db\\*.py")),
-        ("lib", glob.glob("lib\\*.*"))],
-)

Copied: tags/0.10/winsetup.py (from rev 1271, trunk/winsetup.py)



From mikej06 at mail.berlios.de  Sun Aug  9 22:52:35 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Sun, 9 Aug 2009 22:52:35 +0200
Subject: [Griffith-svn] r1273 - trunk/lib/plugins/export
Message-ID: <200908092052.n79KqZco016244@sheep.berlios.de>

Author: mikej06
Date: 2009-08-09 22:52:13 +0200 (Sun, 09 Aug 2009)
New Revision: 1273

Modified:
   trunk/lib/plugins/export/__init__.py
Log:
replaced xml.dom.ext.PrettyPrint with xml.dom.minidom.toprettyxml
(xml.dom.ext / PyXML isn't maintained anymore)

Modified: trunk/lib/plugins/export/__init__.py
===================================================================
--- trunk/lib/plugins/export/__init__.py	2009-08-03 21:50:32 UTC (rev 1272)
+++ trunk/lib/plugins/export/__init__.py	2009-08-09 20:52:13 UTC (rev 1273)
@@ -26,7 +26,6 @@
 import gutils
 import gtk
 import xml.dom.minidom
-import xml.dom.ext
 import os
 
 import logging
@@ -172,9 +171,12 @@
 
     def export_document_to_file(self, document, filename):
         # write XML to file
-        fp = open(filename, 'w')
-        xml.dom.ext.PrettyPrint(document, fp, encoding=self.encoding)
-        fp.close()
+        xml = document.toprettyxml(encoding=self.encoding)
+        fp = open(filename, 'wb')
+        try:
+            fp.write(xml)
+        finally:
+            fp.close()
 
     def export_to_document(self, document, mainelement):
         table_movies = db.metadata.tables['movies']



From piotrek at mail.berlios.de  Sun Aug  9 23:15:58 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 9 Aug 2009 23:15:58 +0200
Subject: [Griffith-svn] r1274 - in trunk: . glade lib lib/plugins
	lib/plugins/extensions
Message-ID: <200908092115.n79LFwrI018150@sheep.berlios.de>

Author: piotrek
Date: 2009-08-09 23:15:57 +0200 (Sun, 09 Aug 2009)
New Revision: 1274

Added:
   trunk/lib/plugins/extensions/
   trunk/lib/plugins/extensions/__init__.py
   trunk/lib/plugins/extensions/amazon.py
   trunk/lib/plugins/extensions/ge_amazon.py
Removed:
   trunk/lib/amazon.py
Modified:
   trunk/ChangeLog
   trunk/NEWS
   trunk/glade/griffith.glade
   trunk/griffith
   trunk/lib/edit.py
   trunk/lib/initialize.py
   trunk/lib/main_treeview.py
   trunk/lib/plugins/__init__.py
   trunk/lib/version.py
   trunk/lib/widgets.py
Log:
* Version changed to 0.11~svn
* Initial structure for extensions created
  + ~/.griffith/lib/extensions can be used for user's extensions
* Amazon posters feature converted to Griffith extension


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/ChangeLog	2009-08-09 21:15:57 UTC (rev 1274)
@@ -5,6 +5,12 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-09  Piotr O?arowski
+	* Version changed to 0.11~svn
+	* Initial structure for extensions created
+	  + ~/.griffith/lib/extensions can be used for user's extensions
+	* Amazon posters feature converted to Griffith extension
+
 ---- 0.10 ----
 
 2009-08-03  Piotr O?arowski

Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/NEWS	2009-08-09 21:15:57 UTC (rev 1274)
@@ -1,3 +1,9 @@
+Griffith 0.11
+=============
+* Griffith extensions feature added. You can add your own extensions in
+  ~/.griffith/lib/extensions
+
+
 Griffith 0.10
 =============
 * Almost unchanged release candidate 1

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/glade/griffith.glade	2009-08-09 21:15:57 UTC (rev 1274)
@@ -191,48 +191,6 @@
                         </child>
                       </widget>
                     </child>
-                    <child>
-                      <widget class="GtkSeparatorMenuItem" id="separator7">
-                        <property name="visible">True</property>
-                      </widget>
-                    </child>
-                    <child>
-                      <widget class="GtkMenuItem" id="poster1">
-                        <property name="visible">True</property>
-                        <property name="label" translatable="yes">Poster image</property>
-                        <property name="use_underline">True</property>
-                        <child>
-                          <widget class="GtkMenu" id="poster1_menu">
-                            <child>
-                              <widget class="GtkImageMenuItem" id="open_poster">
-                                <property name="visible">True</property>
-                                <property name="label">gtk-open</property>
-                                <property name="use_underline">True</property>
-                                <property name="use_stock">True</property>
-                                <signal name="activate" handler="on_open_poster_clicked"/>
-                              </widget>
-                            </child>
-                            <child>
-                              <widget class="GtkMenuItem" id="fetch_poster">
-                                <property name="visible">True</property>
-                                <property name="label" translatable="yes">Fetch from Amazon</property>
-                                <property name="use_underline">True</property>
-                                <signal name="activate" handler="on_fetch_poster_clicked"/>
-                              </widget>
-                            </child>
-                            <child>
-                              <widget class="GtkImageMenuItem" id="delete_poster">
-                                <property name="visible">True</property>
-                                <property name="label">gtk-delete</property>
-                                <property name="use_underline">True</property>
-                                <property name="use_stock">True</property>
-                                <signal name="activate" handler="on_delete_poster_clicked"/>
-                              </widget>
-                            </child>
-                          </widget>
-                        </child>
-                      </widget>
-                    </child>
                   </widget>
                 </child>
               </widget>
@@ -657,17 +615,6 @@
                       </packing>
                     </child>
                     <child>
-                      <widget class="GtkToolButton" id="toolbutton9">
-                        <property name="visible">True</property>
-                        <property name="tooltip" translatable="yes">Attempt to fetch a big poster from Amazon services Web site</property>
-                        <property name="stock_id">gtk-network</property>
-                        <signal name="clicked" handler="on_fetch_poster_clicked"/>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                      </packing>
-                    </child>
-                    <child>
                       <widget class="GtkSeparatorToolItem" id="separatortoolitem5">
                         <property name="visible">True</property>
                       </widget>
@@ -836,6 +783,32 @@
           </packing>
         </child>
         <child>
+          <widget class="GtkHBox" id="ext_hbox">
+            <property name="visible">True</property>
+            <child>
+              <widget class="GtkHandleBox" id="ext_toolbar_hb">
+                <property name="visible">True</property>
+                <property name="shadow_type">GTK_SHADOW_OUT</property>
+                <child>
+                  <widget class="GtkToolbar" id="ext_toolbar">
+                    <property name="visible">True</property>
+                    <property name="toolbar_style">GTK_TOOLBAR_BOTH_HORIZ</property>
+                    <property name="show_arrow">False</property>
+                  </widget>
+                </child>
+              </widget>
+              <packing>
+                <property name="position">0</property>
+              </packing>
+            </child>
+          </widget>
+          <packing>
+            <property name="expand">False</property>
+            <property name="fill">False</property>
+            <property name="position">3</property>
+          </packing>
+        </child>
+        <child>
           <widget class="GtkHPaned" id="hpaned1">
             <property name="visible">True</property>
             <property name="can_focus">True</property>
@@ -2415,7 +2388,7 @@
             </child>
           </widget>
           <packing>
-            <property name="position">3</property>
+            <property name="position">4</property>
           </packing>
         </child>
         <child>
@@ -2425,7 +2398,7 @@
           <packing>
             <property name="expand">False</property>
             <property name="fill">False</property>
-            <property name="position">4</property>
+            <property name="position">5</property>
           </packing>
         </child>
       </widget>

Modified: trunk/griffith
===================================================================
--- trunk/griffith	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/griffith	2009-08-09 21:15:57 UTC (rev 1274)
@@ -122,6 +122,7 @@
         initialize.preferences(self)
         initialize.movie_plugins(self)
         initialize.export_plugins(self)
+        initialize.extensions(self)
         initialize.people_treeview(self)
         initialize.web_results(self)
         self.initialized = True
@@ -373,11 +374,6 @@
     def z_poster_hide(self, *args):
         self.widgets['poster_window'].hide()
 
-    def get_poster(self, *args):
-        """tries to fetch a new big poster from amazon"""
-        from edit import fetch_bigger_poster
-        fetch_bigger_poster(self)
-
     # rating --------------------------------------------------------------
 
     def scale_rating_change_add(self, *args):
@@ -1200,11 +1196,6 @@
 
     # windows/dialogs -----------------------------------------------------
 
-    def results_cancel_ck(self, *args):
-        from widgets import reconnect_add_signals
-        reconnect_add_signals(self)
-        self.widgets['results']['window'].hide()
-
     def save_state(self):
         """Saves main window state"""
         # size should only be saved on microsoft windows systems
@@ -1278,10 +1269,6 @@
                     int(self.config.get('height', section='window')))
         self.widgets['window'].show()
 
-    def on_delete_event_r(self, *args):
-        self.widgets['results']['window'].hide()
-        return True
-
     def on_delete_event_poster(self, *args):
         self.widgets['poster_window'].hide()
         return True
@@ -1327,11 +1314,11 @@
             gutils.run_browser(self._trailer_url)
 
     def on_goto_homepage_activate(site, *args):
-        gutils.run_browser("http://www.griffith.cc/")
+        gutils.run_browser('http://www.griffith.cc/')
     def on_goto_forum_activate(site, *args):
-        gutils.run_browser("http://forum.griffith.cc/")
+        gutils.run_browser('http://forum.griffith.cc/')
     def on_goto_report_bug_activate(site, *args):
-        gutils.run_browser("https://bugs.launchpad.net/griffith/")
+        gutils.run_browser('http://bugs.griffith.cc/')
 
     # toolbar -------------------------------------------------------------
     def toggle_toolbar(self, *args):
@@ -1414,16 +1401,42 @@
         elif event.type == gtk.gdk._2BUTTON_PRESS:
             self.edit_movie()
 
+    # -=[ results window ]=------------------------------------------------
+    def on_results_window_close(self, *args):
+        self.widgets['results']['window'].hide()
+        # restore default signals (reassgin results window to "add movie" dialog)
+        self.widgets['add']['b_get_from_web'].set_sensitive(True)
+        if self._resultswin_window_closed_signal:
+            self._resultswin_window_closed_signal(*args)
+        self._resultswin_window_closed_signal = None
+        self._resultswin_button_pressed_signal = self.on_add_movie_results_button_press_event
+        self._resultswin_process = self.populate_dialog_with_results
+        return True
+
     def on_results_button_press_event(self, widget, event):
+        if event.type == gtk.gdk._2BUTTON_PRESS:
+            return self.on_results_select_press_event(widget)
+        return self._resultswin_button_pressed_signal(widget, event)
+    
+    def on_results_select_press_event(self, button):
+        treeselection = self.widgets['results']['treeview'].get_selection()
+        if not treeselection:
+            log.debug('no treeselection')
+            return False
+        tmp_model, tmp_iter = treeselection.get_selected()
+        if tmp_iter is None:
+            log.debug('no selected iter found')
+            return False
+        selected_key = int(tmp_model.get_value(tmp_iter, 0))
+        self.widgets['results']['window'].hide()
+        return self._resultswin_process(selected_key)
+
+    def on_add_movie_results_button_press_event(self, widget, event):
         """add a double click event to add movie results"""
+        # TODO: use on_results_select_press_event and its selected_key
         if event.type == gtk.gdk._2BUTTON_PRESS:
             add.populate_with_results(self)
 
-    def on_poster_results_button_press_event(self, widget, event):
-        """add a double click event to poster results"""
-        if event.type == gtk.gdk._2BUTTON_PRESS:
-            add.populate_with_results(self)
-    
     # -=[ treeview ]=------------------------------------------------------
     def go_first(self, *args):
         self.click_on(self.widgets['treeview'], 'first')

Deleted: trunk/lib/amazon.py
===================================================================
--- trunk/lib/amazon.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/amazon.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -1,397 +0,0 @@
-__all__ = []
-"""Python wrapper
-
-
-for Amazon web APIs
-
-This module allows you to access Amazon's web APIs,
-to do things like search Amazon and get the results programmatically.
-Described here:
-  http://www.amazon.com/webservices
-
-You need a Amazon-provided license key to use these services.
-Follow the link above to get one.  These functions will look in
-several places (in this order) for the license key:
-- the "license_key" argument of each function
-- the module-level LICENSE_KEY variable (call setLicense once to set it)
-- an environment variable called AMAZON_LICENSE_KEY
-- a file called ".amazonkey" in the current directory
-- a file called "amazonkey.txt" in the current directory
-- a file called ".amazonkey" in your home directory
-- a file called "amazonkey.txt" in your home directory
-- a file called ".amazonkey" in the same directory as amazon.py
-- a file called "amazonkey.txt" in the same directory as amazon.py
-
-Sample usage:
->>> import amazon
->>> amazon.setLicense('...') # must get your own key!
->>> pythonBooks = amazon.searchByKeyword('Python')
->>> pythonBooks[0].ProductName
-u'Learning Python (Help for Programmers)'
->>> pythonBooks[0].URL
-...
->>> pythonBooks[0].OurPrice
-...
-
-Other available functions:
-- browseBestSellers
-- searchByASIN
-- searchByUPC
-- searchByAuthor
-- searchByArtist
-- searchByActor
-- searchByDirector
-- searchByManufacturer
-- searchByListMania
-- searchSimilar
-- searchByWishlist
-
-Other usage notes:
-- Most functions can take product_line as well, see source for possible values
-- All functions can take type="lite" to get less detail in results
-- All functions can take page=N to get second, third, fourth page of results
-- All functions can take license_key="XYZ", instead of setting it globally
-- All functions can take http_proxy="http://x/y/z" which overrides your system setting
-"""
-
-__author__ = "Mark Pilgrim (f8dy at diveintomark.org)"
-__version__ = "0.64.1"
-__cvsversion__ = "$Revision: 1.1 $"[11:-2]
-__date__ = "$Date: 2005/08/06 13:29:10 $"[7:-2]
-__copyright__ = "Copyright (c) 2002 Mark Pilgrim"
-__license__ = "Python"
-# Powersearch and return object type fix by Joseph Reagle <geek at goatee.net>
-
-# Locale support by Michael Josephson <mike at josephson.org>
-
-# Modification to _contentsOf to strip trailing whitespace when loading Amazon key
-# from a file submitted by Patrick Phalen.
-
-# Support for specifying locale and associates ID as search parameters and 
-# internationalisation fix for the SalesRank integer conversion by
-# Christian Theune <ct at gocept.com>, gocept gmbh & co. kg
-
-# Support for BlendedSearch contributed by Alex Choo
-
-from xml.dom import minidom
-import os, sys, getopt, cgi, urllib, string
-try:
-    import timeoutsocket # http://www.timo-tasi.org/python/timeoutsocket.py
-    timeoutsocket.setDefaultSocketTimeout(10)
-except ImportError:
-    pass
-import logging
-log = logging.getLogger("Griffith")
-
-LICENSE_KEY = ""
-ASSOCIATE = "webservices-20"
-HTTP_PROXY = None
-LOCALE = "us"
-# default API version is from 2005-10-05
-APIVERSION='2008-06-26'
-
-# don't touch the rest of these constants
-class AmazonError(Exception): pass
-class NoLicenseKey(Exception): pass
-_amazonfile1 = ".amazonkey"
-_amazonfile2 = "amazonkey.txt"
-_licenseLocations = (
-    (lambda key: key, 'passed to the function in license_key variable'),
-    (lambda key: LICENSE_KEY, 'module-level LICENSE_KEY variable (call setLicense to set it)'),
-    (lambda key: os.environ.get('AMAZON_LICENSE_KEY', None), 'an environment variable called AMAZON_LICENSE_KEY'),
-    (lambda key: _contentsOf(os.getcwd(), _amazonfile1), '%s in the current directory' % _amazonfile1),
-    (lambda key: _contentsOf(os.getcwd(), _amazonfile2), '%s in the current directory' % _amazonfile2),
-    (lambda key: _contentsOf(os.environ.get('HOME', ''), _amazonfile1), '%s in your home directory' % _amazonfile1),
-    (lambda key: _contentsOf(os.environ.get('HOME', ''), _amazonfile2), '%s in your home directory' % _amazonfile2),
-    (lambda key: _contentsOf(_getScriptDir(), _amazonfile1), '%s in the amazon.py directory' % _amazonfile1),
-    (lambda key: _contentsOf(_getScriptDir(), _amazonfile2), '%s in the amazon.py directory' % _amazonfile2)
-    )
-_supportedLocales = {
-        "us" : (None, "ecs.amazonaws.com/onca/xml?Service=AWSECommerceService"),   
-        "uk" : ("uk", "ecs.amazonaws.co.uk/onca/xml?Service=AWSECommerceService"),
-        "de" : ("de", "ecs.amazonaws.de/onca/xml?Service=AWSECommerceService"),
-        "ca" : ("ca", "ecs.amazonaws.ca/onca/xml?Service=AWSECommerceService"),
-        "fr" : ("fr", "ecs.amazonaws.fr/onca/xml?Service=AWSECommerceService"),
-        "jp" : ("jp", "ecs.amazonaws.jp/onca/xml?Service=AWSECommerceService")
-    }
-
-## administrative functions
-def version():
-    print """PyAmazon %(__version__)s
-%(__copyright__)s
-released %(__date__)s
-""" % globals()
-
-def setAssociate(associate):
-    global ASSOCIATE
-    ASSOCIATE=associate
-
-def getAssociate(override=None):
-    return override or ASSOCIATE
-
-## utility functions
-
-def _checkLocaleSupported(locale):
-    if not _supportedLocales.has_key(locale):
-        raise AmazonError, ("Unsupported locale. Locale must be one of: %s" %
-            string.join(_supportedLocales, ", "))
-
-def setLocale(locale):
-    """set locale"""
-    global LOCALE
-    _checkLocaleSupported(locale)
-    LOCALE = locale
-
-def getLocale(locale=None):
-    """get locale"""
-    return locale or LOCALE
-
-def setLicense(license_key):
-    """set license key"""
-    global LICENSE_KEY
-    LICENSE_KEY = license_key
-
-def getLicense(license_key = None):
-    """get license key
-
-    license key can come from any number of locations;
-    see module docs for search order"""
-    for get, location in _licenseLocations:
-        rc = get(license_key)
-        if rc: return rc
-    raise NoLicenseKey, 'get a license key at http://www.amazon.com/webservices'
-
-def setProxy(http_proxy):
-    """set HTTP proxy"""
-    global HTTP_PROXY
-    HTTP_PROXY = http_proxy
-
-def getProxy(http_proxy = None):
-    """get HTTP proxy"""
-    return http_proxy or HTTP_PROXY
-
-def getProxies(http_proxy = None):
-    http_proxy = getProxy(http_proxy)
-    if http_proxy:
-        proxies = {"http": http_proxy}
-    else:
-        proxies = None
-    return proxies
-
-def _contentsOf(dirname, filename):
-    filename = os.path.join(dirname, filename)
-    if not os.path.exists(filename): return None
-    fsock = open(filename)
-    contents =  fsock.read().strip()
-    fsock.close()
-    return contents
-
-def _getScriptDir():
-    if __name__ == '__main__':
-        return os.path.abspath(os.path.dirname(sys.argv[0]))
-    else:
-        return os.path.abspath(os.path.dirname(sys.modules[__name__].__file__))
-
-class Bag: pass
-
-def unmarshal(element):
-    rc = Bag()
-    if isinstance(element, minidom.Element) and (element.tagName == 'Details'):
-        rc.URL = element.attributes["url"].value
-    childElements = [e for e in element.childNodes if isinstance(e, minidom.Element)]
-    if childElements:
-        for child in childElements:
-            key = child.tagName
-            if hasattr(rc, key):
-                if type(getattr(rc, key)) <> type([]):
-                    setattr(rc, key, [getattr(rc, key)])
-                setattr(rc, key, getattr(rc, key) + [unmarshal(child)])
-            elif isinstance(child, minidom.Element) and (child.tagName == 'Details' or child.tagName == 'Item'):
-                # make the first Details element a key
-                setattr(rc,key,[unmarshal(child)])
-                #dbg: because otherwise 'hasattr' only tests
-                #dbg: on the second occurence: if there's a
-                #dbg: single return to a query, it's not a
-                #dbg: list. This module should always
-                #dbg: return a list of Details objects.
-            else:
-                setattr(rc, key, unmarshal(child))
-    else:
-        rc = "".join([e.data for e in element.childNodes if isinstance(e, minidom.Text)])
-        if element.tagName == 'SalesRank':
-            rc = rc.replace('.', '')
-            rc = rc.replace(',', '')
-            rc = int(rc)
-    return rc
-
-def buildURL(search_type, searchfield, searchvalue, product_line, type, page, license_key, locale, associate):
-    _checkLocaleSupported(locale)
-    if isinstance(searchvalue, unicode):
-        searchvalue = searchvalue.encode('utf-8') # needed for urllib.quote
-    url = "http://" + _supportedLocales[locale][1]
-    if search_type == 'ItemLookup':
-        url += "&AssociateTag=%s" % associate
-        url += "&AWSAccessKeyId=%s" % license_key.strip()
-        url += "&ResponseGroup=%s" % type
-        if product_line:
-            url += "&SearchIndex=%s" % product_line
-        url += "&Operation=%s" % search_type
-        url += "&IdType=%s" % searchfield
-        url += "&ItemId=%s" % searchvalue
-    else:
-        url += "&AssociateTag=%s" % associate
-        url += "&AWSAccessKeyId=%s" % license_key.strip()
-        url += "&ResponseGroup=%s" % type
-        if page:
-            url += "&ItemPage=%s" % page
-        if product_line:
-            url += "&SearchIndex=%s" % product_line
-        url += "&Operation=%s" % search_type
-        url += "&%s=%s" % (searchfield, urllib.quote(searchvalue))
-        url += "&Sort=titlerank"
-    if not APIVERSION is None:
-        url += "&Version=%s" % APIVERSION
-    log.info('URL: ' + url)
-    return url
-
-
-## main functions
-
-
-def search(search_type, searchfield, searchvalue, product_line, type = "Large", page = None,
-           license_key=None, http_proxy = None, locale = None, associate = None):
-    """search Amazon
-
-    You need a license key to call this function; see
-    http://www.amazon.com/webservices
-    to get one.  Then you can either pass it to
-    this function every time, or set it globally; see the module docs for details.
-
-    Parameters:
-    keyword - keyword to search
-    search_type - in (KeywordSearch, BrowseNodeSearch, AsinSearch, UpcSearch, AuthorSearch, ArtistSearch, ActorSearch, DirectorSearch, ManufacturerSearch, ListManiaSearch, SimilaritySearch)
-    product_line - type of product to search for.  restrictions based on search_type
-        UpcSearch - in (music, classical)
-        AuthorSearch - must be "books"
-        ArtistSearch - in (music, classical)
-        ActorSearch - in (dvd, vhs, video)
-        DirectorSearch - in (dvd, vhs, video)
-        ManufacturerSearch - in (electronics, kitchen, videogames, software, photo, pc-hardware)
-    http_proxy (optional) - address of HTTP proxy to use for sending and receiving SOAP messages
-
-    Returns: list of Bags, each Bag may contain the following attributes:
-      Asin - Amazon ID ("ASIN" number) of this item
-      Authors - list of authors
-      Availability - "available", etc.
-      BrowseList - list of related categories
-      Catalog - catalog type ("Book", etc)
-      CollectiblePrice - ?, format "$34.95"
-      ImageUrlLarge - URL of large image of this item
-      ImageUrlMedium - URL of medium image of this item
-      ImageUrlSmall - URL of small image of this item
-      Isbn - ISBN number
-      ListPrice - list price, format "$34.95"
-      Lists - list of ListMania lists that include this item
-      Manufacturer - manufacturer
-      Media - media ("Paperback", "Audio CD", etc)
-      NumMedia - number of different media types in which this item is available
-      OurPrice - Amazon price, format "$24.47"
-      ProductName - name of this item
-      ReleaseDate - release date, format "09 April, 1999"
-      Reviews - reviews (AvgCustomerRating, plus list of CustomerReview with Rating, Summary, Content)
-      SalesRank - sales rank (integer)
-      SimilarProducts - list of Product, which is ASIN number
-      ThirdPartyNewPrice - ?, format "$34.95"
-      URL - URL of this item
-    """
-    license_key = getLicense(license_key)
-    locale = getLocale(locale)
-    associate = getAssociate(associate)
-    url = buildURL(search_type, searchfield, searchvalue, product_line, type, page, 
-            license_key, locale, associate)
-    proxies = getProxies(http_proxy)
-    u = urllib.FancyURLopener(proxies)
-    usock = u.open(url)
-    xmldoc = minidom.parse(usock)
-
-#     from xml.dom.ext import PrettyPrint
-#     PrettyPrint(xmldoc)
-
-    usock.close()
-    data = unmarshal(xmldoc)
-    if search_type == "BlendedSearch":
-        if hasattr(data, 'BlendedSearch'):
-            data = data.BlendedSearch
-    elif hasattr(data, 'ItemSearchResponse'):
-        data = data.ItemSearchResponse 
-    elif hasattr(data, 'ItemLookupResponse'):
-        data = data.ItemLookupResponse 
-
-    if hasattr(data, 'Errors'):
-        raise AmazonError, data.Errors
-    else:
-        if search_type == "BlendedSearch":
-            return data 
-        else:            
-            if hasattr(data, 'Items'):
-                return data.Items
-            else:
-                return data
-
-def searchByKeyword(keyword, product_line="Books", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ItemSearch", 'Keywords', keyword, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByTitle(keyword, product_line="Books", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ItemSearch", 'Title', keyword, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def browseBestSellers(browse_node, product_line="Books", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("BrowseNodeSearch", 'Keywords', browse_node, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByASIN(ASIN, type="Large", license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ItemLookup", 'ASIN', ASIN, None, type, None, license_key, http_proxy, locale, associate)
-
-def searchByUPC(UPC, product_line="Books", type="Large", license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ItemLookup", 'UPC', UPC, product_line, type, None, license_key, http_proxy, locale, associate)
-
-def searchByEAN(EAN, product_line="Books", type="Large", license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ItemLookup", 'EAN', EAN, product_line, type, None, license_key, http_proxy, locale, associate)
-
-def searchByAuthor(author, type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("AuthorSearch", 'Keywords', author, "Books", type, page, license_key, http_proxy, locale, associate)
-
-def searchByArtist(artist, product_line="Music", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    if product_line not in ("music", "classical"):
-        raise AmazonError, "product_line must be in ('Music', 'Classical')"
-    return search("ArtistSearch", 'Keywords', artist, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByActor(actor, product_line="DVD", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    if product_line not in ("DVD", "VHS", "Video"):
-        raise AmazonError, "product_line must be in ('DVD', 'VHS', 'Video')"
-    return search("ActorSearch", 'Keywords', actor, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByDirector(director, product_line="DVD", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    if product_line not in ("DVD", "VHS", "Video"):
-        raise AmazonError, "product_line must be in ('DVD', 'VHS', 'Video')"
-    return search("DirectorSearch", 'Keywords', director, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByManufacturer(manufacturer, product_line="pc-hardware", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    if product_line not in ("electronics", "kitchen", "videogames", "software", "photo", "pc-hardware"):
-        raise AmazonError, "product_line must be in ('electronics', 'kitchen', 'videogames', 'software', 'photo', 'pc-hardware')"
-    return search("ManufacturerSearch", 'Keywords', manufacturer, product_line, type, page, license_key, http_proxy, locale, associate)
-
-def searchByListMania(listManiaID, type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("ListManiaSearch", 'Keywords', listManiaID, None, type, page, license_key, http_proxy, locale, associate)
-
-def searchSimilar(ASIN, type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("SimilaritySearch", 'Keywords', ASIN, None, type, page, license_key, http_proxy, locale, associate)
-
-def searchByWishlist(wishlistID, type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("WishlistSearch", 'Keywords', wishlistID, None, type, page, license_key, http_proxy, locale, associate)
-
-def searchByPower(keyword, product_line="Books", type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("PowerSearch", 'Keywords', keyword, product_line, type, page, license_key, http_proxy, locale, associate)
-    # >>> RecentKing = amazon.searchByPower('author:Stephen King and pubdate:2003')
-    # >>> SnowCrash = amazon.searchByPower('title:Snow Crash')
-
-def searchByBlended(keyword, type="Large", page=1, license_key=None, http_proxy=None, locale=None, associate=None):
-    return search("BlendedSearch", 'Keywords', keyword, None, type, page, license_key, http_proxy, locale, associate)

Modified: trunk/lib/edit.py
===================================================================
--- trunk/lib/edit.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/edit.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -23,13 +23,9 @@
 
 import logging
 import os
-import tempfile
-from urllib import urlcleanup, FancyURLopener, urlretrieve
 
 import gtk
-from PIL import Image
 
-import amazon
 import db
 import delete
 import gutils
@@ -133,201 +129,3 @@
     pixbuf = self.Image.get_pixbuf()
     self.treemodel.set_value(tmp_iter, 1, pixbuf)
 
-def fetch_bigger_poster(self):
-    match = 0
-    log.info("fetching poster from amazon...")
-    movie = self.db.session.query(db.Movie).filter_by(movie_id=self._movie_id).first()
-    if movie is None:
-        gutils.error(self,_("You have no movies in your database"), self.widgets['window'])
-        return False
-    current_poster_md5 = movie.poster_md5
-    if current_poster_md5:
-        current_poster = gutils.get_image_fname(current_poster_md5, self.db)
-    else:
-        current_poster = None
-    amazon.setLicense("04GDDMMXX8X9CJ1B22G2")
-
-    locale = self.config.get('amazon_locale', 0, section='add')
-    keyword = self.widgets['movie']['o_title'].get_text()
-    if locale == '1':
-        locale = 'uk'
-    elif locale == '2':
-        locale = 'de'
-        keyword = self.widgets['movie']['title'].get_text()
-    elif locale == '3':
-        locale = 'ca'
-    elif locale == '4':
-        locale = 'fr'
-    elif locale == '5':
-        locale = 'jp'
-    else:
-        locale = None
-
-    try:
-        result = amazon.searchByTitle(keyword, type="Large", product_line="DVD", locale=locale)
-        if hasattr(result, 'TotalPages'):
-            # get next result pages
-            pages = int(result.TotalPages)
-            page = 2
-            while page <= pages and page < 11:
-                tmp = amazon.searchByTitle(keyword, type='Large', product_line='DVD', locale=locale, page=page)
-                result.Item.extend(tmp.Item)
-                page = page + 1
-        if not hasattr(result, 'Item') or not len(result.Item):
-            # fallback if nothing is found by title
-            result = amazon.searchByKeyword(keyword, type="Large", product_line="DVD", locale=locale)
-            if hasattr(result, 'TotalPages'):
-                # get next result pages
-                pages = int(result.TotalPages)
-                page = 2
-                while page <= pages and page < 11:
-                    tmp = amazon.searchByKeyword(keyword, type='Large', product_line='DVD', locale=locale, page=page)
-                    result.Item.extend(tmp.Item)
-                    page = page + 1
-        log.info("... %s posters found" % result.TotalResults)
-    except:
-        gutils.warning(_("No posters found for this movie."))
-        return
-
-    from widgets import connect_poster_signals, reconnect_add_signals
-    connect_poster_signals(self, get_poster_select_dc, result, current_poster)
-
-    if not hasattr(result, 'Item') or not len(result.Item):
-        gutils.warning(_("No posters found for this movie."))
-        reconnect_add_signals(self)
-        return
-
-    if len(result.Item) == 1:
-        o_title = self.widgets['movie']['o_title'].get_text().decode('utf-8')
-        if o_title == result.Item[0].ItemAttributes.Title or keyword == result.Item[0].ItemAttributes.Title:
-            get_poster(self, 0, result)
-            return
-
-    self.treemodel_results.clear()
-    self.widgets['add']['b_get_from_web'].set_sensitive(False) # disable movie plugins (result window is shared)
-
-    for f in range(len(result.Item)):
-        if hasattr(result.Item[f], "LargeImage") and len(result.Item[f].LargeImage.URL):
-            title = result.Item[f].ItemAttributes.Title
-            if hasattr(result.Item[f].ItemAttributes, 'ProductGroup'):
-                title = title + u' - ' + result.Item[f].ItemAttributes.ProductGroup
-            elif hasattr(result.Item[f].ItemAttributes, 'Binding'):
-                title = title + u' - ' + result.Item[f].ItemAttributes.Binding
-            if hasattr(result.Item[f].ItemAttributes, 'ReleaseDate'):
-                title = title + u' - ' + result.Item[f].ItemAttributes.ReleaseDate[:4]
-            elif hasattr(result.Item[f].ItemAttributes, 'TheatricalReleaseDate'):
-                result.Item[f].ItemAttributes.TheatricalReleaseDate[:4]
-            if hasattr(result.Item[f].ItemAttributes, 'Studio'):
-                title = title + u' - ' + result.Item[f].ItemAttributes.Studio
-            myiter = self.treemodel_results.insert_before(None, None)
-            self.treemodel_results.set_value(myiter, 0, str(f))
-            self.treemodel_results.set_value(myiter, 1, title)
-
-    self.widgets['results']['window'].show()
-    self.widgets['results']['window'].set_keep_above(True)
-
-def get_poster_select_dc(self, event, mself, result, current_poster):
-    if event.type == gtk.gdk._2BUTTON_PRESS:
-        get_poster(mself, None, result)
-
-def get_poster_select(self, mself, result, current_poster):
-    get_poster(mself, None, result)
-
-def get_poster(self, f, result):
-    from widgets import reconnect_add_signals
-    from movie import Progress, Retriever
-    if f is None:
-        treeselection = self.widgets['results']['treeview'].get_selection()
-        (tmp_model, tmp_iter) = treeselection.get_selected()
-        if tmp_iter is None:
-            return False
-        f = int(tmp_model.get_value(tmp_iter, 0))
-        self.widgets['results']['window'].hide()
-
-    file_to_copy = tempfile.mktemp(suffix=self.widgets['movie']['number'].get_text(), \
-        dir=self.locations['temp'])
-    file_to_copy += ".jpg"
-    canceled = False
-    if len(result.Item[f].LargeImage.URL):
-        try:
-            progress = Progress(self.widgets['window'],_("Fetching poster"),_("Wait a moment"))
-            retriever = Retriever(result.Item[f].LargeImage.URL, self.widgets['window'], progress, file_to_copy)
-            retriever.start()
-            while retriever.isAlive():
-                progress.pulse()
-                if progress.status:
-                    canceled = True
-                while gtk.events_pending():
-                    gtk.main_iteration()
-            progress.close()
-            urlcleanup()
-        except:
-            canceled = True
-            gutils.warning(_("Sorry. A connection error has occurred."))
-            try:
-                os.remove(file_to_copy)
-            except:
-                log.error("no permission for %s"%file_to_copy)
-
-    if not canceled:
-        if os.path.isfile(file_to_copy):
-            im = None
-            try:
-                im = Image.open(file_to_copy)
-            except IOError:
-                log.warn("failed to identify %s"%file_to_copy)
-
-            if im and im.size == (1,1):
-                url = FancyURLopener().open("http://www.amazon.com/gp/product/images/%s" % result.Item[f].ASIN).read()
-                if url.find('no-img-sm._V47056216_.gif') > 0:
-                    log.warn('No image available')
-                    gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
-                    return False
-                url = gutils.after(url, 'id="imageViewerDiv"><img src="')
-                url = gutils.before(url, '" id="prodImage"')
-                urlretrieve(url, file_to_copy)
-                try:
-                    im = Image.open(file_to_copy)
-                except IOError:
-                    log.warn("failed to identify %s"%file_to_copy)
-
-            if not im:
-                # something wrong with the image, give some feedback to the user
-                log.warn('No image available')
-                gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
-                return False
-
-            if im.mode != 'RGB': # convert GIFs
-                im = im.convert('RGB')
-                im.save(file_to_copy, 'JPEG')
-            # set to None because the file is locked otherwise (os.remove throws an exception)
-            im = None
-
-            handler = self.widgets['big_poster'].set_from_file(file_to_copy)
-
-            self.widgets['poster_window'].show()
-            self.widgets['poster_window'].move(0,0)
-            response = gutils.question(_("Do you want to use this poster instead?"), True, self.widgets['window'])
-            if response == -8:
-                log.info("Using fetched poster, updating and removing old one from disk.")
-                update_image(self, self.widgets['movie']['number'].get_text(), file_to_copy)
-            else:
-                log.info("Reverting to previous poster and deleting new one from disk.")
-                try:
-                    os.remove(file_to_copy)
-                except:
-                    log.error("no permission for %s"%file_to_copy)
-
-            self.widgets['poster_window'].hide()
-        else:
-            gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
-    else:
-        # cleanup temporary files after canceling the download
-        if os.path.isfile(file_to_copy):
-            try:
-                os.remove(file_to_copy)
-            except:
-                log.error("no permission for %s"%file_to_copy)
-    # reconnect the signals to the shared result list
-    reconnect_add_signals(self)
-

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/initialize.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -478,6 +478,32 @@
     w['box_import_2'].show_all()
     w['box_import_3'].show_all()
 
+def extensions(self):
+    import plugins.extensions
+    user_extensions_path = os.path.join(self.locations['home'], 'lib', 'extensions')
+    if os.path.isdir(user_extensions_path):
+        plugins.extensions.scan_for_extensions(user_extensions_path)
+
+    if hasattr(self, 'extensions'):
+        for ext in self.extensions:
+            ext.clear()
+    self.extensions = [] # deletes previous instances
+
+    for ext_name in plugins.extensions.by_name:
+        ext_module = plugins.extensions.by_name[ext_name]
+        if ext_module.enabled:
+            try:
+                ext = ext_module(self)
+                self.extensions.append(ext)
+            except (NotImplementedError, DeprecationWarning), e:
+                log.warning('extension skipped: %s', e.message)
+                log.debug('extension skipped: %s', ext_module.__file__)
+                continue
+            if ext_module.toolbar_icon:
+                toolbar = self.widgets['extensions']['toolbar']
+                i = ext_module.toolbar_icon
+                ext.toolbar_icon_widget = toolbar.insert_stock(ext_module.toolbar_icon, ext_module.description, None, ext._on_toolbar_icon_clicked, None, -1)
+
 def people_treeview(self, create=True):
     row = None
     self.p_treemodel = gtk.TreeStore(gobject.TYPE_STRING, gobject.TYPE_STRING, gobject.TYPE_STRING, gobject.TYPE_STRING)
@@ -623,16 +649,16 @@
     self.widgets['results']['treeview'].set_model(self.treemodel_results)
     self.widgets['results']['treeview'].set_headers_visible(False)
     # column ids
-    renderer=gtk.CellRendererText()
-    self.column1=gtk.TreeViewColumn(None, renderer, text=0)
-    self.column1.set_visible(False)
-    self.widgets['results']['treeview'].append_column(self.column1)
+    renderer = gtk.CellRendererText()
+    column1 = gtk.TreeViewColumn(None, renderer, text=0)
+    column1.set_visible(False)
+    self.widgets['results']['treeview'].append_column(column1)
     # column titles
-    renderer=gtk.CellRendererText()
-    self.column2=gtk.TreeViewColumn(None, renderer, text=1)
-    self.column2.set_resizable(True)
-    self.column2.set_sort_column_id(1)
-    self.widgets['results']['treeview'].append_column(self.column2)
+    renderer = gtk.CellRendererText()
+    column2 = gtk.TreeViewColumn(None, renderer, text=1)
+    column2.set_resizable(True)
+    column2.set_sort_column_id(1)
+    self.widgets['results']['treeview'].append_column(column2)
 
 def spellcheck(self):
     global spell_support

Modified: trunk/lib/main_treeview.py
===================================================================
--- trunk/lib/main_treeview.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/main_treeview.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -51,6 +51,8 @@
             # poster window is visible
             filename = gutils.get_image_fname(movie.poster_md5, self.db)
             self.widgets['big_poster'].set_from_file(filename)
+        for ext in self.extensions:
+            ext.maintree_clicked(treeselection, movie)
         set_details(self, movie)
     else:
         set_details(self, {})
@@ -225,12 +227,10 @@
         if filename and os.path.isfile(filename):
             image_path = filename
             self.widgets['add']['delete_poster'].set_sensitive(True)
-            self.widgets['menu']['delete_poster'].set_sensitive(True)
             w['picture_button'].set_sensitive(True)
         else:
             image_path = os.path.join(self.locations['images'], 'default.png')
             self.widgets['add']['delete_poster'].set_sensitive(False)
-            self.widgets['menu']['delete_poster'].set_sensitive(False)
             w['picture_button'].set_sensitive(False)
     else:
         image_path = os.path.join(self.locations['images'], 'default.png')

Modified: trunk/lib/plugins/__init__.py
===================================================================
--- trunk/lib/plugins/__init__.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/plugins/__init__.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -1 +1 @@
-__all__ = ['export', 'imp', 'movie']
+__all__ = ['export', 'imp', 'movie', 'extensions']

Added: trunk/lib/plugins/extensions/__init__.py
===================================================================
--- trunk/lib/plugins/extensions/__init__.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/plugins/extensions/__init__.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -0,0 +1,139 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright ? 2009 Piotr O?arowski
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published byp
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+import glob
+import logging
+import os.path
+import sys
+
+import db
+
+log = logging.getLogger('Griffith')
+
+# minimum and maximum supported extension APIs
+COMPAT = (1, 1)
+
+class GriffithExtensionBase(object):
+    """Griffith Extension
+
+    :attr config: configuration
+    :attr db: database
+    :attr locations: dictionary with Griffth locations
+    :attr widgets: dictionary with GUI widgets
+    :attr preferences: dictionary used to generate new widgets in preferences window
+        every key points to another dictionary that contains:
+        * name: will be shown to user
+        * type: int or unicode (type) or list (instance)
+        * min: minimum value (int) or length (unicode)
+        * max: maximum value (int) or length (unicode)
+    :attr app: application reference (use only if really needed)
+    """
+    name = None
+    description = None
+    author = None
+    email = None
+    version = None
+    api = 1 # required Griffith Extension API
+
+    enabled = True # default state (can be later changed in preferences)
+    toolbar_icon = None # None or stock icon name
+    preferences = {}
+
+    toolbar_icon_widget = None # will be constructed from toolbar_icon
+
+    def __new__(class_, *args, **kwargs):
+        if class_.api < COMPAT[0]:
+            raise DeprecationWarning("Extension is using API that is no longer supported: %s (api=%d)" % (class_.name, class_.api))
+        if class_.api > COMPAT[1]:
+            raise NotImplementedError("Extension is using API that is not yet supported: %s (api=%d)" % (class_.name, class_.api))
+        obj = object.__new__(class_, *args, **kwargs)
+        obj.app = app = args[0]
+        obj.widgets = app.widgets
+        obj.config = app.config
+        obj.db = app.db
+        obj.locations = app.locations
+        return obj
+
+    def __repr__(self):
+        return "<GriffithExtension api=%d name=%s version=%s>" % (self.api, self.name, self.version)
+
+    def get_config_value(self, key, default=None):
+        return self.config.get("%s_%s" % (self.id, key), default, section='extensions')
+
+    def _on_toolbar_icon_clicked(self, button_widget):
+        session = self.db.Session()
+        movie = session.query(db.Movie).filter(db.Movie.movie_id==self.app._movie_id).first()
+        if not movie:
+            log.error('No movie selected')
+        else:
+            self.toolbar_icon_clicked(button_widget, movie)
+
+    # methods that can be overwritten:
+
+    def __init__(self, griffith):
+        """Initializes extension"""
+   
+    def clear(self): # __del__ cannot be used here (signal references issue)
+        """Invoked when extension is about to be disabled"""
+        if self.toolbar_icon_widget:
+            print self.toolbar_icon_widget.destroy()
+
+    def maintree_clicked(self, selection, movie):
+        """Invoked every time new movie is selected"""
+    
+    def toolbar_icon_clicked(self, widget, movie):
+        """Invoked when toolbar icon is clicked"""
+
+    def filter_movies(self, conditions):
+        """Modifies movie selection (via search conditions)"""
+        return conditions
+
+
+by_name = {} # extension modules by name 
+def scan_for_extensions(path):
+    """Adds new extensions from given path"""
+
+    names = dict((os.path.basename(x)[:-3], x) for x in glob.glob("%s/ge_[a-zA-Z]*.py" % path))
+    names.update(dict((os.path.basename(x)[:-4], x) for x in glob.glob("%s/ge_[a-zA-Z]*.pyo" % path)))
+    names.update(dict((os.path.basename(x)[:-4], x) for x in glob.glob("%s/ge_[a-zA-Z]*.pyc" % path)))
+
+    if names:
+        remove_from_syspath = False
+        if path not in sys.path:
+            remove_from_syspath = True
+            sys.path.append(path)
+
+        for ext_name in names:
+            #module = __import__("plugins.extensions.%s" % ext_name, fromlist=[ext_name])
+            module = __import__(ext_name)
+            id_ = ext_name[3:] # skip the "ge_"
+            extension = module.GriffithExtension
+            extension.id = id_
+            extension.__file__ = names[ext_name]
+            by_name[id_] = extension
+
+        if remove_from_syspath:
+            del sys.path[-1]
+
+scan_for_extensions(os.path.dirname(__file__)) # user's directory will be added later (in app)
+


Property changes on: trunk/lib/plugins/extensions/__init__.py
___________________________________________________________________
Name: svn:keywords
   + Id

Copied: trunk/lib/plugins/extensions/amazon.py (from rev 1272, trunk/lib/amazon.py)


Property changes on: trunk/lib/plugins/extensions/amazon.py
___________________________________________________________________
Name: svn:keywords
   + Id

Added: trunk/lib/plugins/extensions/ge_amazon.py
===================================================================
--- trunk/lib/plugins/extensions/ge_amazon.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/plugins/extensions/ge_amazon.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -0,0 +1,227 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright ? 2009 Piotr O?arowski
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published byp
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+import logging
+import os
+import tempfile
+from urllib import urlcleanup, FancyURLopener, urlretrieve
+
+import gtk
+from PIL import Image
+
+import gutils
+from plugins.extensions import GriffithExtensionBase as Base
+from widgets import populate_results_window
+from edit import update_image
+
+import amazon
+
+log = logging.getLogger('Griffith')
+amazon.setLicense('04GDDMMXX8X9CJ1B22G2')
+
+class GriffithExtension(Base):
+    name = 'Amazon'
+    description = _('Fetch from Amazon')
+    author = 'Piotr O?arowski'
+    email = 'piotr at griffith.cc'
+    version = 1
+    api = 1
+
+    preferences = {'locale': {'name': _('Select source'),
+                              'type': ('US', 'UK', 'DE', 'CA', 'FR', 'JP')}}
+    toolbar_icon = 'gtk-network'
+
+    def toolbar_icon_clicked(self, widget, movie):
+        log.info('fetching poster from Amazon...')
+        self.movie = movie
+
+        if movie is None:
+            gutils.error(self.app, _('You have no movies in your database'), self.widgets['window'])
+            return False
+
+        locale = self.get_config_value('locale', 'US').lower()
+
+        keyword = movie.o_title
+        if locale == 'de':
+            keyword = movie.title
+
+        try:
+            result = amazon.searchByTitle(keyword, type='Large', product_line='DVD', locale=locale)
+            if hasattr(result, 'TotalPages'):
+                # get next result pages
+                pages = int(result.TotalPages)
+                page = 2
+                while page <= pages and page < 11:
+                    tmp = amazon.searchByTitle(keyword, type='Large', product_line='DVD', locale=locale, page=page)
+                    result.Item.extend(tmp.Item)
+                    page = page + 1
+            if not hasattr(result, 'Item') or not len(result.Item):
+                # fallback if nothing is found by title
+                result = amazon.searchByKeyword(keyword, type='Large', product_line='DVD', locale=locale)
+                if hasattr(result, 'TotalPages'):
+                    # get next result pages
+                    pages = int(result.TotalPages)
+                    page = 2
+                    while page <= pages and page < 11:
+                        tmp = amazon.searchByKeyword(keyword, type='Large', product_line='DVD', locale=locale, page=page)
+                        result.Item.extend(tmp.Item)
+                        page = page + 1
+            self._result = result
+            log.info("... %s posters found" % result.TotalResults)
+        except:
+            gutils.warning(_('No posters found for this movie.'))
+            return
+
+        if not hasattr(result, 'Item') or not len(result.Item):
+            gutils.warning(_('No posters found for this movie.'))
+            return
+
+        if len(result.Item) == 1:
+            o_title = self.widgets['movie']['o_title'].get_text().decode('utf-8')
+            if o_title == result.Item[0].ItemAttributes.Title or keyword == result.Item[0].ItemAttributes.Title:
+                self.get_poster(self.app, result.Item[0])
+                return
+
+        # populate results window
+        items = {}
+        for i, item in enumerate(result.Item):
+            if hasattr(item, 'LargeImage') and len(item.LargeImage.URL):
+                title = item.ItemAttributes.Title
+                if hasattr(item.ItemAttributes, 'ProductGroup'):
+                    title = title + u' - ' + item.ItemAttributes.ProductGroup
+                elif hasattr(item.ItemAttributes, 'Binding'):
+                    title = title + u' - ' + item.ItemAttributes.Binding
+                if hasattr(item.ItemAttributes, 'ReleaseDate'):
+                    title = title + u' - ' + item.ItemAttributes.ReleaseDate[:4]
+                elif hasattr(item.ItemAttributes, 'TheatricalReleaseDate'):
+                    item.ItemAttributes.TheatricalReleaseDate[:4]
+                if hasattr(item.ItemAttributes, 'Studio'):
+                    title = title + u' - ' + item.ItemAttributes.Studio
+                items[i] = title
+
+        populate_results_window(self.app.treemodel_results, items)
+        self.widgets['add']['b_get_from_web'].set_sensitive(False) # disable movie plugins (result window is shared)
+        self.app._resultswin_process = self.on_result_selected # use this signal (will be reverted when window is closed)
+        self.widgets['results']['window'].show()
+        self.widgets['results']['window'].set_keep_above(True)
+
+    def on_result_selected(self, key):
+        key = int(key)
+        if self._result.Item[key].LargeImage.URL:
+            poster_file = self.get_poster(self._result.Item[key])
+            if poster_file:
+                update_image(self.app, self.movie.number, poster_file)
+                try:
+                    os.remove(poster_file)
+                except:
+                    log.error('cannot remove %s', poster_file)
+        self.widgets['results']['window'].hide()
+        self.widgets['add']['b_get_from_web'].set_sensitive(True)
+
+    def get_poster(self, item):
+        """Returns file path to the new poster"""
+
+        from movie import Progress, Retriever
+
+        file_to_copy = tempfile.mktemp(suffix=self.widgets['movie']['number'].get_text(), \
+            dir=self.locations['temp'])
+        file_to_copy += ".jpg"
+        canceled = False
+        try:
+            progress = Progress(self.widgets['window'], _("Fetching poster"), _("Wait a moment"))
+            retriever = Retriever(item.LargeImage.URL, self.widgets['window'], progress, file_to_copy)
+            retriever.start()
+            while retriever.isAlive():
+                progress.pulse()
+                if progress.status:
+                    canceled = True
+                while gtk.events_pending():
+                    gtk.main_iteration()
+            progress.close()
+            urlcleanup()
+        except:
+            canceled = True
+            gutils.warning(_("Sorry. A connection error has occurred."))
+            try:
+                os.remove(file_to_copy)
+            except:
+                log.error("no permission for %s"%file_to_copy)
+
+        if not canceled:
+            if os.path.isfile(file_to_copy):
+                im = None
+                try:
+                    im = Image.open(file_to_copy)
+                except IOError:
+                    log.warn("failed to identify %s"%file_to_copy)
+
+                if im and im.size == (1,1):
+                    url = FancyURLopener().open("http://www.amazon.com/gp/product/images/%s" % item.ASIN).read()
+                    if url.find('no-img-sm._V47056216_.gif') > 0:
+                        log.warn('No image available')
+                        gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
+                        return False
+                    url = gutils.after(url, 'id="imageViewerDiv"><img src="')
+                    url = gutils.before(url, '" id="prodImage"')
+                    urlretrieve(url, file_to_copy)
+                    try:
+                        im = Image.open(file_to_copy)
+                    except IOError:
+                        log.warn("failed to identify %s", file_to_copy)
+
+                if not im:
+                    # something wrong with the image, give some feedback to the user
+                    log.warn('No image available')
+                    gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
+                    return False
+
+                if im.mode != 'RGB': # convert GIFs
+                    im = im.convert('RGB')
+                    im.save(file_to_copy, 'JPEG')
+                # set to None because the file is locked otherwise (os.remove throws an exception)
+                im = None
+
+                handler = self.widgets['big_poster'].set_from_file(file_to_copy)
+
+                self.widgets['poster_window'].show()
+                self.widgets['poster_window'].move(0,0)
+                response = gutils.question(_("Do you want to use this poster instead?"), True, self.widgets['window'])
+                if response == -8:
+                    return file_to_copy
+                else:
+                    log.info("Reverting to previous poster and deleting new one from disk.")
+                    try:
+                        os.remove(file_to_copy)
+                    except:
+                        log.error('cannot remove %s', file_to_copy)
+
+                self.widgets['poster_window'].hide()
+            else:
+                gutils.warning(_("Sorry. This movie is listed but has no poster available at Amazon.com."))
+        else:
+            # cleanup temporary files after canceling the download
+            if os.path.isfile(file_to_copy):
+                try:
+                    os.remove(file_to_copy)
+                except:
+                    log.error('cannot remove %s', file_to_copy)


Property changes on: trunk/lib/plugins/extensions/ge_amazon.py
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/lib/version.py
===================================================================
--- trunk/lib/version.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/version.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -22,7 +22,7 @@
 # GNU General Public License, version 2 or later
 
 pname        = "Griffith"
-pversion     = "0.10"
+pversion     = "0.11~svn"
 pauthor      = "Vasco Nunes, Piotr O?arowski <griffith-private at lists.berlios.de>"
 pyear        = "2005-2009"
 pwebsite     = "http://www.griffith.cc/"

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2009-08-09 20:52:13 UTC (rev 1273)
+++ trunk/lib/widgets.py	2009-08-09 21:15:57 UTC (rev 1274)
@@ -1,4 +1,5 @@
 # -*- coding: UTF-8 -*-
+# vim: fdm=marker
 
 __revision__ = '$Id$'
 
@@ -34,9 +35,9 @@
     self.widgets['treeview'] = get('main_treeview')
     self.widgets['treeview'].connect('button_press_event', self.on_maintree_button_press_event)
     self.widgets['statusbar'] = get('statusbar')
-    self.widgets['progressbar']    = get('w_progress')    # get from web
+    self.widgets['progressbar'] = get('w_progress')    # get from web
     #buttons
-    self.widgets['new_db']      = get('new_bt')
+    self.widgets['new_db'] = get('new_bt')
     self.widgets['toolbar'] = get('toolbar1')
     
 
@@ -137,7 +138,7 @@
         'lang_treeview'    : get('lang_treeview'),
         'b_get_from_web'   : get('get_from_web'),
         'c_web_source'     : get('combo_source'), # c_web_source
-        'delete_poster'    : get('delete_poster'),
+        'delete_poster'    : get('t_delete_poster'),
         'add_button'       : get('am_add_button'),
         'add_close_button' : get('am_add_close_button'),
         'clear_button'     : get('am_clear_button'),
@@ -266,11 +267,14 @@
         'select':   get('results_select'),
         'cancel':   get('results_cancel'),
     }
-    self.widgets['results']['window'].connect('delete_event', self.on_delete_event_r)
+    self.widgets['results']['window'].connect('delete_event', self.on_results_window_close)
     self.widgets['results']['window'].set_transient_for(self.widgets['add']['window'])
     # default results window signals:
-    self.results_signal = self.widgets['results']['select'].connect('clicked', self.populate_dialog_with_results)
-    self.results_double_click = self.widgets['results']['treeview'].connect('button_press_event', self.on_results_button_press_event)
+    self._resultswin_window_closed_signal = None
+    self._resultswin_process = self.populate_dialog_with_results
+    self._resultswin_button_pressed_signal = self.on_add_movie_results_button_press_event
+    self.widgets['results']['select'].connect('clicked', self.on_results_select_press_event)
+    self.widgets['results']['treeview'].connect('button_press_event', self.on_results_button_press_event)
     #}}}
 
     self.widgets['print_cover'] = {#{{{
@@ -330,7 +334,6 @@
         'not_seen_movies' : get('seen_movies'),
         'loaned_movies'   : get('loaned_movies'),
         'all_movies'      : get('all_movies'),
-        'delete_poster'   : get('t_delete_poster'),
         'loan'            : get('loan1'),
         'email'           : get('return1'),
         'return'          : get('e-mail_reminder1'),
@@ -342,6 +345,9 @@
         'return' : get('popup_return'),
         'email'  : get('popup_email'),
     }#}}}
+    self.widgets['extensions'] = {
+        'toolbar': get('ext_toolbar'),
+    }
     
     self.widgets['w_loan_to']     = get('w_loan_to')
     self.widgets['w_loan_to'].connect('delete_event', self.on_delete_event_lt)
@@ -434,7 +440,6 @@
         'on_open_poster_clicked'                 : self.change_poster,
         'on_zoom_poster_clicked'                 : self.z_poster,
         'on_delete_poster_clicked'               : self.del_poster,
-        'on_fetch_poster_clicked'                : self.get_poster,
         # URLs
         'on_goto_homepage_activate'              : self.on_goto_homepage_activate,
         'on_goto_forum_activate'                 : self.on_goto_forum_activate,
@@ -464,7 +469,7 @@
         'on_am_remove_collection_button_clicked' : self.remove_collection,
         'on_f_col_changed'                       : self.filter_collection,
         'on_f_advfilter_changed'                 : self.filter_using_advfilter_rule,
-        'on_results_cancel_clicked'              : self.results_cancel_ck,
+        'on_results_cancel_clicked'              : self.on_results_window_close,
         # languages
         'on_lang_add_clicked'                    : self.on_lang_add_clicked,
         'on_lang_remove_clicked'                 : self.on_lang_remove_clicked,
@@ -512,44 +517,15 @@
         'on_advfilter_open'                      : lambda w: advfilter.load(self.db, self.widgets['advfilter'], self.field_names),
     })#}}}
 
-def reconnect_add_signals(self):#{{{
-    self.widgets['add']['b_get_from_web'].set_sensitive(True)
-    try:
-        self.widgets['results']['select'].disconnect(self.poster_results_signal)
-    except:
-        pass
+def populate_results_window(treemodel, items):
+    treemodel.clear()
 
-    try:
-        self.widgets['results']['treeview'].disconnect(self.results_poster_double_click)
-    except:
-        pass
+    if isinstance(items, dict):
+        iterable = items.iteritems()
+    else:
+        iterable = items
 
-    # connect signals
-    self.results_signal = self.widgets['results']['select'].connect('clicked', \
-            self.populate_dialog_with_results)
-    self.results_double_click = self.widgets['results']['treeview'].connect('button_press_event', \
-        self.on_results_button_press_event)#}}}
-
-def connect_poster_signals(self, event, result, current_poster):#{{{
-    import edit
-
-    try:
-        self.widgets['results']['select'].disconnect(self.results_signal)
-    except:
-        pass
-
-    try:
-        self.widgets['results']['treeview'].disconnect(self.results_double_click)
-    except:
-        pass
-
-    # connect signals
-
-    self.results_poster_double_click = self.widgets['results']['treeview'].connect('button_press_event', \
-        edit.get_poster_select_dc, self, result, current_poster)
-
-    self.poster_results_signal = \
-        self.widgets['results']['select'].connect('clicked', edit.get_poster_select, \
-        self, result, current_poster)
-    #}}}
-# vim: fdm=marker
+    for key, value in iterable:
+        myiter = treemodel.insert_before(None, None)
+        treemodel.set_value(myiter, 0, str(key))
+        treemodel.set_value(myiter, 1, value)



From piotrek at mail.berlios.de  Tue Aug 11 23:55:35 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Tue, 11 Aug 2009 23:55:35 +0200
Subject: [Griffith-svn] r1275 - in trunk: . lib/plugins/extensions
Message-ID: <200908112155.n7BLtZYu020657@sheep.berlios.de>

Author: piotrek
Date: 2009-08-11 23:55:35 +0200 (Tue, 11 Aug 2009)
New Revision: 1275

Added:
   trunk/lib/plugins/extensions/ge_player.py
Modified:
   trunk/ChangeLog
   trunk/lib/plugins/extensions/__init__.py
Log:
Add Player extension


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-09 21:15:57 UTC (rev 1274)
+++ trunk/ChangeLog	2009-08-11 21:55:35 UTC (rev 1275)
@@ -5,6 +5,9 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-11  Piotr O?arowski
+	* Add Player extension
+
 2009-08-09  Piotr O?arowski
 	* Version changed to 0.11~svn
 	* Initial structure for extensions created

Modified: trunk/lib/plugins/extensions/__init__.py
===================================================================
--- trunk/lib/plugins/extensions/__init__.py	2009-08-09 21:15:57 UTC (rev 1274)
+++ trunk/lib/plugins/extensions/__init__.py	2009-08-11 21:55:35 UTC (rev 1275)
@@ -30,7 +30,7 @@
 
 log = logging.getLogger('Griffith')
 
-# minimum and maximum supported extension APIs
+# minimum and maximum supported extension API
 COMPAT = (1, 1)
 
 class GriffithExtensionBase(object):
@@ -55,7 +55,7 @@
     version = None
     api = 1 # required Griffith Extension API
 
-    enabled = True # default state (can be later changed in preferences)
+    enabled = True # default state (can be changed in preferences later)
     toolbar_icon = None # None or stock icon name
     preferences = {}
 
@@ -93,7 +93,7 @@
     def __init__(self, griffith):
         """Initializes extension"""
    
-    def clear(self): # __del__ cannot be used here (signal references issue)
+    def clear(self): # __del__ cannot be used here (signal reference issue)
         """Invoked when extension is about to be disabled"""
         if self.toolbar_icon_widget:
             print self.toolbar_icon_widget.destroy()

Added: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-09 21:15:57 UTC (rev 1274)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-11 21:55:35 UTC (rev 1275)
@@ -0,0 +1,63 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright ? 2009 Piotr O?arowski
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published byp
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+import logging
+from subprocess import Popen
+
+from plugins.extensions import GriffithExtensionBase as Base
+
+log = logging.getLogger('Griffith')
+
+class GriffithExtension(Base):
+    name = 'Player'
+    description = _('Plays movie trailer')
+    author = 'Piotr O?arowski'
+    email = 'piotr at griffith.cc'
+    version = 1
+    api = 1
+    enabled = False # disabled by default
+    enabled = True
+
+    preferences = {'command': {'name': _('Command'),
+                               'hint': _('%s (if given) will be replaced with file path'),
+                               'default': 'mplayer %s',
+                               'type': unicode}}
+    toolbar_icon = 'gtk-open'
+
+    def toolbar_icon_clicked(self, widget, movie):
+        if not movie or not movie.trailer:
+            
+            return False
+
+        command = self.get_config_value('command', self.preferences['command']['default']).lower()
+        if '%s' in command:
+            command %= movie.trailer
+        else:
+            command = "%s %s" % (command, movie.trailer)
+        Popen(command, shell=True)
+
+    def maintree_clicked(self, selection, movie):
+        if movie and movie.trailer:
+            self.toolbar_icon_widget.set_sensitive(True)
+        else:
+            self.toolbar_icon_widget.set_sensitive(False)


Property changes on: trunk/lib/plugins/extensions/ge_player.py
___________________________________________________________________
Name: svn:keywords
   + Id



From piotrek at mail.berlios.de  Wed Aug 12 00:01:14 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Wed, 12 Aug 2009 00:01:14 +0200
Subject: [Griffith-svn] r1276 - trunk/lib/plugins/extensions
Message-ID: <200908112201.n7BM1EX5022800@sheep.berlios.de>

Author: piotrek
Date: 2009-08-12 00:01:14 +0200 (Wed, 12 Aug 2009)
New Revision: 1276

Modified:
   trunk/lib/plugins/extensions/ge_player.py
Log:
minor fix


Modified: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-11 21:55:35 UTC (rev 1275)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-11 22:01:14 UTC (rev 1276)
@@ -36,7 +36,6 @@
     version = 1
     api = 1
     enabled = False # disabled by default
-    enabled = True
 
     preferences = {'command': {'name': _('Command'),
                                'hint': _('%s (if given) will be replaced with file path'),
@@ -46,10 +45,9 @@
 
     def toolbar_icon_clicked(self, widget, movie):
         if not movie or not movie.trailer:
-            
             return False
 
-        command = self.get_config_value('command', self.preferences['command']['default']).lower()
+        command = self.get_config_value('command', self.preferences['command']['default'])
         if '%s' in command:
             command %= movie.trailer
         else:



From piotrek at mail.berlios.de  Wed Aug 12 23:56:48 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Wed, 12 Aug 2009 23:56:48 +0200
Subject: [Griffith-svn] r1277 - in trunk: . glade lib lib/plugins/extensions
Message-ID: <200908122156.n7CLumXf027709@sheep.berlios.de>

Author: piotrek
Date: 2009-08-12 23:56:47 +0200 (Wed, 12 Aug 2009)
New Revision: 1277

Modified:
   trunk/ChangeLog
   trunk/glade/griffith.glade
   trunk/lib/initialize.py
   trunk/lib/plugins/extensions/__init__.py
   trunk/lib/plugins/extensions/ge_amazon.py
   trunk/lib/preferences.py
   trunk/lib/widgets.py
Log:
* Remove Amazon stuff from preferences window
* Region 2 and 4 names shorten (to fit in preferences window)
* Show tabs on the left side of preferences window
* Show extension settings in preferences


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/ChangeLog	2009-08-12 21:56:47 UTC (rev 1277)
@@ -5,6 +5,12 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-12  Piotr O?arowski
+	* Remove Amazon stuff from preferences window
+	* Region 2 and 4 names shorten (to fit in preferences window)
+	* Show tabs on the left side of preferences window
+	* Show extension settings in preferences
+
 2009-08-11  Piotr O?arowski
 	* Add Player extension
 

Modified: trunk/glade/griffith.glade
===================================================================
--- trunk/glade/griffith.glade	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/glade/griffith.glade	2009-08-12 21:56:47 UTC (rev 1277)
@@ -2577,6 +2577,7 @@
             <property name="visible">True</property>
             <property name="can_focus">True</property>
             <property name="border_width">4</property>
+            <property name="tab_pos">left</property>
             <child>
               <widget class="GtkVBox" id="vbox58">
                 <property name="visible">True</property>
@@ -5525,63 +5526,6 @@
                         </child>
                       </widget>
                     </child>
-                    <child>
-                      <widget class="GtkFrame" id="frame26">
-                        <property name="visible">True</property>
-                        <property name="label_xalign">0</property>
-                        <child>
-                          <widget class="GtkAlignment" id="alignment90">
-                            <property name="visible">True</property>
-                            <property name="left_padding">12</property>
-                            <child>
-                              <widget class="GtkVBox" id="vbox61">
-                                <property name="visible">True</property>
-                                <property name="border_width">8</property>
-                                <property name="spacing">4</property>
-                                <child>
-                                  <widget class="GtkLabel" id="label302">
-                                    <property name="visible">True</property>
-                                    <property name="label" translatable="yes">Use locale:</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="expand">False</property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <widget class="GtkComboBox" id="cb_amazon_locale">
-                                    <property name="visible">True</property>
-                                    <property name="items">US
-UK
-DE
-CA
-FR
-JP</property>
-                                  </widget>
-                                  <packing>
-                                    <property name="expand">False</property>
-                                    <property name="position">1</property>
-                                  </packing>
-                                </child>
-                              </widget>
-                            </child>
-                          </widget>
-                        </child>
-                        <child>
-                          <widget class="GtkLabel" id="label301">
-                            <property name="visible">True</property>
-                            <property name="label" translatable="yes">Fetch from Amazon</property>
-                            <property name="use_markup">True</property>
-                          </widget>
-                          <packing>
-                            <property name="type">label_item</property>
-                          </packing>
-                        </child>
-                      </widget>
-                      <packing>
-                        <property name="expand">False</property>
-                        <property name="position">1</property>
-                      </packing>
-                    </child>
                   </widget>
                 </child>
                 <child>
@@ -5749,6 +5693,63 @@
                 <property name="tab_fill">False</property>
               </packing>
             </child>
+	  <child>
+	    <widget class="GtkScrolledWindow" id="scrolledwindow12">
+	      <property name="border_width">4</property>
+	      <property name="visible">True</property>
+	      <property name="can_focus">True</property>
+	      <property name="hscrollbar_policy">GTK_POLICY_NEVER</property>
+	      <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+	      <property name="shadow_type">GTK_SHADOW_NONE</property>
+	      <property name="window_placement">GTK_CORNER_TOP_LEFT</property>
+
+	      <child>
+		<widget class="GtkViewport" id="viewport11">
+		  <property name="visible">True</property>
+		  <property name="shadow_type">GTK_SHADOW_NONE</property>
+
+		  <child>
+		    <widget class="GtkVBox" id="p_extensions_vbox">
+		      <property name="visible">True</property>
+		      <property name="homogeneous">False</property>
+		      <property name="spacing">0</property>
+
+		      <child>
+			<placeholder/>
+		      </child>
+		    </widget>
+		  </child>
+		</widget>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="tab_expand">False</property>
+	      <property name="tab_fill">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkLabel" id="label308">
+	      <property name="visible">True</property>
+          <property name="label" translatable="yes">Extensions</property>
+	      <property name="use_underline">False</property>
+	      <property name="use_markup">False</property>
+	      <property name="justify">GTK_JUSTIFY_LEFT</property>
+	      <property name="wrap">False</property>
+	      <property name="selectable">False</property>
+	      <property name="xalign">0.5</property>
+	      <property name="yalign">0.5</property>
+	      <property name="xpad">0</property>
+	      <property name="ypad">0</property>
+	      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+	      <property name="width_chars">-1</property>
+	      <property name="single_line_mode">False</property>
+	      <property name="angle">0</property>
+	    </widget>
+	    <packing>
+	      <property name="type">tab</property>
+	    </packing>
+	  </child>
           </widget>
           <packing>
             <property name="position">2</property>

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/lib/initialize.py	2009-08-12 21:56:47 UTC (rev 1277)
@@ -478,6 +478,83 @@
     w['box_import_2'].show_all()
     w['box_import_3'].show_all()
 
+def extension(self, module, enabled):
+    if enabled:
+        try:
+            ext = module(self)
+        except (NotImplementedError, DeprecationWarning), e:
+            log.warning('extension skipped: %s', e.message)
+            log.debug('extension skipped: %s', module.__file__)
+            return False
+        if module.toolbar_icon:
+            toolbar = self.widgets['extensions']['toolbar']
+            ext.toolbar_icon_widget = toolbar.insert_stock(module.toolbar_icon, module.description, None, ext._on_toolbar_icon_clicked, None, -1)
+    else:
+        ext = None
+
+    # preferences window
+
+    p_vbox = self.widgets['extensions']['preferences_vbox']
+
+    label = "%s v%s <i>(%s &lt;%s&gt;)</i>" % (module.name, module.version, module.author, module.email)
+    expander = gtk.Expander(label=label)
+    expander.set_use_markup(True)
+    vbox = gtk.VBox()
+
+    # extension details
+    hbox = gtk.HBox()
+    vbox.pack_start(hbox, expand=False)
+    enabled_cb = gtk.CheckButton(label=_('use this extension'))
+    enabled_cb.set_active(enabled)
+    vbox.pack_start(enabled_cb, expand=False)
+
+    for pref_name in module.preferences:
+        #preferences = {'command': {'name': _('Command'),
+        #                       'hint': _('%s (if given) will be replaced with file path'),
+        #                       'default': 'mplayer %s',
+        #                       'type': unicode}}
+        name = module.preferences[pref_name].get('name', pref_name)
+        hint = module.preferences[pref_name].get('hint')
+        value = module.preferences[pref_name].get('default')
+        #TODO: get value from config
+        type_ = module.preferences[pref_name].get('type', unicode)
+
+        hbox = gtk.HBox()
+        hbox.pack_start(gtk.Label(name), expand=False, padding=4)
+
+        if type_ is unicode:
+            w = gtk.Entry()
+            w.insert_text(value)
+            # TODO: min, max
+        # elif type is int: # TODO
+        elif isinstance(type_, (list, tuple, dict)):
+            model = gtk.TreeStore(str, str)
+            myiter = model.append(None, None)
+            if isinstance(type_, dict):
+                iterable = type_.iteritems()
+            else:
+                iterable = enumerate(type_)
+            for code, value in iterable:
+                model.set_value(myiter, 0, unicode(code))
+                model.set_value(myiter, 1, unicode(value))
+            w = gtk.ComboBox(model=model)
+            # TODO: select default value
+        else:
+            log.error('type not recognized %s', type(type_))
+            continue
+
+        if hint:
+            w.set_tooltip_markup(hint)
+        hbox.pack_start(w)
+
+        vbox.pack_start(hbox, expand=False)
+
+    expander.add(vbox)
+    p_vbox.pack_start(expander, expand=False)
+    p_vbox.show_all()
+
+    return ext
+
 def extensions(self):
     import plugins.extensions
     user_extensions_path = os.path.join(self.locations['home'], 'lib', 'extensions')
@@ -491,18 +568,11 @@
 
     for ext_name in plugins.extensions.by_name:
         ext_module = plugins.extensions.by_name[ext_name]
-        if ext_module.enabled:
-            try:
-                ext = ext_module(self)
-                self.extensions.append(ext)
-            except (NotImplementedError, DeprecationWarning), e:
-                log.warning('extension skipped: %s', e.message)
-                log.debug('extension skipped: %s', ext_module.__file__)
-                continue
-            if ext_module.toolbar_icon:
-                toolbar = self.widgets['extensions']['toolbar']
-                i = ext_module.toolbar_icon
-                ext.toolbar_icon_widget = toolbar.insert_stock(ext_module.toolbar_icon, ext_module.description, None, ext._on_toolbar_icon_clicked, None, -1)
+        enabled = ext_module.enabled
+        # TODO: get list of disabled extensions from config
+        ext = extension(self, ext_module, enabled)
+        if ext:
+            self.extensions.append(ext)
 
 def people_treeview(self, create=True):
     row = None
@@ -635,9 +705,9 @@
     self._regions = (
         _('Region 0 (No Region Coding)'),
         _('Region 1 (United States of America, Canada)'),
-        _('Region 2 (Europe,including France, Greece, Turkey, Egypt, Arabia, Japan and South Africa)'),
+        _('Region 2 (Europe, Egypt, Arabia, Japan and South Africa)'),
         _('Region 3 (Korea, Thailand, Vietnam, Borneo and Indonesia)'),
-        _('Region 4 (Australia and New Zealand, Mexico, the Caribbean, and South America)'),
+        _('Region 4 (Australia and New Zealand, Mexico and South America)'),
         _('Region 5 (India, Africa, Russia and former USSR countries)'),
         _('Region 6 (Popular Republic of China)'),
         _('Region 7 (Reserved for Unspecified Special Use)'),

Modified: trunk/lib/plugins/extensions/__init__.py
===================================================================
--- trunk/lib/plugins/extensions/__init__.py	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/lib/plugins/extensions/__init__.py	2009-08-12 21:56:47 UTC (rev 1277)
@@ -43,7 +43,7 @@
     :attr preferences: dictionary used to generate new widgets in preferences window
         every key points to another dictionary that contains:
         * name: will be shown to user
-        * type: int or unicode (type) or list (instance)
+        * type: int, unicode (type) or list, tuple, dict (instance)
         * min: minimum value (int) or length (unicode)
         * max: maximum value (int) or length (unicode)
     :attr app: application reference (use only if really needed)

Modified: trunk/lib/plugins/extensions/ge_amazon.py
===================================================================
--- trunk/lib/plugins/extensions/ge_amazon.py	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/lib/plugins/extensions/ge_amazon.py	2009-08-12 21:56:47 UTC (rev 1277)
@@ -48,7 +48,7 @@
     api = 1
 
     preferences = {'locale': {'name': _('Select source'),
-                              'type': ('US', 'UK', 'DE', 'CA', 'FR', 'JP')}}
+                              'type': (u'US', u'UK', u'DE', u'CA', u'FR', u'JP')}}
     toolbar_icon = 'gtk-network'
 
     def toolbar_icon_clicked(self, widget, movie):

Modified: trunk/lib/preferences.py
===================================================================
--- trunk/lib/preferences.py	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/lib/preferences.py	2009-08-12 21:56:47 UTC (rev 1277)
@@ -200,8 +200,6 @@
 
     w['spell_lang'].set_text(str(self.config.get('lang', 'en', section='spell')))
 
-    w['amazon_locale'].set_active(int(self.config.get('amazon_locale', 0, section='add')))
-
     if page is not None:
         w['notebook'].set_current_page(page)
     w['window'].show()

Modified: trunk/lib/widgets.py
===================================================================
--- trunk/lib/widgets.py	2009-08-11 22:01:14 UTC (rev 1276)
+++ trunk/lib/widgets.py	2009-08-12 21:56:47 UTC (rev 1277)
@@ -347,6 +347,7 @@
     }#}}}
     self.widgets['extensions'] = {
         'toolbar': get('ext_toolbar'),
+        'preferences_vbox': get('p_extensions_vbox'),
     }
     
     self.widgets['w_loan_to']     = get('w_loan_to')



From piotrek at mail.berlios.de  Thu Aug 13 22:06:55 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 13 Aug 2009 22:06:55 +0200
Subject: [Griffith-svn] r1278 - in trunk: . lib lib/plugins/extensions
Message-ID: <200908132006.n7DK6tBV017492@sheep.berlios.de>

Author: piotrek
Date: 2009-08-13 22:06:54 +0200 (Thu, 13 Aug 2009)
New Revision: 1278

Added:
   trunk/lib/plugins/extensions/ge_mark_seen.py
Modified:
   trunk/ChangeLog
   trunk/lib/initialize.py
   trunk/lib/preferences.py
   trunk/lib/sql.py
Log:
* Add 'Mark as seen' extension
* Allow PNG images to be used as toolbar icons by extensions
* sql.update_whereclause now accepts Update queries


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-12 21:56:47 UTC (rev 1277)
+++ trunk/ChangeLog	2009-08-13 20:06:54 UTC (rev 1278)
@@ -5,6 +5,10 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-13  Piotr O?arowski
+	* Add 'Mark as seen' extension
+	* Allow PNG images to be used as toolbar icons by extensions
+
 2009-08-12  Piotr O?arowski
 	* Remove Amazon stuff from preferences window
 	* Region 2 and 4 names shorten (to fit in preferences window)

Modified: trunk/lib/initialize.py
===================================================================
--- trunk/lib/initialize.py	2009-08-12 21:56:47 UTC (rev 1277)
+++ trunk/lib/initialize.py	2009-08-13 20:06:54 UTC (rev 1278)
@@ -488,7 +488,18 @@
             return False
         if module.toolbar_icon:
             toolbar = self.widgets['extensions']['toolbar']
-            ext.toolbar_icon_widget = toolbar.insert_stock(module.toolbar_icon, module.description, None, ext._on_toolbar_icon_clicked, None, -1)
+            if module.toolbar_icon.endswith('.png'):
+                icon_path = os.path.join(os.path.dirname(module.__file__), 'data', module.toolbar_icon)
+                if not os.path.isfile(icon_path):
+                    icon_path = os.path.join(self.locations['images'], module.toolbar_icon)
+                if not os.path.isfile(icon_path):
+                    log.error('icon not found: %s', module.toolbar_icon)
+                else:
+                    icon = gtk.Image()
+                    icon.set_from_file(icon_path)
+                    ext.toolbar_icon_widget = toolbar.insert_item(None, module.description, None, icon, ext._on_toolbar_icon_clicked, None, -1)
+            else:
+                ext.toolbar_icon_widget = toolbar.insert_stock(module.toolbar_icon, module.description, None, ext._on_toolbar_icon_clicked, None, -1)
     else:
         ext = None
 
@@ -498,6 +509,7 @@
 
     label = "%s v%s <i>(%s &lt;%s&gt;)</i>" % (module.name, module.version, module.author, module.email)
     expander = gtk.Expander(label=label)
+    expander.get_label_widget().set_tooltip_markup(module.description)
     expander.set_use_markup(True)
     vbox = gtk.VBox()
 
@@ -509,10 +521,6 @@
     vbox.pack_start(enabled_cb, expand=False)
 
     for pref_name in module.preferences:
-        #preferences = {'command': {'name': _('Command'),
-        #                       'hint': _('%s (if given) will be replaced with file path'),
-        #                       'default': 'mplayer %s',
-        #                       'type': unicode}}
         name = module.preferences[pref_name].get('name', pref_name)
         hint = module.preferences[pref_name].get('hint')
         value = module.preferences[pref_name].get('default')

Added: trunk/lib/plugins/extensions/ge_mark_seen.py
===================================================================
--- trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-12 21:56:47 UTC (rev 1277)
+++ trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-13 20:06:54 UTC (rev 1278)
@@ -0,0 +1,56 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright ? 2009 Piotr O?arowski
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published byp
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+import logging
+
+from sqlalchemy.sql import select, update
+
+from db.tables import movies as movies_table
+from plugins.extensions import GriffithExtensionBase as Base
+from sql import update_whereclause
+
+log = logging.getLogger('Griffith')
+
+class GriffithExtension(Base):
+    name = 'Mark as seen'
+    description = _('Marks all currently filtered movies as seen')
+    author = 'Piotr O?arowski'
+    email = 'piotr at griffith.cc'
+    version = 0.1
+    api = 1
+    enabled = False # disabled by default
+
+    toolbar_icon = 'seen.png'
+
+    def toolbar_icon_clicked(self, widget, movie):
+        log.info('marking %d movies as seen', self.app.total)
+        #TODO: 'are you sure?'
+        session = self.db.Session()
+        update_query = update(movies_table, values={'seen': True})
+
+        update_whereclause(update_query, self.app._search_conditions)
+
+        session.execute(update_query)
+        session.commit()
+
+        self.app.populate_treeview() # update seen widget in the list


Property changes on: trunk/lib/plugins/extensions/ge_mark_seen.py
___________________________________________________________________
Name: svn:keywords
   + Id

Modified: trunk/lib/preferences.py
===================================================================
--- trunk/lib/preferences.py	2009-08-12 21:56:47 UTC (rev 1277)
+++ trunk/lib/preferences.py	2009-08-13 20:06:54 UTC (rev 1278)
@@ -380,8 +380,6 @@
     c.set('lang', w['spell_lang'].get_text(), section='spell')
     c['pdf_reader'] = save_reader
 
-    c.set('amazon_locale', w['amazon_locale'].get_active(), section='add')
-    
     if spell_support:
         if c.get('gtkspell', False, section='spell') == False and not was_false:
             self.notes_spell.detach()

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2009-08-12 21:56:47 UTC (rev 1277)
+++ trunk/lib/sql.py	2009-08-13 20:06:54 UTC (rev 1278)
@@ -28,9 +28,10 @@
 import logging
 import os.path
 
-from sqlalchemy            import *
+from sqlalchemy import *
 from sqlalchemy.exceptions import OperationalError
-from sqlalchemy.orm        import sessionmaker
+from sqlalchemy.orm import sessionmaker
+from sqlalchemy.sql.expression import Update
 
 import db # ORM data (SQLAlchemy stuff)
 import gutils # TODO: get rid of this import
@@ -131,6 +132,12 @@
 
 
 def update_whereclause(query, cond): # {{{
+    # Update class doesn't have .append_whereclause
+    update_query = None
+    if isinstance(query, Update):
+        update_query = query
+        query = select(db.tables.movies.columns)
+
     if cond['loaned'] is True:
         query.append_whereclause(db.Movie.loaned==True)
     if cond['loaned'] is False:
@@ -218,7 +225,7 @@
         query.append_whereclause(or_(*values))
 
     # sorting
-    for rule in cond["sort_by"]:
+    for rule in cond.get('sort_by', []):
         if rule.endswith(" DESC"):
             reverse = True
             column = rule.replace(" DESC", '')
@@ -237,6 +244,11 @@
         else:
             query.append_order_by(asc(db.metadata.tables[table].columns[column]))
 
-    log.debug(query.compile())
+    if update_query:
+        update_query.where(query._whereclause)
+        query = update_query
+    else:
+        log.debug(query.compile())
+
     return query #}}}
 



From piotrek at mail.berlios.de  Thu Aug 13 22:43:51 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 13 Aug 2009 22:43:51 +0200
Subject: [Griffith-svn] r1279 - in trunk/lib: . plugins/extensions
Message-ID: <200908132043.n7DKhpe8026233@sheep.berlios.de>

Author: piotrek
Date: 2009-08-13 22:43:51 +0200 (Thu, 13 Aug 2009)
New Revision: 1279

Modified:
   trunk/lib/plugins/extensions/ge_mark_seen.py
   trunk/lib/sql.py
Log:
update_query hack no longer needed


Modified: trunk/lib/plugins/extensions/ge_mark_seen.py
===================================================================
--- trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-13 20:06:54 UTC (rev 1278)
+++ trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-13 20:43:51 UTC (rev 1279)
@@ -23,7 +23,7 @@
 
 import logging
 
-from sqlalchemy.sql import select, update
+from sqlalchemy.sql import update
 
 from db.tables import movies as movies_table
 from plugins.extensions import GriffithExtensionBase as Base
@@ -48,7 +48,7 @@
         session = self.db.Session()
         update_query = update(movies_table, values={'seen': True})
 
-        update_whereclause(update_query, self.app._search_conditions)
+        update_query = update_whereclause(update_query, self.app._search_conditions)
 
         session.execute(update_query)
         session.commit()

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2009-08-13 20:06:54 UTC (rev 1278)
+++ trunk/lib/sql.py	2009-08-13 20:43:51 UTC (rev 1279)
@@ -132,123 +132,113 @@
 
 
 def update_whereclause(query, cond): # {{{
-    # Update class doesn't have .append_whereclause
-    update_query = None
-    if isinstance(query, Update):
-        update_query = query
-        query = select(db.tables.movies.columns)
-
     if cond['loaned'] is True:
-        query.append_whereclause(db.Movie.loaned==True)
+        query = query.where(db.Movie.loaned==True)
     if cond['loaned'] is False:
-        query.append_whereclause(db.Movie.loaned==False)
+        query = query.where(db.Movie.loaned==False)
     if cond['seen'] is True:
-        query.append_whereclause(db.Movie.seen==True)
+        query = query.where(db.Movie.seen==True)
     if cond['seen'] is False:
-        query.append_whereclause(db.Movie.seen==False)
+        query = query.where(db.Movie.seen==False)
 
     if cond["collections"]:
-        query.append_whereclause(db.Movie.collection_id.in_(cond["collections"]))
+        query = query.where(db.Movie.collection_id.in_(cond["collections"]))
     if cond["no_collections"]:
-        query.append_whereclause(~db.Movie.collection_id.in_(cond["no_collections"]))
+        query = query.where(~db.Movie.collection_id.in_(cond["no_collections"]))
 
     if cond["volumes"]:
-        query.append_whereclause(db.Movie.volume_id.in_(cond["volumes"]))
+        query = query.where(db.Movie.volume_id.in_(cond["volumes"]))
     if cond["no_volumes"]:
-        query.append_whereclause(~db.Movie.volume_id.in_(cond["no_volumes"]))
+        query = query.where(~db.Movie.volume_id.in_(cond["no_volumes"]))
 
     loaned_to = []
     for per_id in cond["loaned_to"]:
         loaned_to.append(exists([db.tables.loans.c.movie_id],\
                 and_(db.Movie.movie_id==db.tables.loans.c.movie_id, db.tables.loans.c.person_id==per_id, db.tables.loans.c.return_date==None)))
     if loaned_to:
-        query.append_whereclause(or_(*loaned_to))
+        query = query.where(or_(*loaned_to))
 
     loan_history = []
     for per_id in cond["loan_history"]:
         loan_history.append(exists([db.tables.loans.c.movie_id],\
                 and_(db.Movie.movie_id==db.tables.loans.c.movie_id, db.tables.loans.c.person_id==per_id)))
     if loan_history:
-        query.append_whereclause(or_(*loan_history))
+        query = query.where(or_(*loan_history))
 
     required_tags = []
     for tag_id in cond["required_tags"]:
         required_tags.append(exists([db.MovieTag.movie_id], \
             and_(db.Movie.movie_id==db.MovieTag.movie_id, db.MovieTag.tag_id==tag_id)))
     if required_tags:
-        query.append_whereclause(and_(*required_tags))
+        query = query.where(and_(*required_tags))
 
     tags = []
     for tag_id in cond["tags"]:
         tags.append(exists([db.MovieTag.movie_id], \
             and_(db.Movie.movie_id==db.MovieTag.movie_id, db.MovieTag.tag_id==tag_id)))
     if tags:
-        query.append_whereclause(or_(*tags))
+        query = query.where(or_(*tags))
 
     no_tags = []
     for tag_id in cond["no_tags"]:
         no_tags.append(~exists([db.MovieTag.movie_id], \
             and_(db.Movie.movie_id==db.MovieTag.movie_id, db.MovieTag.tag_id==tag_id)))
     if no_tags:
-        query.append_whereclause(and_(*no_tags))
+        query = query.where(and_(*no_tags))
 
     for field in cond["equals_n"]:
         values = [ db.tables.movies.columns[field]!=value for value in cond["equals_n"][field] ]
-        query.append_whereclause(and_(*values))
+        query = query.where(and_(*values))
 
     for field in cond["startswith_n"]:
         values = [ not_(db.tables.movies.columns[field].startswith(value)) for value in cond["startswith_n"][field] ]
-        query.append_whereclause(and_(*values))
+        query = query.where(and_(*values))
 
     for field in cond["like_n"]:
         values = [ not_(db.tables.movies.columns[field].like(value)) for value in cond["like_n"][field] ]
-        query.append_whereclause(and_(*values))
+        query = query.where(and_(*values))
 
     for field in cond["contains_n"]: # XXX: it's not the SQLAlchemy's .contains() i.e. not for one-to-many or many-to-many collections
         values = [ not_(db.tables.movies.columns[field].like('%'+value+'%')) for value in cond["contains_n"][field] ]
-        query.append_whereclause(and_(*values))
+        query = query.where(and_(*values))
 
     for field in cond["equals"]:
         values = [ db.tables.movies.columns[field]==value for value in cond["equals"][field] ]
-        query.append_whereclause(or_(*values))
+        query = query.where(or_(*values))
 
     for field in cond["startswith"]:
         values = [ db.tables.movies.columns[field].startswith(value) for value in cond["startswith"][field] ]
-        query.append_whereclause(or_(*values))
+        query = query.where(or_(*values))
 
     for field in cond["like"]:
         values = [ db.tables.movies.columns[field].like(value) for value in cond["like"][field] ]
-        query.append_whereclause(or_(*values))
+        query = query.where(or_(*values))
 
     for field in cond["contains"]: # XXX: it's not the SQLAlchemy's .contains() i.e. not for one-to-many or many-to-many collections
         values = [ db.tables.movies.columns[field].like('%'+value+'%') for value in cond["contains"][field] ]
-        query.append_whereclause(or_(*values))
+        query = query.where(or_(*values))
 
     # sorting
-    for rule in cond.get('sort_by', []):
-        if rule.endswith(" DESC"):
-            reverse = True
-            column = rule.replace(" DESC", '')
-        else:
-            column = rule.replace(" ASC", '') # note that " ASC" is optional
-            reverse = False
+    if not isinstance(query, Update):
+        for rule in cond.get('sort_by', []):
+            if rule.endswith(" DESC"):
+                reverse = True
+                column = rule.replace(" DESC", '')
+            else:
+                column = rule.replace(" ASC", '') # note that " ASC" is optional
+                reverse = False
 
-        table = 'movies'
-        tmp = column.split('.')
-        if len(tmp) > 1:
-            table = tmp[0]
-            column = tmp[1]
+            table = 'movies'
+            tmp = column.split('.')
+            if len(tmp) > 1:
+                table = tmp[0]
+                column = tmp[1]
 
-        if reverse:
-            query.append_order_by(desc(db.metadata.tables[table].columns[column]))
-        else:
-            query.append_order_by(asc(db.metadata.tables[table].columns[column]))
+            if reverse:
+                query = query.order_by(desc(db.metadata.tables[table].columns[column]))
+            else:
+                query = query.order_by(asc(db.metadata.tables[table].columns[column]))
 
-    if update_query:
-        update_query.where(query._whereclause)
-        query = update_query
-    else:
-        log.debug(query.compile())
-
+    log.debug(query)
     return query #}}}
 



From piotrek at mail.berlios.de  Thu Aug 13 23:05:12 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 13 Aug 2009 23:05:12 +0200
Subject: [Griffith-svn] r1280 - in trunk: . lib lib/plugins/export
	lib/plugins/extensions
Message-ID: <200908132105.n7DL5Coc031357@sheep.berlios.de>

Author: piotrek
Date: 2009-08-13 23:05:08 +0200 (Thu, 13 Aug 2009)
New Revision: 1280

Modified:
   trunk/ChangeLog
   trunk/griffith
   trunk/lib/add.py
   trunk/lib/backup.py
   trunk/lib/delete.py
   trunk/lib/edit.py
   trunk/lib/gutils.py
   trunk/lib/loan.py
   trunk/lib/people.py
   trunk/lib/plugins/export/PluginExportCSV.py
   trunk/lib/plugins/export/PluginExportHTML.py
   trunk/lib/plugins/export/PluginExportPDF.py
   trunk/lib/plugins/export/PluginExportXML.py
   trunk/lib/plugins/export/PluginExportiPod.py
   trunk/lib/plugins/export/__init__.py
   trunk/lib/plugins/extensions/ge_amazon.py
   trunk/lib/plugins/extensions/ge_mark_seen.py
Log:
gutils.question now returns True or False


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/ChangeLog	2009-08-13 21:05:08 UTC (rev 1280)
@@ -8,6 +8,7 @@
 2009-08-13  Piotr O?arowski
 	* Add 'Mark as seen' extension
 	* Allow PNG images to be used as toolbar icons by extensions
+	* gutils.question now returns True or False
 
 2009-08-12  Piotr O?arowski
 	* Remove Amazon stuff from preferences window

Modified: trunk/griffith
===================================================================
--- trunk/griffith	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/griffith	2009-08-13 21:05:08 UTC (rev 1280)
@@ -1023,18 +1023,16 @@
         create(self)
 
     def restore(self, *args):
-        response = gutils.question(_("""Are you sure you want to restore?
+        if gutils.question(_("""Are you sure you want to restore?
 Your current movie collection will be replaced.
-You can't undo this operation."""), True, self.widgets['window'])
-        if response == gtk.RESPONSE_YES:
+You can't undo this operation."""), self.widgets['window']):
             from backup import restore
             restore(self)
 
     def merge(self, *args):
-        response = gutils.question(_("""Are you sure you want to mix?
+        if gutils.question(_("""Are you sure you want to mix?
 Your current movie collection will be mixed with a backup.
-You can't undo this operation."""), True, self.widgets['window'])
-        if response == gtk.RESPONSE_YES:
+You can't undo this operation."""), self.widgets['window']):
             from backup import restore
             restore(self, merge=True)
 
@@ -1332,13 +1330,9 @@
 
     def new_dbb(self, *args):
         """initializes a new Griffith Database file"""
-        response = gutils.question(_('Are you sure you want to create a new database?\nYou will lose ALL your current data!'), \
-            True, self.widgets['window'])
-        if response == gtk.RESPONSE_YES:
+        if gutils.question(_('Are you sure you want to create a new database?\nYou will lose ALL your current data!'), self.widgets['window']):
             log.debug('NEW DATABASE')
-            response_sec = gutils.question(_('Last chance!\nDo you confirm that you want\nto lose your current data?'), \
-                True, self.widgets['window'])
-            if response_sec == gtk.RESPONSE_YES:
+            if gutils.question(_('Last chance!\nDo you confirm that you want\nto lose your current data?'), self.widgets['window']):
                 from sqlalchemy import select
                 from sql import GriffithSQL
                 from delete import delete_poster_from_cache
@@ -1490,12 +1484,11 @@
     if ('~' in version.pversion or '-' in version.pversion) and \
        config.get('warned_version', section='devel') != version.pversion:
 
-        response = gutils.question(_("""This is development version of Griffith.
+        if not gutils.question(_("""This is development version of Griffith.
 Upgrade path from dev. versions may not be provided.
 Please make sure you have a backup!
 
-Do you want to proceed?"""))
-        if response != gtk.RESPONSE_YES:
+Do you want to proceed?""")):
             sys.exit(2)
         else:
             config.set('warned_version', version.pversion, section='devel')

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/add.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -657,15 +657,11 @@
 
     if details['o_title']:
         if session.query(db.Movie).filter_by(o_title=details['o_title']).count() > 0:
-            response = gutils.question(_('Movie with that title already exists, are you sure you want to add?'), \
-                                       False, self.widgets['add']['window'])
-            if response == gtk.RESPONSE_NO:
+            if not gutils.question(_('Movie with that title already exists, are you sure you want to add?'), self.widgets['add']['window']):
                 return False
     if details['title']:
         if session.query(db.Movie).filter_by(title=details['title']).count() > 0:
-            response = gutils.question(_('Movie with that title already exists, are you sure you want to add?'), \
-                                       False, self.widgets['add']['window'])
-            if response == gtk.RESPONSE_NO:
+            if not gutils.question(_('Movie with that title already exists, are you sure you want to add?'), self.widgets['add']['window']):
                 return False
     
     if details['image']:

Modified: trunk/lib/backup.py
===================================================================
--- trunk/lib/backup.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/backup.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -58,8 +58,7 @@
 
         zipfilename = filename[0].decode('utf-8')
         if os.path.isfile(zipfilename):
-            response = gutils.question(_("File exists. Do you want to overwrite it?"), window=self.widgets['window'])
-            if response != gtk.RESPONSE_YES:
+            if not gutils.question(_("File exists. Do you want to overwrite it?"), window=self.widgets['window']):
                 proceed = False
 
         if proceed:

Modified: trunk/lib/delete.py
===================================================================
--- trunk/lib/delete.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/delete.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -39,8 +39,7 @@
         gutils.warning(msg=_("You can't delete movie while it is loaned."))
         return False
 
-    response = gutils.question(_("Are you sure you want to delete this movie?"), True, self.widgets['window'])
-    if response == -8:    # gtk.RESPONSE_YES == -8
+    if gutils.question(_('Are you sure you want to delete this movie?'), self.widgets['window']):
         delete_poster(self, movie.poster_md5)
 
         self.db.session.delete(movie)

Modified: trunk/lib/edit.py
===================================================================
--- trunk/lib/edit.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/edit.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -96,8 +96,7 @@
     if not movie:
         log.error("Cannot delete unknown movie's poster!")
         return False
-    response = gutils.question(_("Are you sure you want to delete this poster?"), True, self.widgets['window'])
-    if response==-8:
+    if gutils.question(_("Are you sure you want to delete this poster?"), self.widgets['window']):
         image_path = os.path.join(self.locations['images'], 'default.png')
         handler = self.widgets['movie']['picture'].set_from_pixbuf(gtk.gdk.pixbuf_new_from_file(image_path))
         gutils.garbage(handler)

Modified: trunk/lib/gutils.py
===================================================================
--- trunk/lib/gutils.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/gutils.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -257,7 +257,7 @@
     dialog.run()
     dialog.destroy()
 
-def question(msg, cancel=True, window=None):
+def question(msg, window=None):
     dialog = gtk.MessageDialog(window,
             gtk.DIALOG_MODAL | gtk.DIALOG_DESTROY_WITH_PARENT,
             gtk.MESSAGE_QUESTION, gtk.BUTTONS_NONE, msg)
@@ -267,7 +267,7 @@
     dialog.set_skip_taskbar_hint(False)
     response = dialog.run()
     dialog.destroy()
-    return response
+    return response == gtk.RESPONSE_OK
 
 def file_chooser(title, action=None, buttons=None, name='', folder=os.path.expanduser('~'), picture=False, backup=False):
     dialog = gtk.FileChooserDialog(title=title, action=action, buttons=buttons)

Modified: trunk/lib/loan.py
===================================================================
--- trunk/lib/loan.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/loan.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -70,10 +70,9 @@
     # ask if user wants to loan whole collection
     loan_whole_collection = False
     if movie.collection_id > 0:
-        response = gutils.question(_("Do you want to loan whole collection?"), window=self.widgets['window'])
-        if response == gtk.RESPONSE_YES:
+        if gutils.question(_('Do you want to loan whole collection?'), window=self.widgets['window']):
             loan_whole_collection = True
-        elif response == gtk.RESPONSE_CANCEL:
+        else:
             return False
     
     try:

Modified: trunk/lib/people.py
===================================================================
--- trunk/lib/people.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/people.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -120,7 +120,6 @@
             self.p_treemodel.set_value(myiter, 1, p.email)
 
 def delete_person(self):
-    response = None
     has_history = False
     has_history_msg = ''
     try:
@@ -138,10 +137,8 @@
     if person.returned_movies_count > 0:
         has_history = True
         has_history_msg = _("This person has data in the loan history. This data will be erased if you continue.")
-    response = gutils.question(_("%s\nAre you sure you want to delete this person?" % has_history_msg), \
-                               True, self.widgets['people']['window'])
-
-    if response == -8:
+    
+    if gutils.question(_("%s\nAre you sure you want to delete this person?" % has_history_msg), self.widgets['people']['window']):
         treeselection = self.widgets['people']['treeview'].get_selection()
         (tmp_model, tmp_iter) = treeselection.get_selected()
         self.db.session.delete(person)

Modified: trunk/lib/plugins/export/PluginExportCSV.py
===================================================================
--- trunk/lib/plugins/export/PluginExportCSV.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/PluginExportCSV.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -55,8 +55,7 @@
                 self.config.save()
             overwrite = None
             if os.path.isfile(filename[0]):
-                response = gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window)
-                if response==-8:
+                if gutils.question(_("File exists. Do you want to overwrite it?"), self.parent_window):
                     overwrite = True
                 else:
                     overwrite = False

Modified: trunk/lib/plugins/export/PluginExportHTML.py
===================================================================
--- trunk/lib/plugins/export/PluginExportHTML.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/PluginExportHTML.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -581,7 +581,7 @@
             
             posters_dir = os.path.join(config['exported_dir'], 'posters')
             if os.path.isdir(posters_dir):
-                if gutils.question(_("Directory %s already exists.\nDo you want to overwrite it?") % posters_dir, True, self.widgets['window']) == gtk.RESPONSE_YES:
+                if gutils.question(_("Directory %s already exists.\nDo you want to overwrite it?") % posters_dir, self.widgets['window']):
                     try:
                         shutil.rmtree(posters_dir)
                     except:

Modified: trunk/lib/plugins/export/PluginExportPDF.py
===================================================================
--- trunk/lib/plugins/export/PluginExportPDF.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/PluginExportPDF.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -79,8 +79,7 @@
             overwrite = None
             pdffilename = filename[0].decode('utf-8')
             if os.path.isfile(pdffilename):
-                response = gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window)
-                if response==-8:
+                if gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window):
                     overwrite = True
                 else:
                     overwrite = False

Modified: trunk/lib/plugins/export/PluginExportXML.py
===================================================================
--- trunk/lib/plugins/export/PluginExportXML.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/PluginExportXML.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -56,8 +56,7 @@
                 self.config.save()
             overwrite = None
             if os.path.isfile(filename[0]):
-                response = gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window)
-                if response==-8:
+                if gutils.question(_("File exists. Do you want to overwrite it?"), self.parent_window):
                     overwrite = True
                 else:
                     overwrite = False

Modified: trunk/lib/plugins/export/PluginExportiPod.py
===================================================================
--- trunk/lib/plugins/export/PluginExportiPod.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/PluginExportiPod.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -102,8 +102,7 @@
             if filename and filename[0]:
                 overwrite = None
                 if os.path.isfile(filename[0]):
-                    response = gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window)
-                    if response==-8:
+                    if gutils.question(_("File exists. Do you want to overwrite it?"), True, self.parent_window):
                         overwrite = True
                     else:
                         overwrite = False

Modified: trunk/lib/plugins/export/__init__.py
===================================================================
--- trunk/lib/plugins/export/__init__.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/export/__init__.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -159,8 +159,7 @@
                 self.config.save()
             overwrite = None
             if os.path.isfile(self.filepath):
-                response = gutils.question(_('File exists. Do you want to overwrite it?'), 1, self.parent_window)
-                if response==-8:
+                if gutils.question(_('File exists. Do you want to overwrite it?'), self.parent_window):
                     overwrite = True
                 else:
                     overwrite = False

Modified: trunk/lib/plugins/extensions/ge_amazon.py
===================================================================
--- trunk/lib/plugins/extensions/ge_amazon.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/extensions/ge_amazon.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -205,8 +205,7 @@
 
                 self.widgets['poster_window'].show()
                 self.widgets['poster_window'].move(0,0)
-                response = gutils.question(_("Do you want to use this poster instead?"), True, self.widgets['window'])
-                if response == -8:
+                if gutils.question(_("Do you want to use this poster instead?"), self.widgets['window']):
                     return file_to_copy
                 else:
                     log.info("Reverting to previous poster and deleting new one from disk.")

Modified: trunk/lib/plugins/extensions/ge_mark_seen.py
===================================================================
--- trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-13 20:43:51 UTC (rev 1279)
+++ trunk/lib/plugins/extensions/ge_mark_seen.py	2009-08-13 21:05:08 UTC (rev 1280)
@@ -26,6 +26,7 @@
 from sqlalchemy.sql import update
 
 from db.tables import movies as movies_table
+from gutils import question
 from plugins.extensions import GriffithExtensionBase as Base
 from sql import update_whereclause
 
@@ -43,14 +44,13 @@
     toolbar_icon = 'seen.png'
 
     def toolbar_icon_clicked(self, widget, movie):
-        log.info('marking %d movies as seen', self.app.total)
-        #TODO: 'are you sure?'
-        session = self.db.Session()
-        update_query = update(movies_table, values={'seen': True})
+        if question(_('Are you sure you want to update %d movies?') % self.app.total):
+            session = self.db.Session()
 
-        update_query = update_whereclause(update_query, self.app._search_conditions)
+            update_query = update(movies_table, values={'seen': True})
+            update_query = update_whereclause(update_query, self.app._search_conditions)
 
-        session.execute(update_query)
-        session.commit()
+            session.execute(update_query)
+            session.commit()
 
-        self.app.populate_treeview() # update seen widget in the list
+            self.app.populate_treeview() # update seen widget in the list



From piotrek at mail.berlios.de  Thu Aug 13 23:17:07 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 13 Aug 2009 23:17:07 +0200
Subject: [Griffith-svn] r1281 - trunk/lib
Message-ID: <200908132117.n7DLH7O7001385@sheep.berlios.de>

Author: piotrek
Date: 2009-08-13 23:17:06 +0200 (Thu, 13 Aug 2009)
New Revision: 1281

Modified:
   trunk/lib/gutils.py
Log:
gtk.RESPONSE_YES returns True as well


Modified: trunk/lib/gutils.py
===================================================================
--- trunk/lib/gutils.py	2009-08-13 21:05:08 UTC (rev 1280)
+++ trunk/lib/gutils.py	2009-08-13 21:17:06 UTC (rev 1281)
@@ -267,7 +267,7 @@
     dialog.set_skip_taskbar_hint(False)
     response = dialog.run()
     dialog.destroy()
-    return response == gtk.RESPONSE_OK
+    return response in (gtk.RESPONSE_OK, gtk.RESPONSE_YES)
 
 def file_chooser(title, action=None, buttons=None, name='', folder=os.path.expanduser('~'), picture=False, backup=False):
     dialog = gtk.FileChooserDialog(title=title, action=action, buttons=buttons)



From mikej06 at mail.berlios.de  Fri Aug 14 00:10:38 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Fri, 14 Aug 2009 00:10:38 +0200
Subject: [Griffith-svn] r1282 - trunk/lib/plugins/extensions
Message-ID: <200908132210.n7DMAcii012951@sheep.berlios.de>

Author: mikej06
Date: 2009-08-14 00:10:09 +0200 (Fri, 14 Aug 2009)
New Revision: 1282

Modified:
   trunk/lib/plugins/extensions/ge_player.py
Log:
player extension: compatibility for windows

Modified: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-13 21:17:06 UTC (rev 1281)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:10:09 UTC (rev 1282)
@@ -23,6 +23,7 @@
 
 import logging
 from subprocess import Popen
+from gutils import is_windows_system
 
 from plugins.extensions import GriffithExtensionBase as Base
 
@@ -47,7 +48,14 @@
         if not movie or not movie.trailer:
             return False
 
-        command = self.get_config_value('command', self.preferences['command']['default'])
+        if is_windows_system():
+            command = self.get_config_value('command')
+            if not command:
+                import win32api
+                win32api.ShellExecute(0, None, movie.trailer, None, None, 0)
+                return
+        else:
+            command = self.get_config_value('command', self.preferences['command']['default'])
         if '%s' in command:
             command %= movie.trailer
         else:



From piotrek at mail.berlios.de  Fri Aug 14 00:17:17 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Fri, 14 Aug 2009 00:17:17 +0200
Subject: [Griffith-svn] r1283 - trunk/lib/plugins/extensions
Message-ID: <200908132217.n7DMHH8B014424@sheep.berlios.de>

Author: piotrek
Date: 2009-08-14 00:17:17 +0200 (Fri, 14 Aug 2009)
New Revision: 1283

Modified:
   trunk/lib/plugins/extensions/ge_player.py
Log:
use empty default value on Windows


Modified: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:10:09 UTC (rev 1282)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:17:17 UTC (rev 1283)
@@ -23,8 +23,8 @@
 
 import logging
 from subprocess import Popen
+
 from gutils import is_windows_system
-
 from plugins.extensions import GriffithExtensionBase as Base
 
 log = logging.getLogger('Griffith')
@@ -42,6 +42,9 @@
                                'hint': _('%s (if given) will be replaced with file path'),
                                'default': 'mplayer %s',
                                'type': unicode}}
+    if is_windows_system:
+        preferences['command']['default'] = ''
+
     toolbar_icon = 'gtk-open'
 
     def toolbar_icon_clicked(self, widget, movie):



From piotrek at mail.berlios.de  Fri Aug 14 00:19:05 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Fri, 14 Aug 2009 00:19:05 +0200
Subject: [Griffith-svn] r1284 - trunk/lib/plugins/extensions
Message-ID: <200908132219.n7DMJ5gj014854@sheep.berlios.de>

Author: piotrek
Date: 2009-08-14 00:19:05 +0200 (Fri, 14 Aug 2009)
New Revision: 1284

Modified:
   trunk/lib/plugins/extensions/ge_player.py
Log:
typo


Modified: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:17:17 UTC (rev 1283)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:19:05 UTC (rev 1284)
@@ -42,7 +42,7 @@
                                'hint': _('%s (if given) will be replaced with file path'),
                                'default': 'mplayer %s',
                                'type': unicode}}
-    if is_windows_system:
+    if is_windows_system():
         preferences['command']['default'] = ''
 
     toolbar_icon = 'gtk-open'



From piotrek at mail.berlios.de  Fri Aug 14 00:21:26 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Fri, 14 Aug 2009 00:21:26 +0200
Subject: [Griffith-svn] r1285 - trunk/lib/plugins/extensions
Message-ID: <200908132221.n7DMLQDf015426@sheep.berlios.de>

Author: piotrek
Date: 2009-08-14 00:21:26 +0200 (Fri, 14 Aug 2009)
New Revision: 1285

Modified:
   trunk/lib/plugins/extensions/ge_player.py
Log:
cosmetic changes ;)


Modified: trunk/lib/plugins/extensions/ge_player.py
===================================================================
--- trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:19:05 UTC (rev 1284)
+++ trunk/lib/plugins/extensions/ge_player.py	2009-08-13 22:21:26 UTC (rev 1285)
@@ -51,14 +51,12 @@
         if not movie or not movie.trailer:
             return False
 
-        if is_windows_system():
-            command = self.get_config_value('command')
-            if not command:
-                import win32api
-                win32api.ShellExecute(0, None, movie.trailer, None, None, 0)
-                return
-        else:
-            command = self.get_config_value('command', self.preferences['command']['default'])
+        command = self.get_config_value('command', self.preferences['command']['default'])
+        if is_windows_system() and not command:
+            import win32api
+            win32api.ShellExecute(0, None, movie.trailer, None, None, 0)
+            return
+
         if '%s' in command:
             command %= movie.trailer
         else:



From mikej06 at mail.berlios.de  Mon Aug 17 20:58:47 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Mon, 17 Aug 2009 20:58:47 +0200
Subject: [Griffith-svn] r1286 - trunk/lib
Message-ID: <200908171858.n7HIwlLp004939@sheep.berlios.de>

Author: mikej06
Date: 2009-08-17 20:57:41 +0200 (Mon, 17 Aug 2009)
New Revision: 1286

Modified:
   trunk/lib/movie.py
Log:
cleanup open file handles

Modified: trunk/lib/movie.py
===================================================================
--- trunk/lib/movie.py	2009-08-13 22:21:26 UTC (rev 1285)
+++ trunk/lib/movie.py	2009-08-17 18:57:41 UTC (rev 1286)
@@ -165,7 +165,10 @@
         try:
             if retriever.html:
                 ifile = file(retriever.html[0], "rb")
-                data = ifile.read()
+                try:
+                    data = ifile.read()
+                finally:
+                    ifile.close()
                 # check for gzip compressed pages before decoding to unicode
                 if len(data) > 2 and data[0:2] == '\037\213':
                     data = gutils.decompress(data)
@@ -326,7 +329,10 @@
         try:
             if retriever.html:
                 ifile = file(retriever.html[0], 'rb')
-                self.page = ifile.read()
+                try:
+                    self.page = ifile.read()
+                finally:
+                    ifile.close()
                 # check for gzip compressed pages before decoding to unicode
                 if len(self.page) > 2 and self.page[0:2] == '\037\213':
                     self.page = gutils.decompress(self.page)



From mikej06 at mail.berlios.de  Mon Aug 17 21:02:24 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Mon, 17 Aug 2009 21:02:24 +0200
Subject: [Griffith-svn] r1287 - trunk
Message-ID: <200908171902.n7HJ2OZ0005505@sheep.berlios.de>

Author: mikej06
Date: 2009-08-17 21:01:34 +0200 (Mon, 17 Aug 2009)
New Revision: 1287

Modified:
   trunk/griffith
Log:
reloading export plugins in debug mode

Modified: trunk/griffith
===================================================================
--- trunk/griffith	2009-08-17 18:57:41 UTC (rev 1286)
+++ trunk/griffith	2009-08-17 19:01:34 UTC (rev 1287)
@@ -166,7 +166,12 @@
     ###########
 
     def on_export_activate(self, menu_iter, plugin_name):
-        module = __import__('PluginExport%s' % plugin_name)
+        plugin_name = 'PluginExport%s' % plugin_name
+        module = __import__(plugin_name)
+        if self.debug_mode:
+            log.debug('reloading %s', plugin_name)
+            import sys
+            reload(sys.modules[plugin_name])
         plugin = module.ExportPlugin(self.db, self.locations, self.widgets['window'], self._search_conditions, self.config)
         if plugin.initialize():
             try:



From mikej06 at mail.berlios.de  Mon Aug 17 21:11:07 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Mon, 17 Aug 2009 21:11:07 +0200
Subject: [Griffith-svn] r1288 - trunk/lib
Message-ID: <200908171911.n7HJB7mq006630@sheep.berlios.de>

Author: mikej06
Date: 2009-08-17 21:09:57 +0200 (Mon, 17 Aug 2009)
New Revision: 1288

Modified:
   trunk/lib/add.py
Log:
[#412221] German "Merkmale" (additional features/tokens/characteristics) cannot be de-selected

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2009-08-17 19:01:34 UTC (rev 1287)
+++ trunk/lib/add.py	2009-08-17 19:09:57 UTC (rev 1288)
@@ -830,10 +830,10 @@
                 setattr(movie, i, details[i])
 
         # clear previous data (in case of updates)
-        for i in movie.languages:
-            movie.languages.remove(i)
-        for i in movie.languages:
-            movie.languages.remove(i)
+        while len(movie.languages):
+            movie.languages.remove(movie.languages[0])
+        while len(movie.tags):
+            movie.tags.remove(movie.tags[0])
         # languages
         if t_languages is not None:
             for lang in t_languages:



From mikej06 at mail.berlios.de  Mon Aug 17 21:45:35 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Mon, 17 Aug 2009 21:45:35 +0200
Subject: [Griffith-svn] r1289 - trunk/lib
Message-ID: <200908171945.n7HJjZRi010572@sheep.berlios.de>

Author: mikej06
Date: 2009-08-17 21:45:15 +0200 (Mon, 17 Aug 2009)
New Revision: 1289

Modified:
   trunk/lib/add.py
Log:
[#412221] German "Merkmale" (additional features/tokens/characteristics) cannot be de-selected

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2009-08-17 19:09:57 UTC (rev 1288)
+++ trunk/lib/add.py	2009-08-17 19:45:15 UTC (rev 1289)
@@ -830,10 +830,10 @@
                 setattr(movie, i, details[i])
 
         # clear previous data (in case of updates)
-        while len(movie.languages):
-            movie.languages.remove(movie.languages[0])
-        while len(movie.tags):
-            movie.tags.remove(movie.tags[0])
+        if movie.languages:
+            movie.languages = []
+        if movie.tags:
+            movie.tags = []
         # languages
         if t_languages is not None:
             for lang in t_languages:



From piotrek at mail.berlios.de  Tue Aug 18 21:46:37 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Tue, 18 Aug 2009 21:46:37 +0200
Subject: [Griffith-svn] r1290 - in trunk: . lib
Message-ID: <200908181946.n7IJkbnk016988@sheep.berlios.de>

Author: piotrek
Date: 2009-08-18 21:46:36 +0200 (Tue, 18 Aug 2009)
New Revision: 1290

Modified:
   trunk/ChangeLog
   trunk/lib/add.py
Log:
Fix update_movie() to actually load the image


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-17 19:45:15 UTC (rev 1289)
+++ trunk/ChangeLog	2009-08-18 19:46:36 UTC (rev 1290)
@@ -5,6 +5,9 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-18  Piotr O?arowski
+	* Fix update_movie() to actually load the image
+
 2009-08-13  Piotr O?arowski
 	* Add 'Mark as seen' extension
 	* Allow PNG images to be used as toolbar icons by extensions

Modified: trunk/lib/add.py
===================================================================
--- trunk/lib/add.py	2009-08-17 19:45:15 UTC (rev 1289)
+++ trunk/lib/add.py	2009-08-18 19:46:36 UTC (rev 1290)
@@ -89,7 +89,7 @@
             details["poster_md5"] = new_poster_md5
             if session.query(db.Poster).filter_by(md5sum=new_poster_md5).count() == 0:
                 try:
-                    data = file(tmp_image_path, 'rb').read()
+                    data = file(new_image_path, 'rb').read()
                 except Exception, e:
                     log.warning("cannot read poster data")
                 else:



From piotrek at mail.berlios.de  Tue Aug 18 21:51:47 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Tue, 18 Aug 2009 21:51:47 +0200
Subject: [Griffith-svn] r1291 - trunk/lib
Message-ID: <200908181951.n7IJplp8018091@sheep.berlios.de>

Author: piotrek
Date: 2009-08-18 21:51:46 +0200 (Tue, 18 Aug 2009)
New Revision: 1291

Modified:
   trunk/lib/edit.py
Log:
delete_poster button no longer available in the menu


Modified: trunk/lib/edit.py
===================================================================
--- trunk/lib/edit.py	2009-08-18 19:46:36 UTC (rev 1290)
+++ trunk/lib/edit.py	2009-08-18 19:51:46 UTC (rev 1291)
@@ -86,7 +86,6 @@
 
     self.widgets['movie']['picture_button'].set_sensitive(True)
     self.widgets['add']['delete_poster'].set_sensitive(True)
-    self.widgets['menu']['delete_poster'].set_sensitive(True)
 
     self.update_statusbar(_("Image has been updated"))
 
@@ -116,7 +115,6 @@
         self.update_statusbar(_("Image has been updated"))
 
         self.widgets['add']['delete_poster'].set_sensitive(False)
-        self.widgets['menu']['delete_poster'].set_sensitive(False)
         self.widgets['movie']['picture_button'].set_sensitive(False)
     else:
         pass



From piotrek at mail.berlios.de  Thu Aug 20 20:57:27 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Thu, 20 Aug 2009 20:57:27 +0200
Subject: [Griffith-svn] r1292 - in trunk: . lib
Message-ID: <200908201857.n7KIvRpT015997@sheep.berlios.de>

Author: piotrek
Date: 2009-08-20 20:57:26 +0200 (Thu, 20 Aug 2009)
New Revision: 1292

Modified:
   trunk/ChangeLog
   trunk/lib/sql.py
Log:
Add pool_recycle parameter in config file and set the default to 1 hour
(SQLAlchemy will recycle MySQL connections after given number of seconds of inactivity - fixes "MySQL server has gone away" issue)


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-18 19:51:46 UTC (rev 1291)
+++ trunk/ChangeLog	2009-08-20 18:57:26 UTC (rev 1292)
@@ -5,6 +5,11 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-20  Piotr O?arowski
+	* Add pool_recycle parameter in config file and set the default to 1 hour
+	  (SQLAlchemy will recycle MySQL connections after given number of seconds
+	  of inactivity - fixes "MySQL server has gone away" issue)
+
 2009-08-18  Piotr O?arowski
 	* Fix update_movie() to actually load the image
 

Modified: trunk/lib/sql.py
===================================================================
--- trunk/lib/sql.py	2009-08-18 19:51:46 UTC (rev 1291)
+++ trunk/lib/sql.py	2009-08-20 18:57:26 UTC (rev 1292)
@@ -64,16 +64,17 @@
                 config.set('port', DEFAULT_PORTS[config.get('type', section='database')], section='database')
 
         conn_params = config.to_dict(section='database')
-        conn_params['port'] = int(conn_params['port'])
+        conn_params.update({'port': int(conn_params['port']),
+                            'engine_kwargs': {'echo': False, 'convert_unicode': False}})
 
         # connect to database --------------------------------------{{{
-        convert_unicode = False # see MySQL
         if config.get('type', section='database') == 'sqlite':
             url = "sqlite:///%s.db" % os.path.join(griffith_dir, conn_params['name'])
         elif config.get('type', section='database') == 'postgres':
             url = "postgres://%(user)s:%(passwd)s@%(host)s:%(port)d/%(name)s" % conn_params
         elif config.get('type', section='database') == 'mysql':
-            convert_unicode = True
+            conn_params['engine_kwargs']['convert_unicode'] = True
+            conn_params['engine_kwargs']['pool_recycle'] = int(config.get('pool_recycle', 3600, section='database'))
             url = "mysql://%(user)s:%(passwd)s@%(host)s:%(port)d/%(name)s?charset=utf8&use_unicode=0" % conn_params
         elif config.get('type', section='database') == 'mssql':
             # use_scope_identity=0 have to be set as workaround for a sqlalchemy bug
@@ -91,7 +92,7 @@
 
         # try to establish a db connection
         try:
-            engine = create_engine(url, echo=False, convert_unicode=convert_unicode)
+            engine = create_engine(url, **conn_params['engine_kwargs'])
             conn = engine.connect()
         except Exception, e:    # InvalidRequestError, ImportError
             log.info("MetaData: %s", e)



From mikej06 at mail.berlios.de  Wed Aug 26 20:46:58 2009
From: mikej06 at mail.berlios.de (mikej06 at mail.berlios.de)
Date: Wed, 26 Aug 2009 20:46:58 +0200
Subject: [Griffith-svn] r1293 - branches/0.9.x
	branches/0.9.x/lib/plugins/movie trunk trunk/lib/plugins/movie
Message-ID: <200908261846.n7QIkwYk017898@sheep.berlios.de>

Author: mikej06
Date: 2009-08-26 20:46:32 +0200 (Wed, 26 Aug 2009)
New Revision: 1293

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/plugins/movie/PluginMovieFilmAffinity.py
   trunk/ChangeLog
   trunk/lib/plugins/movie/PluginMovieFilmAffinity.py
Log:
[#418911] It doesn't import cover art from FilmAffinity

Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2009-08-20 18:57:26 UTC (rev 1292)
+++ branches/0.9.x/ChangeLog	2009-08-26 18:46:32 UTC (rev 1293)
@@ -5,6 +5,9 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-26  Michael Jahn
+	* [#418911] It doesn't import cover art from FilmAffinity
+
 2009-07-07  Michael Jahn
 	* updated Allocine, CineMovies, IMDb-de, Zelluloid plugin
 

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieFilmAffinity.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieFilmAffinity.py	2009-08-20 18:57:26 UTC (rev 1292)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieFilmAffinity.py	2009-08-26 18:46:32 UTC (rev 1293)
@@ -44,7 +44,7 @@
 		self.page = self.page.replace('\x92', '\'')
 
 	def get_image(self):
-		tmp = string.find(self.page, 'www.filmaffinity.com/imgs/movies/')
+		tmp = string.find(self.page, 'pics.filmaffinity.com/')
 		if tmp == -1:
 			self.image_url = ''
 		else:

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-20 18:57:26 UTC (rev 1292)
+++ trunk/ChangeLog	2009-08-26 18:46:32 UTC (rev 1293)
@@ -5,6 +5,9 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-26  Michael Jahn
+	* [#418911] It doesn't import cover art from FilmAffinity
+
 2009-08-20  Piotr O?arowski
 	* Add pool_recycle parameter in config file and set the default to 1 hour
 	  (SQLAlchemy will recycle MySQL connections after given number of seconds

Modified: trunk/lib/plugins/movie/PluginMovieFilmAffinity.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieFilmAffinity.py	2009-08-20 18:57:26 UTC (rev 1292)
+++ trunk/lib/plugins/movie/PluginMovieFilmAffinity.py	2009-08-26 18:46:32 UTC (rev 1293)
@@ -44,7 +44,7 @@
         self.page = self.page.replace(u'\x92', '\'')
 
     def get_image(self):
-        tmp = string.find(self.page, 'www.filmaffinity.com/imgs/movies/')
+        tmp = string.find(self.page, 'pics.filmaffinity.com/')
         if tmp == -1:
             self.image_url = ''
         else:



From piotrek at mail.berlios.de  Fri Aug 28 22:28:38 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Fri, 28 Aug 2009 22:28:38 +0200
Subject: [Griffith-svn] r1294 - in trunk: . lib
Message-ID: <200908282028.n7SKScbU018381@sheep.berlios.de>

Author: piotrek
Date: 2009-08-28 22:28:38 +0200 (Fri, 28 Aug 2009)
New Revision: 1294

Modified:
   trunk/ChangeLog
   trunk/lib/gutils.py
Log:
[Bug 420462] --clean fixed


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2009-08-26 18:46:32 UTC (rev 1293)
+++ trunk/ChangeLog	2009-08-28 20:28:38 UTC (rev 1294)
@@ -5,6 +5,9 @@
 (c) 2005-2009  Vasco Nunes, Piotr O?arowski
 
 
+2009-08-28  Piotr O?arowski
+	* [Bug 420462] --clean fixed
+
 2009-08-26  Michael Jahn
 	* [#418911] It doesn't import cover art from FilmAffinity
 

Modified: trunk/lib/gutils.py
===================================================================
--- trunk/lib/gutils.py	2009-08-26 18:46:32 UTC (rev 1293)
+++ trunk/lib/gutils.py	2009-08-28 20:28:38 UTC (rev 1294)
@@ -26,7 +26,6 @@
 import sys
 try:
     import gtk
-    import gobject
     import db
 except:
     pass
@@ -346,25 +345,21 @@
 
 def clean_posters_dir(self):
     posters_dir = self.locations['posters']
-
     counter = 0
 
-    for files in os.walk(posters_dir):
-        for names in files:
-            for name in names:
-                if not name.endswith('_m.jpg') and not name.endswith('_s.jpg'):
-                    poster_md5 = gutils.md5sum(file(name, 'rb'))
-                    # lets check if this poster is orphan
-                    used = self.db.session.query(db.Poster).count_by(md5sum=poster_md5)
-                    if not used:
-                        counter += 1
-                        os.unlink(os.path.join(posters_dir, name))
-                        m_file = os.path.join(posters_dir, "m_"+name)
-                        if os.path.isfile(m_file):
-                            os.unlink(m_file)
-                        t_file = os.path.join(posters_dir, "t_"+name)
-                        if os.path.isfile(t_file):
-                            os.unlink(t_file)
+    for dirpath, dirnames, filenames in os.walk(posters_dir):
+        for name in filenames:
+            filepath = os.path.join(dirpath, name)
+            if name.endswith('_m.jpg') or name.endswith('_s.jpg'):
+                # it's safe to remove all thumbs, they'll be regenerated later
+                os.unlink(filepath)
+            else:
+                poster_md5 = md5sum(file(filepath, 'rb'))
+                # lets check if this poster is orphan
+                used = self.db.session.query(db.Poster).filter(db.Poster.md5sum==poster_md5).count()
+                if not used:
+                    counter += 1
+                    os.unlink(filepath)
 
     if counter:
         print "%d orphan files cleaned." %counter



From piotrek at mail.berlios.de  Sun Aug 30 22:02:03 2009
From: piotrek at mail.berlios.de (piotrek at BerliOS)
Date: Sun, 30 Aug 2009 22:02:03 +0200
Subject: [Griffith-svn] r1295 - trunk
Message-ID: <200908302002.n7UK23ld028431@sheep.berlios.de>

Author: piotrek
Date: 2009-08-30 22:02:03 +0200 (Sun, 30 Aug 2009)
New Revision: 1295

Modified:
   trunk/README
Log:
MySQL: recommend COLLATE utf8_general_ci


Modified: trunk/README
===================================================================
--- trunk/README	2009-08-28 20:28:38 UTC (rev 1294)
+++ trunk/README	2009-08-30 20:02:03 UTC (rev 1295)
@@ -80,7 +80,7 @@
 MySQL
 -----
 
-	CREATE DATABASE `griffith` DEFAULT CHARACTER SET utf8;
+	CREATE DATABASE `griffith` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
 	CREATE USER 'griffith'@'localhost' IDENTIFIED BY 'gRiFiTh';
 	CREATE USER 'griffith'@'%' IDENTIFIED BY 'gRiFiTh';
 	GRANT ALL ON `griffith` . * TO 'griffith'@'localhost';



