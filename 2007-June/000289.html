<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Griffith-svn] r771 - trunk/lib
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/griffith-svn/2007-June/index.html" >
   <LINK REL="made" HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r771%20-%20trunk/lib&In-Reply-To=%3C200706161912.l5GJCwK7029507%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000288.html">
   <LINK REL="Next"  HREF="000290.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Griffith-svn] r771 - trunk/lib</H1>
    <B>piotrek at BerliOS</B> 
    <A HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r771%20-%20trunk/lib&In-Reply-To=%3C200706161912.l5GJCwK7029507%40sheep.berlios.de%3E"
       TITLE="[Griffith-svn] r771 - trunk/lib">piotrek at mail.berlios.de
       </A><BR>
    <I>Sat Jun 16 21:12:58 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000288.html">[Griffith-svn] r769 - in trunk: . lib/plugins/export
</A></li>
        <LI>Next message: <A HREF="000290.html">[Griffith-svn] r772 - trunk/lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#289">[ date ]</a>
              <a href="thread.html#289">[ thread ]</a>
              <a href="subject.html#289">[ subject ]</a>
              <a href="author.html#289">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: piotrek
Date: 2007-06-16 21:12:57 +0200 (Sat, 16 Jun 2007)
New Revision: 771

Modified:
   trunk/lib/config.py
   trunk/lib/preferences.py
Log:
fix saving 'sortby' option (use the right section this time)


Modified: trunk/lib/config.py
===================================================================
--- trunk/lib/config.py	2007-06-12 22:32:20 UTC (rev 770)
+++ trunk/lib/config.py	2007-06-16 19:12:57 UTC (rev 771)
@@ -89,8 +89,6 @@
 			except:
 				print 'Cannot parse config file'
 				return False
-			#for i in self._cfg.items('main'):
-			#	self[i[0]] = i[1]
 			return True
 		else:
 			return False
@@ -106,45 +104,7 @@
 		self._cfg.add_section('spell')
 		self._cfg.add_section('add')
 		self._cfg.add_section('main')
-		self._cfg.set('main', 'pdf_reader', 'xpdf')
-		self._cfg.set('window', 'height', '700')
-		self._cfg.set('window', 'width', '500')
-		self._cfg.set('window', 'top', 'None')
-		self._cfg.set('window', 'left', 'None')
-		self._cfg.set('mainlist', 'director', 'True')
-		self._cfg.set('mainlist', 'number', 'True')
-		self._cfg.set('mainlist', 'otitle', 'True')
-		self._cfg.set('mainlist', 'title', 'True')
-		self._cfg.set('mainlist', 'image', 'True')
-		self._cfg.set('mainlist', 'sortby', 'number')
-		self._cfg.set('mainlist', 'sortby_reverse', 'False')
-		self._cfg.set('window', 'view_toolbar', 'True')
-		self._cfg.set('spell', 'gtkspell', 'True')
-		self._cfg.set('spell', 'plot', 'True')
-		self._cfg.set('spell', 'notes', 'True')
-		self._cfg.set('spell', 'lang', 'en')
-		self._cfg.set('main', 'default_movie_plugin', 'IMDB')
-		self._cfg.set('main', 'rating_image', '0') # 0       = meter; 1 = stars
-		self._cfg.set('defaults', 'color', '0')
-		self._cfg.set('defaults', 'condition', '0')
-		self._cfg.set('defaults', 'layers', '0')
-		self._cfg.set('defaults', 'media', '0')
-		self._cfg.set('defaults', 'region', '0')
-		self._cfg.set('defaults', 'vcodec', '0')
-		self._cfg.set('mail', 'smtp_server', 'localhost')
-		self._cfg.set('mail', 'use_auth', 'False')
-		self._cfg.set('mail', 'username', '')
-		self._cfg.set('mail', 'password', '')
-		self._cfg.set('mail', 'email', 'griffith')
-		self._cfg.set('main', 'posters', 'posters')
-		self._cfg.set('main', 'font', '')
-		self._cfg.set('database', 'type', 'sqlite')
-		self._cfg.set('database', 'file', 'griffith.db')
-		self._cfg.set('database', 'host', 'localhost')
-		self._cfg.set('database', 'port', '5432')
-		self._cfg.set('database', 'name', 'griffith')
-		self._cfg.set('database', 'user', 'griffith')
-		self._cfg.set('database', 'passwd', 'gRiFiTh')
+		self._cfg.set('add', 's_cast', 'True')
 		self._cfg.set('add', 's_classification', 'True')
 		self._cfg.set('add', 's_country', 'True')
 		self._cfg.set('add', 's_director', 'True')
@@ -160,7 +120,45 @@
 		self._cfg.set('add', 's_studio', 'True')
 		self._cfg.set('add', 's_title', 'True')
 		self._cfg.set('add', 's_trailer', 'True')
-		self._cfg.set('add', 's_cast', 'True')
 		self._cfg.set('add', 's_year', 'True')
-		self._cfg.set('mainlist', 'limit', '0') # limit search results to x items (0 -&gt; no limits)
+		self._cfg.set('database', 'file', 'griffith.db')
+		self._cfg.set('database', 'host', 'localhost')
+		self._cfg.set('database', 'name', 'griffith')
+		self._cfg.set('database', 'passwd', 'gRiFiTh')
+		self._cfg.set('database', 'port', '5432')
+		self._cfg.set('database', 'type', 'sqlite')
+		self._cfg.set('database', 'user', 'griffith')
+		self._cfg.set('defaults', 'color', '0')
+		self._cfg.set('defaults', 'condition', '0')
+		self._cfg.set('defaults', 'layers', '0')
+		self._cfg.set('defaults', 'media', '0')
+		self._cfg.set('defaults', 'region', '0')
+		self._cfg.set('defaults', 'vcodec', '0')
+		self._cfg.set('mail', 'email', 'griffith')
+		self._cfg.set('mail', 'password', '')
+		self._cfg.set('mail', 'smtp_server', 'localhost')
+		self._cfg.set('mail', 'use_auth', 'False')
+		self._cfg.set('mail', 'username', '')
+		self._cfg.set('main', 'default_movie_plugin', 'IMDB')
+		self._cfg.set('main', 'font', '')
+		self._cfg.set('main', 'pdf_reader', 'xpdf')
+		self._cfg.set('main', 'posters', 'posters')
+		self._cfg.set('main', 'rating_image', '0')	# 0 = meter; 1 = stars
+		self._cfg.set('mainlist', 'director', 'True')
+		self._cfg.set('mainlist', 'image', 'True')
+		self._cfg.set('mainlist', 'limit', '0')		# limit search results to x items (0 -&gt; no limits)
+		self._cfg.set('mainlist', 'number', 'True')
+		self._cfg.set('mainlist', 'otitle', 'True')
+		self._cfg.set('mainlist', 'sortby', 'number')
+		self._cfg.set('mainlist', 'sortby_reverse', 'False')
+		self._cfg.set('mainlist', 'title', 'True')
+		self._cfg.set('spell', 'gtkspell', 'True')
+		self._cfg.set('spell', 'lang', 'en')
+		self._cfg.set('spell', 'notes', 'True')
+		self._cfg.set('spell', 'plot', 'True')
+		self._cfg.set('window', 'height', '700')
+		self._cfg.set('window', 'left', 'None')
+		self._cfg.set('window', 'top', 'None')
+		self._cfg.set('window', 'view_toolbar', 'True')
+		self._cfg.set('window', 'width', '500')
 		self.save()

Modified: trunk/lib/preferences.py
===================================================================
--- trunk/lib/preferences.py	2007-06-12 22:32:20 UTC (rev 770)
+++ trunk/lib/preferences.py	2007-06-16 19:12:57 UTC (rev 771)
@@ -210,10 +210,10 @@
 	if w['sortby'].get_active():
 		field = self.sort_criteria[w['sortby'].get_active()]
 		if field:
-			c['sortby'] = field
+			c.set('sortby', field, section='mainlist')
 	else:
-		c['sortby'] = 'number'
-	c['sortby_reverse'] = w['sortby_reverse'].get_active()
+		c.set('sortby', 'number', section='mainlist')
+	c.set('sortby_reverse', w['sortby_reverse'].get_active(), section='mainlist')
 	
 	c.set('limit', str(int(w['s_limit'].get_value())), section='mainlist')
 	


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000288.html">[Griffith-svn] r769 - in trunk: . lib/plugins/export
</A></li>
	<LI>Next message: <A HREF="000290.html">[Griffith-svn] r772 - trunk/lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#289">[ date ]</a>
              <a href="thread.html#289">[ thread ]</a>
              <a href="subject.html#289">[ subject ]</a>
              <a href="author.html#289">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/griffith-svn">More information about the Griffith-svn
mailing list</a><br>
</body></html>
