<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Griffith-svn] r1013 - branches/0.9.x branches/0.9.x/lib	branches/0.9.x/lib/plugins/movie trunk trunk/lib	trunk/lib/plugins/movie
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/griffith-svn/2008-October/index.html" >
   <LINK REL="made" HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r1013%20-%20branches/0.9.x%20branches/0.9.x/lib%0A%09branches/0.9.x/lib/plugins/movie%20trunk%20trunk/lib%0A%09trunk/lib/plugins/movie&In-Reply-To=%3C200810232101.m9NL1GR4011547%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000492.html">
   <LINK REL="Next"  HREF="000494.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Griffith-svn] r1013 - branches/0.9.x branches/0.9.x/lib	branches/0.9.x/lib/plugins/movie trunk trunk/lib	trunk/lib/plugins/movie</H1>
    <B>mikej06 at mail.berlios.de</B> 
    <A HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r1013%20-%20branches/0.9.x%20branches/0.9.x/lib%0A%09branches/0.9.x/lib/plugins/movie%20trunk%20trunk/lib%0A%09trunk/lib/plugins/movie&In-Reply-To=%3C200810232101.m9NL1GR4011547%40sheep.berlios.de%3E"
       TITLE="[Griffith-svn] r1013 - branches/0.9.x branches/0.9.x/lib	branches/0.9.x/lib/plugins/movie trunk trunk/lib	trunk/lib/plugins/movie">mikej06 at mail.berlios.de
       </A><BR>
    <I>Thu Oct 23 23:01:16 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000492.html">[Griffith-svn] r1012 - in trunk: . glade lib
</A></li>
        <LI>Next message: <A HREF="000494.html">[Griffith-svn] r1014 - in trunk: . glade lib lib/plugins/export	lib/plugins/imp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#493">[ date ]</a>
              <a href="thread.html#493">[ thread ]</a>
              <a href="subject.html#493">[ subject ]</a>
              <a href="author.html#493">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mikej06
Date: 2008-10-23 23:00:53 +0200 (Thu, 23 Oct 2008)
New Revision: 1013

Modified:
   branches/0.9.x/ChangeLog
   branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
   branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py
   branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py
   branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py
   branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py
   branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py
   branches/0.9.x/lib/test_movieplugins.py
   trunk/ChangeLog
   trunk/lib/plugins/movie/PluginMovieAmazon.py
   trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py
   trunk/lib/plugins/movie/PluginMovieIMDB-de.py
   trunk/lib/plugins/movie/PluginMovieKinoDe.py
   trunk/lib/plugins/movie/PluginMovieOFDb.py
   trunk/lib/plugins/movie/PluginMovieZelluloid.py
   trunk/lib/test_movieplugins.py
Log:
* updated IMDB-de, Kino.de, Zelluloid plugin
* added original url check within plugin test


Modified: branches/0.9.x/ChangeLog
===================================================================
--- branches/0.9.x/ChangeLog	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/ChangeLog	2008-10-23 21:00:53 UTC (rev 1013)
@@ -5,6 +5,10 @@
 (c) 2005-2008  Vasco Nunes, Piotr O&#380;arowski
 
 
+2008-10-23  Michael Jahn
+	* updated IMDB-de, Kino.de, Zelluloid plugin
+	* added original url check within plugin test
+
 2008-09-23  Michael Jahn
 	* [#273172] &quot;Properties/Volume/show...in this volume&quot; is broken
 

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -367,12 +367,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -&gt; expected result count }
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 10,
-		'Arahan'				: 5,
-		'Ein gl&#252;ckliches Jahr'	: 1
+		'Rocky Balboa'			: [ 10, 10 ],
+		'Arahan'				: [ 6, 6 ],
+		'Ein gl&#252;ckliches Jahr'	: [ 1, 1 ]
 	}
 
 class PluginTest:
@@ -437,7 +437,6 @@
 			'country'			: 'S&#252;dkorea',
 			'genre'				: 'Actionkom&#246;die, Abenteuer- &amp; Actionkom&#246;die, Fantasykom&#246;die, Action, Kom&#246;die, Mehr Fantasy, Korea, Action, Kom&#246;die, Fantasy, Unter 10 EUR',
 			'classification'	: 'Freigegeben ab 16 Jahren',
-			'studio'			: 'Splendid Entertainment/WVG',
 			'o_site'			: False,
 			'site'				: '<A HREF="http://www.amazon.de/dp/B000BSNOD6">http://www.amazon.de/dp/B000BSNOD6</A>',
 			'trailer'			: False,

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -172,12 +172,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -&gt; expected result count }
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 1,
-		'Arahan'				: 1,
-		'Ein gl&#252;ckliches Jahr'	: 0
+		'Rocky Balboa'			: [ 1, 1 ],
+		'Arahan'				: [ 1, 1 ],
+		'Ein gl&#252;ckliches Jahr'	: [ 0, 0 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,7 +31,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>'
-plugin_version      = '1.2'
+plugin_version      = '1.3'
 
 class Plugin(movie.Movie):
 	def __init__(self, id):
@@ -42,6 +42,16 @@
 	def initialize(self):
 		self.cast_page = self.open_page(url=self.url + '/fullcredits')
 		self.plot_page = self.open_page(url=self.url + '/plotsummary')
+		# correction of all &amp;#xxx entities
+		self.page = self.page.decode(self.encode)
+		self.page = gutils.convert_entities(self.page)
+		self.page = self.page.encode(self.encode)
+		self.cast_page = self.cast_page.decode(self.encode)
+		self.cast_page = gutils.convert_entities(self.cast_page)
+		self.cast_page = self.cast_page.encode(self.encode)
+		self.plot_page = self.plot_page.decode(self.encode)
+		self.plot_page = gutils.convert_entities(self.plot_page)
+		self.plot_page = self.plot_page.encode(self.encode)
 
 	def get_image(self):
 		tmp = string.find(self.page, 'a name=&quot;poster&quot;')
@@ -51,10 +61,10 @@
 			self.image_url = gutils.trim(self.page[tmp:], 'src=&quot;', '&quot;')
 
 	def get_o_title(self):
-		self.o_title = gutils.trim(self.page, '&lt;h1&gt;', ' &lt;span')
+		self.o_title = gutils.trim(self.page, '&lt;h1&gt;', '&lt;span')
 
 	def get_title(self):
-		self.title = gutils.trim(self.page, '&lt;h1&gt;', ' &lt;span')
+		self.title = gutils.trim(self.page, '&lt;h1&gt;', '&lt;span')
 		elements = string.split(gutils.trim(self.page, '&lt;h5&gt;Alternativ:', '&lt;/div&gt;'), '&lt;i class=&quot;transl&quot;')
 		if len(elements) &gt; 1:
 			for element in elements:
@@ -69,6 +79,8 @@
 			self.director = gutils.trim(self.page,'&lt;h5&gt;Regisseur:&lt;/h5&gt;', '&lt;/div&gt;')
 		self.director = self.__before_more(self.director)
 		self.director = self.director.replace('&lt;br/&gt;', ', ')
+		self.director = gutils.clean(self.director)
+		self.director = re.sub(',$', '', self.director)
 
 	def get_plot(self):
 		self.plot = gutils.trim(self.page, '&lt;h5&gt;Kurzbeschreibung:&lt;/h5&gt;', '&lt;/div&gt;')
@@ -86,7 +98,7 @@
 		self.year = gutils.after(self.year, '&quot;&gt;')
 
 	def get_runtime(self):
-		self.runtime = gutils.trim(self.page, '&lt;h5&gt;L&auml;nge:&lt;/h5&gt;', ' min')
+		self.runtime = self.regextrim(self.page, '&lt;h5&gt;L[^n]+nge:&lt;/h5&gt;', ' [Mm]in')
 
 	def get_genre(self):
 		self.genre = gutils.trim(self.page, '&lt;h5&gt;Genre:&lt;/h5&gt;', '&lt;/div&gt;')
@@ -103,12 +115,14 @@
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;even&quot;&gt;', &quot;\n&quot;)
 		self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;odd&quot;&gt;', &quot;\n&quot;)
 		self.cast = self.__before_more(self.cast)
+		self.cast = re.sub('[ ]+', ' ', self.cast)
 
 	def get_classification(self):
 		self.classification = gutils.trim(gutils.trim(self.page, 'Altersfreigabe:', '&lt;/div&gt;'), 'Germany:', '&amp;')
 
 	def get_studio(self):
-		self.studio = gutils.trim(self.page, '&lt;h5&gt;Company:&lt;/h5&gt;', '&lt;/a&gt;')
+		self.studio = gutils.trim(self.page, '&lt;h5&gt;Firma:&lt;/h5&gt;', '&lt;/div&gt;')
+		self.studio = self.__before_more(self.studio)
 
 	def get_o_site(self):
 		self.o_site = ''
@@ -120,10 +134,13 @@
 		self.trailer = &quot;<A HREF="http://german.imdb.com/title/tt%s/trailers">http://german.imdb.com/title/tt%s/trailers</A>&quot; % self.movie_id
 
 	def get_country(self):
-		self.country = gutils.trim(self.page, '&lt;h5&gt;Produktionsland:&lt;/h5&gt;', '&lt;/div&gt;')
+		self.country = gutils.trim(self.page, '&lt;h5&gt;Land:&lt;/h5&gt;', '&lt;/div&gt;')
+		self.country = self.__before_more(self.country)
+		self.country = re.sub('[\n]+', '', self.country)
+		self.country = re.sub('[ ]+', ' ', self.country)
 
 	def get_rating(self):
-		self.rating = gutils.trim(self.page, '&lt;b&gt;Nutzer-Bewertung:&lt;/b&gt;', '/10')
+		self.rating = gutils.trim(self.page, '&lt;h5&gt;Nutzer-Bewertung:&lt;/h5&gt;', '/10')
 		if self.rating:
 			try:
 				self.rating = str(float(gutils.clean(self.rating)))
@@ -134,13 +151,33 @@
 		self.notes = ''
 		language = gutils.trim(self.page, '&lt;h5&gt;Sprache:&lt;/h5&gt;', '&lt;/div&gt;')
 		language = gutils.strip_tags(language)
+		language = re.sub('[\n]+', '', language)
+		language = re.sub('[ ]+', ' ', language)
+		language = language.rstrip()
 		color = gutils.trim(self.page, '&lt;h5&gt;Farbe:&lt;/h5&gt;', '&lt;/div&gt;')
 		color = gutils.strip_tags(color)
+		color = re.sub('[\n]+', '', color)
+		color = re.sub('[ ]+', ' ', color)
+		color = re.sub('[ ]+$', '', color)
+		color = color.rstrip()
 		sound = gutils.trim(self.page, '&lt;h5&gt;Tonverfahren:&lt;/h5&gt;', '&lt;/div&gt;')
 		sound = gutils.strip_tags(sound)
+		sound = re.sub('[\n]+', '', sound)
+		sound = re.sub('[ ]+', ' ', sound)
+		sound = sound.rstrip()
+		soundsplit = sound.split(' | ')
+		if len(soundsplit) &gt; 1:
+			soundsplit.sort()
+			sound = ''
+			for elem in soundsplit:
+				sound += elem + ' | '
+			sound = sound[0:len(sound) - 3]
 		tagline = gutils.trim(self.page, '&lt;h5&gt;Werbezeile:&lt;/h5&gt;', '&lt;/div&gt;')
 		tagline = self.__before_more(tagline)
 		tagline = gutils.strip_tags(tagline)
+		tagline = re.sub('[\n]+', '', tagline)
+		tagline = re.sub('[ ]+', ' ', tagline)
+		tagline = tagline.rstrip()
 		if len(language)&gt;0:
 			self.notes = &quot;%s: %s\n&quot; %(_('Language'), language)
 		if len(sound)&gt;0:
@@ -151,31 +188,211 @@
 			self.notes += &quot;%s: %s\n&quot; %('Tagline', tagline)
 	
 	def __before_more(self, data):
-		tmp = string.find(data, '&gt;mehr...&lt;')
+		tmp = string.find(data, '&gt;mehr&lt;')
 		if tmp&gt;0:
 			data = data[:tmp] + '&gt;'
 		return data
 
+	def regextrim(self,text,key1,key2):
+		obj = re.search(key1, text)
+		if obj is None:
+			return ''
+		else:
+			p1 = obj.end()
+		obj = re.search(key2, text[p1:])
+		if obj is None:
+			return ''
+		else:
+			p2 = p1 + obj.start()
+		return text[p1:p2]
+
 class SearchPlugin(movie.SearchMovie):
-	PATTERN = re.compile(r&quot;&quot;&quot;&lt;a href=['&quot;]/title/tt([0-9]+)/[&quot;']&gt;(.*?)&lt;/td&gt;&quot;&quot;&quot;)
+	PATTERN = re.compile(r&quot;&quot;&quot;&lt;a href=['&quot;]/title/tt([0-9]+)/[&quot;']&gt;(.*?)(&lt;/td&gt;|&lt;/A&gt;)&quot;&quot;&quot;, re.IGNORECASE)
+	PATTERN_POWERSEARCH = re.compile(r&quot;&quot;&quot;Here are the [0-9]+ matching titles&quot;&quot;&quot;)
+
 	def __init__(self):
 		self.original_url_search	= '<A HREF="http://german.imdb.com/find?more=tt&amp;q=">http://german.imdb.com/find?more=tt&amp;q=</A>'
-		self.translated_url_search	= '<A HREF="http://german.imdb.com/find?more=tt&amp;q=">http://german.imdb.com/find?more=tt&amp;q=</A>'
+		self.translated_url_search	= '<A HREF="http://german.imdb.com/List?words=">http://german.imdb.com/List?words=</A>'
 		self.encode = 'iso8859-1'
+		self.remove_accents = False
 
 	def search(self,parent_window):
 		self.open_search(parent_window)
-		self.page = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit');
-		self.page = self.page.decode('iso-8859-1')
+		tmp = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit')
+		if tmp == '':
+			if self.PATTERN_POWERSEARCH.search(self.page) is None:
+				self.page = ''
+		else:
+			self.page = tmp 
+		# correction of all &amp;#xxx entities
+		self.page = self.page.decode(self.encode)
+		self.page = gutils.convert_entities(self.page)
+		self.page = self.page.encode(self.encode)
 		return self.page
 
 	def get_searches(self):
 		elements = string.split(self.page, '&lt;tr&gt;')
+		if len(elements) &lt; 2:
+			elements = string.split(self.page, '&lt;TR&gt;')
 
 		if len(elements):
 			for element in elements[1:]:
 				match = self.PATTERN.findall(element)
-				if len(match):
-					tmp  = gutils.clean(match[0][1])
-					self.ids.append(match[0][0])
+				for entry in match:
+					tmp  = gutils.clean(entry[1])
+					self.ids.append(entry[0])
 					self.titles.append(tmp)
+
+#
+# Plugin Test
+#
+class SearchPluginTest(SearchPlugin):
+	#
+	# Configuration for automated tests:
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
+	#
+	test_configuration = {
+		'Rocky Balboa'			: [ 3, 13 ],
+		'Ein gl&#252;ckliches Jahr'	: [ 1, 30 ]
+	}
+
+class PluginTest:
+	#
+	# Configuration for automated tests:
+	# dict { movie_id -&gt; dict { arribute -&gt; value } }
+	#
+	# value: * True/False if attribute only should be tested for any value
+	#        * or the expected value
+	#
+	test_configuration = {
+		'0479143' : { 
+			'title' 			: 'Rocky Balboa',
+			'o_title' 			: 'Rocky Balboa',
+			'director'			: 'Sylvester Stallone',
+			'plot' 				: True,
+			'cast'				: 'Sylvester Stallone' + _(' as ') + 'Rocky Balboa\n\
+Burt Young' + _(' as ') + 'Paulie Panina\n\
+Antonio Tarver' + _(' as ') + 'Mason \'The Line\' Dixon\n\
+Geraldine Hughes' + _(' as ') + 'Marie\n\
+Milo Ventimiglia' + _(' as ') + 'Robert Balboa Jr.\n\
+Tony Burton' + _(' as ') + 'Duke\n\
+A.J. Benza' + _(' as ') + 'L.C.\n\
+James Francis Kelly III' + _(' as ') + 'Steps\n\
+Talia Shire' + _(' as ') + 'Adrian (archive footage)\n\
+Lou DiBella' + _(' as ') + 'Himself\n\
+Mike Tyson' + _(' as ') + 'Himself\n\
+Henry G. Sanders' + _(' as ') + 'Martin\n\
+Pedro Lovell' + _(' as ') + 'Spider Rico\n\
+Ana Gerena' + _(' as ') + 'Isabel\n\
+Angela Boyd' + _(' as ') + 'Angie\n\
+Louis Giansante' + _(' as ') + 'Bar Thug\n\
+Maureen Schilling' + _(' as ') + 'Lucky\'s Bartender\n\
+Lahmard J. Tate' + _(' as ') + 'X-Cell (as Lahmard Tate)\n\
+Woody Paige' + _(' as ') + 'ESPN Commentator (as Woodrow W. Paige)\n\
+Skip Bayless' + _(' as ') + 'ESPN Commentator\n\
+Jay Crawford' + _(' as ') + 'ESPN Commentator\n\
+Brian Kenny' + _(' as ') + 'ESPN Host\n\
+Dana Jacobson' + _(' as ') + 'ESPN Host\n\
+Charles Johnson' + _(' as ') + 'ESPN Host (as Chuck Johnson)\n\
+James Binns' + _(' as ') + 'Commissioner (as James J. Binns)\n\
+Johnnie Hobbs Jr.' + _(' as ') + 'Commissioner\n\
+Barney Fitzpatrick' + _(' as ') + 'Commissioner\n\
+Jim Lampley' + _(' as ') + 'HBO Commentator\n\
+Larry Merchant' + _(' as ') + 'HBO Commentator\n\
+Max Kellerman' + _(' as ') + 'HBO Commentator\n\
+LeRoy Neiman' + _(' as ') + 'Himself\n\
+Bert Randolph Sugar' + _(' as ') + 'Ring Magazine Reporter\n\
+Bernard Fern&#225;ndez' + _(' as ') + 'Boxing Association of America Writer (as Bernard Fernandez)\n\
+Gunnar Peterson' + _(' as ') + 'Weightlifting Trainer\n\
+Yahya' + _(' as ') + 'Dixon\'s Opponent\n\
+Marc Ratner' + _(' as ') + 'Weigh-In Official\n\
+Anthony Lato Jr.' + _(' as ') + 'Rocky\'s Inspector\n\
+Jack Lazzarado' + _(' as ') + 'Dixon\'s Inspector\n\
+Michael Buffer' + _(' as ') + 'Ring Announcer\n\
+Joe Cortez' + _(' as ') + 'Referee\n\
+Carter Mitchell' + _(' as ') + 'Shamrock Foreman\n\
+Vinod Kumar' + _(' as ') + 'Ravi\n\
+Fran Pultro' + _(' as ') + 'Father at Restaurant\n\
+Frank Stallone' + _(' as ') + 'Dinner Patron (as Frank Stallone Jr.)\n\
+Jody Giambelluca' + _(' as ') + 'Dinner Patron\n\
+Tobias Segal' + _(' as ') + 'Robert\'s Friend\n\
+Tim Carr' + _(' as ') + 'Robert\'s Friend\n\
+Matt Frack' + _(' as ') + 'Robert\'s Friend #3\n\
+Paul Dion Monte' + _(' as ') + 'Robert\'s Friend\n\
+Kevin King Templeton' + _(' as ') + 'Robert\'s Friend (as Kevin King-Templeton)\n\
+Robert Michael Kelly' + _(' as ') + 'Mr. Tomilson\n\
+Rick Buchborn' + _(' as ') + 'Rocky Fan\n\
+Nick Baker' + _(' as ') + 'Irish Pub Bartender\n\
+Don Sherman' + _(' as ') + 'Andy\n\
+Stu Nahan' + _(' as ') + 'Computer Fight Commentator (voice)\n\
+Gary Compton' + _(' as ') + 'Security Guard\n\
+&#252;brige Besetzung in alphabetischer Reihenfolge:\n\
+Ricky Cavazos' + _(' as ') + 'Boxing Spectator (uncredited)\n\
+David Kneeream' + _(' as ') + 'Adrian\'s Patron (uncredited)\n\
+Dolph Lundgren' + _(' as ') + 'Captain Ivan Drago (archive footage) (uncredited)\n\
+Burgess Meredith' + _(' as ') + 'Mickey Goldmill (archive footage) (uncredited)\n\
+Keith Moyer' + _(' as ') + 'Bar Patron (uncredited)\n\
+Mr. T' + _(' as ') + 'Clubber Lang (archive footage) (uncredited)',
+			'country'			: 'USA',
+			'genre'				: 'Action | Sport',
+			'classification'	: False,
+			'studio'			: 'Metro-Goldwyn-Mayer (MGM)',
+			'o_site'			: False,
+			'site'				: '<A HREF="http://german.imdb.com/title/tt0479143">http://german.imdb.com/title/tt0479143</A>',
+			'trailer'			: '<A HREF="http://german.imdb.com/title/tt0479143/trailers">http://german.imdb.com/title/tt0479143/trailers</A>',
+			'year'				: 2006,
+			'notes'				: _('Language') + ': Englisch | Spanisch\n'\
++ _('Audio') + ': DTS | Dolby Digital | SDDS\n'\
++ _('Color') + ': Farbe\n\
+Tagline: It ain\'t over \'til it\'s over.',
+			'runtime'			: 102,
+			'image'				: True,
+			'rating'			: 7
+		},
+		'0069815' : { 
+			'title' 			: 'Gl&#252;ckliches Jahr, Ein',
+			'o_title' 			: 'Bonne ann&#233;e, La',
+			'director'			: 'Claude Lelouch',
+			'plot' 				: True,
+			'cast'				: 'Lino Ventura' + _(' as ') + 'Simon\n\
+Fran&#231;oise Fabian' + _(' as ') + 'Fran&#231;oise\n\
+Charles G&#233;rard' + _(' as ') + 'Charlot\n\
+Andr&#233; Falcon' + _(' as ') + 'Le bijoutier\n\
+Mireille Mathieu' + _(' as ') + 'Herself / Elle-m&#234;me\n\
+Lilo' + _(' as ') + 'Madame F&#233;lix\n\
+Claude Mann' + _(' as ') + 'L\'intellectuel\n\
+Fr&#233;d&#233;ric de Pasquale' + _(' as ') + 'L\'amant parisien\n\
+G&#233;rard Sire' + _(' as ') + 'Le directeur de la prison\n\
+Silvano Tranquilli' + _(' as ') + 'L\'amant italien\n\
+Andr&#233; Barello\n\
+Michel Bertay\n\
+Norman de la Chesnaye\n\
+Pierre Edeline\n\
+Pierre Pontiche\n\
+Michou' + _(' as ') + 'Himself\n\
+Bettina Rheims' + _(' as ') + 'La jeune vendeuse\n\
+Joseph Rythmann\n\
+Georges Staquet\n\
+Jacques Villedieu\n\
+Harry Walter\n\
+&#252;brige Besetzung in alphabetischer Reihenfolge:\n\
+Anouk Aim&#233;e' + _(' as ') + 'Une femme (archive footage) (uncredited)\n\
+Elie Chouraqui' + _(' as ') + '(uncredited)\n\
+R&#233;my Julienne' + _(' as ') + 'Chauffeur de taxi (uncredited)\n\
+Jean-Louis Trintignant' + _(' as ') + 'Un homme (archive footage) (uncredited)',
+			'country'			: 'France | Italy',
+			'genre'				: 'Kom&#246;die',
+			'classification'	: False,
+			'studio'			: 'Les Films 13',
+			'o_site'			: False,
+			'site'				: '<A HREF="http://german.imdb.com/title/tt0069815">http://german.imdb.com/title/tt0069815</A>',
+			'trailer'			: '<A HREF="http://german.imdb.com/title/tt0069815/trailers">http://german.imdb.com/title/tt0069815/trailers</A>',
+			'year'				: 1973,
+			'notes'				: _('Language') + ': Franz&#246;sisch\n'\
++ _('Audio') + ': Mono\n'\
++ _('Color') + ': Farbe (Eastmancolor)',
+			'runtime'			: 90,
+			'image'				: True,
+			'rating'			: 7
+		},
+	}

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -33,7 +33,7 @@
 plugin_language = _(&quot;German&quot;)
 plugin_author = &quot;Michael Jahn&quot;
 plugin_author_email = &quot;&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;&quot;
-plugin_version = &quot;1.11&quot;
+plugin_version = &quot;1.12&quot;
 
 class Plugin(movie.Movie):
 	url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm/">http://www.kino.de/kinofilm/</A>&quot;
@@ -63,7 +63,7 @@
 	def get_image(self):
 		self.image_url = ''
 		tmpdata = self.regextrim(self.tmp_page, '(PRINT[-]CONTENT[-]START|&lt;td class=&quot;content&quot;&gt;)', '(Dieser Film wurde |&gt;FOTOSHOW&lt;|&gt;KRITIK&lt;)')
-		tmpdatasplit = re.split('src=&quot;<A HREF="http://images.kino.de/flbilder">http://images.kino.de/flbilder</A>', tmpdata)
+		tmpdatasplit = re.split('src=&quot;<A HREF="http://.+/flbilder">http://.+/flbilder</A>', tmpdata)
 		if len(tmpdatasplit) &gt; 2:
 			tmpdata = gutils.before(tmpdatasplit[2], '.jpg')
 			if tmpdata &lt;&gt; '':
@@ -88,9 +88,9 @@
 			self.title = gutils.after(self.regextrim(self.tmp_page, 'headline2&quot;[^&gt;]*&gt;[ \t\r\n]*&lt;a href=&quot;/kinofilm', '&lt;/a&gt;'), '&gt;')
 
 	def get_director(self):
-		self.director = gutils.trim(self.tmp_creditspage,&quot;Regie&quot;,&quot;&lt;/a&gt;&quot;)
-		self.director = gutils.after(self.director,&quot;/star/&quot;)
-		self.director = gutils.after(self.director,&quot;&gt;&quot;)
+		self.director = self.regextrim(self.tmp_creditspage, '&gt;[ ]*Regie', '&lt;/a&gt;')
+		self.director = gutils.after(self.director, '/star/')
+		self.director = gutils.after(self.director, '&gt;')
 
 	def get_plot(self):
 		# little steps to perfect plot (I hope ... it's a terrible structured content ... )
@@ -158,9 +158,9 @@
 		self.classification = self.regextrim(self.tmp_page,'FSK:( |&nbsp;)+', '&lt;/strong&gt;')
 
 	def get_studio(self):
-		self.studio = self.regextrim(self.tmp_page, 'Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
+		self.studio = self.regextrim(self.tmp_page, '&gt;[ ]*Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
 		if (self.studio == &quot;&quot;):
-			self.studio = self.regextrim(self.tmp_page, 'Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
+			self.studio = self.regextrim(self.tmp_page, '&gt;[ ]*Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
 
 	def get_o_site(self):
 		self.o_site = &quot;&quot;
@@ -305,12 +305,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -&gt; expected result count }
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 6,
-		'Arahan'				: 6,
-		'Ein gl&#252;ckliches Jahr'	: 3
+		'Rocky Balboa'			: [ 6, 6 ],
+		'Arahan'				: [ 6, 6 ],
+		'Ein gl&#252;ckliches Jahr'	: [ 3, 3 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -158,12 +158,12 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -&gt; expected result count }
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'			: 1,
-		'Arahan'				: 3,
-		'gl&#252;ckliches'			: 4
+		'Rocky Balboa'			: [ 1, 1 ],
+		'Arahan'				: [ 3, 2 ],
+		'gl&#252;ckliches'			: [ 4, 2 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py
===================================================================
--- branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -33,7 +33,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;'
-plugin_version      = '1.0'
+plugin_version      = '1.1'
 
 class Plugin(movie.Movie):
 	index_url = '<A HREF="http://www.zelluloid.de/filme/index.php3?id=">http://www.zelluloid.de/filme/index.php3?id=</A>'
@@ -105,7 +105,7 @@
 
 	def get_classification(self):
 		self.classification = gutils.trim(self.detail_page, 'FSK: ', '&lt;/TD&gt;')
-		self.classification = re.sub(',.*', '', self.classification)
+		self.classification = re.sub('[,&lt;].*', '', self.classification)
 
 	def get_studio(self):
 		self.studio = gutils.strip_tags(gutils.trim(self.detail_page, 'alt=&quot;Produktion&quot;', '&nbsp;'))
@@ -177,11 +177,11 @@
 class SearchPluginTest(SearchPlugin):
 	#
 	# Configuration for automated tests:
-	# dict { movie_id -&gt; expected result count }
+	# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 	#
 	test_configuration = {
-		'Rocky Balboa'		: 1,
-		'Die wilden H&#252;hner'	: 3
+		'Rocky Balboa'		: [ 1, 1 ],
+		'Die wilden H&#252;hner'	: [ 3, 3 ]
 	}
 
 class PluginTest:

Modified: branches/0.9.x/lib/test_movieplugins.py
===================================================================
--- branches/0.9.x/lib/test_movieplugins.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ branches/0.9.x/lib/test_movieplugins.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,12 +31,12 @@
 # dict in both cases.
 #
 # SearchPluginTest.test_configuration:
-# dict { movie_id -&gt; expected result count }
+# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 #
 # PluginTest.test_configuration:
 # dict { movie_id -&gt; dict { arribute -&gt; value } }
 #
-# value: * True/False if attribute should only be tested for any value
+# value: * True/False if attribute should only be tested for any value or nothing
 #        * or the expected value
 #
 
@@ -64,6 +64,7 @@
 	test_plugins = [
 		'PluginMovieAmazon',
 		'PluginMovieFilmeVonAZ',
+		'PluginMovieIMDB-de',
 		'PluginMovieKinoDe',
 		'PluginMovieOFDb',
 		'PluginMovieZelluloid',
@@ -73,10 +74,12 @@
 	# simulates the search for a movie title and compares
 	# the count of results with the expected count
 	#
-	def test_search(self, plugin, title, cnt):
+	def test_search(self, plugin, title, cntOriginal, cntTranslated):
 		global debug, myconfig
+		result = True
 		plugin.debug = debug
 		plugin.config = myconfig
+		# plugin.translated_url_search
 		plugin.url = plugin.translated_url_search
 		if plugin.remove_accents:
 			plugin.title = gutils.remove_accents(title, 'utf-8')
@@ -84,10 +87,21 @@
 			plugin.title = title
 		plugin.search(None)
 		plugin.get_searches()
-		if not len(plugin.ids) - 1 == cnt:	# first entry is always '' (???)
-			print &quot;Title: %s - expected: %d - found: %d&quot; % (title, cnt, len(plugin.ids) - 1)
-			return False
-		return True
+		if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
+			print &quot;Title (Translated): %s - expected: %d - found: %d&quot; % (title, cntOriginal, len(plugin.ids) - 1)
+			result = False
+		# plugin.original_url_search
+		plugin.url = plugin.original_url_search
+		if plugin.remove_accents:
+			plugin.title = gutils.remove_accents(title, 'utf-8')
+		else:
+			plugin.title = title
+		plugin.search(None)
+		plugin.get_searches()
+		if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
+			print &quot;Title (Original): %s - expected: %d - found: %d&quot; % (title, cntTranslated, len(plugin.ids) - 1)
+			result = False
+		return result
 
 	#
 	# check every configured movie title
@@ -105,7 +119,7 @@
 		if not pluginTestConfig == None:
 			for i in pluginTestConfig.test_configuration:
 				searchPlugin = plugin.SearchPlugin()
-				if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i]):
+				if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i][0], pluginTestConfig.test_configuration[i][1]):
 					result = False
 				sleep(1) # needed for amazon
 		
@@ -281,4 +295,8 @@
 #
 # Start the tests
 #
+gtk.gdk.threads_init()
+gtk.gdk.threads_enter()
 PluginTester().do_test()
+#gtk.main()
+gtk.gdk.threads_leave()

Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/ChangeLog	2008-10-23 21:00:53 UTC (rev 1013)
@@ -5,6 +5,10 @@
 (c) 2005-2008  Vasco Nunes, Piotr O&#380;arowski
 
 
+2008-10-23  Michael Jahn
+	* updated IMDB-de, Kino.de, Zelluloid plugin
+	* added original url check within plugin test
+
 2008-10-23  Piotr O&#380;arowski
 	* clean/restore search conditions in advfilter
 

Modified: trunk/lib/plugins/movie/PluginMovieAmazon.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieAmazon.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -367,12 +367,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -&gt; expected result count }
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 10,
-        'Arahan'                : 5,
-        'Ein gl&#252;ckliches Jahr'    : 1
+        'Rocky Balboa'            : [ 10, 10 ],
+        'Arahan'                : [ 6, 6 ],
+        'Ein gl&#252;ckliches Jahr'    : [ 1, 1 ]
     }
 
 class PluginTest:
@@ -437,7 +437,6 @@
             'country'            : 'S&#252;dkorea',
             'genre'                : 'Actionkom&#246;die, Abenteuer- &amp; Actionkom&#246;die, Fantasykom&#246;die, Action, Kom&#246;die, Mehr Fantasy, Korea, Action, Kom&#246;die, Fantasy, Unter 10 EUR',
             'classification'    : 'Freigegeben ab 16 Jahren',
-            'studio'            : 'Splendid Entertainment/WVG',
             'o_site'            : False,
             'site'                : '<A HREF="http://www.amazon.de/dp/B000BSNOD6">http://www.amazon.de/dp/B000BSNOD6</A>',
             'trailer'            : False,

Modified: trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieFilmeVonAZ.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -173,12 +173,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -&gt; expected result count }
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 1,
-        'Arahan'                : 1,
-        'Ein gl&#252;ckliches Jahr'    : 0
+        'Rocky Balboa'            : [ 1, 1 ],
+        'Arahan'                : [ 1, 1 ],
+        'Ein gl&#252;ckliches Jahr'    : [ 0, 0 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieIMDB-de.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieIMDB-de.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -32,7 +32,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>'
-plugin_version      = '1.2'
+plugin_version      = '1.3'
 
 class Plugin(movie.Movie):
     def __init__(self, id):
@@ -43,6 +43,16 @@
     def initialize(self):
         self.cast_page = self.open_page(url=self.url + '/fullcredits')
         self.plot_page = self.open_page(url=self.url + '/plotsummary')
+        # correction of all &amp;#xxx entities
+        self.page = self.page.decode(self.encode)
+        self.page = gutils.convert_entities(self.page)
+        self.page = self.page.encode(self.encode)
+        self.cast_page = self.cast_page.decode(self.encode)
+        self.cast_page = gutils.convert_entities(self.cast_page)
+        self.cast_page = self.cast_page.encode(self.encode)
+        self.plot_page = self.plot_page.decode(self.encode)
+        self.plot_page = gutils.convert_entities(self.plot_page)
+        self.plot_page = self.plot_page.encode(self.encode)
 
     def get_image(self):
         tmp = string.find(self.page, 'a name=&quot;poster&quot;')
@@ -52,10 +62,10 @@
             self.image_url = gutils.trim(self.page[tmp:], 'src=&quot;', '&quot;')
 
     def get_o_title(self):
-        self.o_title = gutils.trim(self.page, '&lt;h1&gt;', ' &lt;span')
+        self.o_title = gutils.trim(self.page, '&lt;h1&gt;', '&lt;span')
 
     def get_title(self):
-        self.title = gutils.trim(self.page, '&lt;h1&gt;', ' &lt;span')
+        self.title = gutils.trim(self.page, '&lt;h1&gt;', '&lt;span')
         elements = string.split(gutils.trim(self.page, '&lt;h5&gt;Alternativ:', '&lt;/div&gt;'), '&lt;i class=&quot;transl&quot;')
         if len(elements) &gt; 1:
             for element in elements:
@@ -70,6 +80,8 @@
             self.director = gutils.trim(self.page,'&lt;h5&gt;Regisseur:&lt;/h5&gt;', '&lt;/div&gt;')
         self.director = self.__before_more(self.director)
         self.director = self.director.replace('&lt;br/&gt;', ', ')
+        self.director = gutils.clean(self.director)
+        self.director = re.sub(',$', '', self.director)
 
     def get_plot(self):
         self.plot = gutils.trim(self.page, '&lt;h5&gt;Kurzbeschreibung:&lt;/h5&gt;', '&lt;/div&gt;')
@@ -87,7 +99,7 @@
         self.year = gutils.after(self.year, '&quot;&gt;')
 
     def get_runtime(self):
-        self.runtime = gutils.trim(self.page, '&lt;h5&gt;L&auml;nge:&lt;/h5&gt;', ' min')
+        self.runtime = self.regextrim(self.page, '&lt;h5&gt;L[^n]+nge:&lt;/h5&gt;', ' [Mm]in')
 
     def get_genre(self):
         self.genre = gutils.trim(self.page, '&lt;h5&gt;Genre:&lt;/h5&gt;', '&lt;/div&gt;')
@@ -98,18 +110,20 @@
         self.cast = gutils.trim(self.cast_page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
         if self.cast == '':
             self.cast = gutils.trim(self.page, '&lt;table class=&quot;cast&quot;&gt;', '&lt;/table&gt;')
-        self.cast = string.replace(self.cast, ' ... ', _(' as '))
-        self.cast = string.replace(self.cast, '...', _(' as '))
+        self.cast = string.replace(self.cast, ' ... ', _(' as ').encode('utf8'))
+        self.cast = string.replace(self.cast, '...', _(' as ').encode('utf8'))
         self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr&gt;', &quot;\n&quot;)
         self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;even&quot;&gt;', &quot;\n&quot;)
         self.cast = string.replace(self.cast, '&lt;/tr&gt;&lt;tr class=&quot;odd&quot;&gt;', &quot;\n&quot;)
         self.cast = self.__before_more(self.cast)
+        self.cast = re.sub('[ ]+', ' ', self.cast)
 
     def get_classification(self):
         self.classification = gutils.trim(gutils.trim(self.page, 'Altersfreigabe:', '&lt;/div&gt;'), 'Germany:', '&amp;')
 
     def get_studio(self):
-        self.studio = gutils.trim(self.page, '&lt;h5&gt;Company:&lt;/h5&gt;', '&lt;/a&gt;')
+        self.studio = gutils.trim(self.page, '&lt;h5&gt;Firma:&lt;/h5&gt;', '&lt;/div&gt;')
+        self.studio = self.__before_more(self.studio)
 
     def get_o_site(self):
         self.o_site = ''
@@ -121,10 +135,13 @@
         self.trailer = &quot;<A HREF="http://german.imdb.com/title/tt%s/trailers">http://german.imdb.com/title/tt%s/trailers</A>&quot; % self.movie_id
 
     def get_country(self):
-        self.country = gutils.trim(self.page, '&lt;h5&gt;Produktionsland:&lt;/h5&gt;', '&lt;/div&gt;')
+        self.country = gutils.trim(self.page, '&lt;h5&gt;Land:&lt;/h5&gt;', '&lt;/div&gt;')
+        self.country = self.__before_more(self.country)
+        self.country = re.sub('[\n]+', '', self.country)
+        self.country = re.sub('[ ]+', ' ', self.country)
 
     def get_rating(self):
-        self.rating = gutils.trim(self.page, '&lt;b&gt;Nutzer-Bewertung:&lt;/b&gt;', '/10')
+        self.rating = gutils.trim(self.page, '&lt;h5&gt;Nutzer-Bewertung:&lt;/h5&gt;', '/10')
         if self.rating:
             try:
                 self.rating = str(float(gutils.clean(self.rating)))
@@ -135,48 +152,248 @@
         self.notes = ''
         language = gutils.trim(self.page, '&lt;h5&gt;Sprache:&lt;/h5&gt;', '&lt;/div&gt;')
         language = gutils.strip_tags(language)
+        language = re.sub('[\n]+', '', language)
+        language = re.sub('[ ]+', ' ', language)
+        language = language.rstrip()
         color = gutils.trim(self.page, '&lt;h5&gt;Farbe:&lt;/h5&gt;', '&lt;/div&gt;')
         color = gutils.strip_tags(color)
+        color = re.sub('[\n]+', '', color)
+        color = re.sub('[ ]+', ' ', color)
+        color = re.sub('[ ]+$', '', color)
+        color = color.rstrip()
         sound = gutils.trim(self.page, '&lt;h5&gt;Tonverfahren:&lt;/h5&gt;', '&lt;/div&gt;')
         sound = gutils.strip_tags(sound)
+        sound = re.sub('[\n]+', '', sound)
+        sound = re.sub('[ ]+', ' ', sound)
+        sound = sound.rstrip()
+        soundsplit = sound.split(' | ')
+        if len(soundsplit) &gt; 1:
+            soundsplit.sort()
+            sound = ''
+            for elem in soundsplit:
+                sound += elem + ' | '
+            sound = sound[0:len(sound) - 3]
         tagline = gutils.trim(self.page, '&lt;h5&gt;Werbezeile:&lt;/h5&gt;', '&lt;/div&gt;')
         tagline = self.__before_more(tagline)
         tagline = gutils.strip_tags(tagline)
+        tagline = re.sub('[\n]+', '', tagline)
+        tagline = re.sub('[ ]+', ' ', tagline)
+        tagline = tagline.rstrip()
         if len(language)&gt;0:
-            self.notes = &quot;%s: %s\n&quot; %(_('Language'), language)
+            self.notes = &quot;%s: %s\n&quot; %(_('Language').encode('utf8'), language)
         if len(sound)&gt;0:
-            self.notes += &quot;%s: %s\n&quot; %(gutils.strip_tags(_('&lt;b&gt;Audio&lt;/b&gt;')), sound)
+            self.notes += &quot;%s: %s\n&quot; %(gutils.strip_tags(_('&lt;b&gt;Audio&lt;/b&gt;').encode('utf8')), sound)
         if len(color)&gt;0:
-            self.notes += &quot;%s: %s\n&quot; %(_('Color'), color)
+            self.notes += &quot;%s: %s\n&quot; %(_('Color').encode('utf8'), color)
         if len(tagline)&gt;0:
             self.notes += &quot;%s: %s\n&quot; %('Tagline', tagline)
     
     def __before_more(self, data):
-        tmp = string.find(data, '&gt;mehr...&lt;')
+        tmp = string.find(data, '&gt;mehr&lt;')
         if tmp&gt;0:
             data = data[:tmp] + '&gt;'
         return data
 
+    def regextrim(self,text,key1,key2):
+        obj = re.search(key1, text)
+        if obj is None:
+            return ''
+        else:
+            p1 = obj.end()
+        obj = re.search(key2, text[p1:])
+        if obj is None:
+            return ''
+        else:
+            p2 = p1 + obj.start()
+        return text[p1:p2]
+
 class SearchPlugin(movie.SearchMovie):
-    PATTERN = re.compile(r&quot;&quot;&quot;&lt;a href=['&quot;]/title/tt([0-9]+)/[&quot;']&gt;(.*?)&lt;/td&gt;&quot;&quot;&quot;)
+    PATTERN = re.compile(r&quot;&quot;&quot;&lt;a href=['&quot;]/title/tt([0-9]+)/[&quot;']&gt;(.*?)(&lt;/td&gt;|&lt;/A&gt;)&quot;&quot;&quot;, re.IGNORECASE)
+    PATTERN_POWERSEARCH = re.compile(r&quot;&quot;&quot;Here are the [0-9]+ matching titles&quot;&quot;&quot;)
+
     def __init__(self):
         self.original_url_search    = '<A HREF="http://german.imdb.com/find?more=tt&amp;q=">http://german.imdb.com/find?more=tt&amp;q=</A>'
-        self.translated_url_search    = '<A HREF="http://german.imdb.com/find?more=tt&amp;q=">http://german.imdb.com/find?more=tt&amp;q=</A>'
+        self.translated_url_search    = '<A HREF="http://german.imdb.com/List?words=">http://german.imdb.com/List?words=</A>'
         self.encode = 'iso8859-1'
+        self.remove_accents = False
 
     def search(self,parent_window):
         self.open_search(parent_window)
-        self.page = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit');
-        self.page = self.page.decode('iso-8859-1')
+        tmp = gutils.trim(self.page, ' angezeigt)', ' Treffergenauigkeit')
+        if tmp == '':
+            if self.PATTERN_POWERSEARCH.search(self.page) is None:
+                self.page = ''
+        else:
+            self.page = tmp 
+        # correction of all &amp;#xxx entities
+        self.page = self.page.decode(self.encode)
+        self.page = gutils.convert_entities(self.page)
+        self.page = self.page.encode(self.encode)
         return self.page
 
     def get_searches(self):
         elements = string.split(self.page, '&lt;tr&gt;')
+        if len(elements) &lt; 2:
+            elements = string.split(self.page, '&lt;TR&gt;')
 
         if len(elements):
             for element in elements[1:]:
                 match = self.PATTERN.findall(element)
-                if len(match):
-                    tmp  = gutils.clean(match[0][1])
-                    self.ids.append(match[0][0])
+                for entry in match:
+                    tmp  = gutils.clean(entry[1])
+                    self.ids.append(entry[0])
                     self.titles.append(tmp)
+
+#
+# Plugin Test
+#
+class SearchPluginTest(SearchPlugin):
+    #
+    # Configuration for automated tests:
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
+    #
+    test_configuration = {
+        'Rocky Balboa'            : [ 3, 13 ],
+        'Ein gl&#252;ckliches Jahr'    : [ 1, 30 ]
+    }
+
+class PluginTest:
+    #
+    # Configuration for automated tests:
+    # dict { movie_id -&gt; dict { arribute -&gt; value } }
+    #
+    # value: * True/False if attribute only should be tested for any value
+    #        * or the expected value
+    #
+    test_configuration = {
+        '0479143' : { 
+            'title'             : 'Rocky Balboa',
+            'o_title'             : 'Rocky Balboa',
+            'director'            : 'Sylvester Stallone',
+            'plot'                 : True,
+            'cast'                : 'Sylvester Stallone' + _(' as ') + 'Rocky Balboa\n\
+Burt Young' + _(' as ') + 'Paulie Panina\n\
+Antonio Tarver' + _(' as ') + 'Mason \'The Line\' Dixon\n\
+Geraldine Hughes' + _(' as ') + 'Marie\n\
+Milo Ventimiglia' + _(' as ') + 'Robert Balboa Jr.\n\
+Tony Burton' + _(' as ') + 'Duke\n\
+A.J. Benza' + _(' as ') + 'L.C.\n\
+James Francis Kelly III' + _(' as ') + 'Steps\n\
+Talia Shire' + _(' as ') + 'Adrian (archive footage)\n\
+Lou DiBella' + _(' as ') + 'Himself\n\
+Mike Tyson' + _(' as ') + 'Himself\n\
+Henry G. Sanders' + _(' as ') + 'Martin\n\
+Pedro Lovell' + _(' as ') + 'Spider Rico\n\
+Ana Gerena' + _(' as ') + 'Isabel\n\
+Angela Boyd' + _(' as ') + 'Angie\n\
+Louis Giansante' + _(' as ') + 'Bar Thug\n\
+Maureen Schilling' + _(' as ') + 'Lucky\'s Bartender\n\
+Lahmard J. Tate' + _(' as ') + 'X-Cell (as Lahmard Tate)\n\
+Woody Paige' + _(' as ') + 'ESPN Commentator (as Woodrow W. Paige)\n\
+Skip Bayless' + _(' as ') + 'ESPN Commentator\n\
+Jay Crawford' + _(' as ') + 'ESPN Commentator\n\
+Brian Kenny' + _(' as ') + 'ESPN Host\n\
+Dana Jacobson' + _(' as ') + 'ESPN Host\n\
+Charles Johnson' + _(' as ') + 'ESPN Host (as Chuck Johnson)\n\
+James Binns' + _(' as ') + 'Commissioner (as James J. Binns)\n\
+Johnnie Hobbs Jr.' + _(' as ') + 'Commissioner\n\
+Barney Fitzpatrick' + _(' as ') + 'Commissioner\n\
+Jim Lampley' + _(' as ') + 'HBO Commentator\n\
+Larry Merchant' + _(' as ') + 'HBO Commentator\n\
+Max Kellerman' + _(' as ') + 'HBO Commentator\n\
+LeRoy Neiman' + _(' as ') + 'Himself\n\
+Bert Randolph Sugar' + _(' as ') + 'Ring Magazine Reporter\n\
+Bernard Fern&#225;ndez' + _(' as ') + 'Boxing Association of America Writer (as Bernard Fernandez)\n\
+Gunnar Peterson' + _(' as ') + 'Weightlifting Trainer\n\
+Yahya' + _(' as ') + 'Dixon\'s Opponent\n\
+Marc Ratner' + _(' as ') + 'Weigh-In Official\n\
+Anthony Lato Jr.' + _(' as ') + 'Rocky\'s Inspector\n\
+Jack Lazzarado' + _(' as ') + 'Dixon\'s Inspector\n\
+Michael Buffer' + _(' as ') + 'Ring Announcer\n\
+Joe Cortez' + _(' as ') + 'Referee\n\
+Carter Mitchell' + _(' as ') + 'Shamrock Foreman\n\
+Vinod Kumar' + _(' as ') + 'Ravi\n\
+Fran Pultro' + _(' as ') + 'Father at Restaurant\n\
+Frank Stallone' + _(' as ') + 'Dinner Patron (as Frank Stallone Jr.)\n\
+Jody Giambelluca' + _(' as ') + 'Dinner Patron\n\
+Tobias Segal' + _(' as ') + 'Robert\'s Friend\n\
+Tim Carr' + _(' as ') + 'Robert\'s Friend\n\
+Matt Frack' + _(' as ') + 'Robert\'s Friend #3\n\
+Paul Dion Monte' + _(' as ') + 'Robert\'s Friend\n\
+Kevin King Templeton' + _(' as ') + 'Robert\'s Friend (as Kevin King-Templeton)\n\
+Robert Michael Kelly' + _(' as ') + 'Mr. Tomilson\n\
+Rick Buchborn' + _(' as ') + 'Rocky Fan\n\
+Nick Baker' + _(' as ') + 'Irish Pub Bartender\n\
+Don Sherman' + _(' as ') + 'Andy\n\
+Stu Nahan' + _(' as ') + 'Computer Fight Commentator (voice)\n\
+Gary Compton' + _(' as ') + 'Security Guard\n\
+&#252;brige Besetzung in alphabetischer Reihenfolge:\n\
+Ricky Cavazos' + _(' as ') + 'Boxing Spectator (uncredited)\n\
+David Kneeream' + _(' as ') + 'Adrian\'s Patron (uncredited)\n\
+Dolph Lundgren' + _(' as ') + 'Captain Ivan Drago (archive footage) (uncredited)\n\
+Burgess Meredith' + _(' as ') + 'Mickey Goldmill (archive footage) (uncredited)\n\
+Keith Moyer' + _(' as ') + 'Bar Patron (uncredited)\n\
+Mr. T' + _(' as ') + 'Clubber Lang (archive footage) (uncredited)',
+            'country'            : 'USA',
+            'genre'                : 'Action | Sport',
+            'classification'    : False,
+            'studio'            : 'Metro-Goldwyn-Mayer (MGM)',
+            'o_site'            : False,
+            'site'                : '<A HREF="http://german.imdb.com/title/tt0479143">http://german.imdb.com/title/tt0479143</A>',
+            'trailer'            : '<A HREF="http://german.imdb.com/title/tt0479143/trailers">http://german.imdb.com/title/tt0479143/trailers</A>',
+            'year'                : 2006,
+            'notes'                : _('Language') + ': Englisch | Spanisch\n'\
++ _('Audio') + ': DTS | Dolby Digital | SDDS\n'\
++ _('Color') + ': Farbe\n\
+Tagline: It ain\'t over \'til it\'s over.',
+            'runtime'            : 102,
+            'image'                : True,
+            'rating'            : 7
+        },
+        '0069815' : { 
+            'title'             : 'Gl&#252;ckliches Jahr, Ein',
+            'o_title'             : 'Bonne ann&#233;e, La',
+            'director'            : 'Claude Lelouch',
+            'plot'                 : True,
+            'cast'                : 'Lino Ventura' + _(' as ') + 'Simon\n\
+Fran&#231;oise Fabian' + _(' as ') + 'Fran&#231;oise\n\
+Charles G&#233;rard' + _(' as ') + 'Charlot\n\
+Andr&#233; Falcon' + _(' as ') + 'Le bijoutier\n\
+Mireille Mathieu' + _(' as ') + 'Herself / Elle-m&#234;me\n\
+Lilo' + _(' as ') + 'Madame F&#233;lix\n\
+Claude Mann' + _(' as ') + 'L\'intellectuel\n\
+Fr&#233;d&#233;ric de Pasquale' + _(' as ') + 'L\'amant parisien\n\
+G&#233;rard Sire' + _(' as ') + 'Le directeur de la prison\n\
+Silvano Tranquilli' + _(' as ') + 'L\'amant italien\n\
+Andr&#233; Barello\n\
+Michel Bertay\n\
+Norman de la Chesnaye\n\
+Pierre Edeline\n\
+Pierre Pontiche\n\
+Michou' + _(' as ') + 'Himself\n\
+Bettina Rheims' + _(' as ') + 'La jeune vendeuse\n\
+Joseph Rythmann\n\
+Georges Staquet\n\
+Jacques Villedieu\n\
+Harry Walter\n\
+&#252;brige Besetzung in alphabetischer Reihenfolge:\n\
+Anouk Aim&#233;e' + _(' as ') + 'Une femme (archive footage) (uncredited)\n\
+Elie Chouraqui' + _(' as ') + '(uncredited)\n\
+R&#233;my Julienne' + _(' as ') + 'Chauffeur de taxi (uncredited)\n\
+Jean-Louis Trintignant' + _(' as ') + 'Un homme (archive footage) (uncredited)',
+            'country'            : 'France | Italy',
+            'genre'                : 'Kom&#246;die',
+            'classification'    : False,
+            'studio'            : 'Les Films 13',
+            'o_site'            : False,
+            'site'                : '<A HREF="http://german.imdb.com/title/tt0069815">http://german.imdb.com/title/tt0069815</A>',
+            'trailer'            : '<A HREF="http://german.imdb.com/title/tt0069815/trailers">http://german.imdb.com/title/tt0069815/trailers</A>',
+            'year'                : 1973,
+            'notes'                : _('Language') + ': Franz&#246;sisch\n'\
++ _('Audio') + ': Mono\n'\
++ _('Color') + ': Farbe (Eastmancolor)',
+            'runtime'            : 90,
+            'image'                : True,
+            'rating'            : 7
+        },
+    }

Modified: trunk/lib/plugins/movie/PluginMovieKinoDe.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieKinoDe.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -34,7 +34,7 @@
 plugin_language = _(&quot;German&quot;)
 plugin_author = &quot;Michael Jahn&quot;
 plugin_author_email = &quot;&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;&quot;
-plugin_version = &quot;1.11&quot;
+plugin_version = &quot;1.12&quot;
 
 class Plugin(movie.Movie):
     url_to_use = &quot;<A HREF="http://www.kino.de/kinofilm/">http://www.kino.de/kinofilm/</A>&quot;
@@ -64,7 +64,7 @@
     def get_image(self):
         self.image_url = ''
         tmpdata = self.regextrim(self.tmp_page, '(PRINT[-]CONTENT[-]START|&lt;td class=&quot;content&quot;&gt;)', '(Dieser Film wurde |&gt;FOTOSHOW&lt;|&gt;KRITIK&lt;)')
-        tmpdatasplit = re.split('src=&quot;<A HREF="http://images.kino.de/flbilder">http://images.kino.de/flbilder</A>', tmpdata)
+        tmpdatasplit = re.split('src=&quot;<A HREF="http://.+/flbilder">http://.+/flbilder</A>', tmpdata)
         if len(tmpdatasplit) &gt; 2:
             tmpdata = gutils.before(tmpdatasplit[2], '.jpg')
             if tmpdata &lt;&gt; '':
@@ -89,9 +89,9 @@
             self.title = gutils.after(self.regextrim(self.tmp_page, 'headline2&quot;[^&gt;]*&gt;[ \t\r\n]*&lt;a href=&quot;/kinofilm', '&lt;/a&gt;'), '&gt;')
 
     def get_director(self):
-        self.director = gutils.trim(self.tmp_creditspage,&quot;Regie&quot;,&quot;&lt;/a&gt;&quot;)
-        self.director = gutils.after(self.director,&quot;/star/&quot;)
-        self.director = gutils.after(self.director,&quot;&gt;&quot;)
+        self.director = self.regextrim(self.tmp_creditspage, '&gt;[ ]*Regie', '&lt;/a&gt;')
+        self.director = gutils.after(self.director, '/star/')
+        self.director = gutils.after(self.director, '&gt;')
 
     def get_plot(self):
         # little steps to perfect plot (I hope ... it's a terrible structured content ... )
@@ -159,9 +159,9 @@
         self.classification = self.regextrim(self.tmp_page,'FSK:( |&nbsp;)+', '&lt;/strong&gt;')
 
     def get_studio(self):
-        self.studio = self.regextrim(self.tmp_page, 'Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
+        self.studio = self.regextrim(self.tmp_page, '&gt;[ ]*Verleih:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
         if (self.studio == &quot;&quot;):
-            self.studio = self.regextrim(self.tmp_page, 'Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
+            self.studio = self.regextrim(self.tmp_page, '&gt;[ ]*Anbieter:( |&nbsp;)+', '( - |&nbsp;-&nbsp;)*&lt;/strong&gt;')
 
     def get_o_site(self):
         self.o_site = &quot;&quot;
@@ -306,12 +306,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -&gt; expected result count }
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'            : 6,
-        'Arahan'                : 6,
-        'Ein gl&#252;ckliches Jahr'    : 3
+        'Rocky Balboa'            : [ 6, 6 ],
+        'Arahan'                : [ 6, 6 ],
+        'Ein gl&#252;ckliches Jahr'    : [ 3, 3 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieOFDb.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieOFDb.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -159,12 +159,12 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -&gt; expected result count }
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'          : 1,
-        'Arahan'                : 3,
-        'gl&#252;ckliches'          : 4
+        'Rocky Balboa'            : [ 1, 1 ],
+        'Arahan'                : [ 3, 2 ],
+        'gl&#252;ckliches'            : [ 4, 2 ]
     }
 
 class PluginTest:

Modified: trunk/lib/plugins/movie/PluginMovieZelluloid.py
===================================================================
--- trunk/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/plugins/movie/PluginMovieZelluloid.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -34,7 +34,7 @@
 plugin_language     = _('German')
 plugin_author       = 'Michael Jahn'
 plugin_author_email = '&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">mikej06 at hotmail.com</A>&gt;'
-plugin_version      = '1.0'
+plugin_version      = '1.1'
 
 class Plugin(movie.Movie):
     index_url = '<A HREF="http://www.zelluloid.de/filme/index.php3?id=">http://www.zelluloid.de/filme/index.php3?id=</A>'
@@ -106,7 +106,7 @@
 
     def get_classification(self):
         self.classification = gutils.trim(self.detail_page, 'FSK: ', '&lt;/TD&gt;')
-        self.classification = re.sub(',.*', '', self.classification)
+        self.classification = re.sub('[,&lt;].*', '', self.classification)
 
     def get_studio(self):
         self.studio = gutils.strip_tags(gutils.trim(self.detail_page, 'alt=&quot;Produktion&quot;', '&nbsp;'))
@@ -178,11 +178,11 @@
 class SearchPluginTest(SearchPlugin):
     #
     # Configuration for automated tests:
-    # dict { movie_id -&gt; expected result count }
+    # dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
     #
     test_configuration = {
-        'Rocky Balboa'        : 1,
-        'Die wilden H&#252;hner'    : 3
+        'Rocky Balboa'        : [ 1, 1 ],
+        'Die wilden H&#252;hner'    : [ 3, 3 ]
     }
 
 class PluginTest:

Modified: trunk/lib/test_movieplugins.py
===================================================================
--- trunk/lib/test_movieplugins.py	2008-10-23 20:54:56 UTC (rev 1012)
+++ trunk/lib/test_movieplugins.py	2008-10-23 21:00:53 UTC (rev 1013)
@@ -31,12 +31,12 @@
 # dict in both cases.
 #
 # SearchPluginTest.test_configuration:
-# dict { movie_id -&gt; expected result count }
+# dict { movie_id -&gt; [ expected result count for original url, expected result count for translated url ] }
 #
 # PluginTest.test_configuration:
 # dict { movie_id -&gt; dict { arribute -&gt; value } }
 #
-# value: * True/False if attribute should only be tested for any value
+# value: * True/False if attribute should only be tested for any value or nothing
 #        * or the expected value
 #
 
@@ -63,6 +63,7 @@
     test_plugins = [
         'PluginMovieAmazon',
         'PluginMovieFilmeVonAZ',
+        'PluginMovieIMDB-de',
         'PluginMovieKinoDe',
         'PluginMovieOFDb',
         'PluginMovieZelluloid',
@@ -72,9 +73,11 @@
     # simulates the search for a movie title and compares
     # the count of results with the expected count
     #
-    def test_search(self, plugin, title, cnt):
+    def test_search(self, plugin, title, cntOriginal, cntTranslated):
         global myconfig
+        result = True
         plugin.config = myconfig
+        # plugin.translated_url_search
         plugin.url = plugin.translated_url_search
         if plugin.remove_accents:
             plugin.title = gutils.remove_accents(title, 'utf-8')
@@ -82,10 +85,21 @@
             plugin.title = title
         plugin.search(None)
         plugin.get_searches()
-        if not len(plugin.ids) - 1 == cnt:    # first entry is always '' (???)
-            print &quot;Title: %s - expected: %d - found: %d&quot; % (title, cnt, len(plugin.ids) - 1)
-            return False
-        return True
+        if not len(plugin.ids) - 1 == cntOriginal:	# first entry is always '' (???)
+            print &quot;Title (Translated): %s - expected: %d - found: %d&quot; % (title, cntOriginal, len(plugin.ids) - 1)
+            result = False
+        # plugin.original_url_search
+        plugin.url = plugin.original_url_search
+        if plugin.remove_accents:
+            plugin.title = gutils.remove_accents(title, 'utf-8')
+        else:
+            plugin.title = title
+        plugin.search(None)
+        plugin.get_searches()
+        if not len(plugin.ids) - 1 == cntTranslated:	# first entry is always '' (???)
+            print &quot;Title (Original): %s - expected: %d - found: %d&quot; % (title, cntTranslated, len(plugin.ids) - 1)
+            result = False
+        return result
 
     #
     # check every configured movie title
@@ -103,7 +117,7 @@
         if not pluginTestConfig == None:
             for i in pluginTestConfig.test_configuration:
                 searchPlugin = plugin.SearchPlugin()
-                if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i]):
+                if not self.test_search(searchPlugin, i, pluginTestConfig.test_configuration[i][0], pluginTestConfig.test_configuration[i][1]):
                     result = False
                 sleep(1) # needed for amazon
         
@@ -276,4 +290,8 @@
 #
 # Start the tests
 #
+gtk.gdk.threads_init()
+gtk.gdk.threads_enter()
 PluginTester().do_test()
+#gtk.main()
+gtk.gdk.threads_leave()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000492.html">[Griffith-svn] r1012 - in trunk: . glade lib
</A></li>
	<LI>Next message: <A HREF="000494.html">[Griffith-svn] r1014 - in trunk: . glade lib lib/plugins/export	lib/plugins/imp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#493">[ date ]</a>
              <a href="thread.html#493">[ thread ]</a>
              <a href="subject.html#493">[ subject ]</a>
              <a href="author.html#493">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/griffith-svn">More information about the Griffith-svn
mailing list</a><br>
</body></html>
