<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Griffith-svn] r730 - in trunk: . data debian lib
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/griffith-svn/2007-February/index.html" >
   <LINK REL="made" HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r730%20-%20in%20trunk%3A%20.%20data%20debian%20lib&In-Reply-To=%3C200702122031.l1CKVn1E020635%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000249.html">
   <LINK REL="Next"  HREF="000251.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Griffith-svn] r730 - in trunk: . data debian lib</H1>
    <B>piotrek at BerliOS</B> 
    <A HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r730%20-%20in%20trunk%3A%20.%20data%20debian%20lib&In-Reply-To=%3C200702122031.l1CKVn1E020635%40sheep.berlios.de%3E"
       TITLE="[Griffith-svn] r730 - in trunk: . data debian lib">piotrek at mail.berlios.de
       </A><BR>
    <I>Mon Feb 12 21:31:49 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000249.html">[Griffith-svn] r729 - in trunk: . lib
</A></li>
        <LI>Next message: <A HREF="000251.html">[Griffith-svn] r731 - in trunk: . lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#250">[ date ]</a>
              <a href="thread.html#250">[ thread ]</a>
              <a href="subject.html#250">[ subject ]</a>
              <a href="author.html#250">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: piotrek
Date: 2007-02-12 21:31:48 +0100 (Mon, 12 Feb 2007)
New Revision: 730

Modified:
   trunk/ChangeLog
   trunk/NEWS
   trunk/README
   trunk/data/griffith.desktop
   trunk/debian/changelog
   trunk/lib/dbupgrade.py
   trunk/lib/main_treeview.py
   trunk/lib/version.py
   trunk/winpackage.iss
   trunk/winsetup.py
Log:
prepare 0.9.1 release


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/ChangeLog	2007-02-12 20:31:48 UTC (rev 730)
@@ -4,19 +4,24 @@
 ------------------
 (c) 2005-2007  Vasco Nunes, Piotr O&#380;arowski
 
+---- 0.9.1 ---
+
 2007-02-11  Piotr O&#380;arowski
 	* Fix one more bad case in upgrade function
 	* Fix setting loan status in upgrade function
 
-2007-02-03 Jessica K. Parth
+2007-02-03  Jessica K. Parth
 	* OFDb movie plugin updated (website changed)
 
+2007-01-27  Piotr O&#380;arowski
+	* English translation fixes (thanks Frijolie)
+
 ---- 0.9 ---
 
 2007-01-26  Piotr O&#380;arowski
 	* WP and Filmweb movie plugins updated
 
-2007-01-26 Jessica K. Parth
+2007-01-26  Jessica K. Parth
 	* Fix AniDB Problems in Windows ( file-open problem in movie.py )
 
 2007-01-25  Piotr O&#380;arowski

Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/NEWS	2007-02-12 20:31:48 UTC (rev 730)
@@ -1,3 +1,11 @@
+Griffith 0.9.1
+==============
+Loan data is now imported correctly from old database.
+Please change &quot;griffith.db&quot; into &quot;griffith.gri&quot; in griffith.conf file to redo the upgrade process.
+On Linux you can do that with this simple command:
+`sed -ie 's/griffith.db/griffith.gri/' ~/griffith.conf`
+
+
 Griffith 0.9
 ============
 * Possible memory leak fixed (year data from some movie plugins wasn't parsed

Modified: trunk/README
===================================================================
--- trunk/README	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/README	2007-02-12 20:31:48 UTC (rev 730)
@@ -1,5 +1,5 @@
-Griffith 0.9 README
-===================
+Griffith 0.9.1 README
+=====================
 
 This document was last updated on Thu Jan 09 2007.
 Please see the file COPYING for licensing and warranty information.

Modified: trunk/data/griffith.desktop
===================================================================
--- trunk/data/griffith.desktop	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/data/griffith.desktop	2007-02-12 20:31:48 UTC (rev 730)
@@ -2,7 +2,7 @@
 Name=Griffith
 GenericName=Griffith - Movie Collection Manager
 Comment=Movie Collection Manager
-Version=0.9
+Version=0.9.1
 Encoding=UTF-8
 Exec=griffith
 Icon=griffith.png

Modified: trunk/debian/changelog
===================================================================
--- trunk/debian/changelog	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/debian/changelog	2007-02-12 20:31:48 UTC (rev 730)
@@ -1,3 +1,9 @@
+griffith (0.9.1-1) unstable; urgency=low
+
+  * New upstream release
+
+ -- Piotr Ozarowski &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">ozarow at gmail.com</A>&gt;  Mon, 12 Feb 2007 21:30:40 +0100
+
 griffith (0.9-1) unstable; urgency=low
 
   * New upstream release

Modified: trunk/lib/dbupgrade.py
===================================================================
--- trunk/lib/dbupgrade.py	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/lib/dbupgrade.py	2007-02-12 20:31:48 UTC (rev 730)
@@ -403,6 +403,7 @@
 		l.date = str(i[4])[:10]
 		if not_returned:
 			m.loaned = True
+			l.return_date = None
 		else:
 			l.return_date = str(i[5])[:10]
 		

Modified: trunk/lib/main_treeview.py
===================================================================
--- trunk/lib/main_treeview.py	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/lib/main_treeview.py	2007-02-12 20:31:48 UTC (rev 730)
@@ -153,15 +153,15 @@
 	else:
 		tmp = '0'
 	if item.has_key('medium_id') and item['medium_id']:
-		try:
-			tmp += ' x ' + item['medium'].name
-		except:
+		if item.medium is not None:
+			tmp += ' x ' + item.medium.name
+		else:
 			pass
 	w['medium'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; % gutils.html_encode(tmp))
 	if item.has_key('vcodec_id'):
-		try:
-			w['vcodec'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; % gutils.html_encode(item['vcodec'].name))
-		except:
+		if item.vcodec is not None:
+			w['vcodec'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; % gutils.html_encode(item.vcodec.name))
+		else:
 			w['vcodec'].set_text('')
 	else:
 		w['vcodec'].set_text('')
@@ -220,12 +220,15 @@
 		w['return_button'].set_sensitive(True)
 		
 		data_loan = get_loan_info(self.db, collection_id=item['collection_id'], volume_id=item['volume_id'], movie_id=item['movie_id'])
-		data_person = self.db.Person.get_by(person_id=data_loan.person.person_id)
-		self.person_name = str(data_person.name)
-		self.person_email = str(data_person.email)
-		self.loan_date = str(data_loan.date)
-		w['loan_info'].set_label(_(&quot;This movie has been loaned to &quot;) + self.person_name + _(&quot; on &quot;) + self.loan_date[:10])
-	else:
+		if data_loan is None:
+			item.loaned = False
+		else:
+			data_person = self.db.Person.get_by(person_id=data_loan.person.person_id)
+			self.person_name = str(data_person.name)
+			self.person_email = str(data_person.email)
+			self.loan_date = str(data_loan.date)
+			w['loan_info'].set_label(_(&quot;This movie has been loaned to &quot;) + self.person_name + _(&quot; on &quot;) + self.loan_date[:10])
+	if item.has_key('loaned') and item['loaned'] != True: # &quot;loaned&quot; status can be changed above, so don't use &quot;else:&quot; in this line
 		self.widgets['popups']['loan'].set_sensitive(True)
 		self.widgets['popups']['email'].set_sensitive(False)
 		self.widgets['popups']['return'].set_sensitive(False)

Modified: trunk/lib/version.py
===================================================================
--- trunk/lib/version.py	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/lib/version.py	2007-02-12 20:31:48 UTC (rev 730)
@@ -23,8 +23,8 @@
 
 from gettext import gettext as _
 pname        = &quot;Griffith&quot;
-pversion     = &quot;0.9+svn&quot;
-pauthor      = &quot;Vasco Nunes &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">vasco.m.nunes at gmail.com</A>&gt;, Piotr O&#380;arowski &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">ozarow+griffith at gmail.com</A>&gt;&quot;
+pversion     = &quot;0.9.1&quot;
+pauthor      = &quot;Vasco Nunes, Piotr O&#380;arowski &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">griffith-private at lists.berlios.de</A>&gt;&quot;
 pyear        = &quot;2005-2007&quot;
 pwebsite     = &quot;<A HREF="http://griffith.berlios.de/">http://griffith.berlios.de/</A>&quot;
 pdescription = _(&quot;Griffith is a film collection manager.&quot;)

Modified: trunk/winpackage.iss
===================================================================
--- trunk/winpackage.iss	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/winpackage.iss	2007-02-12 20:31:48 UTC (rev 730)
@@ -3,7 +3,7 @@
 
 [Setup]
 AppName=Griffith
-AppVerName=Griffith 0.9
+AppVerName=Griffith 0.9.1
 AppPublisher=Vasco Nunes, Piotr O&#380;arowski
 AppPublisherURL=<A HREF="http://griffith.berlios.de/">http://griffith.berlios.de/</A>
 AppSupportURL=<A HREF="http://griffith.berlios.de/">http://griffith.berlios.de/</A>
@@ -14,7 +14,7 @@
 LicenseFile=C:\griffith\COPYING
 InfoAfterFile=C:\griffith\README
 OutputDir=C:\griffith\installer
-OutputBaseFilename=griffith-0.9-win32
+OutputBaseFilename=griffith-0.9.1-win32
 SetupIconFile=C:\griffith\images\griffith.ico
 Compression=lzma
 SolidCompression=true
@@ -22,7 +22,7 @@
 InternalCompressLevel=ultra
 AppCopyright=Vasco Nunes/Piotr Ozarowski
 DisableStartupPrompt=false
-AppVersion=0.9
+AppVersion=0.9.1
 
 [Languages]
 Name: eng; MessagesFile: compiler:Default.isl

Modified: trunk/winsetup.py
===================================================================
--- trunk/winsetup.py	2007-02-12 00:12:43 UTC (rev 729)
+++ trunk/winsetup.py	2007-02-12 20:31:48 UTC (rev 730)
@@ -54,7 +54,7 @@
 
 setup(
     name = &quot;Griffith&quot;,
-    version = &quot;0.9&quot;,
+    version = &quot;0.9.1&quot;,
 	description = 'Griffith - A film manager',
     author = 'Vasco Nunes/Piotr Ozarowski',
     author_email = '<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">vasco.m.nunes at gmail.com</A>',


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000249.html">[Griffith-svn] r729 - in trunk: . lib
</A></li>
	<LI>Next message: <A HREF="000251.html">[Griffith-svn] r731 - in trunk: . lib
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#250">[ date ]</a>
              <a href="thread.html#250">[ thread ]</a>
              <a href="subject.html#250">[ subject ]</a>
              <a href="author.html#250">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/griffith-svn">More information about the Griffith-svn
mailing list</a><br>
</body></html>
