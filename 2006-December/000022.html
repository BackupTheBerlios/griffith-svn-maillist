<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Griffith-svn] r490 - in griffith: . glade lib lib/plugins	lib/plugins/export lib/plugins/imp lib/plugins/movie
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/griffith-svn/2006-December/index.html" >
   <LINK REL="made" HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r490%20-%20in%20griffith%3A%20.%20glade%20lib%20lib/plugins%0A%09lib/plugins/export%20lib/plugins/imp%20lib/plugins/movie&In-Reply-To=%3C200612080359.kB83xaBq030769%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000021.html">
   <LINK REL="Next"  HREF="000023.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Griffith-svn] r490 - in griffith: . glade lib lib/plugins	lib/plugins/export lib/plugins/imp lib/plugins/movie</H1>
    <B>piotrek at BerliOS</B> 
    <A HREF="mailto:griffith-svn%40lists.berlios.de?Subject=Re%3A%20%5BGriffith-svn%5D%20r490%20-%20in%20griffith%3A%20.%20glade%20lib%20lib/plugins%0A%09lib/plugins/export%20lib/plugins/imp%20lib/plugins/movie&In-Reply-To=%3C200612080359.kB83xaBq030769%40sheep.berlios.de%3E"
       TITLE="[Griffith-svn] r490 - in griffith: . glade lib lib/plugins	lib/plugins/export lib/plugins/imp lib/plugins/movie">piotrek at mail.berlios.de
       </A><BR>
    <I>Fri Dec  8 04:59:36 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000021.html">[Griffith-svn] r489 - in griffith: . lib/plugins/movie
</A></li>
        <LI>Next message: <A HREF="000023.html">[Griffith-svn] r491 - griffith/lib/plugins/movie
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22">[ date ]</a>
              <a href="thread.html#22">[ thread ]</a>
              <a href="subject.html#22">[ subject ]</a>
              <a href="author.html#22">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: piotrek
Date: 2006-12-08 04:59:34 +0100 (Fri, 08 Dec 2006)
New Revision: 490

Added:
   griffith/lib/plugins/__init__.py
   griffith/lib/plugins/export/__init__.py
   griffith/lib/plugins/imp/
   griffith/lib/plugins/imp/CSV.py
   griffith/lib/plugins/imp/__init__.py
   griffith/lib/plugins/movie/__init__.py
Removed:
   griffith/lib/plugins/import/
Modified:
   griffith/glade/import.glade
   griffith/griffith
   griffith/lib/initialize.py
Log:
import plugin system in beta version now (should work ;)


Modified: griffith/glade/import.glade
===================================================================
--- griffith/glade/import.glade	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/glade/import.glade	2006-12-08 03:59:34 UTC (rev 490)
@@ -42,7 +42,6 @@
 	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
 	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
-	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_cancelbutton_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:26:38 GMT&quot;/&gt;
 	    &lt;/widget&gt;
 	  &lt;/child&gt;
 
@@ -56,7 +55,6 @@
 	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
 	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
-	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_import_button_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:27:17 GMT&quot;/&gt;
 	    &lt;/widget&gt;
 	  &lt;/child&gt;
 	&lt;/widget&gt;
@@ -488,8 +486,8 @@
 	  &lt;child&gt;
 	    &lt;widget class=&quot;GtkFileChooserWidget&quot; id=&quot;fcw&quot;&gt;
 	      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;width_request&quot;&gt;300&lt;/property&gt;
-	      &lt;property name=&quot;height_request&quot;&gt;100&lt;/property&gt;
+	      &lt;property name=&quot;width_request&quot;&gt;400&lt;/property&gt;
+	      &lt;property name=&quot;height_request&quot;&gt;250&lt;/property&gt;
 	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;action&quot;&gt;GTK_FILE_CHOOSER_ACTION_OPEN&lt;/property&gt;
 	      &lt;property name=&quot;local_only&quot;&gt;True&lt;/property&gt;
@@ -526,186 +524,96 @@
 	  &lt;/child&gt;
 
 	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox1&quot;&gt;
-	      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
+	    &lt;widget class=&quot;GtkFrame&quot; id=&quot;frame1&quot;&gt;
+	      &lt;property name=&quot;border_width&quot;&gt;8&lt;/property&gt;
 	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_ETCHED_IN&lt;/property&gt;
 
 	      &lt;child&gt;
-		&lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow1&quot;&gt;
+		&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment1&quot;&gt;
 		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_AUTOMATIC&lt;/property&gt;
-		  &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_AUTOMATIC&lt;/property&gt;
-		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
-		  &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_padding&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		  &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
 
 		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkTreeView&quot; id=&quot;tv_csv_available&quot;&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox1&quot;&gt;
 		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;headers_visible&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;rules_hint&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;reorderable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;enable_search&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;fixed_height_mode&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;hover_selection&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;hover_expand&quot;&gt;False&lt;/property&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
 
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkVButtonBox&quot; id=&quot;vbuttonbox1&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_SPREAD&lt;/property&gt;
-		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;box_import_1&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
 
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_csv_add&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot;&gt;gtk-go-forward&lt;/property&gt;
-		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NONE&lt;/property&gt;
-		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_csv_add_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:14:08 GMT&quot;/&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
+			  &lt;child&gt;
+			    &lt;placeholder/&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
 
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_csv_remove&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot;&gt;gtk-go-back&lt;/property&gt;
-		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NONE&lt;/property&gt;
-		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_csv_remove_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:14:13 GMT&quot;/&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;box_import_2&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
 
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_csv_move_up&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot;&gt;gtk-go-up&lt;/property&gt;
-		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NONE&lt;/property&gt;
-		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_csv_move_up_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:14:18 GMT&quot;/&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
+			  &lt;child&gt;
+			    &lt;placeholder/&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
 
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_csv_move_down&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot;&gt;gtk-go-down&lt;/property&gt;
-		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NONE&lt;/property&gt;
-		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_csv_move_down_clicked&quot; last_modification_time=&quot;Wed, 06 Dec 2006 19:14:24 GMT&quot;/&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;padding&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;box_import_3&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
 
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow2&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_AUTOMATIC&lt;/property&gt;
-		  &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_AUTOMATIC&lt;/property&gt;
-		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
-		  &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkTreeView&quot; id=&quot;tv_csv_selected&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;headers_visible&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;rules_hint&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;reorderable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;enable_search&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;fixed_height_mode&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;hover_selection&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;hover_expand&quot;&gt;False&lt;/property&gt;
+			  &lt;child&gt;
+			    &lt;placeholder/&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
 		    &lt;/widget&gt;
 		  &lt;/child&gt;
 		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		&lt;/packing&gt;
 	      &lt;/child&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;tab_fill&quot;&gt;True&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
 
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label34&quot;&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Fields&lt;/property&gt;
-	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;type&quot;&gt;tab&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkTable&quot; id=&quot;table3&quot;&gt;
-	      &lt;property name=&quot;border_width&quot;&gt;8&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;n_rows&quot;&gt;7&lt;/property&gt;
-	      &lt;property name=&quot;n_columns&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;row_spacing&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;column_spacing&quot;&gt;2&lt;/property&gt;
-
 	      &lt;child&gt;
-		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label24&quot;&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label35&quot;&gt;
 		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Delimeter&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;b&gt;Import only fields selected below&lt;/b&gt;&lt;/property&gt;
 		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
 		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
 		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
 		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
 		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
 		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
 		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
@@ -715,273 +623,9 @@
 		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
 		&lt;/widget&gt;
 		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
 		&lt;/packing&gt;
 	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label25&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Quote character&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label26&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Escape character&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label23&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Dialect&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label32&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Line terminator&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;5&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;cb_csv_doublequote&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Double quote&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;5&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;6&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;cb_csv_skipinitialspace&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Skip initial space&lt;/property&gt;
-		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;6&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;7&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkComboBox&quot; id=&quot;combo_csv_dialect&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;items&quot;&gt;&lt;/property&gt;
-		  &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_csv_delimeter&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;text&quot;&gt;,&lt;/property&gt;
-		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_csv_quotechar&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&quot;&lt;/property&gt;
-		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;1&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_csv_escapechar&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;width_chars&quot;&gt;1&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_csv_line_terminator&quot;&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;\r\n&lt;/property&gt;
-		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;5&lt;/property&gt;
-		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-		&lt;/packing&gt;
-	      &lt;/child&gt;
 	    &lt;/widget&gt;
 	    &lt;packing&gt;
 	      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
@@ -990,9 +634,9 @@
 	  &lt;/child&gt;
 
 	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;l_data&quot;&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label34&quot;&gt;
 	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot;&gt;CSV&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Fields&lt;/property&gt;
 	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
 	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
 	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;

Modified: griffith/griffith
===================================================================
--- griffith/griffith	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/griffith	2006-12-08 03:59:34 UTC (rev 490)
@@ -119,32 +119,11 @@
 		export_plugin.ExportPlugin(self.db, self.locations, self.widgets['window'], self.debug)
 
 	def on_import_activate(self, *args):
-		initialize.import_plugins(self)
+		if self.widgets.has_key('import'):
+			self.widgets['import']['window'].show()
+		else:
+			initialize.import_plugins(self)
 
-	def on_import_plugin_changed(self, *args):
-		w = self.widgets['import']
-		plugin_name = w['plugin'].get_active_text()
-		ip = __import__('PluginImport%s' % plugin_name)
-		w['author'].set_text(ip.ImportPlugin.author)
-		w['email'].set_text(ip.ImportPlugin.email)
-		w['version'].set_text(ip.ImportPlugin.version)
-		w['description'].set_text(ip.ImportPlugin.description)
-	
-	def on_import_button_clicked(self, *args):
-		plugin_name = self.widgets['import']['plugin'].get_active_text()
-		ip = __import__('PluginImport%s' % plugin_name)
-		ip = ip.ImportPlugin(self)
-		if ip.initialize():
-			total = ip.count_movies()
-			# TODO: show progres bar
-			ip.run()
-			gutils.info(self, _(&quot;%s file has been imported. %s movies added.&quot;) \
-				% (ip.name, ip.imported), self.widgets['window'])
-			ip.clear()
-			self.populate_treeview()
-	def on_cancel_button_clicked(self, *args):
-		self.widgets['import']['window'].hide()
-
 	def destroy(self, widget, data=None):
 		self.save_state()
 		gtk.main_quit()

Modified: griffith/lib/initialize.py
===================================================================
--- griffith/lib/initialize.py	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/lib/initialize.py	2006-12-08 03:59:34 UTC (rev 490)
@@ -339,59 +339,50 @@
 	dinamically finds the available import plugins
 	and fills the import menu entry
 	&quot;&quot;&quot;
-	# glade
 	
-	if self.widgets.has_key('import'):
-		self.debug('Import plugins already initialized')
-		return False
-
+	import plugins.imp, math
+	# glade
 	glade_file = gtk.glade.XML(os.path.join(self.locations['glade'], 'import.glade'))
 	get = lambda x: glade_file.get_widget(x)
 	
 	w = self.widgets['import'] = {
 		'window'	: get('dialog_import'),
 		'fcw'		: get('fcw'),
-		'notebook'	: get('notebook'),
 		'plugin'	: get('combo_plugin'),
 		'author'	: get('l_author'),
 		'email'		: get('l_email'),
 		'version'	: get('l_version'),
 		'description'	: get('l_description'),
-		'available'	: get('tv_csv_available'),
-		'selected'	: get('tv_csv_selected'),
-		'csv'		: {
-			'dialect'		: get('combo_csv_dialect'),
-			'delimeter'		: get('entry_csv_delimeter'),
-			'quotechar'		: get('entry_csv_quotechar'),
-			'escapechar'		: get('entry_csv_escapechar'),
-			'line_terminator'	: get('entry_csv_line_terminator'),
-			'doublequote'		: get('cb_csv_doublequote'),
-			'skipinitialspace'	: get('cb_csv_skipinitialspace'),
-		}
+		'box_import_1'	: get('box_import_1'),
+		'box_import_2'	: get('box_import_2'),
+		'box_import_3'	: get('box_import_3'),
+		'fields'	: {},
 	}
+	get('cancel_button').connect('clicked', lambda x: w['window'].hide())
+	get('import_button').connect('clicked', plugins.imp.on_import_button_clicked, self)
+	w['plugin'].connect('changed', plugins.imp.on_import_plugin_changed, w)
 	
-	# TODO:
-	glade_file.signal_autoconnect({
-		'on_import_button_clicked'	: self.on_import_button_clicked,
-		'on_cancel_button_clicked'	: self.on_cancel_button_clicked,
-		'on_import_plugin_changed'	: self.on_import_plugin_changed,
-	})
-	
-	plugins = gutils.read_plugins('PluginImport', \
-		self.locations['import_plugins'])
-	plugins.sort()
-	for p in plugins:
-		plugin_module = os.path.basename(p).replace('.py', '')
-		plugin_name = plugin_module.replace('PluginImport', '')
-		w['plugin'].append_text(plugin_name)
+	for name in plugins.imp.__all__:
+		w['plugin'].append_text(name)
 	w['plugin'].set_active(0)
-	import csv
-	for i in csv.list_dialects():
-		w['csv']['dialect'].append_text(i)
-	w['csv']['dialect'].set_active(1) # Excell
-#	for i in self.field_names:
-#		# add row
 	
+	# fields to import
+	j = 0
+	k = math.ceil( len(self.field_names) / float(3) )
+	for i in self.field_names:
+		j = j + 1
+		w['fields'][i] = gtk.CheckButton(self.field_names[i])
+		w['fields'][i].set_active(True) # TODO: get from config
+		if j &lt;= k:
+			w['box_import_1'].add(w['fields'][i])
+		elif j&lt;= 2*k:
+			w['box_import_2'].add(w['fields'][i])
+		else:
+			w['box_import_3'].add(w['fields'][i])
+	w['box_import_1'].show_all()
+	w['box_import_2'].show_all()
+	w['box_import_3'].show_all()
+	
 
 def people_treeview(self, create=True):
 	row = None

Added: griffith/lib/plugins/__init__.py
===================================================================
--- griffith/lib/plugins/__init__.py	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/lib/plugins/__init__.py	2006-12-08 03:59:34 UTC (rev 490)
@@ -0,0 +1 @@
+__all__ = ['export', 'imp', 'movie']


Property changes on: griffith/lib/plugins/__init__.py
___________________________________________________________________
Name: svn:keywords
   + Id

Added: griffith/lib/plugins/export/__init__.py
===================================================================


Property changes on: griffith/lib/plugins/export/__init__.py
___________________________________________________________________
Name: svn:keywords
   + Id

Added: griffith/lib/plugins/imp/CSV.py
===================================================================
--- griffith/lib/plugins/imp/CSV.py	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/lib/plugins/imp/CSV.py	2006-12-08 03:59:34 UTC (rev 490)
@@ -0,0 +1,102 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+###########################################################################
+#    Copyright (C) 2006 by Jessica Katharina Parth                         
+#    &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">Jessica.K.P at women-at-work.org</A>&gt;                                                 
+#
+# Copyright: See COPYING file that comes with this distribution
+#
+###########################################################################
+
+from gettext import gettext as _
+from plugins.imp import ImportPlugin
+
+def digits_only(s):
+	import string, re
+	_match = re.compile(r&quot;\d+&quot;)
+	try:
+		s = reduce( string.join, _match.findall(s) )
+	except:
+		s = '0'
+	return s
+	
+class ImportPlugin(ImportPlugin):
+	description	= _(&quot;Full CSV list import plugin&quot;)
+	author		= &quot;Jessica Katharina Parth&quot;
+	email		= &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/griffith-svn">Jessica.K.P at women-at-work.org</A>&quot;
+	version		= &quot;0.1&quot;
+	file_filters	= '*.[cC][sS][vV]'
+	mime_types	= ('text/comma-separated-values', 'text/csv', 'application/csv',
+			'application/excel', 'application/vnd.ms-excel', 'application/vnd.msexcel')
+
+	def initialize(self):
+		import gtk, gutils
+		# TODO: configure csv.reader
+		return True
+
+	def set_source(self, name):
+		import csv, codecs, os
+		if name is None or not os.path.isfile(name):
+			return False
+		self.__source_name = name
+		self.data = csv.reader(codecs.open(name, 'r', 'iso-8859-1'), dialect='excel', quotechar='&quot;', delimiter=',')
+		return True
+
+	def count_movies(self):
+		return len(open(self.__source_name).readlines()) # FIXME
+	
+	def get_movie_details(self, item):
+		from add import validate_details
+		x = 0
+		
+		t_movies = {
+			'classification' : item[8],
+			'color'          : None,
+			'cond'           : None,
+			'country'        : None,
+			'director'       : None,
+			'genre'          : item[4],
+			'image'          : None,
+			'layers'         : None,
+			'media_num'      : int(digits_only(item[0])),
+			'number'         : None,
+			'o_site'         : None,
+			'o_title'        : item[7],
+			'rating'         : None,
+			'region'         : None,
+			'runtime'        : digits_only(item[3]),
+			'seen'           : None, #bool(row[x]),
+			'site'           : None,
+			'studio'         : None,
+			'title'          : item[1],
+			'trailer'        : None,
+			'year'           : digits_only(item[2]),
+			'collection_id'  : None, #self.collection_combo_ids[],
+			'volume_id'      : None, #self.volume_combo_ids[],
+			'cast'           : item[6],
+			'notes'          : None,
+			'plot'           : item[5],
+		}
+		
+		# languages
+#		from sets import Set as set # for python2.3 compatibility
+#		t_movies['languages'] = set()
+#		for lang in item[x]:
+#			lang_id   = item[x]
+#			lang_type = item[x]
+#			acodec    = item[x]
+#			achannel  = item[x]
+#			subformat = item[x]
+#			t_movies['languages'].add((lang_id, lang_type, acodec, achannel, subformat))
+	
+		# tags
+#		t_movies['tags'] = {}
+#		if item[x] == True:
+#			t_movies['tags'][0] = 1
+		
+		validate_details(t_movies)
+
+		return t_movies
+	


Property changes on: griffith/lib/plugins/imp/CSV.py
___________________________________________________________________
Name: svn:keywords
   + Id

Added: griffith/lib/plugins/imp/__init__.py
===================================================================
--- griffith/lib/plugins/imp/__init__.py	2006-12-08 01:06:09 UTC (rev 489)
+++ griffith/lib/plugins/imp/__init__.py	2006-12-08 03:59:34 UTC (rev 490)
@@ -0,0 +1,183 @@
+# -*- coding: UTF-8 -*-
+
+__revision__ = '$Id$'
+
+# Copyright (c) 2006 Piotr O&#380;arowski
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published byp
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
+
+# You may use and distribute this software under the terms of the
+# GNU General Public License, version 2 or later
+
+# detect all plugins:
+import glob, os.path
+from gettext import gettext as _
+
+__all__ = [os.path.basename(x)[:-3] for x in glob.glob(&quot;%s/*.py&quot; % os.path.dirname(__file__))]
+__all__.remove('__init__')
+
+class ImportPlugin:
+	description = None
+	author = None
+	email = None
+	version = None
+	# file chooser:
+	file_filters = None
+	mime_types = None
+
+	edit = False		# open add window for every movie?
+
+	imported = 0
+	data = None
+
+	def __init__(self, parent, fields_to_import):
+		self.db = parent.db
+		self.locations = parent.locations
+		self.parent = parent
+		self.fields_to_import = fields_to_import
+		global debug
+		debug = self.debug = self.parent.debug
+
+	def initialize(self, filename):
+		&quot;&quot;&quot;
+		Initializes plugin (get all parameters from user, etc.)
+		&quot;&quot;&quot;
+		self.imported = 0
+		return True
+
+	def set_source(self, name):
+		&quot;&quot;&quot;
+		Prepare source (open file, etc.)
+
+		this function will prepare self.data for processing
+		&quot;&quot;&quot;
+
+	def count_movies(self):
+		&quot;&quot;&quot;
+		Returns number of movies in file which is about to be imported
+		&quot;&quot;&quot;
+		pass
+
+	def get_movie_details(self, item):
+		&quot;&quot;&quot;
+		Returns dictionary with movie details (process data item)
+		&quot;&quot;&quot;
+		pass
+
+	def run(self, name):
+		&quot;&quot;&quot;
+		Import movies
+		&quot;&quot;&quot;
+		
+		if self.edit is True:
+			from add import edit_movie
+		else:
+			from gutils import find_next_available
+		
+		if not self.set_source(name):
+			debug.show(&quot;Can't read data from file %s&quot; % name)
+			return False
+		
+		for item in self.data:
+			details = self.get_movie_details(item)
+			if details is None:
+				continue
+			if details['o_title'] or details['title']:
+				if details['o_title']:
+					tmp_movie = self.db.Movie.get_by(o_title=details['o_title'])
+					if tmp_movie is not None:
+						debug.show(&quot;movie already exists (o_title=%s)&quot; % details['o_title'])
+						continue
+				if details['title']:
+					tmp_movie = self.db.Movie.get_by(title=details['title'])
+					if tmp_movie is not None:
+						debug.show(&quot;movie already exists (title=%s)&quot; % details['title'])
+						continue
+				if details.has_key('number') and self.fields_to_import.has_key('number') is True:
+					details['number'] = None
+				if self.edit is True:
+					edit_movie(self.parent, details)	# FIXME: wait until save or cancel button pressed
+				else:
+					if details['number'] is None:
+						details['number'] = find_next_available(self.parent)
+					movie = self.db.Movie()
+					movie.add_to_db(details)
+				self.imported += 1 # FIXME: what about cancel button in edit window
+			else:
+				debug('skipping movie without title or original title')
+		return True
+
+	def clear(self):
+		self.data = None
+		self.imported = 0
+		self.__source_name = None
+
+
+def on_import_plugin_changed(combobox, widgets, *args):
+	from gtk import FileFilter
+	import plugins.imp
+	plugin_name = widgets['plugin'].get_active_text()
+	__import__(&quot;plugins.imp.%s&quot; % plugin_name)
+	ip = eval(&quot;plugins.imp.%s.ImportPlugin&quot; % plugin_name)
+	widgets['author'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; % ip.author)
+	widgets['email'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; % ip.email)
+	widgets['version'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; %ip.version)
+	widgets['description'].set_markup(&quot;&lt;i&gt;%s&lt;/i&gt;&quot; %ip.description)
+	# file filters
+	for i in widgets['fcw'].list_filters():
+		widgets['fcw'].remove_filter(i)
+	f = FileFilter()
+	f.set_name(plugin_name)
+	if ip.file_filters is not None:
+		if isinstance(ip.file_filters, tuple) or isinstance(ip.file_filters, list):
+			for i in ip.file_filters:
+				f.add_pattern(i)
+		else:
+			f.add_pattern(ip.file_filters)
+	if ip.mime_types is not None:
+		if isinstance(ip.mime_types, tuple) or isinstance(ip.mime_types, list):
+			for i in ip.mime_types:
+				f.add_mime_type(i)
+		else:
+			f.add_mime_type(ip.mime_types)
+	widgets['fcw'].add_filter(f)
+	f = FileFilter()
+	f.set_name(_(&quot;All files&quot;))
+	f.add_pattern(&quot;*&quot;)
+	widgets['fcw'].add_filter(f)
+
+def on_import_button_clicked(button, self, *args):
+	import plugins.imp, gutils
+	plugin_name = self.widgets['import']['plugin'].get_active_text()
+	filename = self.widgets['import']['fcw'].get_filename() # TODO: multiple files
+	
+	fields = []
+	w = self.widgets['import']['fields']
+	for i in w:
+		if w[i].get_active():
+			fields.append(i)
+
+	__import__(&quot;plugins.imp.%s&quot; % plugin_name)
+	ip = eval(&quot;plugins.imp.%s.ImportPlugin(self, fields)&quot; % plugin_name)
+	if ip.initialize():
+		# TODO: show progres bar
+		# for file in selected_files:
+		if ip.run(filename):
+			gutils.info(self, _(&quot;%s file has been imported. %s movies added.&quot;) \
+				% (plugin_name, ip.imported), self.widgets['window'])
+			self.populate_treeview()
+			self.widgets['import']['window'].hide()
+		ip.clear()
+


Property changes on: griffith/lib/plugins/imp/__init__.py
___________________________________________________________________
Name: svn:keywords
   + Id

Added: griffith/lib/plugins/movie/__init__.py
===================================================================


Property changes on: griffith/lib/plugins/movie/__init__.py
___________________________________________________________________
Name: svn:keywords
   + Id


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000021.html">[Griffith-svn] r489 - in griffith: . lib/plugins/movie
</A></li>
	<LI>Next message: <A HREF="000023.html">[Griffith-svn] r491 - griffith/lib/plugins/movie
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22">[ date ]</a>
              <a href="thread.html#22">[ thread ]</a>
              <a href="subject.html#22">[ subject ]</a>
              <a href="author.html#22">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/griffith-svn">More information about the Griffith-svn
mailing list</a><br>
</body></html>
